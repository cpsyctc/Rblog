<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Correlation coefficients (1)</title>

  <meta property="description" itemprop="description" content="Exploration of the differences between different correlation coefficients."/>

  <link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"/>

  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2023-12-30"/>
  <meta property="article:created" itemprop="dateCreated" content="2023-12-30"/>
  <meta name="article:author" content="Chris Evans"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Correlation coefficients (1)"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Exploration of the differences between different correlation coefficients."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Correlation coefficients (1)"/>
  <meta property="twitter:description" content="Exploration of the differences between different correlation coefficients."/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","categories","output","creative_commons"]}},"value":[{"type":"character","attributes":{},"value":["Correlation coefficients (1)"]},{"type":"character","attributes":{},"value":["Exploration of the differences between different correlation coefficients.\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation","affiliation_url","orcid_id"]}},"value":[{"type":"character","attributes":{},"value":["Chris Evans"]},{"type":"character","attributes":{},"value":["https://www.psyctc.org/R_blog/"]},{"type":"character","attributes":{},"value":["PSYCTC.org"]},{"type":"character","attributes":{},"value":["https://www.psyctc.org/psyctc/"]},{"type":"character","attributes":{},"value":["0000-0002-4197-4202"]}]}]},{"type":"character","attributes":{},"value":["2023-12-30"]},{"type":"character","attributes":{},"value":["correlations"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","toc_depth","highlight_downlit","self_contained","code_folding"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[4]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["CC BY-SA"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["correlations_files/anchor-4.2.2/anchor.min.js","correlations_files/bowser-1.9.3/bowser.min.js","correlations_files/distill-2.2.21/template.v2.js","correlations_files/figure-html5/Kendall2N4-1.png","correlations_files/figure-html5/plot1n4-1.png","correlations_files/figure-html5/plot2n4-1.png","correlations_files/figure-html5/Spearman3N4-1.png","correlations_files/figure-html5/transformations1-1.png","correlations_files/figure-html5/transformations3-1.png","correlations_files/figure-html5/transformations5-1.png","correlations_files/header-attrs-2.25/header-attrs.js","correlations_files/jquery-3.6.0/jquery-3.6.0.js","correlations_files/jquery-3.6.0/jquery-3.6.0.min.js","correlations_files/jquery-3.6.0/jquery-3.6.0.min.map","correlations_files/popper-2.6.0/popper.min.js","correlations_files/tabwid-1.1.3/tabwid.css","correlations_files/tabwid-1.1.3/tabwid.js","correlations_files/tippy-6.2.7/tippy-bundle.umd.min.js","correlations_files/tippy-6.2.7/tippy-light-border.css","correlations_files/tippy-6.2.7/tippy.css","correlations_files/tippy-6.2.7/tippy.umd.min.js","correlations_files/webcomponents-2.0.0/webcomponents.js","distill-preview.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  hr.section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    margin: 0px;
  }


  d-byline {
    border-top: none;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
    border-top: none;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  /* tweak for Pandoc numbered line within distill */
  d-article pre.numberSource code > span {
      left: -2em;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // separator
    var separator = '<hr class="section-separator" style="clear: both"/>';
    // prepend separator above appendix
    $('.d-byline').before(separator);
    $('.d-article').before(separator);

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme, except when numbering line
    // in code chunk
    $('pre:not(.numberLines) code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        var author_name = front_matter.authors[i].author
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="correlations_files/header-attrs-2.25/header-attrs.js"></script>
  <link href="correlations_files/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
  <script src="correlations_files/tabwid-1.1.3/tabwid.js"></script>
  <script src="correlations_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="correlations_files/popper-2.6.0/popper.min.js"></script>
  <link href="correlations_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="correlations_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="correlations_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="correlations_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="correlations_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="correlations_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="correlations_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Correlation coefficients (1)","description":"Exploration of the differences between different correlation coefficients.","authors":[{"author":"Chris Evans","authorURL":"https://www.psyctc.org/R_blog/","affiliation":"PSYCTC.org","affiliationURL":"https://www.psyctc.org/psyctc/","orcidID":"0000-0002-4197-4202"}],"publishedDate":"2023-12-30T00:00:00.000+00:00","citationText":"Evans, 2023"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Correlation coefficients (1)</h1>

<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt-tag">correlations</div>
</div>
<!--/radix_placeholder_categories-->
<p><p>Exploration of the differences between different correlation coefficients.</p></p>
</div>

<div class="d-byline">
  Chris Evans <a href="https://www.psyctc.org/R_blog/" class="uri">https://www.psyctc.org/R_blog/</a> (PSYCTC.org)<a href="https://www.psyctc.org/psyctc/" class="uri">https://www.psyctc.org/psyctc/</a>
  
<br/>2023-12-30
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#what-correlation-coefficients-are-doing" id="toc-what-correlation-coefficients-are-doing">What correlation coefficients are doing</a></li>
<li><a href="#the-scaling-of-our-variables" id="toc-the-scaling-of-our-variables">The scaling of our variables</a>
<ul>
<li><a href="#getting-an-unbiased-estimate-of-a-population-coefficient" id="toc-getting-an-unbiased-estimate-of-a-population-coefficient">Getting an unbiased estimate of a population coefficient</a></li>
<li><a href="#summarising-the-pearson-correlation-coefficient" id="toc-summarising-the-pearson-correlation-coefficient">Summarising the Pearson correlation coefficient</a></li>
</ul></li>
<li><a href="#rank-correlation" id="toc-rank-correlation">Rank correlation</a>
<ul>
<li><a href="#spearman-rank-correlation-coefficient" id="toc-spearman-rank-correlation-coefficient">Spearman rank correlation coefficient</a></li>
<li><a href="#summarising-the-spearman-correlation-coefficient" id="toc-summarising-the-spearman-correlation-coefficient">Summarising the Spearman correlation coefficient</a></li>
<li><a href="#kendalls-tau-correlation-coefficients-tau" id="toc-kendalls-tau-correlation-coefficients-tau">Kendall’s tau correlation coefficients <span class="math inline">\(\tau\)</span></a></li>
</ul></li>
<li><a href="#but-what-about-ties-why-are-there-multiple-kendall-correlation-coefficients" id="toc-but-what-about-ties-why-are-there-multiple-kendall-correlation-coefficients">But what about ties? Why are there multiple Kendall correlation coefficients?</a>
<ul>
<li><a href="#kendalls-tau-c-correlation-coefficient" id="toc-kendalls-tau-c-correlation-coefficient">Kendall’s tau c correlation coefficient</a></li>
<li><a href="#summarising-kendalls-tau-correlation-coefficients" id="toc-summarising-kendalls-tau-correlation-coefficients">Summarising Kendall’s tau correlation coefficients</a></li>
</ul></li>
<li><a href="#are-the-values-comparable-across-the-different-coefficients-for-the-same-data" id="toc-are-the-values-comparable-across-the-different-coefficients-for-the-same-data">Are the values comparable across the different coefficients for the same data?</a></li>
<li><a href="#effects-of-transformations-of-the-data" id="toc-effects-of-transformations-of-the-data">Effects of transformations of the data</a>
<ul>
<li><a href="#linear-transforms" id="toc-linear-transforms">Linear transforms</a></li>
<li><a href="#non-linear-transforms" id="toc-non-linear-transforms">Non-linear transforms</a></li>
<li><a href="#tie-creating-transforms" id="toc-tie-creating-transforms">Tie creating transforms</a></li>
</ul></li>
<li><a href="#summarising-the-different-correlation-coefficients" id="toc-summarising-the-different-correlation-coefficients">Summarising the different correlation coefficients</a></li>
<li><a href="#conclusions" id="toc-conclusions">Conclusions</a></li>
</ul>
</nav>
</div>
<p>At various times in my research career I think I have made use of the Pearson correlation coefficient (often), Spearman ditto (often), Kendall tau b (rarely) and I don’t think I have ever used Kendall’s tau c but I knew it existed but I don’t think I’d ever been able to explain when it was best to use it or why. I don’t think I knew that Kendall’s tau a existed. This is an attempt to get the differences sorted out. However, I am also going to look at:</p>
<ul>
<li>the basics of what these coefficients are doing</li>
<li>how this relates to issues of “scaling” and to Steven’s hierarchy of scaling properties</li>
<li>hence the distinction between rank order correlations and Pearson’s correlation coefficient</li>
<li>comparing values across the different coefficients</li>
<li>effects of transformations of the data on the coefficients</li>
</ul>
<p>Those issues form the bases for the following further isues but I’ll put those in later posts as this is getting long enough already!</p>
<ul>
<li>issues about “testing” a correlation, technically, testing whether a correlation as strong as, or stronger than, the one seen in the dataset might by unlikely to have arisen in chance sampling of that dataset from a null population model, i.e. p values and the NHST (Null Hypothesis Significance Test) of an observed correlation</li>
<li>how this relates to distributions: in the dataset and in any postulated population from which the dataset came</li>
<li>touching a bit on estimation: the precision with which a correlation from give dataset might estimate a (not necessarily null) population correlation, i.e. finding a confidence interval around an observed correlation value.</li>
</ul>
<h2 id="what-correlation-coefficients-are-doing">What correlation coefficients are doing</h2>
<p>So why are we computing correlations? Or more technically “why are we computing correlation <em>coefficients</em>?”</p>
<p>This seems obvious: we want to know whether the values of one variable in a dataset seem to be systematically related to the values of another variable.</p>
<h2 id="the-scaling-of-our-variables">The scaling of our variables</h2>
<p>If we want to know whether the values of one variable in a dataset seem to be systematically related to the values of another variable we are clearly into questions of scalin and the classic story about scaling, at least in the psychological realm, is Steven’s levels of measurement, keeping things in the house, I hope <a href="https://www.psyctc.org/psyctc/glossary2/ratio-scaling/">this entry</a> in the <a href="https://www.psyctc.org/psyctc/book/glossary/">glossary</a> for Jo-anne’s and my <a href="https://www.psyctc.org/psyctc/book/">OMbook</a>.</p>
<p>Let’s start with an example with a tiny dataset to make it easy to show how the various correlation coefficients are calculated.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>12345</span><span class='op'>)</span></span>
<span><span class='va'>totN</span> <span class='op'>&lt;-</span> <span class='fl'>4</span></span>
<span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>totN</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>ID <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/row_number.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>         y <span class='op'>=</span> <span class='va'>x</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>totN</span>, sd <span class='op'>=</span> <span class='fl'>.5</span><span class='op'>)</span>,</span>
<span>         meanX <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,</span>
<span>         meanY <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>,</span>
<span>         sdX <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,</span>
<span>         sdY <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>,</span>
<span>         devX <span class='op'>=</span> <span class='va'>x</span> <span class='op'>-</span> <span class='va'>meanX</span>,</span>
<span>         devY <span class='op'>=</span> <span class='va'>y</span> <span class='op'>-</span> <span class='va'>meanY</span>,</span>
<span>         stdX <span class='op'>=</span> <span class='va'>devX</span> <span class='op'>/</span> <span class='va'>sdX</span>,</span>
<span>         stdY <span class='op'>=</span> <span class='va'>devY</span> <span class='op'>/</span> <span class='va'>sdY</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibDat1N4</span></span>
<span></span>
<span><span class='va'>tibDat1N4</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-a7e852a0{}.cl-a7de37c0{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-a7e1a356{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-a7e1a360{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-a7e1ba4e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a7e1ba4f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a7e1ba58{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a7e1ba62{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a7e1ba63{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a7e1ba64{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-a7e852a0'><thead><tr style="overflow-wrap:break-word;"><th class="cl-a7e1ba4e"><p class="cl-a7e1a356"><span class="cl-a7de37c0">ID</span></p></th><th class="cl-a7e1ba4f"><p class="cl-a7e1a360"><span class="cl-a7de37c0">x</span></p></th><th class="cl-a7e1ba4f"><p class="cl-a7e1a360"><span class="cl-a7de37c0">y</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-a7e1ba58"><p class="cl-a7e1a356"><span class="cl-a7de37c0">1</span></p></td><td class="cl-a7e1ba62"><p class="cl-a7e1a360"><span class="cl-a7de37c0">-0.45</span></p></td><td class="cl-a7e1ba62"><p class="cl-a7e1a360"><span class="cl-a7de37c0">-0.15</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a7e1ba58"><p class="cl-a7e1a356"><span class="cl-a7de37c0">2</span></p></td><td class="cl-a7e1ba62"><p class="cl-a7e1a360"><span class="cl-a7de37c0">-0.11</span></p></td><td class="cl-a7e1ba62"><p class="cl-a7e1a360"><span class="cl-a7de37c0">-1.02</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a7e1ba58"><p class="cl-a7e1a356"><span class="cl-a7de37c0">3</span></p></td><td class="cl-a7e1ba62"><p class="cl-a7e1a360"><span class="cl-a7de37c0">0.59</span></p></td><td class="cl-a7e1ba62"><p class="cl-a7e1a360"><span class="cl-a7de37c0">0.90</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a7e1ba63"><p class="cl-a7e1a356"><span class="cl-a7de37c0">4</span></p></td><td class="cl-a7e1ba64"><p class="cl-a7e1a360"><span class="cl-a7de37c0">0.71</span></p></td><td class="cl-a7e1ba64"><p class="cl-a7e1a360"><span class="cl-a7de37c0">0.57</span></p></td></tr></tbody></table></div>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>valPearson1N4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>tibDat1N4</span><span class='op'>$</span><span class='va'>x</span>, <span class='va'>tibDat1N4</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span></span></code></pre>
</div>
</details>
</div>
<p>That tiny <em>n</em> = 4 dataset has a Pearson correlation coefficient of
0.74</p>
<p>A scattergram of the data looks like this.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibDat1N4</span>, </span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>meanX</span>, y <span class='op'>=</span> <span class='va'>meanY</span><span class='op'>)</span>,</span>
<span>             shape <span class='op'>=</span> <span class='fl'>23</span>,</span>
<span>             size <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             fill <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>ID</span><span class='op'>)</span>,</span>
<span>            nudge_x <span class='op'>=</span> <span class='fl'>.05</span>,</span>
<span>            nudge_y <span class='op'>=</span> <span class='fl'>.05</span>,</span>
<span>            size <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span>                  ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Scattergram of n = "</span>,</span>
<span>                 <span class='va'>totN</span>,</span>
<span>                 <span class='st'>" dataset, numbered by x values"</span><span class='op'>)</span>,</span>
<span>          subtitle <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Reference lines mark zero on x and y axes"</span>,</span>
<span>                            <span class='st'>"\nRed diamond marks mean for both x and y"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>aspect.ratio <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="correlations_files/figure-html5/plot1n4-1.png" width="1536" /></p>
</div>
<p>We get to the Pearson correlation coefficient in effect by standardising each of the variables, i.e. replacing the scores by their deviation from their mean score and then dividing those deviations by the standard deviation of each variable. For our little dataset that gives us this.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibDat1N4</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-a886534c{}.cl-a8809722{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-a8831bd2{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-a8831bdc{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-a8832b90{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a8832b9a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a8832b9b{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a8832ba4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a8832bae{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a8832baf{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-a886534c'><thead><tr style="overflow-wrap:break-word;"><th class="cl-a8832b90"><p class="cl-a8831bd2"><span class="cl-a8809722">ID</span></p></th><th class="cl-a8832b9a"><p class="cl-a8831bdc"><span class="cl-a8809722">x</span></p></th><th class="cl-a8832b9a"><p class="cl-a8831bdc"><span class="cl-a8809722">y</span></p></th><th class="cl-a8832b9a"><p class="cl-a8831bdc"><span class="cl-a8809722">meanX</span></p></th><th class="cl-a8832b9a"><p class="cl-a8831bdc"><span class="cl-a8809722">meanY</span></p></th><th class="cl-a8832b9a"><p class="cl-a8831bdc"><span class="cl-a8809722">sdX</span></p></th><th class="cl-a8832b9a"><p class="cl-a8831bdc"><span class="cl-a8809722">sdY</span></p></th><th class="cl-a8832b9a"><p class="cl-a8831bdc"><span class="cl-a8809722">devX</span></p></th><th class="cl-a8832b9a"><p class="cl-a8831bdc"><span class="cl-a8809722">devY</span></p></th><th class="cl-a8832b9a"><p class="cl-a8831bdc"><span class="cl-a8809722">stdX</span></p></th><th class="cl-a8832b9a"><p class="cl-a8831bdc"><span class="cl-a8809722">stdY</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-a8832b9b"><p class="cl-a8831bd2"><span class="cl-a8809722">1</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">-0.45</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">-0.15</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">0.18</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">0.08</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">0.56</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">0.85</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">-0.64</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">-0.23</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">-1.14</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">-0.27</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a8832b9b"><p class="cl-a8831bd2"><span class="cl-a8809722">2</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">-0.11</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">-1.02</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">0.18</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">0.08</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">0.56</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">0.85</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">-0.29</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">-1.09</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">-0.53</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">-1.29</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a8832b9b"><p class="cl-a8831bd2"><span class="cl-a8809722">3</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">0.59</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">0.90</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">0.18</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">0.08</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">0.56</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">0.85</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">0.40</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">0.82</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">0.72</span></p></td><td class="cl-a8832ba4"><p class="cl-a8831bdc"><span class="cl-a8809722">0.97</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a8832bae"><p class="cl-a8831bd2"><span class="cl-a8809722">4</span></p></td><td class="cl-a8832baf"><p class="cl-a8831bdc"><span class="cl-a8809722">0.71</span></p></td><td class="cl-a8832baf"><p class="cl-a8831bdc"><span class="cl-a8809722">0.57</span></p></td><td class="cl-a8832baf"><p class="cl-a8831bdc"><span class="cl-a8809722">0.18</span></p></td><td class="cl-a8832baf"><p class="cl-a8831bdc"><span class="cl-a8809722">0.08</span></p></td><td class="cl-a8832baf"><p class="cl-a8831bdc"><span class="cl-a8809722">0.56</span></p></td><td class="cl-a8832baf"><p class="cl-a8831bdc"><span class="cl-a8809722">0.85</span></p></td><td class="cl-a8832baf"><p class="cl-a8831bdc"><span class="cl-a8809722">0.53</span></p></td><td class="cl-a8832baf"><p class="cl-a8831bdc"><span class="cl-a8809722">0.50</span></p></td><td class="cl-a8832baf"><p class="cl-a8831bdc"><span class="cl-a8809722">0.95</span></p></td><td class="cl-a8832baf"><p class="cl-a8831bdc"><span class="cl-a8809722">0.58</span></p></td></tr></tbody></table></div>
</div>
<p>That shows the mean values for each variable, the deviations of the scores from those means (for each variable) and then the standardised deviations. If we now plot these standardised values we get this.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibDat1N4</span>, </span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>stdX</span>, y <span class='op'>=</span> <span class='va'>stdY</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>0</span>, y <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>             shape <span class='op'>=</span> <span class='fl'>23</span>,</span>
<span>             size <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             fill <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>ID</span><span class='op'>)</span>,</span>
<span>            nudge_x <span class='op'>=</span> <span class='fl'>.05</span>,</span>
<span>            nudge_y <span class='op'>=</span> <span class='fl'>.05</span>,</span>
<span>            size <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1.2</span>, <span class='fl'>1.2</span><span class='op'>)</span>,</span>
<span>                  ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1.2</span>, <span class='fl'>1.2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Scattergram of standardised deviations from mean values"</span>,</span>
<span>          subtitle <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Reference lines mark zero deviations on x and y axes"</span>,</span>
<span>                            <span class='st'>"\nRed diamond marks mean for both x and y which must be zero"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>aspect.ratio <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="correlations_files/figure-html5/plot2n4-1.png" width="1536" /></p>
</div>
<p>The Pearson correlation coefficient is just the sum of the products of these deviation scores divided by the product of their variances. This shows the deviation data, standardised data, products of the standardised data and the squares of the standardised data. The final row gives the sum across the <em>n</em> = 4 observations.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibDat1N4</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>productStdXStdY <span class='op'>=</span> <span class='va'>stdX</span> <span class='op'>*</span> <span class='va'>stdY</span>,</span>
<span>         sqStdX <span class='op'>=</span> <span class='va'>stdX</span><span class='op'>^</span><span class='fl'>2</span>,</span>
<span>         sqStdY <span class='op'>=</span> <span class='va'>stdY</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibDat1N4</span></span>
<span></span>
<span><span class='va'>tibDat1N4</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>devX</span> <span class='op'>:</span> <span class='va'>sqStdY</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/across.html'>across</a></span><span class='op'>(</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='va'>sum</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>ID <span class='op'>=</span> <span class='st'>"Sum"</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibSumValues</span></span>
<span></span>
<span><span class='va'>tibDat1N4</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>devX</span> <span class='op'>:</span> <span class='va'>sqStdY</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind_rows.html'>bind_rows</a></span><span class='op'>(</span><span class='va'>tibSumValues</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-a905a93a{}.cl-a900a714{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-a902d200{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-a902d20a{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-a902dfac{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a902dfad{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a902dfae{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a902dfb6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a902dfb7{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a902dfb8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-a905a93a'><thead><tr style="overflow-wrap:break-word;"><th class="cl-a902dfac"><p class="cl-a902d200"><span class="cl-a900a714">ID</span></p></th><th class="cl-a902dfad"><p class="cl-a902d20a"><span class="cl-a900a714">devX</span></p></th><th class="cl-a902dfad"><p class="cl-a902d20a"><span class="cl-a900a714">devY</span></p></th><th class="cl-a902dfad"><p class="cl-a902d20a"><span class="cl-a900a714">stdX</span></p></th><th class="cl-a902dfad"><p class="cl-a902d20a"><span class="cl-a900a714">stdY</span></p></th><th class="cl-a902dfad"><p class="cl-a902d20a"><span class="cl-a900a714">productStdXStdY</span></p></th><th class="cl-a902dfad"><p class="cl-a902d20a"><span class="cl-a900a714">sqStdX</span></p></th><th class="cl-a902dfad"><p class="cl-a902d20a"><span class="cl-a900a714">sqStdY</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-a902dfae"><p class="cl-a902d200"><span class="cl-a900a714">1</span></p></td><td class="cl-a902dfb6"><p class="cl-a902d20a"><span class="cl-a900a714">-0.64</span></p></td><td class="cl-a902dfb6"><p class="cl-a902d20a"><span class="cl-a900a714">-0.23</span></p></td><td class="cl-a902dfb6"><p class="cl-a902d20a"><span class="cl-a900a714">-1.14</span></p></td><td class="cl-a902dfb6"><p class="cl-a902d20a"><span class="cl-a900a714">-0.27</span></p></td><td class="cl-a902dfb6"><p class="cl-a902d20a"><span class="cl-a900a714">0.30</span></p></td><td class="cl-a902dfb6"><p class="cl-a902d20a"><span class="cl-a900a714">1.31</span></p></td><td class="cl-a902dfb6"><p class="cl-a902d20a"><span class="cl-a900a714">0.07</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a902dfae"><p class="cl-a902d200"><span class="cl-a900a714">2</span></p></td><td class="cl-a902dfb6"><p class="cl-a902d20a"><span class="cl-a900a714">-0.29</span></p></td><td class="cl-a902dfb6"><p class="cl-a902d20a"><span class="cl-a900a714">-1.09</span></p></td><td class="cl-a902dfb6"><p class="cl-a902d20a"><span class="cl-a900a714">-0.53</span></p></td><td class="cl-a902dfb6"><p class="cl-a902d20a"><span class="cl-a900a714">-1.29</span></p></td><td class="cl-a902dfb6"><p class="cl-a902d20a"><span class="cl-a900a714">0.67</span></p></td><td class="cl-a902dfb6"><p class="cl-a902d20a"><span class="cl-a900a714">0.28</span></p></td><td class="cl-a902dfb6"><p class="cl-a902d20a"><span class="cl-a900a714">1.65</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a902dfae"><p class="cl-a902d200"><span class="cl-a900a714">3</span></p></td><td class="cl-a902dfb6"><p class="cl-a902d20a"><span class="cl-a900a714">0.40</span></p></td><td class="cl-a902dfb6"><p class="cl-a902d20a"><span class="cl-a900a714">0.82</span></p></td><td class="cl-a902dfb6"><p class="cl-a902d20a"><span class="cl-a900a714">0.72</span></p></td><td class="cl-a902dfb6"><p class="cl-a902d20a"><span class="cl-a900a714">0.97</span></p></td><td class="cl-a902dfb6"><p class="cl-a902d20a"><span class="cl-a900a714">0.70</span></p></td><td class="cl-a902dfb6"><p class="cl-a902d20a"><span class="cl-a900a714">0.52</span></p></td><td class="cl-a902dfb6"><p class="cl-a902d20a"><span class="cl-a900a714">0.94</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a902dfae"><p class="cl-a902d200"><span class="cl-a900a714">4</span></p></td><td class="cl-a902dfb6"><p class="cl-a902d20a"><span class="cl-a900a714">0.53</span></p></td><td class="cl-a902dfb6"><p class="cl-a902d20a"><span class="cl-a900a714">0.50</span></p></td><td class="cl-a902dfb6"><p class="cl-a902d20a"><span class="cl-a900a714">0.95</span></p></td><td class="cl-a902dfb6"><p class="cl-a902d20a"><span class="cl-a900a714">0.58</span></p></td><td class="cl-a902dfb6"><p class="cl-a902d20a"><span class="cl-a900a714">0.55</span></p></td><td class="cl-a902dfb6"><p class="cl-a902d20a"><span class="cl-a900a714">0.89</span></p></td><td class="cl-a902dfb6"><p class="cl-a902d20a"><span class="cl-a900a714">0.34</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a902dfb7"><p class="cl-a902d200"><span class="cl-a900a714">Sum</span></p></td><td class="cl-a902dfb8"><p class="cl-a902d20a"><span class="cl-a900a714">0.00</span></p></td><td class="cl-a902dfb8"><p class="cl-a902d20a"><span class="cl-a900a714">0.00</span></p></td><td class="cl-a902dfb8"><p class="cl-a902d20a"><span class="cl-a900a714">0.00</span></p></td><td class="cl-a902dfb8"><p class="cl-a902d20a"><span class="cl-a900a714">0.00</span></p></td><td class="cl-a902dfb8"><p class="cl-a902d20a"><span class="cl-a900a714">2.23</span></p></td><td class="cl-a902dfb8"><p class="cl-a902d20a"><span class="cl-a900a714">3.00</span></p></td><td class="cl-a902dfb8"><p class="cl-a902d20a"><span class="cl-a900a714">3.00</span></p></td></tr></tbody></table></div>
</div>
<p>So the Pearson correlation coefficient here is:</p>
<p><span class="math display">\[ \text{Pearson R}=\frac{\text{2.23}}{3} \]</span></p>
<p>which is the value
0.74 we saw earlier.</p>
<h3 id="getting-an-unbiased-estimate-of-a-population-coefficient">Getting an unbiased estimate of a population coefficient</h3>
<p>Why divided by three not divided by four? Because the sample variance and SD are biased estimates of the population variance and SD and we want a correlation coefficient that is an unbiased estimate of the population correlation coefficient so the divisor is <em>n</em> - 1 not <em>n</em>: the usual and completely robust correction for bias in estimating variances/SDs. In technical terms this is telling us the “covariance” of x and y: the proportion of their separate variances that is “shared”, i.e. in the same direction. This is achieved by taking the product of the deviations from the means. If both values are below the mean they are both negative and the product of two negatives, for example -1.14 * -.27 is a positive, here .30. Equally of course, the product of two positives is a positive, here say .95 * .58 being .55. So the mean of the products of the standardised deviations will be positive if the deviations are mostly in the same directions. Standardising, i.e. dividing by each variable’s standard deviation gives us a single scale for the correlation, regardless of the variances so we can multiply or divided those x and y values by any constant value, or add or subtract any constant value from them and we will still get the same correlation.</p>
<h3 id="summarising-the-pearson-correlation-coefficient">Summarising the Pearson correlation coefficient</h3>
<ul>
<li>This is the standardised covariance of the two sets of values in the dataset.<br />
</li>
<li>It is bounded by -1 for perfect negative correlation and +1 for perfect positive correlation and is zero if there is no simple correlation.</li>
<li>A zero value does not mean there is no systematic relationship between the two variables, just that there is no simple correlation.</li>
<li>The “standardised” ensures it is independent of the scale of the variables so any linear transform of either or both leaves the correlation unchanged.</li>
<li><strong>The big caveat</strong>: Because it is using the raw values of the data points it implicitly assumes that the scaling of each variable can be meaningfully interpreted as equal interval, i.e. that the a score of say 7 is as much bigger than a score of say 5 than is 12 from 10. Technically this is Stevens’s “interval scaling” and assumes, and permits, all linear transforms. This is clearly true if the variables are count data, however for most scores from questionnaires this is clearly <em>not</em> formally true. Stevens “levels of measurement” mapped failure to have at least interval scaling to an obligation to use non-parametric rather than parametric statistical methods but that was rather confounding the issue of scaling with the issue of distribution. That was understandable as things like the maths of Gaussian “Normal” distributions only really make sense if you have interval scaling. However, Lord’s glorious paper Lord, F. M. (1953). <em>On the statistical treatment of football numbers</em>. The American Psychologist, 8, 750–751, showed that not all parametric tests require more than nominal scaling and to me the issue has always seemed to be about the meanings that we attach to our analyses and to the statistics they give us. Using the Pearson correlation coefficient means that we do believe the raw numbers have some some “soft” or “approximate” interval scaling, and always measured with unreliability, but ignoring the raw numbers and just looking at their rank relationships would be losing some of the scaling that you have in your data. On the other hand we should certainly be cautious and not attribute to our analyses precision that really isn’t there: these are not true interval scales. (I’m deferring the issues about formal NHST p values and/or confidence intervals for now.)</li>
</ul>
<h2 id="rank-correlation">Rank correlation</h2>
<p>If we don’t assume that the raw data have the real or my “soft” interval scaling then analysing the raw scores with Pearson’s correlation coefficient, as it relies on the raw scores and their scaling, makes no sense. However, we can look at rank correlation. A positive Pearson correlation coefficient tells us is how much scores on the one variable are associated with scores on the other assuming at least interval scaling, i.e. weighting by the sizes of the values. By contrast a positive rank correlation coefficient only tells is whether a value ranked higher on one variable is likely to be ranked higher on the other. This brings us to the issue that there are a number of ways of indexing rank correlation each with their own advantages. It will also get us to ranking with ties <em>versus</em> perfect ranking. But first the three rank correlation coefficients most used in the mental health, psychology and therapy realms:</p>
<ul>
<li>Spearman rank correlation coefficient</li>
<li>Kendall’s tau b correlation coefficient</li>
<li>Kendall’s tau c correlation coefficient</li>
</ul>
<h3 id="spearman-rank-correlation-coefficient">Spearman rank correlation coefficient</h3>
<p>This is usually given the Greek letter rho (<span class="math inline">\(\rho\)</span>) or sometimes <span class="math inline">\(R_{s}\)</span> and it is simply the Pearson correlation not of the raw scores but of their ranks (within each variable). Here are our data showing the ranks.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibDat1N4</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>rankX <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,</span>
<span>         rankY <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibDat1N4</span></span>
<span></span>
<span><span class='va'>tibDat1N4</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>x</span>, <span class='va'>y</span>, <span class='va'>rankX</span>, <span class='va'>rankY</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-310d1934{}.cl-3104ee76{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-310762b4{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-310762b5{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-31077452{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31077453{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3107745c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3107745d{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31077466{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31077467{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-310d1934'><thead><tr style="overflow-wrap:break-word;"><th class="cl-31077452"><p class="cl-310762b4"><span class="cl-3104ee76">ID</span></p></th><th class="cl-31077453"><p class="cl-310762b5"><span class="cl-3104ee76">x</span></p></th><th class="cl-31077453"><p class="cl-310762b5"><span class="cl-3104ee76">y</span></p></th><th class="cl-31077453"><p class="cl-310762b5"><span class="cl-3104ee76">rankX</span></p></th><th class="cl-31077453"><p class="cl-310762b5"><span class="cl-3104ee76">rankY</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-3107745c"><p class="cl-310762b4"><span class="cl-3104ee76">1</span></p></td><td class="cl-3107745d"><p class="cl-310762b5"><span class="cl-3104ee76">-0.45</span></p></td><td class="cl-3107745d"><p class="cl-310762b5"><span class="cl-3104ee76">-0.15</span></p></td><td class="cl-3107745d"><p class="cl-310762b5"><span class="cl-3104ee76">1</span></p></td><td class="cl-3107745d"><p class="cl-310762b5"><span class="cl-3104ee76">2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3107745c"><p class="cl-310762b4"><span class="cl-3104ee76">2</span></p></td><td class="cl-3107745d"><p class="cl-310762b5"><span class="cl-3104ee76">-0.11</span></p></td><td class="cl-3107745d"><p class="cl-310762b5"><span class="cl-3104ee76">-1.02</span></p></td><td class="cl-3107745d"><p class="cl-310762b5"><span class="cl-3104ee76">2</span></p></td><td class="cl-3107745d"><p class="cl-310762b5"><span class="cl-3104ee76">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3107745c"><p class="cl-310762b4"><span class="cl-3104ee76">3</span></p></td><td class="cl-3107745d"><p class="cl-310762b5"><span class="cl-3104ee76">0.59</span></p></td><td class="cl-3107745d"><p class="cl-310762b5"><span class="cl-3104ee76">0.90</span></p></td><td class="cl-3107745d"><p class="cl-310762b5"><span class="cl-3104ee76">3</span></p></td><td class="cl-3107745d"><p class="cl-310762b5"><span class="cl-3104ee76">4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-31077466"><p class="cl-310762b4"><span class="cl-3104ee76">4</span></p></td><td class="cl-31077467"><p class="cl-310762b5"><span class="cl-3104ee76">0.71</span></p></td><td class="cl-31077467"><p class="cl-310762b5"><span class="cl-3104ee76">0.57</span></p></td><td class="cl-31077467"><p class="cl-310762b5"><span class="cl-3104ee76">4</span></p></td><td class="cl-31077467"><p class="cl-310762b5"><span class="cl-3104ee76">3</span></p></td></tr></tbody></table></div>
</div>
<p>Using the Pearson correlation of the ranks ensures a positive correlation if as the values are higher on the one variable they also tend to be higher on the other. However it ignores the sizes of the differences of scores on the raw variables. This trivial code shows that the asking for the Pearson correlation of the rank data gets you exactly the same value as if you ask for the Spearman correlation of the raw data (that calculation will ignore the raw values of course).</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>### get the Spearman correlation by asking for the Pearson correlation of the ranks</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span><span class='op'>(</span><span class='st'>"%5.3f"</span>, <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>tibDat1N4</span><span class='op'>$</span><span class='va'>rankX</span>, <span class='va'>tibDat1N4</span><span class='op'>$</span><span class='va'>rankY</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>[1] &quot;0.600&quot;</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>### get the Spearman correlation by asking for it to be computed directly from raw data</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span><span class='op'>(</span><span class='st'>"%5.3f"</span>, <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>tibDat1N4</span><span class='op'>$</span><span class='va'>x</span>, <span class='va'>tibDat1N4</span><span class='op'>$</span><span class='va'>y</span>, method <span class='op'>=</span> <span class='st'>"spearman"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>[1] &quot;0.600&quot;</code></pre>
</div>
<p>The scattergram of the ranks is very simple.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibDat1N4</span>,</span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>rankX</span>, y <span class='op'>=</span> <span class='va'>rankY</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>2.5</span>, y <span class='op'>=</span> <span class='fl'>2.5</span>,</span>
<span>             shape <span class='op'>=</span> <span class='fl'>23</span>,</span>
<span>             size <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             fill <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fl'>2.5</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='fl'>2.5</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>ID</span><span class='op'>)</span>,</span>
<span>            nudge_x <span class='op'>=</span> <span class='fl'>.1</span>,</span>
<span>            nudge_y <span class='op'>=</span> <span class='fl'>.1</span>,</span>
<span>            size <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>4</span><span class='op'>)</span>,</span>
<span>                  ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Scattergram of ranks of values"</span>,</span>
<span>          subtitle <span class='op'>=</span> <span class='st'>"Red diamond and reference line mark mean ranks"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>aspect.ratio <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="correlations_files/figure-html5/Spearman3N4-1.png" width="1536" /></p>
</div>
<p>I think the Spearman correlation coefficient is very easy to understand once someone has been taught about the Pearson correlation coefficient. That perhaps explains why There’s a good <a href="https://en.wikipedia.org/wiki/Spearman%27s_rank_correlation_coefficient">Wikipedia page about the Spearman coefficient</a> if you want more about it but some of that anticipates what I’ll come to after looking at Kendall’s correlation coefficients.</p>
<h3 id="summarising-the-spearman-correlation-coefficient">Summarising the Spearman correlation coefficient</h3>
<ul>
<li>It’s a very simple idea: get the Pearson correlation not of the raw data but of the ranks of the data within each variable.</li>
</ul>
<h3 id="kendalls-tau-correlation-coefficients-tau">Kendall’s tau correlation coefficients <span class="math inline">\(\tau\)</span></h3>
<p>This takes a different approach from that of the Spearman coefficient that involves looking at all possible <em>pairs</em> of points and then at whether they are “concordant” or “discordant”. In a concordant pair both variables in the same rank order and in a discordant pair the variables are ranked in the opposite order. With our tiny dataset of four points there are four distinct pairs of points and their concordance is shown in this table.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibDat1N4</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span></span>
<span></span>
<span><span class='co'>### one way to get all combinations of the IDs</span></span>
<span><span class='fu'><a href='https://tidyr.tidyverse.org/reference/expand_grid.html'>expand_grid</a></span><span class='op'>(</span>ID1 <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span>, ID2 <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>ID2</span> <span class='op'>&gt;</span> <span class='va'>ID1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>ID1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>ID1</span><span class='op'>)</span>,</span>
<span>         ID2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>ID2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='co'>### rename ID1 to ID and pull in the first set of data</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>ID <span class='op'>=</span> <span class='va'>ID1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>tmpTib</span>, by <span class='op'>=</span> <span class='st'>"ID"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>x1 <span class='op'>=</span> <span class='va'>x</span>,</span>
<span>         y1 <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='co'>### rename ID1 back again and then ID2 to ID and pull in the second set of data</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>ID1 <span class='op'>=</span> <span class='va'>ID</span>,</span>
<span>         ID <span class='op'>=</span> <span class='va'>ID2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>tmpTib</span>, by <span class='op'>=</span> <span class='st'>"ID"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>x2 <span class='op'>=</span> <span class='va'>x</span>,</span>
<span>         y2 <span class='op'>=</span> <span class='va'>y</span>,</span>
<span>         ID2 <span class='op'>=</span> <span class='va'>ID</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>pairN <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/row_number.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>pairN</span>, <span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibPairs</span></span>
<span></span>
<span><span class='va'>tibPairs</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>tiedX <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Logic.html'>isTRUE</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/all_equal.html'>all_equal</a></span><span class='op'>(</span><span class='va'>x1</span>, <span class='va'>x2</span><span class='op'>)</span><span class='op'>)</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>         tiedY <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Logic.html'>isTRUE</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/all_equal.html'>all_equal</a></span><span class='op'>(</span><span class='va'>y1</span>, <span class='va'>y2</span><span class='op'>)</span><span class='op'>)</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>         Concordant <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>x1</span> <span class='op'>&lt;</span> <span class='va'>x2</span> <span class='op'>&amp;</span> <span class='va'>y1</span> <span class='op'>&lt;</span> <span class='va'>y2</span><span class='op'>)</span> <span class='op'>|</span> <span class='op'>(</span><span class='va'>x1</span> <span class='op'>&gt;</span> <span class='va'>x2</span> <span class='op'>&amp;</span> <span class='va'>y1</span> <span class='op'>&gt;</span> <span class='va'>y2</span><span class='op'>)</span>, <span class='st'>"Concordant"</span>, <span class='st'>"Discordant"</span><span class='op'>)</span>,</span>
<span>         Pair <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Pair "</span>, <span class='va'>pairN</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibPairs</span></span>
<span></span>
<span><span class='va'>tibPairs</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>Pair</span>, <span class='va'>ID1</span>, <span class='va'>ID2</span>, <span class='va'>x1</span>, <span class='va'>y1</span>, <span class='va'>x2</span>, <span class='va'>y2</span>, <span class='va'>Concordant</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-cfa24f78{}.cl-cf9be9d0{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-cf9f0106{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-cf9f0110{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-cf9f111e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cf9f1128{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cf9f1129{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cf9f112a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cf9f1132{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cf9f1133{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-cfa24f78'><thead><tr style="overflow-wrap:break-word;"><th class="cl-cf9f111e"><p class="cl-cf9f0106"><span class="cl-cf9be9d0">Pair</span></p></th><th class="cl-cf9f111e"><p class="cl-cf9f0106"><span class="cl-cf9be9d0">ID1</span></p></th><th class="cl-cf9f111e"><p class="cl-cf9f0106"><span class="cl-cf9be9d0">ID2</span></p></th><th class="cl-cf9f1128"><p class="cl-cf9f0110"><span class="cl-cf9be9d0">x1</span></p></th><th class="cl-cf9f1128"><p class="cl-cf9f0110"><span class="cl-cf9be9d0">y1</span></p></th><th class="cl-cf9f1128"><p class="cl-cf9f0110"><span class="cl-cf9be9d0">x2</span></p></th><th class="cl-cf9f1128"><p class="cl-cf9f0110"><span class="cl-cf9be9d0">y2</span></p></th><th class="cl-cf9f111e"><p class="cl-cf9f0106"><span class="cl-cf9be9d0">Concordant</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-cf9f1129"><p class="cl-cf9f0106"><span class="cl-cf9be9d0">Pair 1</span></p></td><td class="cl-cf9f1129"><p class="cl-cf9f0106"><span class="cl-cf9be9d0">1</span></p></td><td class="cl-cf9f1129"><p class="cl-cf9f0106"><span class="cl-cf9be9d0">2</span></p></td><td class="cl-cf9f112a"><p class="cl-cf9f0110"><span class="cl-cf9be9d0">-0.45</span></p></td><td class="cl-cf9f112a"><p class="cl-cf9f0110"><span class="cl-cf9be9d0">-0.15</span></p></td><td class="cl-cf9f112a"><p class="cl-cf9f0110"><span class="cl-cf9be9d0">-0.11</span></p></td><td class="cl-cf9f112a"><p class="cl-cf9f0110"><span class="cl-cf9be9d0">-1.02</span></p></td><td class="cl-cf9f1129"><p class="cl-cf9f0106"><span class="cl-cf9be9d0">Discordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf9f1129"><p class="cl-cf9f0106"><span class="cl-cf9be9d0">Pair 2</span></p></td><td class="cl-cf9f1129"><p class="cl-cf9f0106"><span class="cl-cf9be9d0">1</span></p></td><td class="cl-cf9f1129"><p class="cl-cf9f0106"><span class="cl-cf9be9d0">3</span></p></td><td class="cl-cf9f112a"><p class="cl-cf9f0110"><span class="cl-cf9be9d0">-0.45</span></p></td><td class="cl-cf9f112a"><p class="cl-cf9f0110"><span class="cl-cf9be9d0">-0.15</span></p></td><td class="cl-cf9f112a"><p class="cl-cf9f0110"><span class="cl-cf9be9d0">0.59</span></p></td><td class="cl-cf9f112a"><p class="cl-cf9f0110"><span class="cl-cf9be9d0">0.90</span></p></td><td class="cl-cf9f1129"><p class="cl-cf9f0106"><span class="cl-cf9be9d0">Concordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf9f1129"><p class="cl-cf9f0106"><span class="cl-cf9be9d0">Pair 3</span></p></td><td class="cl-cf9f1129"><p class="cl-cf9f0106"><span class="cl-cf9be9d0">1</span></p></td><td class="cl-cf9f1129"><p class="cl-cf9f0106"><span class="cl-cf9be9d0">4</span></p></td><td class="cl-cf9f112a"><p class="cl-cf9f0110"><span class="cl-cf9be9d0">-0.45</span></p></td><td class="cl-cf9f112a"><p class="cl-cf9f0110"><span class="cl-cf9be9d0">-0.15</span></p></td><td class="cl-cf9f112a"><p class="cl-cf9f0110"><span class="cl-cf9be9d0">0.71</span></p></td><td class="cl-cf9f112a"><p class="cl-cf9f0110"><span class="cl-cf9be9d0">0.57</span></p></td><td class="cl-cf9f1129"><p class="cl-cf9f0106"><span class="cl-cf9be9d0">Concordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf9f1129"><p class="cl-cf9f0106"><span class="cl-cf9be9d0">Pair 4</span></p></td><td class="cl-cf9f1129"><p class="cl-cf9f0106"><span class="cl-cf9be9d0">2</span></p></td><td class="cl-cf9f1129"><p class="cl-cf9f0106"><span class="cl-cf9be9d0">3</span></p></td><td class="cl-cf9f112a"><p class="cl-cf9f0110"><span class="cl-cf9be9d0">-0.11</span></p></td><td class="cl-cf9f112a"><p class="cl-cf9f0110"><span class="cl-cf9be9d0">-1.02</span></p></td><td class="cl-cf9f112a"><p class="cl-cf9f0110"><span class="cl-cf9be9d0">0.59</span></p></td><td class="cl-cf9f112a"><p class="cl-cf9f0110"><span class="cl-cf9be9d0">0.90</span></p></td><td class="cl-cf9f1129"><p class="cl-cf9f0106"><span class="cl-cf9be9d0">Concordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf9f1129"><p class="cl-cf9f0106"><span class="cl-cf9be9d0">Pair 5</span></p></td><td class="cl-cf9f1129"><p class="cl-cf9f0106"><span class="cl-cf9be9d0">2</span></p></td><td class="cl-cf9f1129"><p class="cl-cf9f0106"><span class="cl-cf9be9d0">4</span></p></td><td class="cl-cf9f112a"><p class="cl-cf9f0110"><span class="cl-cf9be9d0">-0.11</span></p></td><td class="cl-cf9f112a"><p class="cl-cf9f0110"><span class="cl-cf9be9d0">-1.02</span></p></td><td class="cl-cf9f112a"><p class="cl-cf9f0110"><span class="cl-cf9be9d0">0.71</span></p></td><td class="cl-cf9f112a"><p class="cl-cf9f0110"><span class="cl-cf9be9d0">0.57</span></p></td><td class="cl-cf9f1129"><p class="cl-cf9f0106"><span class="cl-cf9be9d0">Concordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf9f1132"><p class="cl-cf9f0106"><span class="cl-cf9be9d0">Pair 6</span></p></td><td class="cl-cf9f1132"><p class="cl-cf9f0106"><span class="cl-cf9be9d0">3</span></p></td><td class="cl-cf9f1132"><p class="cl-cf9f0106"><span class="cl-cf9be9d0">4</span></p></td><td class="cl-cf9f1133"><p class="cl-cf9f0110"><span class="cl-cf9be9d0">0.59</span></p></td><td class="cl-cf9f1133"><p class="cl-cf9f0110"><span class="cl-cf9be9d0">0.90</span></p></td><td class="cl-cf9f1133"><p class="cl-cf9f0110"><span class="cl-cf9be9d0">0.71</span></p></td><td class="cl-cf9f1133"><p class="cl-cf9f0110"><span class="cl-cf9be9d0">0.57</span></p></td><td class="cl-cf9f1132"><p class="cl-cf9f0106"><span class="cl-cf9be9d0">Discordant</span></p></td></tr></tbody></table></div>
</div>
<p>If you prefer plots to tables this plot may be easier to understand. It shows the original scattergram of the four points but adds lines marking the six distinct pairs of points and colour codes the lines to show the concordance of the pairs.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibPairs</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>midX <span class='op'>=</span> <span class='va'>x1</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>x2</span> <span class='op'>-</span> <span class='va'>x1</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>4</span>,</span>
<span>         midY <span class='op'>=</span> <span class='va'>y1</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>y2</span> <span class='op'>-</span> <span class='va'>y1</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibPairs</span></span>
<span></span>
<span><span class='va'>vecPairColours</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Concordant"</span> <span class='op'>=</span> <span class='st'>"green"</span>,</span>
<span>                    <span class='st'>"Discordant"</span> <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibPairs</span>,</span>
<span>       <span class='co'>### put the lines in with arrowheads</span></span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='va'>pairN</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x1</span>, xend <span class='op'>=</span> <span class='va'>x2</span>,</span>
<span>                   y <span class='op'>=</span> <span class='va'>y1</span>, yend <span class='op'>=</span> <span class='va'>y2</span>,</span>
<span>                   colour <span class='op'>=</span> <span class='va'>Concordant</span><span class='op'>)</span>,</span>
<span>               arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>.02</span>, <span class='st'>"native"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'>### label the lines</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>midX</span>, y <span class='op'>=</span> <span class='va'>midY</span>, label <span class='op'>=</span> <span class='va'>Pair</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'>### now put the points in</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibDat1N4</span>,</span>
<span>             inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibDat1N4</span>,</span>
<span>            inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>            <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, label <span class='op'>=</span> <span class='va'>ID</span><span class='op'>)</span>,</span>
<span>            nudge_x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>.04</span>,</span>
<span>            nudge_y <span class='op'>=</span> <span class='fl'>.03</span>,</span>
<span>            size <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"x"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"y"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_color_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>vecPairColours</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span>                  ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Scattergram of points showing their pairs"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>aspect.ratio <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="correlations_files/figure-html5/Kendall2N4-1.png" width="1536" /></p>
</div>
<p>You can see, as you can in the table above, that pair 1 which couples point 1 with point 2 is discordant because the x values increase from point 1 to point 2 but the y values decrease. The same is true for pair 6 but the other four pairs are concordant. The formula for Kendall’s tau (<span class="math inline">\(\tau\)</span>) is</p>
<p><span class="math display">\[ \tau = \frac{\text{(number of concordant pairs)} - \text{(number of discordant pairs)}}{\text{(total number of pairs)}} \]</span></p>
<p>So here that is</p>
<p><span class="math display">\[ \tau = \frac{4 - 2}{6} = .33 \]</span></p>
<p>This formula for <span class="math inline">\(\tau\)</span> nicely ensures that if all pairs are concordant the value is +1 and if all pairs are discordant the value is -1: the behaviour we want of a correlation coefficient. This simple formula is also sometimes called Kendall’s tau a.</p>
<h2 id="but-what-about-ties-why-are-there-multiple-kendall-correlation-coefficients">But what about ties? Why are there multiple Kendall correlation coefficients?</h2>
<p>Where there is perfect ranking, i.e. no ties on either variable, then the Spearman and the Kendall (or Kendall a) coefficients are fine. However, we often have ties in real data and a tied pair of values on either variable can no longer be either concordant or discordant: they are simply tied on one or both variables, this is going to bias Kendall’s tau. There are actually two ways of “correcting” for this and these give us Kendall’s tau b and Kendall’s tau c. The first applies when the likelihood of ties in of the two variables is not markedly different from that for the other variable. The second applies when the likelihood is different which typically arises when one variable has a different range of possible scores from the other variable.</p>
<p>Let’s create some ties in our tiny dataset. I simply duplicated point 1 and called it point 5.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibDat1N4</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/row_number.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>ID <span class='op'>=</span> <span class='st'>"5"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind_rows.html'>bind_rows</a></span><span class='op'>(</span><span class='va'>tibDat1N4</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibDat2N5</span></span>
<span></span>
<span><span class='va'>tibDat2N5</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/autofit.html'>autofit</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-283e03c4{}.cl-2838c77e{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-283b10f6{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-283b1100{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-283b2230{width:0.448in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-283b223a{width:0.68in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-283b223b{width:0.448in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-283b223c{width:0.68in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-283b2244{width:0.448in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-283b2245{width:0.68in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-283e03c4'><thead><tr style="overflow-wrap:break-word;"><th class="cl-283b2230"><p class="cl-283b10f6"><span class="cl-2838c77e">ID</span></p></th><th class="cl-283b223a"><p class="cl-283b1100"><span class="cl-2838c77e">x</span></p></th><th class="cl-283b223a"><p class="cl-283b1100"><span class="cl-2838c77e">y</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-283b223b"><p class="cl-283b10f6"><span class="cl-2838c77e">5</span></p></td><td class="cl-283b223c"><p class="cl-283b1100"><span class="cl-2838c77e">-0.45</span></p></td><td class="cl-283b223c"><p class="cl-283b1100"><span class="cl-2838c77e">-0.15</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-283b223b"><p class="cl-283b10f6"><span class="cl-2838c77e">1</span></p></td><td class="cl-283b223c"><p class="cl-283b1100"><span class="cl-2838c77e">-0.45</span></p></td><td class="cl-283b223c"><p class="cl-283b1100"><span class="cl-2838c77e">-0.15</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-283b223b"><p class="cl-283b10f6"><span class="cl-2838c77e">2</span></p></td><td class="cl-283b223c"><p class="cl-283b1100"><span class="cl-2838c77e">-0.11</span></p></td><td class="cl-283b223c"><p class="cl-283b1100"><span class="cl-2838c77e">-1.02</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-283b223b"><p class="cl-283b10f6"><span class="cl-2838c77e">3</span></p></td><td class="cl-283b223c"><p class="cl-283b1100"><span class="cl-2838c77e">0.59</span></p></td><td class="cl-283b223c"><p class="cl-283b1100"><span class="cl-2838c77e">0.90</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-283b2244"><p class="cl-283b10f6"><span class="cl-2838c77e">4</span></p></td><td class="cl-283b2245"><p class="cl-283b1100"><span class="cl-2838c77e">0.71</span></p></td><td class="cl-283b2245"><p class="cl-283b1100"><span class="cl-2838c77e">0.57</span></p></td></tr></tbody></table></div>
</div>
<p>Kendall’s tau b is:</p>
<p><span class="math display">\[ \tau b = \frac{\text{(number of concordant pairs)} - \text{(number of discordant pairs)}}{\sqrt{\text{(total number of pairs)}-\text{(number of ties on first variable)}}\sqrt{\text{(total number of pairs)}-\text{(number of ties on second variable)}}} \]</span></p>
<p>Slightly confusingly the number of ties is the number of duplicating values so here when we have one x value that occurs twice, i.e. tied but other three x values are distinct we have one x tie. You might think that we have two ties as we have two x values of -.45 but a moment tells us that’s only one tie. If we had three observations with the same x value they would be two x ties and if the other two x values had also been tied (but different from the first three!) then they would add another one tie and the total number of x ties, i.e. ties on the first variable, would be 3.</p>
<p>The denominator in that equation (the divisor, below the line in the equation) ensures that the coefficient will still be bounded by -1 and +1. Here is the new table of pairs.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibDat2N5</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span></span>
<span><span class='co'>### one way to get all combinations of the IDs</span></span>
<span><span class='fu'><a href='https://tidyr.tidyverse.org/reference/expand_grid.html'>expand_grid</a></span><span class='op'>(</span>ID1 <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>, ID2 <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>ID2</span> <span class='op'>&gt;</span> <span class='va'>ID1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>ID1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>ID1</span><span class='op'>)</span>,</span>
<span>         ID2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>ID2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='co'>### rename ID1 to ID and pull in the first set of data</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>ID <span class='op'>=</span> <span class='va'>ID1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>tmpTib</span>, by <span class='op'>=</span> <span class='st'>"ID"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>x1 <span class='op'>=</span> <span class='va'>x</span>,</span>
<span>         y1 <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='co'>### rename ID1 back again and then ID2 to ID and pull in the second set of data</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>ID1 <span class='op'>=</span> <span class='va'>ID</span>,</span>
<span>         ID <span class='op'>=</span> <span class='va'>ID2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>tmpTib</span>, by <span class='op'>=</span> <span class='st'>"ID"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>x2 <span class='op'>=</span> <span class='va'>x</span>,</span>
<span>         y2 <span class='op'>=</span> <span class='va'>y</span>,</span>
<span>         ID2 <span class='op'>=</span> <span class='va'>ID</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>pairN <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/row_number.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>pairN</span>, <span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibPairs5</span></span>
<span></span>
<span><span class='va'>tibPairs5</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rowwise.html'>rowwise</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>tiedX <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Logic.html'>isTRUE</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>x1</span>, <span class='va'>x2</span><span class='op'>)</span><span class='op'>)</span>, <span class='st'>"tie"</span>, <span class='st'>"not tie"</span><span class='op'>)</span>,</span>
<span>         tiedY <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Logic.html'>isTRUE</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>y1</span>, <span class='va'>y2</span><span class='op'>)</span><span class='op'>)</span>, <span class='st'>"tie"</span>, <span class='st'>"not tie"</span><span class='op'>)</span>,</span>
<span>         Concordant <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>x1</span> <span class='op'>&lt;</span> <span class='va'>x2</span> <span class='op'>&amp;</span> <span class='va'>y1</span> <span class='op'>&lt;</span> <span class='va'>y2</span><span class='op'>)</span> <span class='op'>|</span> <span class='op'>(</span><span class='va'>x1</span> <span class='op'>&gt;</span> <span class='va'>x2</span> <span class='op'>&amp;</span> <span class='va'>y1</span> <span class='op'>&gt;</span> <span class='va'>y2</span><span class='op'>)</span>, <span class='st'>"Concordant"</span>, <span class='st'>"Discordant"</span><span class='op'>)</span>,</span>
<span>         Pair <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Pair "</span>, <span class='va'>pairN</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibPairs5</span></span>
<span></span>
<span></span>
<span><span class='va'>tibPairs5</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>Pair</span>, <span class='va'>ID1</span>, <span class='va'>ID2</span>, <span class='va'>x1</span>, <span class='va'>y1</span>, <span class='va'>x2</span>, <span class='va'>y2</span>, <span class='va'>tiedX</span>, <span class='va'>tiedY</span>, <span class='va'>Concordant</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-808cc48c{}.cl-8085b7fa{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-80885ce4{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-80885cee{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8089285e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-80892868{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-80892869{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-80892872{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-80892873{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-80892874{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-808cc48c'><thead><tr style="overflow-wrap:break-word;"><th class="cl-8089285e"><p class="cl-80885ce4"><span class="cl-8085b7fa">Pair</span></p></th><th class="cl-8089285e"><p class="cl-80885ce4"><span class="cl-8085b7fa">ID1</span></p></th><th class="cl-8089285e"><p class="cl-80885ce4"><span class="cl-8085b7fa">ID2</span></p></th><th class="cl-80892868"><p class="cl-80885cee"><span class="cl-8085b7fa">x1</span></p></th><th class="cl-80892868"><p class="cl-80885cee"><span class="cl-8085b7fa">y1</span></p></th><th class="cl-80892868"><p class="cl-80885cee"><span class="cl-8085b7fa">x2</span></p></th><th class="cl-80892868"><p class="cl-80885cee"><span class="cl-8085b7fa">y2</span></p></th><th class="cl-8089285e"><p class="cl-80885ce4"><span class="cl-8085b7fa">tiedX</span></p></th><th class="cl-8089285e"><p class="cl-80885ce4"><span class="cl-8085b7fa">tiedY</span></p></th><th class="cl-8089285e"><p class="cl-80885ce4"><span class="cl-8085b7fa">Concordant</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">Pair 1</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">1</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">2</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">-0.45</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">-0.15</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">-0.11</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">-1.02</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">not tie</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">not tie</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">Discordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">Pair 2</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">1</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">3</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">-0.45</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">-0.15</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">0.59</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">0.90</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">not tie</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">not tie</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">Concordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">Pair 3</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">1</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">4</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">-0.45</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">-0.15</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">0.71</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">0.57</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">not tie</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">not tie</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">Concordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">Pair 4</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">1</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">5</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">-0.45</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">-0.15</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">-0.45</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">-0.15</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">tie</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">tie</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">Discordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">Pair 5</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">2</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">3</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">-0.11</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">-1.02</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">0.59</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">0.90</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">not tie</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">not tie</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">Concordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">Pair 6</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">2</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">4</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">-0.11</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">-1.02</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">0.71</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">0.57</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">not tie</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">not tie</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">Concordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">Pair 7</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">2</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">5</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">-0.11</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">-1.02</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">-0.45</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">-0.15</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">not tie</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">not tie</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">Discordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">Pair 8</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">3</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">4</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">0.59</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">0.90</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">0.71</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">0.57</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">not tie</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">not tie</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">Discordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">Pair 9</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">3</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">5</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">0.59</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">0.90</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">-0.45</span></p></td><td class="cl-80892872"><p class="cl-80885cee"><span class="cl-8085b7fa">-0.15</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">not tie</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">not tie</span></p></td><td class="cl-80892869"><p class="cl-80885ce4"><span class="cl-8085b7fa">Concordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-80892873"><p class="cl-80885ce4"><span class="cl-8085b7fa">Pair 10</span></p></td><td class="cl-80892873"><p class="cl-80885ce4"><span class="cl-8085b7fa">4</span></p></td><td class="cl-80892873"><p class="cl-80885ce4"><span class="cl-8085b7fa">5</span></p></td><td class="cl-80892874"><p class="cl-80885cee"><span class="cl-8085b7fa">0.71</span></p></td><td class="cl-80892874"><p class="cl-80885cee"><span class="cl-8085b7fa">0.57</span></p></td><td class="cl-80892874"><p class="cl-80885cee"><span class="cl-8085b7fa">-0.45</span></p></td><td class="cl-80892874"><p class="cl-80885cee"><span class="cl-8085b7fa">-0.15</span></p></td><td class="cl-80892873"><p class="cl-80885ce4"><span class="cl-8085b7fa">not tie</span></p></td><td class="cl-80892873"><p class="cl-80885ce4"><span class="cl-8085b7fa">not tie</span></p></td><td class="cl-80892873"><p class="cl-80885ce4"><span class="cl-8085b7fa">Concordant</span></p></td></tr></tbody></table></div>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># cor.test(tibDat1N4$x, tibDat1N4$y, method = "kendall")</span></span>
<span><span class='co'># cor.test(tibDat2N5$x, tibDat2N5$y, method = "kendall")</span></span>
<span><span class='co'># </span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='fu'>DescTools</span><span class='fu'>::</span><span class='fu'><a href='https://andrisignorell.github.io/DescTools/reference/KendallTauB.html'>KendallTauB</a></span><span class='op'>(</span><span class='va'>tibDat1N4</span><span class='op'>$</span><span class='va'>x</span>, <span class='va'>tibDat1N4</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>valTauA</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='fu'>DescTools</span><span class='fu'>::</span><span class='fu'><a href='https://andrisignorell.github.io/DescTools/reference/KendallTauB.html'>KendallTauB</a></span><span class='op'>(</span><span class='va'>tibDat2N5</span><span class='op'>$</span><span class='va'>x</span>, <span class='va'>tibDat2N5</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>valTauB</span></span></code></pre>
</div>
</details>
</div>
<p>This gives us a tau b of 0.33, exactly the same as for the four observation dataset without the duplicated row added.</p>
<h3 id="kendalls-tau-c-correlation-coefficient">Kendall’s tau c correlation coefficient</h3>
<p>This is often treated as if it were only a correlation coefficient for a rectangular contingency table with differing numbers of rows (variable 1) from columns (variable 2) but it can be used for any situation in which one or both variables have a limited number of possible values (hence many ties if the dataset isn’t tiny) and where the numbers of possible values for one variable is different from that for the other. Let’s use our five observation dataset to create such a situation.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibDat2N5</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>ID</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>binaryX <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>x</span> <span class='op'>&lt;</span> <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span>         threeLevelY <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span><span class='va'>y</span> <span class='op'>&lt;</span> <span class='op'>-</span><span class='fl'>1</span> <span class='op'>~</span> <span class='fl'>1</span>,</span>
<span>                                 <span class='va'>y</span> <span class='op'>&gt;=</span> <span class='op'>-</span><span class='fl'>1</span> <span class='op'>&amp;</span> <span class='va'>y</span> <span class='op'>&lt;</span> <span class='fl'>0</span> <span class='op'>~</span> <span class='fl'>2</span>,</span>
<span>                                 <span class='va'>y</span> <span class='op'>&gt;=</span> <span class='fl'>0</span> <span class='op'>~</span> <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>x</span>, <span class='va'>y</span>, <span class='va'>binaryX</span>, <span class='va'>threeLevelY</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibTauC</span></span>
<span></span>
<span><span class='va'>tibTauC</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-f8322c4e{}.cl-f82ce126{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f82f3124{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f82f312e{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f82f3ff2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f82f3ffc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f82f3ffd{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f82f4006{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f82f4007{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f82f4008{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-f8322c4e'><thead><tr style="overflow-wrap:break-word;"><th class="cl-f82f3ff2"><p class="cl-f82f3124"><span class="cl-f82ce126">ID</span></p></th><th class="cl-f82f3ffc"><p class="cl-f82f312e"><span class="cl-f82ce126">x</span></p></th><th class="cl-f82f3ffc"><p class="cl-f82f312e"><span class="cl-f82ce126">y</span></p></th><th class="cl-f82f3ffc"><p class="cl-f82f312e"><span class="cl-f82ce126">binaryX</span></p></th><th class="cl-f82f3ffc"><p class="cl-f82f312e"><span class="cl-f82ce126">threeLevelY</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-f82f3ffd"><p class="cl-f82f3124"><span class="cl-f82ce126">1</span></p></td><td class="cl-f82f4006"><p class="cl-f82f312e"><span class="cl-f82ce126">-0.45</span></p></td><td class="cl-f82f4006"><p class="cl-f82f312e"><span class="cl-f82ce126">-0.15</span></p></td><td class="cl-f82f4006"><p class="cl-f82f312e"><span class="cl-f82ce126">0.00</span></p></td><td class="cl-f82f4006"><p class="cl-f82f312e"><span class="cl-f82ce126">2.00</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f82f3ffd"><p class="cl-f82f3124"><span class="cl-f82ce126">2</span></p></td><td class="cl-f82f4006"><p class="cl-f82f312e"><span class="cl-f82ce126">-0.11</span></p></td><td class="cl-f82f4006"><p class="cl-f82f312e"><span class="cl-f82ce126">-1.02</span></p></td><td class="cl-f82f4006"><p class="cl-f82f312e"><span class="cl-f82ce126">0.00</span></p></td><td class="cl-f82f4006"><p class="cl-f82f312e"><span class="cl-f82ce126">1.00</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f82f3ffd"><p class="cl-f82f3124"><span class="cl-f82ce126">3</span></p></td><td class="cl-f82f4006"><p class="cl-f82f312e"><span class="cl-f82ce126">0.59</span></p></td><td class="cl-f82f4006"><p class="cl-f82f312e"><span class="cl-f82ce126">0.90</span></p></td><td class="cl-f82f4006"><p class="cl-f82f312e"><span class="cl-f82ce126">1.00</span></p></td><td class="cl-f82f4006"><p class="cl-f82f312e"><span class="cl-f82ce126">3.00</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f82f3ffd"><p class="cl-f82f3124"><span class="cl-f82ce126">4</span></p></td><td class="cl-f82f4006"><p class="cl-f82f312e"><span class="cl-f82ce126">0.71</span></p></td><td class="cl-f82f4006"><p class="cl-f82f312e"><span class="cl-f82ce126">0.57</span></p></td><td class="cl-f82f4006"><p class="cl-f82f312e"><span class="cl-f82ce126">1.00</span></p></td><td class="cl-f82f4006"><p class="cl-f82f312e"><span class="cl-f82ce126">3.00</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f82f4007"><p class="cl-f82f3124"><span class="cl-f82ce126">5</span></p></td><td class="cl-f82f4008"><p class="cl-f82f312e"><span class="cl-f82ce126">-0.45</span></p></td><td class="cl-f82f4008"><p class="cl-f82f312e"><span class="cl-f82ce126">-0.15</span></p></td><td class="cl-f82f4008"><p class="cl-f82f312e"><span class="cl-f82ce126">0.00</span></p></td><td class="cl-f82f4008"><p class="cl-f82f312e"><span class="cl-f82ce126">2.00</span></p></td></tr></tbody></table></div>
</div>
<p>The contingency table from those new variables is this.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibTauC</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>binaryX</span>, </span>
<span>         y <span class='op'>=</span> <span class='va'>threeLevelY</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibTauC</span></span>
<span></span>
<span><span class='va'>tibTauC</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://sfirke.github.io/janitor/reference/tabyl.html'>tabyl</a></span><span class='op'>(</span><span class='va'>y</span>, <span class='va'>x</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-f849d100{}.cl-f8450e22{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f8471b72{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f84728a6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f84728b0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f84728b1{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-f849d100'><thead><tr style="overflow-wrap:break-word;"><th class="cl-f84728a6"><p class="cl-f8471b72"><span class="cl-f8450e22">y</span></p></th><th class="cl-f84728a6"><p class="cl-f8471b72"><span class="cl-f8450e22">0</span></p></th><th class="cl-f84728a6"><p class="cl-f8471b72"><span class="cl-f8450e22">1</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-f84728b0"><p class="cl-f8471b72"><span class="cl-f8450e22">1</span></p></td><td class="cl-f84728b0"><p class="cl-f8471b72"><span class="cl-f8450e22">1</span></p></td><td class="cl-f84728b0"><p class="cl-f8471b72"><span class="cl-f8450e22">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f84728b0"><p class="cl-f8471b72"><span class="cl-f8450e22">2</span></p></td><td class="cl-f84728b0"><p class="cl-f8471b72"><span class="cl-f8450e22">2</span></p></td><td class="cl-f84728b0"><p class="cl-f8471b72"><span class="cl-f8450e22">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-f84728b1"><p class="cl-f8471b72"><span class="cl-f8450e22">3</span></p></td><td class="cl-f84728b1"><p class="cl-f8471b72"><span class="cl-f8450e22">0</span></p></td><td class="cl-f84728b1"><p class="cl-f8471b72"><span class="cl-f8450e22">2</span></p></td></tr></tbody></table></div>
</div>
<p>The binaryX variable is being counted in column entries and the threeLevelY variable in the rows: we have a 3x2 table. As it happens, all six pairs of values are.</p>
<p>And now the table of pairs of values looks like this.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibTauC</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span></span>
<span><span class='co'>### one way to get all combinations of the IDs</span></span>
<span><span class='fu'><a href='https://tidyr.tidyverse.org/reference/expand_grid.html'>expand_grid</a></span><span class='op'>(</span>ID1 <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>, ID2 <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>ID2</span> <span class='op'>&gt;</span> <span class='va'>ID1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>ID1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>ID1</span><span class='op'>)</span>,</span>
<span>         ID2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>ID2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='co'>### rename ID1 to ID and pull in the first set of data</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>ID <span class='op'>=</span> <span class='va'>ID1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>tmpTib</span>, by <span class='op'>=</span> <span class='st'>"ID"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>x1 <span class='op'>=</span> <span class='va'>x</span>,</span>
<span>         y1 <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='co'>### rename ID1 back again and then ID2 to ID and pull in the second set of data</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>ID1 <span class='op'>=</span> <span class='va'>ID</span>,</span>
<span>         ID <span class='op'>=</span> <span class='va'>ID2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>tmpTib</span>, by <span class='op'>=</span> <span class='st'>"ID"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>x2 <span class='op'>=</span> <span class='va'>x</span>,</span>
<span>         y2 <span class='op'>=</span> <span class='va'>y</span>,</span>
<span>         ID2 <span class='op'>=</span> <span class='va'>ID</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>pairN <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/row_number.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>pairN</span>, <span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibPairs5</span></span>
<span></span>
<span><span class='va'>tibPairs5</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rowwise.html'>rowwise</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>tiedX <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Logic.html'>isTRUE</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>x1</span>, <span class='va'>x2</span><span class='op'>)</span><span class='op'>)</span>, <span class='st'>"tie"</span>, <span class='st'>"not tie"</span><span class='op'>)</span>,</span>
<span>         tiedY <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Logic.html'>isTRUE</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>y1</span>, <span class='va'>y2</span><span class='op'>)</span><span class='op'>)</span>, <span class='st'>"tie"</span>, <span class='st'>"not tie"</span><span class='op'>)</span>,</span>
<span>         Concordant <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>x1</span> <span class='op'>&lt;</span> <span class='va'>x2</span> <span class='op'>&amp;</span> <span class='va'>y1</span> <span class='op'>&lt;</span> <span class='va'>y2</span><span class='op'>)</span> <span class='op'>|</span> <span class='op'>(</span><span class='va'>x1</span> <span class='op'>&gt;</span> <span class='va'>x2</span> <span class='op'>&amp;</span> <span class='va'>y1</span> <span class='op'>&gt;</span> <span class='va'>y2</span><span class='op'>)</span>, <span class='st'>"Concordant"</span>, <span class='st'>"Discordant"</span><span class='op'>)</span>,</span>
<span>         Pair <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Pair "</span>, <span class='va'>pairN</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibPairs5</span></span>
<span></span>
<span></span>
<span><span class='va'>tibPairs5</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>Pair</span>, <span class='va'>ID1</span>, <span class='va'>ID2</span>, <span class='va'>x1</span>, <span class='va'>y1</span>, <span class='va'>x2</span>, <span class='va'>y2</span>, <span class='va'>tiedX</span>, <span class='va'>tiedY</span>, <span class='va'>Concordant</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-a86de012{}.cl-a8676ade{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-a86a9b00{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-a86a9b0a{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-a86aab18{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a86aab19{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a86aab22{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a86aab23{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a86aab2c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a86aab2d{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-a86de012'><thead><tr style="overflow-wrap:break-word;"><th class="cl-a86aab18"><p class="cl-a86a9b00"><span class="cl-a8676ade">Pair</span></p></th><th class="cl-a86aab18"><p class="cl-a86a9b00"><span class="cl-a8676ade">ID1</span></p></th><th class="cl-a86aab18"><p class="cl-a86a9b00"><span class="cl-a8676ade">ID2</span></p></th><th class="cl-a86aab19"><p class="cl-a86a9b0a"><span class="cl-a8676ade">x1</span></p></th><th class="cl-a86aab19"><p class="cl-a86a9b0a"><span class="cl-a8676ade">y1</span></p></th><th class="cl-a86aab19"><p class="cl-a86a9b0a"><span class="cl-a8676ade">x2</span></p></th><th class="cl-a86aab19"><p class="cl-a86a9b0a"><span class="cl-a8676ade">y2</span></p></th><th class="cl-a86aab18"><p class="cl-a86a9b00"><span class="cl-a8676ade">tiedX</span></p></th><th class="cl-a86aab18"><p class="cl-a86a9b00"><span class="cl-a8676ade">tiedY</span></p></th><th class="cl-a86aab18"><p class="cl-a86a9b00"><span class="cl-a8676ade">Concordant</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">Pair 1</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">1</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">2</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">0.00</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">2.00</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">0.00</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">1.00</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">tie</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">not tie</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">Discordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">Pair 2</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">1</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">3</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">0.00</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">2.00</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">1.00</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">3.00</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">not tie</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">not tie</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">Concordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">Pair 3</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">1</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">4</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">0.00</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">2.00</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">1.00</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">3.00</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">not tie</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">not tie</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">Concordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">Pair 4</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">1</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">5</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">0.00</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">2.00</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">0.00</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">2.00</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">tie</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">tie</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">Discordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">Pair 5</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">2</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">3</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">0.00</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">1.00</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">1.00</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">3.00</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">not tie</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">not tie</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">Concordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">Pair 6</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">2</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">4</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">0.00</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">1.00</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">1.00</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">3.00</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">not tie</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">not tie</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">Concordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">Pair 7</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">2</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">5</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">0.00</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">1.00</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">0.00</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">2.00</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">tie</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">not tie</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">Discordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">Pair 8</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">3</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">4</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">1.00</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">3.00</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">1.00</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">3.00</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">tie</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">tie</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">Discordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">Pair 9</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">3</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">5</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">1.00</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">3.00</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">0.00</span></p></td><td class="cl-a86aab23"><p class="cl-a86a9b0a"><span class="cl-a8676ade">2.00</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">not tie</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">not tie</span></p></td><td class="cl-a86aab22"><p class="cl-a86a9b00"><span class="cl-a8676ade">Concordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a86aab2c"><p class="cl-a86a9b00"><span class="cl-a8676ade">Pair 10</span></p></td><td class="cl-a86aab2c"><p class="cl-a86a9b00"><span class="cl-a8676ade">4</span></p></td><td class="cl-a86aab2c"><p class="cl-a86a9b00"><span class="cl-a8676ade">5</span></p></td><td class="cl-a86aab2d"><p class="cl-a86a9b0a"><span class="cl-a8676ade">1.00</span></p></td><td class="cl-a86aab2d"><p class="cl-a86a9b0a"><span class="cl-a8676ade">3.00</span></p></td><td class="cl-a86aab2d"><p class="cl-a86a9b0a"><span class="cl-a8676ade">0.00</span></p></td><td class="cl-a86aab2d"><p class="cl-a86a9b0a"><span class="cl-a8676ade">2.00</span></p></td><td class="cl-a86aab2c"><p class="cl-a86a9b00"><span class="cl-a8676ade">not tie</span></p></td><td class="cl-a86aab2c"><p class="cl-a86a9b00"><span class="cl-a8676ade">not tie</span></p></td><td class="cl-a86aab2c"><p class="cl-a86a9b00"><span class="cl-a8676ade">Concordant</span></p></td></tr></tbody></table></div>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>DescTools</span><span class='fu'>::</span><span class='fu'><a href='https://andrisignorell.github.io/DescTools/reference/StuartTauC.html'>StuartTauC</a></span><span class='op'>(</span><span class='va'>tibTauC</span><span class='op'>$</span><span class='va'>x</span>, <span class='va'>tibTauC</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>valTauC</span></span>
<span><span class='fu'>DescTools</span><span class='fu'>::</span><span class='fu'><a href='https://andrisignorell.github.io/DescTools/reference/KendallTauA.html'>KendallTauA</a></span><span class='op'>(</span><span class='va'>tibTauC</span><span class='op'>$</span><span class='va'>x</span>, <span class='va'>tibTauC</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span>  <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>valTauA</span></span>
<span><span class='fu'>DescTools</span><span class='fu'>::</span><span class='fu'><a href='https://andrisignorell.github.io/DescTools/reference/KendallTauB.html'>KendallTauB</a></span><span class='op'>(</span><span class='va'>tibTauC</span><span class='op'>$</span><span class='va'>x</span>, <span class='va'>tibTauC</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>valTauB</span></span></code></pre>
</div>
</details>
</div>
<p>Here the Kendall tau values are:</p>
<ul>
<li>tau a = 0.6: biased down by the ties</li>
<li>tau b = 0.87: effect of ties reduced</li>
<li>tau c = 0.96: ditto</li>
</ul>
<h3 id="summarising-kendalls-tau-correlation-coefficients">Summarising Kendall’s tau correlation coefficients</h3>
<ul>
<li>Kendall’s idea was to get a correlation by using the concordance of the rank relationships of all possible distinct pairs of points in the dataset: perfect corcordance gives a coefficient of +1, perfect discordance gives a coefficient of -1. Equally balanced concordant and discordant correlations give a correlation of zero.</li>
<li>There are three Kendall tau correlation coefficients
<ul>
<li>tau a will produce a low absolute correlation if the data are not perfectly ranked on either or both variables, i.e. if there are ties, I’ve never seen it used.</li>
<li>tau b applies a correction which stops the coefficient being attenuated by ties</li>
<li>tau c applies a different correction which applies a bit better than the tau b correction if there are only a very limited number of possible scores on one or both variables</li>
</ul></li>
</ul>
<h1 id="are-the-values-comparable-across-the-different-coefficients-for-the-same-data">Are the values comparable across the different coefficients for the same data?</h1>
<p>Well why would they be: they’re measuring different things! Well, the Pearson coefficient is clearly measuring a very different aspect of the data from the rank correlation coefficients. You might expect them to be fairly similar or identical but, at least when we have ties in the data, they are deriving their values rather differently so comparability is clearly not going to be simple or perfect.</p>
<p>One thing that is simple is that all the coefficients are bounded at -1 and +1 and those should index perfect negative and positive correlations and for all the coefficients you’d expect 0 to mark the absence of correlation (whether raw value or rank).</p>
<p>Let’s move from our tiny dataset to somewhat larger ones to see how the values of the coefficients compare across samples from defined population models. This shows the results of analysing a sample from the zero correlation model.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>### null model</span></span>
<span><span class='va'>totN</span> <span class='op'>&lt;-</span> <span class='fl'>200</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>12345</span><span class='op'>)</span></span>
<span><span class='va'>startTime</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/proc.time.html'>proc.time</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>ID <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='va'>totN</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>totN</span><span class='op'>)</span>,</span>
<span>         y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>totN</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibNull200</span></span>
<span></span>
<span><span class='va'>tibNull200</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>Pearson <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, method <span class='op'>=</span> <span class='st'>"pearson"</span><span class='op'>)</span>,</span>
<span>            Spearman <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, method <span class='op'>=</span> <span class='st'>"spearman"</span><span class='op'>)</span>,</span>
<span>            KendallB <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, method <span class='op'>=</span> <span class='st'>"kendall"</span><span class='op'>)</span>,</span>
<span>            KendallC <span class='op'>=</span> <span class='fu'>DescTools</span><span class='fu'>::</span><span class='fu'><a href='https://andrisignorell.github.io/DescTools/reference/StuartTauC.html'>StuartTauC</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibCorrsNull</span></span>
<span><span class='va'>stopTime</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/proc.time.html'>proc.time</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='va'>elapsedTime</span> <span class='op'>&lt;-</span> <span class='va'>stopTime</span> <span class='op'>-</span> <span class='va'>startTime</span></span>
<span></span>
<span><span class='va'>tibCorrsNull</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-2ae9c90a{}.cl-2ae4cff4{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-2ae704cc{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-2ae712f0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2ae712f1{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-2ae9c90a'><thead><tr style="overflow-wrap:break-word;"><th class="cl-2ae712f0"><p class="cl-2ae704cc"><span class="cl-2ae4cff4">Pearson</span></p></th><th class="cl-2ae712f0"><p class="cl-2ae704cc"><span class="cl-2ae4cff4">Spearman</span></p></th><th class="cl-2ae712f0"><p class="cl-2ae704cc"><span class="cl-2ae4cff4">KendallB</span></p></th><th class="cl-2ae712f0"><p class="cl-2ae704cc"><span class="cl-2ae4cff4">KendallC</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-2ae712f1"><p class="cl-2ae704cc"><span class="cl-2ae4cff4">0.037</span></p></td><td class="cl-2ae712f1"><p class="cl-2ae704cc"><span class="cl-2ae4cff4">0.087</span></p></td><td class="cl-2ae712f1"><p class="cl-2ae704cc"><span class="cl-2ae4cff4">0.065</span></p></td><td class="cl-2ae712f1"><p class="cl-2ae704cc"><span class="cl-2ae4cff4">0.065</span></p></td></tr></tbody></table></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>12345</span><span class='op'>)</span></span>
<span><span class='va'>startTime</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/proc.time.html'>proc.time</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='va'>nTot</span> <span class='op'>&lt;-</span> <span class='fl'>300</span></span>
<span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>popCorr <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>.9</span>, <span class='fl'>.1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rowwise.html'>rowwise</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>tmp <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/holodeck/man/sim_covar.html'>sim_covar</a></span><span class='op'>(</span>n_obs <span class='op'>=</span> <span class='va'>nTot</span>, n_vars <span class='op'>=</span> <span class='fl'>2</span>, var <span class='op'>=</span> <span class='fl'>1</span>, cov <span class='op'>=</span> <span class='va'>popCorr</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/unnest.html'>unnest</a></span><span class='op'>(</span><span class='va'>tmp</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>popCorr</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>obsPearson <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>V1</span>, <span class='va'>V2</span><span class='op'>)</span>,</span>
<span>            obsSpearman <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>V1</span>, <span class='va'>V2</span>, method <span class='op'>=</span> <span class='st'>"spearman"</span><span class='op'>)</span>,</span>
<span>            obsKendall <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>V1</span>, <span class='va'>V2</span>, method <span class='op'>=</span> <span class='st'>"kendall"</span><span class='op'>)</span>,</span>
<span>            obsKendallC <span class='op'>=</span> <span class='fu'>DescTools</span><span class='fu'>::</span><span class='fu'><a href='https://andrisignorell.github.io/DescTools/reference/StuartTauC.html'>StuartTauC</a></span><span class='op'>(</span><span class='va'>V1</span>, <span class='va'>V2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibCorrs</span></span>
<span><span class='va'>stopTime</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/proc.time.html'>proc.time</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='va'>elapsedTime</span> <span class='op'>&lt;-</span> <span class='va'>stopTime</span> <span class='op'>-</span> <span class='va'>startTime</span></span>
<span><span class='va'>elapsedTime</span></span></code></pre>
</div>
</details>
<pre><code>    user   system  elapsed 
2071.868    0.864 2073.871 </code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibCorrs</span></span></code></pre>
</div>
</details>
<pre><code># A tibble: 10 × 5
   popCorr obsPearson obsSpearman obsKendall obsKendallC
     &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;
 1     0       0.0658      0.0538     0.0373      0.0373
 2     0.1     0.0727      0.0706     0.0435      0.0435
 3     0.2     0.216       0.233      0.151       0.151 
 4     0.3     0.276       0.279      0.186       0.186 
 5     0.4     0.357       0.356      0.242       0.242 
 6     0.5     0.483       0.470      0.323       0.323 
 7     0.6     0.592       0.583      0.409       0.409 
 8     0.7     0.737       0.723      0.527       0.527 
 9     0.8     0.809       0.797      0.603       0.603 
10     0.9     0.905       0.897      0.721       0.721 </code></pre>
</div>
<h1 id="effects-of-transformations-of-the-data">Effects of transformations of the data</h1>
<h2 id="linear-transforms">Linear transforms</h2>
<p>This is a trivial demonstration that any linear transform of effective continuous data with no ties doesn’t change any of the coefficient coefficients. The transformations are doubling the y values (“DoubleY”) and doubling the y value and adding a constant, 2, to that value (“DoubleYplus2”). These transformation examples all start with the same raw x and y values and a sample size of 200 sampling from a Gaussian population with means of zero, variances of one and population correlation of .75.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/Aariq/holodeck'>holodeck</a></span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>12345</span><span class='op'>)</span></span>
<span><span class='va'>nTot</span> <span class='op'>&lt;-</span> <span class='fl'>200</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/holodeck/man/sim_covar.html'>sim_covar</a></span><span class='op'>(</span>n_obs <span class='op'>=</span> <span class='va'>nTot</span>, n_vars <span class='op'>=</span> <span class='fl'>2</span>, var <span class='op'>=</span> <span class='fl'>1</span>, cov <span class='op'>=</span> <span class='fl'>.75</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>V1</span>,</span>
<span>         RawY <span class='op'>=</span> <span class='va'>V2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>DoubleY <span class='op'>=</span> <span class='fl'>2</span> <span class='op'>*</span> <span class='va'>RawY</span>,</span>
<span>         DoubleYplus2 <span class='op'>=</span> <span class='va'>DoubleY</span> <span class='op'>+</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span>cols <span class='op'>=</span> <span class='va'>RawY</span> <span class='op'>:</span> <span class='va'>DoubleYplus2</span>, names_to <span class='op'>=</span> <span class='st'>"Transform"</span>, values_to <span class='op'>=</span> <span class='st'>"y"</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibTransforms1</span></span>
<span></span>
<span><span class='va'>tibTransforms1</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>Transform</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>meanX <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,</span>
<span>            meanY <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTibMeans</span></span>
<span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibTransforms1</span>,</span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_grid.html'>facet_grid</a></span><span class='op'>(</span>rows <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/vars.html'>vars</a></span><span class='op'>(</span><span class='va'>Transform</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"lm"</span>,</span>
<span>              colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>              se <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>              linewidth <span class='op'>=</span> <span class='fl'>.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>tmpTibMeans</span><span class='op'>$</span><span class='va'>meanX</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTibMeans</span>,</span>
<span>             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='va'>meanY</span><span class='op'>)</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTibMeans</span>,</span>
<span>             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>meanX</span>, y <span class='op'>=</span> <span class='va'>meanY</span><span class='op'>)</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             fill <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             alpha <span class='op'>=</span> <span class='fl'>.4</span>,</span>
<span>             shape <span class='op'>=</span> <span class='fl'>23</span>,</span>
<span>             size <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>.4</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"lm"</span>,</span>
<span>              colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>              se <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>              linewidth <span class='op'>=</span> <span class='fl'>.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Scattergram illustrating effects of linear transforms on data"</span>,</span>
<span>          subtitle <span class='op'>=</span> <span class='st'>"Dotted reference lines and diamond mark means, solid red lines are linear regression fits"</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="correlations_files/figure-html5/transformations1-1.png" width="1536" /></p>
</div>
<p>I put the linear regression lines in top show that the slopes and intercepts are shifted by the transforms but this next table is what we wanted.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>startTime</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/proc.time.html'>proc.time</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='va'>tibTransforms1</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>Transform</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>obsPearson <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span>,</span>
<span>            obsSpearman <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, method <span class='op'>=</span> <span class='st'>"spearman"</span><span class='op'>)</span>,</span>
<span>            obsKendall <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, method <span class='op'>=</span> <span class='st'>"kendall"</span><span class='op'>)</span>,</span>
<span>            obsKendallC <span class='op'>=</span> <span class='fu'>DescTools</span><span class='fu'>::</span><span class='fu'><a href='https://andrisignorell.github.io/DescTools/reference/StuartTauC.html'>StuartTauC</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibTransformCorrs</span></span>
<span><span class='va'>stopTime</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/proc.time.html'>proc.time</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='va'>elapsedTime</span> <span class='op'>&lt;-</span> <span class='va'>stopTime</span> <span class='op'>-</span> <span class='va'>startTime</span></span>
<span><span class='va'>elapsedTime</span></span></code></pre>
</div>
</details>
<pre><code>   user  system elapsed 
118.148   1.097 119.323 </code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibTransformCorrs</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-de724dba{}.cl-de6c3d9e{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-de6f484a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-de6f4854{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-de6f5704{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-de6f570e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-de6f570f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-de6f5718{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-de6f5719{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-de6f5722{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-de724dba'><thead><tr style="overflow-wrap:break-word;"><th class="cl-de6f5704"><p class="cl-de6f484a"><span class="cl-de6c3d9e">Transform</span></p></th><th class="cl-de6f570e"><p class="cl-de6f4854"><span class="cl-de6c3d9e">obsPearson</span></p></th><th class="cl-de6f570e"><p class="cl-de6f4854"><span class="cl-de6c3d9e">obsSpearman</span></p></th><th class="cl-de6f570e"><p class="cl-de6f4854"><span class="cl-de6c3d9e">obsKendall</span></p></th><th class="cl-de6f570e"><p class="cl-de6f4854"><span class="cl-de6c3d9e">obsKendallC</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-de6f570f"><p class="cl-de6f484a"><span class="cl-de6c3d9e">DoubleY</span></p></td><td class="cl-de6f5718"><p class="cl-de6f4854"><span class="cl-de6c3d9e">0.76</span></p></td><td class="cl-de6f5718"><p class="cl-de6f4854"><span class="cl-de6c3d9e">0.75</span></p></td><td class="cl-de6f5718"><p class="cl-de6f4854"><span class="cl-de6c3d9e">0.55</span></p></td><td class="cl-de6f5718"><p class="cl-de6f4854"><span class="cl-de6c3d9e">0.55</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-de6f570f"><p class="cl-de6f484a"><span class="cl-de6c3d9e">DoubleYplus2</span></p></td><td class="cl-de6f5718"><p class="cl-de6f4854"><span class="cl-de6c3d9e">0.76</span></p></td><td class="cl-de6f5718"><p class="cl-de6f4854"><span class="cl-de6c3d9e">0.75</span></p></td><td class="cl-de6f5718"><p class="cl-de6f4854"><span class="cl-de6c3d9e">0.55</span></p></td><td class="cl-de6f5718"><p class="cl-de6f4854"><span class="cl-de6c3d9e">0.55</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-de6f5719"><p class="cl-de6f484a"><span class="cl-de6c3d9e">RawY</span></p></td><td class="cl-de6f5722"><p class="cl-de6f4854"><span class="cl-de6c3d9e">0.76</span></p></td><td class="cl-de6f5722"><p class="cl-de6f4854"><span class="cl-de6c3d9e">0.75</span></p></td><td class="cl-de6f5722"><p class="cl-de6f4854"><span class="cl-de6c3d9e">0.55</span></p></td><td class="cl-de6f5722"><p class="cl-de6f4854"><span class="cl-de6c3d9e">0.55</span></p></td></tr></tbody></table></div>
</div>
<p>That shows that linear transforms have no effect on any of the coefficient. Linear transforms can’t change the Pearson coefficients as the standardisation of both variables for the Pearson correlation removes any constant and any multiplier of the values. Equally, linear transforms never change the rank order of values so can’t change rank correlation coefficients.</p>
<p>More importantly really, that table shows that where there are no ties and a Gaussian distribution the Pearson and Spearman coefficients are very similar as the effects of outliers are small. It shows that the Kendall tau b and c are essentially identical again as there are no ties. Finally, it shows that the Kendall coefficients are markedly smaller than the Spearman and Pearson. That is a fairly generally finding as the actual index being used to measure rank correlation is really very different between the two methods, the Spearman method effectively looking at differences in ranks where the Kendall methods only look at concordance (or not) of directions of difference between pairs points (pairs of observations) thus losing compressing all differences in ranks to binary “concordant”/“discordant” values.</p>
<h2 id="non-linear-transforms">Non-linear transforms</h2>
<p>Here are a series of monotonic but non-linear transforms: raising the y values to the power 6 or cubing them and taking the logarithm (to base 2) of the y values (all after adding 3 to the y values to make them all positive).</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>12345</span><span class='op'>)</span></span>
<span><span class='va'>nTot</span> <span class='op'>&lt;-</span> <span class='fl'>200</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/holodeck/man/sim_covar.html'>sim_covar</a></span><span class='op'>(</span>n_obs <span class='op'>=</span> <span class='va'>nTot</span>, n_vars <span class='op'>=</span> <span class='fl'>2</span>, var <span class='op'>=</span> <span class='fl'>1</span>, cov <span class='op'>=</span> <span class='fl'>.75</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>V1</span>,</span>
<span>         RawY <span class='op'>=</span> <span class='va'>V2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Pwr6Y <span class='op'>=</span> <span class='op'>(</span><span class='va'>RawY</span> <span class='op'>+</span> <span class='fl'>3</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>6</span>,</span>
<span>         CubeY <span class='op'>=</span> <span class='op'>(</span><span class='va'>RawY</span> <span class='op'>+</span> <span class='fl'>3</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>3</span>,</span>
<span>         Log2Y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>RawY</span> <span class='op'>+</span> <span class='fl'>3</span><span class='op'>)</span>, base <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span>cols <span class='op'>=</span> <span class='va'>RawY</span> <span class='op'>:</span> <span class='va'>Log2Y</span>, names_to <span class='op'>=</span> <span class='st'>"Transform"</span>, values_to <span class='op'>=</span> <span class='st'>"y"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Transform <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>ordered</a></span><span class='op'>(</span><span class='va'>Transform</span>,</span>
<span>                             levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Pwr6Y"</span>,</span>
<span>                                        <span class='st'>"CubeY"</span>,</span>
<span>                                        <span class='st'>"Log2Y"</span>,</span>
<span>                                        <span class='st'>"RawY"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibTransforms2</span></span>
<span></span>
<span><span class='va'>tibTransforms2</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>Transform</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>meanX <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,</span>
<span>            meanY <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTibMeans2</span></span>
<span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibTransforms2</span>,</span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_grid.html'>facet_grid</a></span><span class='op'>(</span>rows <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/vars.html'>vars</a></span><span class='op'>(</span><span class='va'>Transform</span><span class='op'>)</span>,</span>
<span>             scale <span class='op'>=</span> <span class='st'>"free_y"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>tmpTibMeans2</span><span class='op'>$</span><span class='va'>meanX</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTibMeans2</span>,</span>
<span>             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='va'>meanY</span><span class='op'>)</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTibMeans2</span>,</span>
<span>             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>meanX</span>, y <span class='op'>=</span> <span class='va'>meanY</span><span class='op'>)</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             fill <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             alpha <span class='op'>=</span> <span class='fl'>.4</span>,</span>
<span>             shape <span class='op'>=</span> <span class='fl'>23</span>,</span>
<span>             size <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>.4</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>              se <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>              linewidth <span class='op'>=</span> <span class='fl'>.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Scattergram illustrating effects of non-linear transforms on data"</span>,</span>
<span>          subtitle <span class='op'>=</span> <span class='st'>"Dotted reference lines and diamond mark means, solid red lines are non-linear regression fits"</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="correlations_files/figure-html5/transformations3-1.png" width="1536" /></p>
</div>
<p>Here the regression lines are the default loess smoothed regression which help show up that the transforms are not linear.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>startTime</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/proc.time.html'>proc.time</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='va'>tibTransforms2</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>Transform</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>obsPearson <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span>,</span>
<span>            obsSpearman <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, method <span class='op'>=</span> <span class='st'>"spearman"</span><span class='op'>)</span>,</span>
<span>            obsKendall <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, method <span class='op'>=</span> <span class='st'>"kendall"</span><span class='op'>)</span>,</span>
<span>            obsKendallC <span class='op'>=</span> <span class='fu'>DescTools</span><span class='fu'>::</span><span class='fu'><a href='https://andrisignorell.github.io/DescTools/reference/StuartTauC.html'>StuartTauC</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibTransformCorrs2</span></span>
<span><span class='va'>stopTime</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/proc.time.html'>proc.time</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='va'>elapsedTime</span> <span class='op'>&lt;-</span> <span class='va'>stopTime</span> <span class='op'>-</span> <span class='va'>startTime</span></span>
<span><span class='va'>tibTransformCorrs2</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-2ce52954{}.cl-2ce00352{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-2ce23d20{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-2ce23d2a{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-2ce24c16{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2ce24c20{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2ce24c21{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2ce24c2a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2ce24c2b{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2ce24c2c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-2ce52954'><thead><tr style="overflow-wrap:break-word;"><th class="cl-2ce24c16"><p class="cl-2ce23d20"><span class="cl-2ce00352">Transform</span></p></th><th class="cl-2ce24c20"><p class="cl-2ce23d2a"><span class="cl-2ce00352">obsPearson</span></p></th><th class="cl-2ce24c20"><p class="cl-2ce23d2a"><span class="cl-2ce00352">obsSpearman</span></p></th><th class="cl-2ce24c20"><p class="cl-2ce23d2a"><span class="cl-2ce00352">obsKendall</span></p></th><th class="cl-2ce24c20"><p class="cl-2ce23d2a"><span class="cl-2ce00352">obsKendallC</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-2ce24c21"><p class="cl-2ce23d20"><span class="cl-2ce00352">Pwr6Y</span></p></td><td class="cl-2ce24c2a"><p class="cl-2ce23d2a"><span class="cl-2ce00352">0.58</span></p></td><td class="cl-2ce24c2a"><p class="cl-2ce23d2a"><span class="cl-2ce00352">0.75</span></p></td><td class="cl-2ce24c2a"><p class="cl-2ce23d2a"><span class="cl-2ce00352">0.55</span></p></td><td class="cl-2ce24c2a"><p class="cl-2ce23d2a"><span class="cl-2ce00352">0.55</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2ce24c21"><p class="cl-2ce23d20"><span class="cl-2ce00352">CubeY</span></p></td><td class="cl-2ce24c2a"><p class="cl-2ce23d2a"><span class="cl-2ce00352">0.72</span></p></td><td class="cl-2ce24c2a"><p class="cl-2ce23d2a"><span class="cl-2ce00352">0.75</span></p></td><td class="cl-2ce24c2a"><p class="cl-2ce23d2a"><span class="cl-2ce00352">0.55</span></p></td><td class="cl-2ce24c2a"><p class="cl-2ce23d2a"><span class="cl-2ce00352">0.55</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2ce24c21"><p class="cl-2ce23d20"><span class="cl-2ce00352">Log2Y</span></p></td><td class="cl-2ce24c2a"><p class="cl-2ce23d2a"><span class="cl-2ce00352">0.75</span></p></td><td class="cl-2ce24c2a"><p class="cl-2ce23d2a"><span class="cl-2ce00352">0.75</span></p></td><td class="cl-2ce24c2a"><p class="cl-2ce23d2a"><span class="cl-2ce00352">0.55</span></p></td><td class="cl-2ce24c2a"><p class="cl-2ce23d2a"><span class="cl-2ce00352">0.55</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2ce24c2b"><p class="cl-2ce23d20"><span class="cl-2ce00352">RawY</span></p></td><td class="cl-2ce24c2c"><p class="cl-2ce23d2a"><span class="cl-2ce00352">0.76</span></p></td><td class="cl-2ce24c2c"><p class="cl-2ce23d2a"><span class="cl-2ce00352">0.75</span></p></td><td class="cl-2ce24c2c"><p class="cl-2ce23d2a"><span class="cl-2ce00352">0.55</span></p></td><td class="cl-2ce24c2c"><p class="cl-2ce23d2a"><span class="cl-2ce00352">0.55</span></p></td></tr></tbody></table></div>
</div>
<p>That table shows very simply how non-linear transforms change the Pearson correlation but, as these are monotonic transforms, they don’t change the rank correlation coefficients at all.</p>
<h2 id="tie-creating-transforms">Tie creating transforms</h2>
<p>What I have done here is to recode the y variable into a binary, four levels, six, eight and ten levels. All splits are approximately equal in size of the tie groups they create, i.e. the binary split the data approximately half/half and the ten level into tie groups each containing about 10% of the data.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>12345</span><span class='op'>)</span></span>
<span><span class='va'>nTot</span> <span class='op'>&lt;-</span> <span class='fl'>200</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/holodeck/man/sim_covar.html'>sim_covar</a></span><span class='op'>(</span>n_obs <span class='op'>=</span> <span class='va'>nTot</span>, n_vars <span class='op'>=</span> <span class='fl'>2</span>, var <span class='op'>=</span> <span class='fl'>1</span>, cov <span class='op'>=</span> <span class='fl'>.75</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>V1</span>,</span>
<span>         RawY <span class='op'>=</span> <span class='va'>V2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>bucket02Y <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/ntile.html'>ntile</a></span><span class='op'>(</span><span class='va'>RawY</span>, n <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,</span>
<span>         bucket04Y <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/ntile.html'>ntile</a></span><span class='op'>(</span><span class='va'>RawY</span>, n <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span>,</span>
<span>         bucket06Y <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/ntile.html'>ntile</a></span><span class='op'>(</span><span class='va'>RawY</span>, n <span class='op'>=</span> <span class='fl'>6</span><span class='op'>)</span>,</span>
<span>         bucket08Y <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/ntile.html'>ntile</a></span><span class='op'>(</span><span class='va'>RawY</span>, n <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span>,</span>
<span>         bucket10Y <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/ntile.html'>ntile</a></span><span class='op'>(</span><span class='va'>RawY</span>, n <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span>cols <span class='op'>=</span> <span class='va'>RawY</span> <span class='op'>:</span> <span class='va'>bucket10Y</span>, names_to <span class='op'>=</span> <span class='st'>"Transform"</span>, values_to <span class='op'>=</span> <span class='st'>"y"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Transform <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>ordered</a></span><span class='op'>(</span><span class='va'>Transform</span>,</span>
<span>                             levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"bucket02Y"</span>,</span>
<span>                                        <span class='st'>"bucket04Y"</span>,</span>
<span>                                        <span class='st'>"bucket06Y"</span>,</span>
<span>                                        <span class='st'>"bucket08Y"</span>,</span>
<span>                                        <span class='st'>"bucket10Y"</span>,</span>
<span>                                        <span class='st'>"RawY"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibTransforms3</span></span>
<span></span>
<span><span class='va'>tibTransforms3</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>Transform</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>meanX <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,</span>
<span>            meanY <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTibMeans3</span></span>
<span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibTransforms3</span>,</span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_grid.html'>facet_grid</a></span><span class='op'>(</span>rows <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/vars.html'>vars</a></span><span class='op'>(</span><span class='va'>Transform</span><span class='op'>)</span>,</span>
<span>             scale <span class='op'>=</span> <span class='st'>"free_y"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>tmpTibMeans3</span><span class='op'>$</span><span class='va'>meanX</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTibMeans3</span>,</span>
<span>             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='va'>meanY</span><span class='op'>)</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTibMeans3</span>,</span>
<span>             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>meanX</span>, y <span class='op'>=</span> <span class='va'>meanY</span><span class='op'>)</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             fill <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             alpha <span class='op'>=</span> <span class='fl'>.4</span>,</span>
<span>             shape <span class='op'>=</span> <span class='fl'>23</span>,</span>
<span>             size <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>.4</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>              se <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>              linewidth <span class='op'>=</span> <span class='fl'>.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Scattergram illustrating effects of transforms creating ties in the y data"</span>,</span>
<span>          subtitle <span class='op'>=</span> <span class='st'>"Dotted reference lines and diamond mark means, solid red lines are non-linear regression fits"</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="correlations_files/figure-html5/transformations5-1.png" width="1536" /></p>
</div>
<p>The non-linear smoothed regression lines are a bit silly but perhaps help convey the impacts of the reduction in numbers of values.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>startTime</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/proc.time.html'>proc.time</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='va'>tibTransforms3</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>Transform</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>obsPearson <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span>,</span>
<span>            obsSpearman <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, method <span class='op'>=</span> <span class='st'>"spearman"</span><span class='op'>)</span>,</span>
<span>            obsKendall <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, method <span class='op'>=</span> <span class='st'>"kendall"</span><span class='op'>)</span>,</span>
<span>            obsKendallC <span class='op'>=</span> <span class='fu'>DescTools</span><span class='fu'>::</span><span class='fu'><a href='https://andrisignorell.github.io/DescTools/reference/StuartTauC.html'>StuartTauC</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibTransformCorrs3</span></span>
<span><span class='va'>stopTime</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/proc.time.html'>proc.time</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='va'>elapsedTime</span> <span class='op'>&lt;-</span> <span class='va'>stopTime</span> <span class='op'>-</span> <span class='va'>startTime</span></span>
<span><span class='va'>tibTransformCorrs3</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-9347f7ae{}.cl-9342d5bc{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-934509e0{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-934509ea{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-93451976{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93451977{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93451978{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93451980{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93451981{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-93451982{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-9347f7ae'><thead><tr style="overflow-wrap:break-word;"><th class="cl-93451976"><p class="cl-934509e0"><span class="cl-9342d5bc">Transform</span></p></th><th class="cl-93451977"><p class="cl-934509ea"><span class="cl-9342d5bc">obsPearson</span></p></th><th class="cl-93451977"><p class="cl-934509ea"><span class="cl-9342d5bc">obsSpearman</span></p></th><th class="cl-93451977"><p class="cl-934509ea"><span class="cl-9342d5bc">obsKendall</span></p></th><th class="cl-93451977"><p class="cl-934509ea"><span class="cl-9342d5bc">obsKendallC</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-93451978"><p class="cl-934509e0"><span class="cl-9342d5bc">bucket02Y</span></p></td><td class="cl-93451980"><p class="cl-934509ea"><span class="cl-9342d5bc">0.59</span></p></td><td class="cl-93451980"><p class="cl-934509ea"><span class="cl-9342d5bc">0.60</span></p></td><td class="cl-93451980"><p class="cl-934509ea"><span class="cl-9342d5bc">0.49</span></p></td><td class="cl-93451980"><p class="cl-934509ea"><span class="cl-9342d5bc">0.69</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-93451978"><p class="cl-934509e0"><span class="cl-9342d5bc">bucket04Y</span></p></td><td class="cl-93451980"><p class="cl-934509ea"><span class="cl-9342d5bc">0.71</span></p></td><td class="cl-93451980"><p class="cl-934509ea"><span class="cl-9342d5bc">0.71</span></p></td><td class="cl-93451980"><p class="cl-934509ea"><span class="cl-9342d5bc">0.57</span></p></td><td class="cl-93451980"><p class="cl-934509ea"><span class="cl-9342d5bc">0.65</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-93451978"><p class="cl-934509e0"><span class="cl-9342d5bc">bucket06Y</span></p></td><td class="cl-93451980"><p class="cl-934509ea"><span class="cl-9342d5bc">0.73</span></p></td><td class="cl-93451980"><p class="cl-934509ea"><span class="cl-9342d5bc">0.74</span></p></td><td class="cl-93451980"><p class="cl-934509ea"><span class="cl-9342d5bc">0.58</span></p></td><td class="cl-93451980"><p class="cl-934509ea"><span class="cl-9342d5bc">0.63</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-93451978"><p class="cl-934509e0"><span class="cl-9342d5bc">bucket08Y</span></p></td><td class="cl-93451980"><p class="cl-934509ea"><span class="cl-9342d5bc">0.74</span></p></td><td class="cl-93451980"><p class="cl-934509ea"><span class="cl-9342d5bc">0.74</span></p></td><td class="cl-93451980"><p class="cl-934509ea"><span class="cl-9342d5bc">0.57</span></p></td><td class="cl-93451980"><p class="cl-934509ea"><span class="cl-9342d5bc">0.60</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-93451978"><p class="cl-934509e0"><span class="cl-9342d5bc">bucket10Y</span></p></td><td class="cl-93451980"><p class="cl-934509ea"><span class="cl-9342d5bc">0.74</span></p></td><td class="cl-93451980"><p class="cl-934509ea"><span class="cl-9342d5bc">0.74</span></p></td><td class="cl-93451980"><p class="cl-934509ea"><span class="cl-9342d5bc">0.56</span></p></td><td class="cl-93451980"><p class="cl-934509ea"><span class="cl-9342d5bc">0.59</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-93451981"><p class="cl-934509e0"><span class="cl-9342d5bc">RawY</span></p></td><td class="cl-93451982"><p class="cl-934509ea"><span class="cl-9342d5bc">0.76</span></p></td><td class="cl-93451982"><p class="cl-934509ea"><span class="cl-9342d5bc">0.75</span></p></td><td class="cl-93451982"><p class="cl-934509ea"><span class="cl-9342d5bc">0.55</span></p></td><td class="cl-93451982"><p class="cl-934509ea"><span class="cl-9342d5bc">0.55</span></p></td></tr></tbody></table></div>
</div>
<p>That table shows how reducing the number of possible scores attenuates the Pearson coefficient and quite markedly when the scores are reduced to a dichotomy. That’s the classic issue that Cohen described so clearly in Cohen, J. (1983). The cost of dichotomization. Applied Psychological Measurement, 7, 249–253. There is an almost identical impact on the Spearman coefficient as the sizes of the possible rank differences are dropping with the decreasing numbers of possible scores. The Kendall tau b coefficient hardly changes until it drops markedly for the dichotomised scores. By contrast Kendall’s tau actually increases a bit with the decreasing numbers of possible scores as the correction for the effects of ties it uses is particularly strong when the number of possible scores drops to just two (in either or both of the variables though only on the y variable here).</p>
<h1 id="summarising-the-different-correlation-coefficients">Summarising the different correlation coefficients</h1>
<p><strong>Naming the two types</strong>: we have two fundamentally different sorts of correlation coefficients: the Pearson correlation which uses raw data and, really, three rank correlation coefficients: Spearman’s and Kendall’s tau b and tau c. These are often referred to as a parametric and three non-parametric correlation coefficients and that makes some sense, more on that below, but it’s really about a null hypothesis testing of the coefficients so I think it’s better to call them “Pearson’s” and then “the rank correlation coefficient x” where “x” is one of those three. That grounds things in what matters.</p>
<p><strong>Bounds/range</strong>: all share the desirable property that they can range from -1 to +1 and those bounds mark perfect negative and positive correlations and their zero values mark the absence of correlation.</p>
<p>However, they are measuring different things and even the three rank correlation coefficients are measuring different things so, beyond the shared meanings of -1, 0 and +1 there is no direct comparability of values across the four.</p>
<p>Another point of difference between the coefficients is in the effects of non-linear transformations and particularly of discretisation affect one or both variables.</p>
<h1 id="conclusions">Conclusions</h1>
<ul>
<li>Though all these correlation coefficients share the bounds of -1 and +1 and that a zero value indicates no correlation (by the method chosen) they are not otherwise comparable.<br />
</li>
<li>Non-linear transformations of one or both variables (including discretisation) can have marked impacts on Pearson correlation values and, by implication, if the scaling of one or both variables is not additive/linear Pearson correlations will change if a different scaling is imposed. As our rating variables are probably not additive/linear, or at least, we really have almost no ways to show they are, we should be cautious about treating them as overly precise indicators of any correlations in our data.</li>
<li>The rank correlation coefficients don’t have this issue but are not simply equivalents for the Pearson. However, if the variables are near continuous and have few or no ties then the Spearman coefficient is generally not radically dissimilar to the Pearson for the same data.</li>
<li>However, as the number of possible scores drops there is an argument that one of Kendall’s tau b or c coefficients become better measures as their values are less affected by differences in numbers of possible scores, and hence numbers of ties.</li>
<li>Where the numbers of possible scores gets very low (single figures or low single figures), Kendall’s tau c arguably resists attenuation better than Kendall’s tau b.</li>
<li>All this leads into questions about significance testing correlation coefficients and into estimation: putting confidence intervals around observed coefficients but those are for one or two further posts …</li>
<li>… and they will take us back to the ever crucial question of what we are doing when using correlation coefficents, what questions are we trying to explore with the coefficients.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="reuse">Reuse</h3>
<p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
