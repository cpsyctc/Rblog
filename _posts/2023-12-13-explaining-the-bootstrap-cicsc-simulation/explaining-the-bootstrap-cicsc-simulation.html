<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Explaining the bootstrap CI(CSC) simulation</title>

  <meta property="description" itemprop="description" content="Explores four methods of estimating a CI around an observed Spearman correlation."/>

  <link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"/>

  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2023-12-13"/>
  <meta property="article:created" itemprop="dateCreated" content="2023-12-13"/>
  <meta name="article:author" content="Chris Evans"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Explaining the bootstrap CI(CSC) simulation"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Explores four methods of estimating a CI around an observed Spearman correlation."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Explaining the bootstrap CI(CSC) simulation"/>
  <meta property="twitter:description" content="Explores four methods of estimating a CI around an observed Spearman correlation."/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","draft","categories","output","creative_commons"]}},"value":[{"type":"character","attributes":{},"value":["Explaining the bootstrap CI(CSC) simulation"]},{"type":"character","attributes":{},"value":["Explores four methods of estimating a CI around an observed Spearman correlation.\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation","affiliation_url","orcid_id"]}},"value":[{"type":"character","attributes":{},"value":["Chris Evans"]},{"type":"character","attributes":{},"value":["https://www.psyctc.org/R_blog/"]},{"type":"character","attributes":{},"value":["PSYCTC.org"]},{"type":"character","attributes":{},"value":["https://www.psyctc.org/psyctc/"]},{"type":"character","attributes":{},"value":["0000-0002-4197-4202"]}]}]},{"type":"character","attributes":{},"value":["2023-12-13"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["bootstrapping","confidence intervals","simulation"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","toc_depth","hightlight_downlit","self_contained","code_folding"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[4]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["CC BY-SA"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["animate1.gif","explaining-the-bootstrap-cicsc-simulation_files/anchor-4.2.2/anchor.min.js","explaining-the-bootstrap-cicsc-simulation_files/bowser-1.9.3/bowser.min.js","explaining-the-bootstrap-cicsc-simulation_files/distill-2.2.21/template.v2.js","explaining-the-bootstrap-cicsc-simulation_files/figure-html5/balance2-1.png","explaining-the-bootstrap-cicsc-simulation_files/figure-html5/balance3-1.png","explaining-the-bootstrap-cicsc-simulation_files/figure-html5/coverage3-1.png","explaining-the-bootstrap-cicsc-simulation_files/figure-html5/coverage6-1.png","explaining-the-bootstrap-cicsc-simulation_files/figure-html5/coverage8-1.png","explaining-the-bootstrap-cicsc-simulation_files/figure-html5/facets-1.png","explaining-the-bootstrap-cicsc-simulation_files/figure-html5/genData-1.png","explaining-the-bootstrap-cicsc-simulation_files/figure-html5/percentileCI1-1.png","explaining-the-bootstrap-cicsc-simulation_files/figure-html5/percentileCI3-1.png","explaining-the-bootstrap-cicsc-simulation_files/figure-html5/sampleStats-1.png","explaining-the-bootstrap-cicsc-simulation_files/figure-html5/showModel-1.png","explaining-the-bootstrap-cicsc-simulation_files/figure-html5/showModelMisclassification-1.png","explaining-the-bootstrap-cicsc-simulation_files/figure-html5/unnamed-chunk-7-1.png","explaining-the-bootstrap-cicsc-simulation_files/header-attrs-2.25/header-attrs.js","explaining-the-bootstrap-cicsc-simulation_files/jquery-3.6.0/jquery-3.6.0.js","explaining-the-bootstrap-cicsc-simulation_files/jquery-3.6.0/jquery-3.6.0.min.js","explaining-the-bootstrap-cicsc-simulation_files/jquery-3.6.0/jquery-3.6.0.min.map","explaining-the-bootstrap-cicsc-simulation_files/popper-2.6.0/popper.min.js","explaining-the-bootstrap-cicsc-simulation_files/tabwid-1.1.3/tabwid.css","explaining-the-bootstrap-cicsc-simulation_files/tabwid-1.1.3/tabwid.js","explaining-the-bootstrap-cicsc-simulation_files/tippy-6.2.7/tippy-bundle.umd.min.js","explaining-the-bootstrap-cicsc-simulation_files/tippy-6.2.7/tippy-light-border.css","explaining-the-bootstrap-cicsc-simulation_files/tippy-6.2.7/tippy.css","explaining-the-bootstrap-cicsc-simulation_files/tippy-6.2.7/tippy.umd.min.js","explaining-the-bootstrap-cicsc-simulation_files/webcomponents-2.0.0/webcomponents.js","tibBalancedN40to200"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  hr.section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    margin: 0px;
  }


  d-byline {
    border-top: none;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
    border-top: none;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  /* tweak for Pandoc numbered line within distill */
  d-article pre.numberSource code > span {
      left: -2em;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // separator
    var separator = '<hr class="section-separator" style="clear: both"/>';
    // prepend separator above appendix
    $('.d-byline').before(separator);
    $('.d-article').before(separator);

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme, except when numbering line
    // in code chunk
    $('pre:not(.numberLines) code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        var author_name = front_matter.authors[i].author
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="explaining-the-bootstrap-cicsc-simulation_files/header-attrs-2.25/header-attrs.js"></script>
  <link href="explaining-the-bootstrap-cicsc-simulation_files/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
  <script src="explaining-the-bootstrap-cicsc-simulation_files/tabwid-1.1.3/tabwid.js"></script>
  <script src="explaining-the-bootstrap-cicsc-simulation_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="explaining-the-bootstrap-cicsc-simulation_files/popper-2.6.0/popper.min.js"></script>
  <link href="explaining-the-bootstrap-cicsc-simulation_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="explaining-the-bootstrap-cicsc-simulation_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="explaining-the-bootstrap-cicsc-simulation_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="explaining-the-bootstrap-cicsc-simulation_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="explaining-the-bootstrap-cicsc-simulation_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="explaining-the-bootstrap-cicsc-simulation_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="explaining-the-bootstrap-cicsc-simulation_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Explaining the bootstrap CI(CSC) simulation","description":"Explores four methods of estimating a CI around an observed Spearman correlation.","authors":[{"author":"Chris Evans","authorURL":"https://www.psyctc.org/R_blog/","affiliation":"PSYCTC.org","affiliationURL":"https://www.psyctc.org/psyctc/","orcidID":"0000-0002-4197-4202"}],"publishedDate":"2023-12-13T00:00:00.000+01:00","citationText":"Evans, 2023"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Explaining the bootstrap CI(CSC) simulation</h1>

<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt-tag">bootstrapping</div>
<div class="dt-tag">confidence intervals</div>
<div class="dt-tag">simulation</div>
</div>
<!--/radix_placeholder_categories-->
<p><p>Explores four methods of estimating a CI around an observed Spearman correlation.</p></p>
</div>

<div class="d-byline">
  Chris Evans <a href="https://www.psyctc.org/R_blog/" class="uri">https://www.psyctc.org/R_blog/</a> (PSYCTC.org)<a href="https://www.psyctc.org/psyctc/" class="uri">https://www.psyctc.org/psyctc/</a>
  
<br/>2023-12-13
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#getting-some-data" id="toc-getting-some-data">Getting some data</a></li>
<li><a href="#bootstrapping" id="toc-bootstrapping">Bootstrapping</a>
<ul>
<li><a href="#so-we-get-resampled-datasets-how-does-that-help" id="toc-so-we-get-resampled-datasets-how-does-that-help">So we get resampled datasets: how does that help?</a></li>
<li><a href="#so-how-do-you-construct-a-bootstrap-ci" id="toc-so-how-do-you-construct-a-bootstrap-ci">So how do you construct a bootstrap CI?</a>
<ul>
<li><a href="#constructing-a-percentile-bootstrap-ci" id="toc-constructing-a-percentile-bootstrap-ci">Constructing a percentile bootstrap CI</a></li>
</ul></li>
</ul></li>
<li><a href="#back-to-the-simulation-testing-the-bootstrap-cis" id="toc-back-to-the-simulation-testing-the-bootstrap-cis">Back to the simulation: testing the bootstrap CIs</a>
<ul>
<li><a href="#coverage" id="toc-coverage">Coverage</a>
<ul>
<li><a href="#summarising-assessment-of-coverage" id="toc-summarising-assessment-of-coverage">Summarising assessment of coverage</a></li>
</ul></li>
<li><a href="#bias" id="toc-bias">Bias</a></li>
</ul></li>
<li><a href="#summary" id="toc-summary">Summary</a></li>
</ul>
</nav>
</div>
<h1 id="getting-some-data">Getting some data</h1>
<p>The exploration and testing of the bootstrap methods of getting a confidence interval (CI) around the method c, CSC (Clinically Significant Change) criterion starts with two sets of data: one from a non-help-seeking (NHS, “non-clinical”) and one from a help-seeking (HS, “clinical”) population. In real life these are rarely true random samples from defined populations not least because people don’t walk around with badges on them saying “NHS” and “HS” so the issues about generalising from real life NHS and HS datasets to get a general CSC are complex but we can dodge that because those issues don’t affect whether the bootstrap methods of getting a CI around an observed CSC are good methods as we’re starting with a model, a simulation, of a true sampling process.</p>
<p>The CSC method c (and the frankly pretty absurd methods a and b) all start with the idea that the scores have Gaussian (“Normal”) distributions where the population means, and perhaps the standard deviations (SDs) are different for the NHS and HS populations. With that Gaussian model those four population parameters: two means and two SDs, completely define the two population distributions of scores.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>nNHS</span> <span class='op'>&lt;-</span> <span class='fl'>40</span></span>
<span><span class='va'>nHS</span> <span class='op'>&lt;-</span> <span class='fl'>40</span></span>
<span><span class='va'>meanNHS</span> <span class='op'>&lt;-</span> <span class='fl'>1</span></span>
<span><span class='va'>meanHS</span> <span class='op'>&lt;-</span> <span class='fl'>2.6</span></span>
<span><span class='va'>sdNHS</span> <span class='op'>&lt;-</span> <span class='fl'>1</span></span>
<span><span class='va'>sdHS</span> <span class='op'>&lt;-</span> <span class='fl'>1</span></span>
<span><span class='va'>valTrueCSC</span> <span class='op'>&lt;-</span> <span class='fl'>1.8</span></span>
<span></span>
<span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>3</span>, <span class='fl'>5.5</span>, <span class='fl'>.001</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>       <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>yNHS <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>dnorm</a></span><span class='op'>(</span><span class='va'>x</span>, mean <span class='op'>=</span> <span class='va'>meanNHS</span>, sd <span class='op'>=</span> <span class='va'>sdNHS</span><span class='op'>)</span>,</span>
<span>              yHS <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>dnorm</a></span><span class='op'>(</span><span class='va'>x</span>, mean <span class='op'>=</span> <span class='va'>meanHS</span>, sd <span class='op'>=</span> <span class='va'>sdHS</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibPopuln</span></span>
<span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibPopuln</span>,</span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>yNHS</span><span class='op'>)</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"green"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>yHS</span><span class='op'>)</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"blue"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>valTrueCSC</span>,</span>
<span>             linewidth <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>meanNHS</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"green"</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>2</span>,</span>
<span>             linewidth <span class='op'>=</span> <span class='fl'>1.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>meanHS</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"blue"</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>2</span>,</span>
<span>             linewidth <span class='op'>=</span> <span class='fl'>1.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Score"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span><span class='st'>"Scores"</span>,</span>
<span>                     <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>3</span>, <span class='fl'>5</span><span class='op'>)</span>,</span>
<span>                     limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>3</span>, <span class='fl'>5.5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span><span class='st'>"Density"</span>,</span>
<span>                     breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>.5</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span>                     limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>.5</span><span class='op'>)</span>,</span>
<span>                     expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Population misclassification using the correct population CSC of "</span>,</span>
<span>                 <span class='va'>valTrueCSC</span><span class='op'>)</span>,</span>
<span>          subtitle <span class='op'>=</span> <span class='st'>"Black reference line marks CSC, dashed vertical lines are population means"</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="explaining-the-bootstrap-cicsc-simulation_files/figure-html5/showModel-1.png" width="1536" /></p>
</div>
<p>The equation that gives the CSC value is</p>
<p><span class="math display">\[ \frac{\left( mean_{NHS} * sd_{HS} \right) + \left( mean_{HS} * sd_{NHS} \right) }{sd_{NHS} + sd_{HS}} \]</span></p>
<p>The crucial quality of that CSC is that, for Gaussian distributions, it will always give the same misclassification rate for the NHS population as for the HS population. That’s shown in this plot.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibPopuln</span>,</span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>yNHS</span><span class='op'>)</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"green"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>yHS</span><span class='op'>)</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"blue"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>valTrueCSC</span>,</span>
<span>             linewidth <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>meanNHS</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"green"</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>2</span>,</span>
<span>             linewidth <span class='op'>=</span> <span class='fl'>1.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>meanHS</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"blue"</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>2</span>,</span>
<span>             linewidth <span class='op'>=</span> <span class='fl'>1.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_ribbon.html'>geom_ribbon</a></span><span class='op'>(</span>data<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>tibPopuln</span>,</span>
<span>                          <span class='va'>x</span> <span class='op'>&gt;</span> <span class='va'>valTrueCSC</span> <span class='op'>&amp;</span> <span class='va'>x</span> <span class='op'>&lt;</span> <span class='cn'>Inf</span><span class='op'>)</span>,</span>
<span>              <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>ymax <span class='op'>=</span> <span class='va'>yNHS</span><span class='op'>)</span>,</span>
<span>              ymin <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>              fill <span class='op'>=</span> <span class='st'>"green"</span>,</span>
<span>              colour<span class='op'>=</span><span class='cn'>NA</span>,</span>
<span>              alpha<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_ribbon.html'>geom_ribbon</a></span><span class='op'>(</span>data<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>tibPopuln</span>,</span>
<span>                          <span class='va'>x</span> <span class='op'>&gt;</span> <span class='op'>-</span><span class='cn'>Inf</span> <span class='op'>&amp;</span> <span class='va'>x</span> <span class='op'>&lt;</span> <span class='va'>valTrueCSC</span><span class='op'>)</span>,</span>
<span>              <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>ymax <span class='op'>=</span> <span class='va'>yHS</span><span class='op'>)</span>,</span>
<span>              ymin <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>              fill <span class='op'>=</span> <span class='st'>"blue"</span>,</span>
<span>              colour<span class='op'>=</span><span class='cn'>NA</span>,</span>
<span>              alpha<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span><span class='st'>"Scores"</span>,</span>
<span>                     breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2</span>,<span class='fl'>5</span><span class='op'>)</span>,</span>
<span>                     limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>3</span>, <span class='fl'>5.5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span><span class='st'>"Density"</span>,</span>
<span>                     breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>.5</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span>                     limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>.5</span><span class='op'>)</span>,</span>
<span>                     expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Population misclassification using the correct population CSC of "</span>,</span>
<span>                 <span class='va'>valTrueCSC</span><span class='op'>)</span>,</span>
<span>          subtitle <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Shaded blue area is help-seeking people scoring below the CSC"</span>,</span>
<span>                           <span class='st'>"\nand shaded green area is that of  the non-help-seeking people scoring above the CSC"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="explaining-the-bootstrap-cicsc-simulation_files/figure-html5/showModelMisclassification-1.png" width="1536" /></p>
</div>
<p>A simulation starts with generating the two samples we need using that Gaussian model. Here’s a first simulation run creating an NHS and HS sample each of size
40 and both with from populations with SD
1. The NHS population mean is
1 with the HS population mean
2.6.</p>
<p>For what it’s worth, the R function to get a sample from a Gaussian population is:</p>
<pre><code>rnorm(n, mean = 1, sd = 1)</code></pre>
<p>where n is the sample size you want, mean the mean and sd the SD. As that code says, the mean and SD default to 1.0, i.e. to the parameters of the standard Gaussian distribution if they are omitted. Here is the first simulation.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>genData</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>nNHS</span>, <span class='va'>nHS</span>, <span class='va'>meanNHS</span>, <span class='va'>meanHS</span>, <span class='va'>sdNHS</span>, <span class='va'>sdHS</span>, <span class='va'>nSims</span><span class='op'>)</span><span class='op'>{</span></span>
<span>  <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>simN <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='va'>nSims</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://tidyr.tidyverse.org/reference/unnest_longer.html'>unnest_longer</a></span><span class='op'>(</span><span class='va'>simN</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rowwise.html'>rowwise</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>trueCSC <span class='op'>=</span> <span class='op'>(</span><span class='va'>sdHS</span><span class='op'>*</span><span class='va'>meanNHS</span> <span class='op'>+</span> <span class='va'>sdNHS</span><span class='op'>*</span><span class='va'>meanHS</span><span class='op'>)</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>sdHS</span> <span class='op'>+</span> <span class='va'>sdNHS</span><span class='op'>)</span>,</span>
<span>           scoresNHS <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>nNHS</span>, mean <span class='op'>=</span> <span class='va'>meanNHS</span>, sd <span class='op'>=</span> <span class='va'>sdNHS</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>           scoresHS <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>nHS</span>, mean <span class='op'>=</span> <span class='va'>meanHS</span>, sd <span class='op'>=</span> <span class='va'>sdHS</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>           meanNHS <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>scoresNHS</span><span class='op'>)</span>,</span>
<span>           sdNHS <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>scoresNHS</span><span class='op'>)</span>,</span>
<span>           meanHS <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>scoresHS</span><span class='op'>)</span>,</span>
<span>           sdHS <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>scoresHS</span><span class='op'>)</span>,</span>
<span>           obsCSC <span class='op'>=</span> <span class='op'>(</span><span class='op'>(</span><span class='va'>meanNHS</span> <span class='op'>*</span> <span class='va'>sdHS</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>meanHS</span> <span class='op'>*</span> <span class='va'>sdNHS</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>sdNHS</span> <span class='op'>+</span> <span class='va'>sdHS</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span>
<span><span class='fu'>genData</span><span class='op'>(</span>nNHS <span class='op'>=</span> <span class='va'>nNHS</span>, nHS <span class='op'>=</span> <span class='va'>nHS</span>, meanNHS <span class='op'>=</span> <span class='va'>meanNHS</span>, meanHS <span class='op'>=</span> <span class='va'>meanHS</span>, sdNHS <span class='op'>=</span> <span class='va'>sdNHS</span>, sdHS <span class='op'>=</span> <span class='va'>sdHS</span>, <span class='fl'>1</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibDat</span></span>
<span></span>
<span><span class='co'>### messy as data were not ideally shaped</span></span>
<span><span class='co'># tibDat %&gt;%</span></span>
<span><span class='co'>#   select(scoresNHS) %&gt;%</span></span>
<span><span class='co'>#   unnest_longer(scoresNHS) %&gt;%</span></span>
<span><span class='co'>#   pull() -&gt; vecScoresNHS</span></span>
<span><span class='va'>tibDat</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>scoresNHS</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/unnest_longer.html'>unnest_longer</a></span><span class='op'>(</span><span class='va'>scoresNHS</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>scores <span class='op'>=</span> <span class='va'>scoresNHS</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>grp <span class='op'>=</span> <span class='st'>"NHS"</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibScoresNHS</span></span>
<span></span>
<span><span class='co'># tibDat %&gt;%</span></span>
<span><span class='co'>#   select(scoresHS) %&gt;%</span></span>
<span><span class='co'>#   unnest_longer(scoresHS) %&gt;%</span></span>
<span><span class='co'>#   pull() -&gt; vecScoresHS</span></span>
<span><span class='va'>tibDat</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>scoresHS</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/unnest_longer.html'>unnest_longer</a></span><span class='op'>(</span><span class='va'>scoresHS</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>scores <span class='op'>=</span> <span class='va'>scoresHS</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>grp <span class='op'>=</span> <span class='st'>"HS"</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibScoresHS</span></span>
<span></span>
<span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind_rows.html'>bind_rows</a></span><span class='op'>(</span><span class='va'>tibScoresNHS</span>,</span>
<span>          <span class='va'>tibScoresHS</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibScores</span></span>
<span></span>
<span><span class='va'>vecColoursGrps</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"NHS"</span> <span class='op'>=</span> <span class='st'>"green"</span>, <span class='st'>"HS"</span> <span class='op'>=</span> <span class='st'>"blue"</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibScores</span>,</span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>scores</span>, fill <span class='op'>=</span> <span class='va'>grp</span>, group <span class='op'>=</span> <span class='va'>grp</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_histogram.html'>geom_histogram</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes_eval.html'>after_stat</a></span><span class='op'>(</span><span class='va'>density</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>                 position <span class='op'>=</span> <span class='st'>"identity"</span>,</span>
<span>                 colour <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>                 alpha <span class='op'>=</span> <span class='fl'>.8</span>, </span>
<span>                 bins <span class='op'>=</span> <span class='fl'>30</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span><span class='st'>"Scores"</span>,</span>
<span>                     breaks <span class='op'>=</span> <span class='op'>-</span><span class='fl'>3</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>3</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>vecColoursGrps</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Histogram of first simulation samples, samples overlaid"</span>,</span>
<span>          subtitle <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Both samples n = "</span>,</span>
<span>                            <span class='va'>nNHS</span>,</span>
<span>                            <span class='st'>" HS sample blue, NHS green, overload points dirty green!"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="explaining-the-bootstrap-cicsc-simulation_files/figure-html5/genData-1.png" width="1536" /></p>
</div>
<p>Of course the sample statistics are not the same as the population parameters.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibScores</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>grp</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>            mean <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>scores</span><span class='op'>)</span>,</span>
<span>            sd <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>scores</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span></span>
<span><span class='op'>(</span><span class='op'>(</span><span class='va'>meanNHS</span> <span class='op'>*</span> <span class='va'>sdHS</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>meanHS</span> <span class='op'>*</span> <span class='va'>sdNHS</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>sdNHS</span> <span class='op'>+</span> <span class='va'>sdHS</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>populnCSC</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/CECPfuns/man/getCSC.html'>getCSC</a></span><span class='op'>(</span><span class='va'>scores</span> <span class='op'>~</span> <span class='va'>grp</span>, data <span class='op'>=</span> <span class='va'>tibScores</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>sampCSC</span></span>
<span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibScores</span>,</span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>scores</span>, fill <span class='op'>=</span> <span class='va'>grp</span>, group <span class='op'>=</span> <span class='va'>grp</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_histogram.html'>geom_histogram</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes_eval.html'>after_stat</a></span><span class='op'>(</span><span class='va'>density</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>                 position <span class='op'>=</span> <span class='st'>"identity"</span>,</span>
<span>                 colour <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>                 alpha <span class='op'>=</span> <span class='fl'>.6</span>, </span>
<span>                 bins <span class='op'>=</span> <span class='fl'>30</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>sampCSC</span>,</span>
<span>             linewidth <span class='op'>=</span> <span class='fl'>2.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTib</span>,</span>
<span>             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>mean</span>,</span>
<span>                 colour <span class='op'>=</span> <span class='va'>grp</span><span class='op'>)</span>,</span>
<span>             linewidth <span class='op'>=</span> <span class='fl'>2.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span><span class='st'>"Scores"</span>,</span>
<span>                     breaks <span class='op'>=</span> <span class='op'>-</span><span class='fl'>3</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>3</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>vecColoursGrps</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>vecColoursGrps</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Histogram of first simulation samples, samples overlaid"</span>,</span>
<span>          subtitle <span class='op'>=</span> <span class='st'>"Vertical lines mark sample means with sample CSC in black"</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="explaining-the-bootstrap-cicsc-simulation_files/figure-html5/sampleStats-1.png" width="1536" /></p>
</div>
<p>Here are the actual sample statistics.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-2d1d2494{}.cl-2d181fc6{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-2d1a4f8a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-2d1a4f94{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-2d1a5e12{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2d1a5e13{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2d1a5e14{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2d1a5e1c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2d1a5e1d{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2d1a5e1e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-2d1d2494'><thead><tr style="overflow-wrap:break-word;"><th class="cl-2d1a5e12"><p class="cl-2d1a4f8a"><span class="cl-2d181fc6">grp</span></p></th><th class="cl-2d1a5e13"><p class="cl-2d1a4f94"><span class="cl-2d181fc6">n</span></p></th><th class="cl-2d1a5e13"><p class="cl-2d1a4f94"><span class="cl-2d181fc6">mean</span></p></th><th class="cl-2d1a5e13"><p class="cl-2d1a4f94"><span class="cl-2d181fc6">sd</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-2d1a5e14"><p class="cl-2d1a4f8a"><span class="cl-2d181fc6">HS</span></p></td><td class="cl-2d1a5e1c"><p class="cl-2d1a4f94"><span class="cl-2d181fc6">40</span></p></td><td class="cl-2d1a5e1c"><p class="cl-2d1a4f94"><span class="cl-2d181fc6">2.500</span></p></td><td class="cl-2d1a5e1c"><p class="cl-2d1a4f94"><span class="cl-2d181fc6">1.059</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d1a5e1d"><p class="cl-2d1a4f8a"><span class="cl-2d181fc6">NHS</span></p></td><td class="cl-2d1a5e1e"><p class="cl-2d1a4f94"><span class="cl-2d181fc6">40</span></p></td><td class="cl-2d1a5e1e"><p class="cl-2d1a4f94"><span class="cl-2d181fc6">0.934</span></p></td><td class="cl-2d1a5e1e"><p class="cl-2d1a4f94"><span class="cl-2d181fc6">0.995</span></p></td></tr></tbody></table></div>
</div>
<p>That illustrates just how far from the population means and SDs the sample statistics can be even with sample sizes of
40.</p>
<p>The sample CSC is:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>### uses the getCSC function from the CECPfuns package</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/CECPfuns/man/getCSC.html'>getCSC</a></span><span class='op'>(</span><span class='va'>scores</span> <span class='op'>~</span> <span class='va'>grp</span>, data <span class='op'>=</span> <span class='va'>tibScores</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>[1] 1.692257</code></pre>
</div>
<p>That too is a long way from the population CSC which we know is:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='op'>(</span><span class='op'>(</span><span class='va'>meanNHS</span> <span class='op'>*</span> <span class='va'>sdHS</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>meanHS</span> <span class='op'>*</span> <span class='va'>sdNHS</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>sdNHS</span> <span class='op'>+</span> <span class='va'>sdHS</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>[1] 1.8</code></pre>
</div>
<p>So it would be helpful to have a confidence interval around an observed sample CSC to give us an idea of the likely imprecision of the sample CSC as a substitute for the population CSC.</p>
<h1 id="bootstrapping">Bootstrapping</h1>
<p>Bootstrapping (from pulling yourself up by your bootstraps) works by “resampling”: creating new samples of the same size as the originals by sampling randomly from those samples <em>with replacement</em> so any of the observations in the original sample can appear in the resample zero, once or more often. The appropriate boostrap resampling for a two group/sample issue like the CSC is the <em>stratified</em> bootstrap where resampling happens within the groups.</p>
<p>This shows the first 10 values (in ascending order of scores) from each group and the resampled values <code>bootSampScore1</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>12345</span><span class='op'>)</span></span>
<span><span class='va'>tibScores</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>grp</span><span class='op'>)</span>, <span class='va'>scores</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>grp</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>indN <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/row_number.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>         bootSampScore1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='va'>scores</span>, <span class='va'>nNHS</span>, replace <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibBoot1</span></span>
<span>         </span>
<span><span class='va'>tibBoot1</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>grp</span>, <span class='va'>indN</span>, <span class='va'>scores</span>, <span class='va'>bootSampScore1</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span></span>
<span><span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>indN</span> <span class='op'>&lt;</span> <span class='fl'>11</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/as_grouped_data.html'>as_grouped_data</a></span><span class='op'>(</span>groups <span class='op'>=</span> <span class='st'>"grp"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-2d3536d8{}.cl-2d2fa6e6{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-2d32558a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-2d325594{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-2d326318{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2d326319{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2d326322{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2d326323{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2d326324{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2d32632c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-2d3536d8'><thead><tr style="overflow-wrap:break-word;"><th class="cl-2d326318"><p class="cl-2d32558a"><span class="cl-2d2fa6e6">grp</span></p></th><th class="cl-2d326319"><p class="cl-2d325594"><span class="cl-2d2fa6e6">indN</span></p></th><th class="cl-2d326319"><p class="cl-2d325594"><span class="cl-2d2fa6e6">scores</span></p></th><th class="cl-2d326319"><p class="cl-2d325594"><span class="cl-2d2fa6e6">bootSampScore1</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-2d326322"><p class="cl-2d32558a"><span class="cl-2d2fa6e6">NHS</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6"></span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6"></span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d326322"><p class="cl-2d32558a"><span class="cl-2d2fa6e6"></span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">1</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">-1.0503769</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">0.2590610</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d326322"><p class="cl-2d32558a"><span class="cl-2d2fa6e6"></span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">2</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">-0.8890820</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">2.1666709</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d326322"><p class="cl-2d32558a"><span class="cl-2d2fa6e6"></span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">3</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">-0.4711732</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">0.1676841</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d326322"><p class="cl-2d32558a"><span class="cl-2d2fa6e6"></span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">4</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">-0.4694578</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">-0.3806626</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d326322"><p class="cl-2d32558a"><span class="cl-2d2fa6e6"></span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">5</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">-0.3806626</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">0.6411831</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d326322"><p class="cl-2d32558a"><span class="cl-2d2fa6e6"></span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">6</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">-0.1817434</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">0.8487587</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d326322"><p class="cl-2d32558a"><span class="cl-2d2fa6e6"></span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">7</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">-0.1378560</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">0.6988439</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d326322"><p class="cl-2d32558a"><span class="cl-2d2fa6e6"></span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">8</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">-0.1085908</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">0.6988439</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d326322"><p class="cl-2d32558a"><span class="cl-2d2fa6e6"></span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">9</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">0.1676841</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">1.8591597</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d326322"><p class="cl-2d32558a"><span class="cl-2d2fa6e6"></span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">10</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">0.2078202</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">-0.4711732</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d326322"><p class="cl-2d32558a"><span class="cl-2d2fa6e6">HS</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6"></span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6"></span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d326322"><p class="cl-2d32558a"><span class="cl-2d2fa6e6"></span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">1</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">0.6886239</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">2.2314999</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d326322"><p class="cl-2d32558a"><span class="cl-2d2fa6e6"></span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">2</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">0.9007918</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">2.2926520</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d326322"><p class="cl-2d32558a"><span class="cl-2d2fa6e6"></span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">3</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">0.9039216</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">2.7021137</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d326322"><p class="cl-2d32558a"><span class="cl-2d2fa6e6"></span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">4</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">0.9392679</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">3.1692996</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d326322"><p class="cl-2d32558a"><span class="cl-2d2fa6e6"></span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">5</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">1.0564541</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">2.6188055</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d326322"><p class="cl-2d32558a"><span class="cl-2d2fa6e6"></span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">6</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">1.2061892</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">3.2008540</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d326322"><p class="cl-2d32558a"><span class="cl-2d2fa6e6"></span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">7</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">1.2091944</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">1.7103410</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d326322"><p class="cl-2d32558a"><span class="cl-2d2fa6e6"></span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">8</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">1.3201008</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">3.4687160</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d326322"><p class="cl-2d32558a"><span class="cl-2d2fa6e6"></span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">9</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">1.4076364</span></p></td><td class="cl-2d326323"><p class="cl-2d325594"><span class="cl-2d2fa6e6">2.6188055</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d326324"><p class="cl-2d32558a"><span class="cl-2d2fa6e6"></span></p></td><td class="cl-2d32632c"><p class="cl-2d325594"><span class="cl-2d2fa6e6">10</span></p></td><td class="cl-2d32632c"><p class="cl-2d325594"><span class="cl-2d2fa6e6">1.5461349</span></p></td><td class="cl-2d32632c"><p class="cl-2d325594"><span class="cl-2d2fa6e6">0.9007918</span></p></td></tr></tbody></table></div>
</div>
<p>As the resampling was at random any correlation between the original scores and the resampling created scores will be random.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibBoot1</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>grp</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>corr <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/CECPfuns/man/getBootCICorr.html'>getBootCICorr</a></span><span class='op'>(</span><span class='va'>scores</span> <span class='op'>~</span> <span class='va'>bootSampScore1</span>, data <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pick.html'>pick</a></span><span class='op'>(</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/unnest_wider.html'>unnest_wider</a></span><span class='op'>(</span><span class='va'>corr</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-2d598466{}.cl-2d54f054{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-2d56ec42{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-2d56ec4c{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-2d56f98a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2d56f994{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2d56f99e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2d56f99f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2d56f9a8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2d56f9a9{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-2d598466'><thead><tr style="overflow-wrap:break-word;"><th class="cl-2d56f98a"><p class="cl-2d56ec42"><span class="cl-2d54f054">grp</span></p></th><th class="cl-2d56f994"><p class="cl-2d56ec4c"><span class="cl-2d54f054">obsCorr</span></p></th><th class="cl-2d56f994"><p class="cl-2d56ec4c"><span class="cl-2d54f054">LCLCorr</span></p></th><th class="cl-2d56f994"><p class="cl-2d56ec4c"><span class="cl-2d54f054">UCLCorr</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-2d56f99e"><p class="cl-2d56ec42"><span class="cl-2d54f054">HS</span></p></td><td class="cl-2d56f99f"><p class="cl-2d56ec4c"><span class="cl-2d54f054">0.170</span></p></td><td class="cl-2d56f99f"><p class="cl-2d56ec4c"><span class="cl-2d54f054">-0.129</span></p></td><td class="cl-2d56f99f"><p class="cl-2d56ec4c"><span class="cl-2d54f054">0.423</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d56f9a8"><p class="cl-2d56ec42"><span class="cl-2d54f054">NHS</span></p></td><td class="cl-2d56f9a9"><p class="cl-2d56ec4c"><span class="cl-2d54f054">-0.029</span></p></td><td class="cl-2d56f9a9"><p class="cl-2d56ec4c"><span class="cl-2d54f054">-0.355</span></p></td><td class="cl-2d56f9a9"><p class="cl-2d56ec4c"><span class="cl-2d54f054">0.269</span></p></td></tr></tbody></table></div>
</div>
<p>Yes. Observed correlations (within groups) safely inside 95% CIs for a population zero correlation.</p>
<p>This shows for the first ten scores in the original NHS sample how many times each value appears in the fully resampled NHS sample.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibBoot1</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>grp</span> <span class='op'>==</span> <span class='st'>"NHS"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>bootSampScore1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpVecNHSbootScores</span></span>
<span></span>
<span><span class='va'>tibBoot1</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>grp</span> <span class='op'>==</span> <span class='st'>"HS"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>bootSampScore1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpVecHSbootScores</span></span>
<span></span>
<span><span class='va'>tibBoot1</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>grp</span> <span class='op'>==</span> <span class='st'>"NHS"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rowwise.html'>rowwise</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>nCopies <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>scores</span> <span class='op'>==</span> <span class='va'>tmpVecNHSbootScores</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>grp</span>, <span class='va'>indN</span>, <span class='va'>nCopies</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>indN</span> <span class='op'>&lt;</span> <span class='fl'>11</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-2d6f337e{}.cl-2d6a7f64{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-2d6c8b7e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-2d6c8b88{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-2d6c9880{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2d6c9881{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2d6c988a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2d6c988b{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2d6c9894{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2d6c9895{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-2d6f337e'><thead><tr style="overflow-wrap:break-word;"><th class="cl-2d6c9880"><p class="cl-2d6c8b7e"><span class="cl-2d6a7f64">grp</span></p></th><th class="cl-2d6c9881"><p class="cl-2d6c8b88"><span class="cl-2d6a7f64">indN</span></p></th><th class="cl-2d6c9881"><p class="cl-2d6c8b88"><span class="cl-2d6a7f64">nCopies</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-2d6c988a"><p class="cl-2d6c8b7e"><span class="cl-2d6a7f64">NHS</span></p></td><td class="cl-2d6c988b"><p class="cl-2d6c8b88"><span class="cl-2d6a7f64">1</span></p></td><td class="cl-2d6c988b"><p class="cl-2d6c8b88"><span class="cl-2d6a7f64">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d6c988a"><p class="cl-2d6c8b7e"><span class="cl-2d6a7f64">NHS</span></p></td><td class="cl-2d6c988b"><p class="cl-2d6c8b88"><span class="cl-2d6a7f64">2</span></p></td><td class="cl-2d6c988b"><p class="cl-2d6c8b88"><span class="cl-2d6a7f64">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d6c988a"><p class="cl-2d6c8b7e"><span class="cl-2d6a7f64">NHS</span></p></td><td class="cl-2d6c988b"><p class="cl-2d6c8b88"><span class="cl-2d6a7f64">3</span></p></td><td class="cl-2d6c988b"><p class="cl-2d6c8b88"><span class="cl-2d6a7f64">3</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d6c988a"><p class="cl-2d6c8b7e"><span class="cl-2d6a7f64">NHS</span></p></td><td class="cl-2d6c988b"><p class="cl-2d6c8b88"><span class="cl-2d6a7f64">4</span></p></td><td class="cl-2d6c988b"><p class="cl-2d6c8b88"><span class="cl-2d6a7f64">2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d6c988a"><p class="cl-2d6c8b7e"><span class="cl-2d6a7f64">NHS</span></p></td><td class="cl-2d6c988b"><p class="cl-2d6c8b88"><span class="cl-2d6a7f64">5</span></p></td><td class="cl-2d6c988b"><p class="cl-2d6c8b88"><span class="cl-2d6a7f64">2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d6c988a"><p class="cl-2d6c8b7e"><span class="cl-2d6a7f64">NHS</span></p></td><td class="cl-2d6c988b"><p class="cl-2d6c8b88"><span class="cl-2d6a7f64">6</span></p></td><td class="cl-2d6c988b"><p class="cl-2d6c8b88"><span class="cl-2d6a7f64">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d6c988a"><p class="cl-2d6c8b7e"><span class="cl-2d6a7f64">NHS</span></p></td><td class="cl-2d6c988b"><p class="cl-2d6c8b88"><span class="cl-2d6a7f64">7</span></p></td><td class="cl-2d6c988b"><p class="cl-2d6c8b88"><span class="cl-2d6a7f64">2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d6c988a"><p class="cl-2d6c8b7e"><span class="cl-2d6a7f64">NHS</span></p></td><td class="cl-2d6c988b"><p class="cl-2d6c8b88"><span class="cl-2d6a7f64">8</span></p></td><td class="cl-2d6c988b"><p class="cl-2d6c8b88"><span class="cl-2d6a7f64">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d6c988a"><p class="cl-2d6c8b7e"><span class="cl-2d6a7f64">NHS</span></p></td><td class="cl-2d6c988b"><p class="cl-2d6c8b88"><span class="cl-2d6a7f64">9</span></p></td><td class="cl-2d6c988b"><p class="cl-2d6c8b88"><span class="cl-2d6a7f64">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d6c9894"><p class="cl-2d6c8b7e"><span class="cl-2d6a7f64">NHS</span></p></td><td class="cl-2d6c9895"><p class="cl-2d6c8b88"><span class="cl-2d6a7f64">10</span></p></td><td class="cl-2d6c9895"><p class="cl-2d6c8b88"><span class="cl-2d6a7f64">2</span></p></td></tr></tbody></table></div>
</div>
<p>So the first two values don’t appear in the bootstrap sample NHS scores at all but then the third value appears 3 times, the fourth doesn’t appear and the fifth appears twice, and so on. Here is the breakdown of number of copies across all
<code>n nNHS</code> sample values.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibBoot1</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>grp</span> <span class='op'>==</span> <span class='st'>"NHS"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rowwise.html'>rowwise</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>nCopies <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>scores</span> <span class='op'>==</span> <span class='va'>tmpVecNHSbootScores</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/count.html'>count</a></span><span class='op'>(</span><span class='va'>nCopies</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-2d88dda6{}.cl-2d84461a{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-2d864ae6{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-2d865874{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2d86587e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2d86587f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-2d88dda6'><thead><tr style="overflow-wrap:break-word;"><th class="cl-2d865874"><p class="cl-2d864ae6"><span class="cl-2d84461a">nCopies</span></p></th><th class="cl-2d865874"><p class="cl-2d864ae6"><span class="cl-2d84461a">n</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-2d86587e"><p class="cl-2d864ae6"><span class="cl-2d84461a">0</span></p></td><td class="cl-2d86587e"><p class="cl-2d864ae6"><span class="cl-2d84461a">17</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d86587e"><p class="cl-2d864ae6"><span class="cl-2d84461a">1</span></p></td><td class="cl-2d86587e"><p class="cl-2d864ae6"><span class="cl-2d84461a">9</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d86587e"><p class="cl-2d864ae6"><span class="cl-2d84461a">2</span></p></td><td class="cl-2d86587e"><p class="cl-2d864ae6"><span class="cl-2d84461a">11</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d86587f"><p class="cl-2d864ae6"><span class="cl-2d84461a">3</span></p></td><td class="cl-2d86587f"><p class="cl-2d864ae6"><span class="cl-2d84461a">3</span></p></td></tr></tbody></table></div>
</div>
<p>Here’s the same breakdown for the HS bootstrap resampled data.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibBoot1</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>grp</span> <span class='op'>==</span> <span class='st'>"HS"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rowwise.html'>rowwise</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>nCopies <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>scores</span> <span class='op'>==</span> <span class='va'>tmpVecHSbootScores</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/count.html'>count</a></span><span class='op'>(</span><span class='va'>nCopies</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-2d9b9090{}.cl-2d96ee50{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-2d98f4fc{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-2d990262{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2d990263{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2d99026c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-2d9b9090'><thead><tr style="overflow-wrap:break-word;"><th class="cl-2d990262"><p class="cl-2d98f4fc"><span class="cl-2d96ee50">nCopies</span></p></th><th class="cl-2d990262"><p class="cl-2d98f4fc"><span class="cl-2d96ee50">n</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-2d990263"><p class="cl-2d98f4fc"><span class="cl-2d96ee50">0</span></p></td><td class="cl-2d990263"><p class="cl-2d98f4fc"><span class="cl-2d96ee50">14</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d990263"><p class="cl-2d98f4fc"><span class="cl-2d96ee50">1</span></p></td><td class="cl-2d990263"><p class="cl-2d98f4fc"><span class="cl-2d96ee50">15</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d990263"><p class="cl-2d98f4fc"><span class="cl-2d96ee50">2</span></p></td><td class="cl-2d990263"><p class="cl-2d98f4fc"><span class="cl-2d96ee50">9</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d990263"><p class="cl-2d98f4fc"><span class="cl-2d96ee50">3</span></p></td><td class="cl-2d990263"><p class="cl-2d98f4fc"><span class="cl-2d96ee50">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2d99026c"><p class="cl-2d98f4fc"><span class="cl-2d96ee50">4</span></p></td><td class="cl-2d99026c"><p class="cl-2d98f4fc"><span class="cl-2d96ee50">1</span></p></td></tr></tbody></table></div>
</div>
<p>This facetted histogram juxtaposes the histogram of the simulated data (“simulation1”) with the first stratified bootstrap replication from those first simulated samples.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibBoot1</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>indN</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span>cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>scores</span>, <span class='va'>bootSampScore1</span><span class='op'>)</span>, names_to <span class='op'>=</span> <span class='st'>"sample"</span>, values_to <span class='op'>=</span> <span class='st'>"scores"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>sample <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>sample</span> <span class='op'>==</span> <span class='st'>"scores"</span>, <span class='st'>"simulation1"</span>, <span class='st'>"bootstrap1"</span><span class='op'>)</span>,</span>
<span>         sample <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>ordered</a></span><span class='op'>(</span><span class='va'>sample</span>,</span>
<span>                          levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"simulation1"</span>, <span class='st'>"bootstrap1"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibBoot1long</span></span>
<span></span>
<span><span class='va'>tibBoot1long</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>sample</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>csc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/CECPfuns/man/getCSC.html'>getCSC</a></span><span class='op'>(</span><span class='va'>scores</span> <span class='op'>~</span> <span class='va'>grp</span>, data <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pick.html'>pick</a></span><span class='op'>(</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>grp</span>, <span class='va'>sample</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>csc <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/nth.html'>first</a></span><span class='op'>(</span><span class='va'>csc</span><span class='op'>)</span>,</span>
<span>         mean <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>scores</span><span class='op'>)</span>,</span>
<span>         sd <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>scores</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibBoot1long</span>,</span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>scores</span>, colour <span class='op'>=</span> <span class='va'>grp</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_grid.html'>facet_grid</a></span><span class='op'>(</span>rows <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/vars.html'>vars</a></span><span class='op'>(</span><span class='va'>sample</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_histogram.html'>geom_histogram</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes_eval.html'>after_stat</a></span><span class='op'>(</span><span class='va'>density</span><span class='op'>)</span>,</span>
<span>                     fill <span class='op'>=</span> <span class='va'>grp</span><span class='op'>)</span>,</span>
<span>                 position <span class='op'>=</span> <span class='st'>"identity"</span>,</span>
<span>                 colour <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>                 alpha <span class='op'>=</span> <span class='fl'>.6</span>, </span>
<span>                 bins <span class='op'>=</span> <span class='fl'>30</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTib</span>, </span>
<span>             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>csc</span><span class='op'>)</span>,</span>
<span>             linewidth <span class='op'>=</span> <span class='fl'>2.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTib</span>,</span>
<span>             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>mean</span>,</span>
<span>                 colour <span class='op'>=</span> <span class='va'>grp</span><span class='op'>)</span>,</span>
<span>             linewidth <span class='op'>=</span> <span class='fl'>2.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span><span class='st'>"Scores"</span>,</span>
<span>                     breaks <span class='op'>=</span> <span class='op'>-</span><span class='fl'>3</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>3</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>vecColoursGrps</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>vecColoursGrps</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Histogram of scores by NHS versus HS group"</span>,</span>
<span>          subtitle <span class='op'>=</span> <span class='st'>"Facetted by sample: first simulationi or first bootstrap resample of that"</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="explaining-the-bootstrap-cicsc-simulation_files/figure-html5/unnamed-chunk-7-1.png" width="1536" /></p>
</div>
<p>It can be seen that as the resampling creates a new dataset so the means and SDs change and so too does the observed CSC from the data.</p>
<p>This animated histogram cycles through the first simulation data and then five bootstrap resampling datasets.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>12345</span><span class='op'>)</span></span>
<span><span class='va'>tibScores</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>grp</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>indN <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/row_number.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_wider.html'>pivot_wider</a></span><span class='op'>(</span>names_from <span class='op'>=</span> <span class='va'>grp</span>, values_from <span class='op'>=</span> <span class='va'>scores</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibScoresWide</span></span>
<span></span>
<span><span class='va'>resample</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>tibScoresWide</span>, <span class='va'>nReps</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>tibScoresWide</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='va'>vecReps</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"bootRep"</span>, <span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span><span class='op'>(</span><span class='st'>"%03.0f"</span>, <span class='fl'>1</span><span class='op'>:</span><span class='va'>nReps</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>repN <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='va'>nReps</span><span class='op'>)</span>,</span>
<span>         indN <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='va'>n</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://tidyr.tidyverse.org/reference/unnest_longer.html'>unnest_longer</a></span><span class='op'>(</span><span class='va'>repN</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>repN <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"bootRep"</span>, <span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span><span class='op'>(</span><span class='st'>"%03.0f"</span>, <span class='va'>repN</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://tidyr.tidyverse.org/reference/unnest_longer.html'>unnest_longer</a></span><span class='op'>(</span><span class='va'>indN</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>repN</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>NHS <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='va'>tibScoresWide</span><span class='op'>$</span><span class='va'>NHS</span><span class='op'>)</span>, <span class='va'>n</span>, replace <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,</span>
<span>           HS <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='va'>tibScoresWide</span><span class='op'>$</span><span class='va'>HS</span><span class='op'>)</span>, <span class='va'>n</span>, replace <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span>  </span>
<span>  <span class='va'>tibScoresWide</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>repN <span class='op'>=</span> <span class='st'>"simulSample"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>repN</span>, <span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib2</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind_rows.html'>bind_rows</a></span><span class='op'>(</span><span class='va'>tmpTib2</span>,</span>
<span>            <span class='va'>tmpTib</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>repN <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>ordered</a></span><span class='op'>(</span><span class='va'>repN</span>,</span>
<span>                          levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"simulSample"</span>,</span>
<span>                                     <span class='va'>vecReps</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span>
<span><span class='fu'>resample</span><span class='op'>(</span><span class='va'>tibScoresWide</span>, <span class='fl'>5</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibLong</span></span>
<span></span>
<span><span class='va'>tibLong</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span>cols <span class='op'>=</span> <span class='va'>NHS</span><span class='op'>:</span><span class='va'>HS</span>, names_to <span class='op'>=</span> <span class='st'>"grp"</span>, values_to <span class='op'>=</span> <span class='st'>"scores"</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibLong2</span></span>
<span></span>
<span><span class='va'>tibLong2</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>repN</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>csc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/CECPfuns/man/getCSC.html'>getCSC</a></span><span class='op'>(</span><span class='va'>scores</span> <span class='op'>~</span> <span class='va'>grp</span>, data <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pick.html'>pick</a></span><span class='op'>(</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>grp</span>, <span class='va'>repN</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>csc <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/nth.html'>first</a></span><span class='op'>(</span><span class='va'>csc</span><span class='op'>)</span>,</span>
<span>         mean <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>scores</span><span class='op'>)</span>,</span>
<span>         sd <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>scores</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibLong2</span>,</span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>scores</span>, colour <span class='op'>=</span> <span class='va'>grp</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_histogram.html'>geom_histogram</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes_eval.html'>after_stat</a></span><span class='op'>(</span><span class='va'>density</span><span class='op'>)</span>,</span>
<span>                     fill <span class='op'>=</span> <span class='va'>grp</span><span class='op'>)</span>,</span>
<span>                 position <span class='op'>=</span> <span class='st'>"identity"</span>,</span>
<span>                 colour <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>                 alpha <span class='op'>=</span> <span class='fl'>.6</span>, </span>
<span>                 bins <span class='op'>=</span> <span class='fl'>30</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTib</span>, </span>
<span>             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>csc</span><span class='op'>)</span>,</span>
<span>             linewidth <span class='op'>=</span> <span class='fl'>2.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTib</span>,</span>
<span>             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>mean</span>,</span>
<span>                 colour <span class='op'>=</span> <span class='va'>grp</span><span class='op'>)</span>,</span>
<span>             linewidth <span class='op'>=</span> <span class='fl'>2.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span><span class='st'>"Scores"</span>,</span>
<span>                     breaks <span class='op'>=</span> <span class='op'>-</span><span class='fl'>3</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>3</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>vecColoursGrps</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>vecColoursGrps</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Histogram of scores, means and CSCs by sample/resample"</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot</span></span>
<span></span>
<span></span>
<span><span class='co'># tmpPlot +</span></span>
<span><span class='co'>#   gganimate::transition_states(repN) +</span></span>
<span><span class='co'>#   labs(title = "Sample: {closest_state}",</span></span>
<span><span class='co'>#        transition_length = 0,</span></span>
<span><span class='co'>#        wrap = TRUE) +</span></span>
<span><span class='co'>#   enter_appear() +</span></span>
<span><span class='co'>#   exit_disappear() -&gt; tmpAnimate</span></span>
<span><span class='co'># </span></span>
<span><span class='co'># anim_save("animate1.gif", tmpAnimate, width = 800, height = 600)</span></span></code></pre>
</div>
</details>
</div>
<p><img src="animate1.gif" /></p>
<p>I’m not sure if animating, with its insistence on cross-fading, conveys the extent to which the bootstrap resamples vary and are different from the sample from which they are created. I’m not sure this facetted plot, with the simulated sample top left then the save five resamples as in the animation is any better.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibLong2</span>,</span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>scores</span>, colour <span class='op'>=</span> <span class='va'>grp</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_histogram.html'>geom_histogram</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes_eval.html'>after_stat</a></span><span class='op'>(</span><span class='va'>density</span><span class='op'>)</span>,</span>
<span>                     fill <span class='op'>=</span> <span class='va'>grp</span><span class='op'>)</span>,</span>
<span>                 position <span class='op'>=</span> <span class='st'>"identity"</span>,</span>
<span>                 colour <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>                 alpha <span class='op'>=</span> <span class='fl'>.6</span>, </span>
<span>                 bins <span class='op'>=</span> <span class='fl'>30</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></span><span class='op'>(</span>facets <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/vars.html'>vars</a></span><span class='op'>(</span><span class='va'>repN</span><span class='op'>)</span>,</span>
<span>             ncol <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTib</span>, </span>
<span>             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>csc</span><span class='op'>)</span>,</span>
<span>             linewidth <span class='op'>=</span> <span class='fl'>2.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTib</span>,</span>
<span>             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>mean</span>,</span>
<span>                 colour <span class='op'>=</span> <span class='va'>grp</span><span class='op'>)</span>,</span>
<span>             linewidth <span class='op'>=</span> <span class='fl'>2.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span><span class='st'>"Scores"</span>,</span>
<span>                     breaks <span class='op'>=</span> <span class='op'>-</span><span class='fl'>3</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>3</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>vecColoursGrps</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>vecColoursGrps</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Histogram of scores, means and CSCs by sample/resample"</span><span class='op'>)</span> </span></code></pre>
</div>
</details>
<p><img src="explaining-the-bootstrap-cicsc-simulation_files/figure-html5/facets-1.png" width="1536" /></p>
</div>
<p>However, I hope that the above has explained the creation of bootstrap resampling datasets.</p>
<h2 id="so-we-get-resampled-datasets-how-does-that-help">So we get resampled datasets: how does that help?</h2>
<p>Primarily because it enables us to construct CIs around an observed statistic and CIs constructed by bootstrapping have some huge positives:</p>
<ol type="1">
<li><p>They don’t need any algebraic, mathematical or parametric model: they just need data to resample.</p></li>
<li><p>If the distributions of the observations are independent (hence the simple bootstrap won’t work for time series data without a lot of other tricks), if the distributions of the variables don’t have huge discontinuitie nor very limited variances and if the <em>n</em> aren’t tiny then the CIs can be very well behaved.</p></li>
</ol>
<p>What does “well behaved mean” for CIs?</p>
<ul>
<li><p>They should include the true population parameter somewhere near 95% of the time (assuming that you asked for the 95% CI). That is to say they tend to have fairly accurate “coverage”.</p></li>
<li><p>Similarly, the of generally fairly unbiased: the CIs falling entirely below the population parameter about as often as entirely above it.</p></li>
</ul>
<p>When I first met bootstrapping that struck me as a bit too good to be true and that wasn’t just my natural scepticism: there is no guarantee that for any particular population parameter you want to estimate from the data you have that the bootstrap method will work well and it doesn’t escape the issues, equally important when generalising in any way from a given dataset to a population or even to general implications. If the data you have are tiny the bootstrap can’t escape how that limits generalisation (and I have a suspicion that with very small datasets it may give wild CIs that, if at the one end of wild may look overly reassuring though with tiny <em>n</em> bootstrapping may simply be wild and might give very wide CIs, I try not to use bootstrapping now with minimum <em>n</em> &lt; 40 though that’s a rule I pretty much plucked out of my imagination, much would depend on the parameter of interest and its distribution). Perhaps more importantly, if your dataset was created (sampled) in a way that makes it unrepresentative of the population to which you want to generalise or for which you want to create implications then bootstrap analyses will be as misleading as any other analyses. (And just pleading a few other issues in “limitations” should never be allowed to hide this.)</p>
<p>What is the logic to this? Well, there is some sophisticated maths for it for many parameters and distributions but as I see it the logic is that the data we have is the [best|latest|only] data we have on which to speculate. So to build up from it (bootstraps? shoelaces?) by looking at how the statistic you are extracting from your dataset changes as you randomly change the data you have, but always sticking within your data, should give you a sensible guide to how precisely you might be estimating a population parameter.</p>
<h2 id="so-how-do-you-construct-a-bootstrap-ci">So how do you construct a bootstrap CI?</h2>
<p>There are a number of ways of doing it but for a lot of statistics/parameters only four are likely to be appropriate. Unsurpisingly, these are four that the R package boot will offer for most analyses. They are:</p>
<ul>
<li><p>percentile</p></li>
<li><p>basic</p></li>
<li><p>normal</p></li>
<li><p>bca (bias controlled and accelerated)</p></li>
</ul>
<p>I may come back to the others in other posts but the easiest to explain is the percentile so I’m going to stick with that here</p>
<h3 id="constructing-a-percentile-bootstrap-ci">Constructing a percentile bootstrap CI</h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibScores</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>grp <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>ordered</a></span><span class='op'>(</span><span class='va'>grp</span>,</span>
<span>                       levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"NHS"</span>, <span class='st'>"HS"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>         grp <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>grp</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpDat</span></span>
<span>  </span>
<span><span class='va'>getCSClocal</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>tmpDat</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='va'>tmpDat</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>    <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>grp</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>    <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span>, </span>
<span>                     mean <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>scores</span><span class='op'>)</span>, </span>
<span>                     sd <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>scores</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibStats</span> </span>
<span>  <span class='va'>tibStats</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>    <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>denominator <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>sd</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>    <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>denominator</span></span>
<span>  </span>
<span>  <span class='va'>tibStats</span><span class='op'>$</span><span class='va'>mean</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span> <span class='op'>*</span> <span class='va'>tibStats</span><span class='op'>$</span><span class='va'>sd</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>tibStats</span><span class='op'>$</span><span class='va'>mean</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>*</span> <span class='va'>tibStats</span><span class='op'>$</span><span class='va'>sd</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span> <span class='op'>-&gt;</span> <span class='va'>numerator</span></span>
<span>  </span>
<span>  <span class='va'>numerator</span><span class='op'>/</span><span class='va'>denominator</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='va'>getCSCforBoot</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>tmpDat</span>, <span class='va'>i</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='fu'>getCSClocal</span><span class='op'>(</span><span class='va'>tmpDat</span><span class='op'>[</span><span class='va'>i</span>, <span class='op'>]</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>12345</span><span class='op'>)</span></span>
<span><span class='va'>tmpBootRes</span> <span class='op'>&lt;-</span> <span class='fu'>boot</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/boot/man/boot.html'>boot</a></span><span class='op'>(</span><span class='va'>tmpDat</span>, </span>
<span>                         statistic <span class='op'>=</span> <span class='va'>getCSCforBoot</span>, </span>
<span>                         stype <span class='op'>=</span> <span class='st'>"i"</span>, </span>
<span>                         strata <span class='op'>=</span> <span class='va'>tmpDat</span><span class='op'>[</span>, <span class='fl'>2</span><span class='op'>]</span>, </span>
<span>                         R <span class='op'>=</span> <span class='fl'>1000</span>,</span>
<span>                         parallel <span class='op'>=</span> <span class='st'>"multicore"</span>, </span>
<span>                         ncpus <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>vecCSCs</span> <span class='op'>&lt;-</span> <span class='va'>tmpBootRes</span><span class='op'>$</span><span class='va'>t</span></span></code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span><span class='va'>vecCSCs</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>bootCSCs <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibBootCSCs</span></span>
<span></span>
<span><span class='va'>tibBootCSCs</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>            mean <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>bootCSCs</span><span class='op'>)</span>,</span>
<span>            SD <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>bootCSCs</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibBootCSCstats</span></span>
<span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibBootCSCs</span>,</span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>bootCSCs</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_histogram.html'>geom_histogram</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>tibBootCSCstats</span><span class='op'>$</span><span class='va'>mean</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"CSC values from each bootstrap resample"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Histogram of CSCs from "</span>,</span>
<span>                 <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>tibBootCSCs</span><span class='op'>)</span>,</span>
<span>                 <span class='st'>" bootstrap resamples of data above"</span><span class='op'>)</span>,</span>
<span>          subtitle <span class='op'>=</span> <span class='st'>"Vertical reference line is mean of the CSCs"</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="explaining-the-bootstrap-cicsc-simulation_files/figure-html5/percentileCI1-1.png" width="1536" /></p>
</div>
<p>The mean of those bootstrap CSCs is
1.687 which is reassuringly close to the raw data CSC
1.692 and neither are far from the known population CSC (which we know because this is simulated data)
1.8. The distribution looks not way off from Gaussian (that’s more important for some of the bootstrap CI methods than for the percentile method), more importantly for all bootstrap methods it looks fairly symmetrical and though there is one outlying (low) CSC, generally the spread doesn’t look wild (taking us back to the issue of near Gaussian distribution really: it’s not “heavy tailed” or “kurtotic”).</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span><span class='op'>(</span><span class='va'>vecCSCs</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.025</span>, <span class='fl'>.975</span><span class='op'>)</span>, type <span class='op'>=</span> <span class='fl'>6</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>type6percentileCI</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/boot/man/boot.ci.html'>boot.ci</a></span><span class='op'>(</span><span class='va'>tmpBootRes</span>,type <span class='op'>=</span> <span class='st'>"perc"</span><span class='op'>)</span><span class='op'>$</span><span class='va'>percent</span><span class='op'>[</span><span class='fl'>1</span>, <span class='fl'>4</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>]</span> <span class='op'>-&gt;</span> <span class='va'>tmpBootCIPercentile</span></span></code></pre>
</div>
</details>
</div>
<p>The 95% bootstrap CI for the CSC here, by the percentile method, is the range between the 2.5% and 97.5% percentiles of those CSCs which turns out to be from
1.44 to
1.94. In this next plot I’ve shown this on another histogram of the same
1000 bootstrap resampling CSC values. (In this histogram I’ve used a much narrower “bin width” so the general shape is less clear but I can make the shading fit the percentiles!) The central 95% of the resamples are coloured green and the lowest 2.5% are showin purple and highest 2.5% in red.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># quantile(vecCSCs, c(.025, .975))</span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibBootCSCs</span>,</span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>bootCSCs</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_histogram.html'>geom_histogram</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>.5</span>,</span>
<span>                 binwidth <span class='op'>=</span> <span class='fl'>.005</span>,</span>
<span>                 fill <span class='op'>=</span> <span class='st'>"green"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>tibBootCSCstats</span><span class='op'>$</span><span class='va'>mean</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>type6percentileCI</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"purple"</span>,</span>
<span>             linewidth <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>type6percentileCI</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>2</span>,</span>
<span>             linewidth <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_histogram.html'>geom_histogram</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>tibBootCSCs</span>,</span>
<span>                             <span class='va'>bootCSCs</span> <span class='op'>&lt;</span> <span class='va'>type6percentileCI</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>,</span>
<span>                 <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>bootCSCs</span><span class='op'>)</span>,</span>
<span>                 binwidth <span class='op'>=</span> <span class='fl'>.005</span>,</span>
<span>                 fill <span class='op'>=</span> <span class='st'>"purple"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_histogram.html'>geom_histogram</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>tibBootCSCs</span>,</span>
<span>                             <span class='va'>bootCSCs</span> <span class='op'>&gt;</span> <span class='va'>type6percentileCI</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span>,</span>
<span>                 <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>bootCSCs</span><span class='op'>)</span>,</span>
<span>                 binwidth <span class='op'>=</span> <span class='fl'>.005</span>,</span>
<span>                 fill <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"CSC values from each bootstrap resample"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Histogram of CSCs from 1,000 bootstrap resamples of data above"</span>,</span>
<span>          subtitle <span class='op'>=</span> <span class='st'>"Black vertical reference line is mean of the CSCs, green give 95% percentile CLs"</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="explaining-the-bootstrap-cicsc-simulation_files/figure-html5/percentileCI3-1.png" width="1536" /></p>
</div>
<p>For completeness here are all four CIs the four bootstrap CI methods gave for that particular simulated sample.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/boot/man/boot.ci.html'>boot.ci</a></span><span class='op'>(</span><span class='va'>tmpBootRes</span>,type <span class='op'>=</span> <span class='st'>"norm"</span><span class='op'>)</span><span class='op'>$</span><span class='va'>norm</span><span class='op'>[</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span> <span class='op'>-&gt;</span> <span class='va'>tmpBootCInorm</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/boot/man/boot.ci.html'>boot.ci</a></span><span class='op'>(</span><span class='va'>tmpBootRes</span>,type <span class='op'>=</span> <span class='st'>"basic"</span><span class='op'>)</span><span class='op'>$</span><span class='va'>basic</span><span class='op'>[</span><span class='fl'>1</span>, <span class='fl'>4</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>]</span> <span class='op'>-&gt;</span> <span class='va'>tmpBootCIbasic</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/boot/man/boot.ci.html'>boot.ci</a></span><span class='op'>(</span><span class='va'>tmpBootRes</span>,type <span class='op'>=</span> <span class='st'>"bca"</span><span class='op'>)</span><span class='op'>$</span><span class='va'>bca</span><span class='op'>[</span><span class='fl'>1</span>, <span class='fl'>4</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>]</span> <span class='op'>-&gt;</span> <span class='va'>tmpBootCIbca</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>tmpBootCIPercentile</span>,</span>
<span>      <span class='va'>tmpBootCIbasic</span>,</span>
<span>      <span class='va'>tmpBootCInorm</span>,</span>
<span>      <span class='va'>tmpBootCIbca</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmp</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>tmp</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"LCL"</span>, <span class='st'>"UCL"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://tibble.tidyverse.org/reference/as_tibble.html'>as_tibble</a></span><span class='op'>(</span><span class='va'>tmp</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>tmp</span><span class='op'>)</span>,</span>
<span>         method <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_remove.html'>str_remove</a></span><span class='op'>(</span><span class='va'>method</span>, <span class='fu'><a href='https://stringr.tidyverse.org/reference/modifiers.html'>fixed</a></span><span class='op'>(</span><span class='st'>"tmpBootCI"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>         method <span class='op'>=</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/case.html'>str_to_sentence</a></span><span class='op'>(</span><span class='va'>method</span><span class='op'>)</span>,</span>
<span>         method <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>method</span> <span class='op'>==</span> <span class='st'>"Bca"</span>, <span class='st'>"bca"</span>, <span class='va'>method</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>method</span>, <span class='va'>LCL</span>, <span class='va'>UCL</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-30465212{}.cl-304178fa{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-304394d2{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-304394dc{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-3043a1f2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3043a1fc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3043a1fd{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3043a206{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3043a207{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3043a208{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-30465212'><thead><tr style="overflow-wrap:break-word;"><th class="cl-3043a1f2"><p class="cl-304394d2"><span class="cl-304178fa">method</span></p></th><th class="cl-3043a1fc"><p class="cl-304394dc"><span class="cl-304178fa">LCL</span></p></th><th class="cl-3043a1fc"><p class="cl-304394dc"><span class="cl-304178fa">UCL</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-3043a1fd"><p class="cl-304394d2"><span class="cl-304178fa">Percentile</span></p></td><td class="cl-3043a206"><p class="cl-304394dc"><span class="cl-304178fa">1.441</span></p></td><td class="cl-3043a206"><p class="cl-304394dc"><span class="cl-304178fa">1.945</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3043a1fd"><p class="cl-304394d2"><span class="cl-304178fa">Basic</span></p></td><td class="cl-3043a206"><p class="cl-304394dc"><span class="cl-304178fa">1.440</span></p></td><td class="cl-3043a206"><p class="cl-304394dc"><span class="cl-304178fa">1.943</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3043a1fd"><p class="cl-304394d2"><span class="cl-304178fa">Norm</span></p></td><td class="cl-3043a206"><p class="cl-304394dc"><span class="cl-304178fa">1.448</span></p></td><td class="cl-3043a206"><p class="cl-304394dc"><span class="cl-304178fa">1.946</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3043a207"><p class="cl-304394d2"><span class="cl-304178fa">bca</span></p></td><td class="cl-3043a208"><p class="cl-304394dc"><span class="cl-304178fa">1.478</span></p></td><td class="cl-3043a208"><p class="cl-304394dc"><span class="cl-304178fa">1.981</span></p></td></tr></tbody></table></div>
</div>
<p>It can be seen that the methods do give different confidence limits but that the confidence intervals are very similar. That brings us to one aspect of the next part of this document: using simulation to test the bootstrap CIs.</p>
<h1 id="back-to-the-simulation-testing-the-bootstrap-cis">Back to the simulation: testing the bootstrap CIs</h1>
<p>As noted above the features of a well behaved CI are proper coverage, i.e. the CI should include the population CSC 95% of the time (or whatever width was set for the CI) and it should also show no or minimal bias: where it doesn’t include the population CSC it should be too high about as often as it is too low.</p>
<h2 id="coverage">Coverage</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># load("tibBalancedN40to100")</span></span>
<span><span class='co'># load("tibBalancedN120to200")</span></span>
<span><span class='co'># load("tibBalancedN250to500")</span></span>
<span><span class='co'># bind_rows(tibBalancedN40to100,</span></span>
<span><span class='co'>#           tibBalancedN120to200,</span></span>
<span><span class='co'>#           tibBalancedN250to500) -&gt; tibBalancedAll</span></span>
<span><span class='co'># tibBalanced &lt;- tibBalancedN40to100</span></span>
<span><span class='co'># rm(tibBalancedN40to100)</span></span>
<span><span class='co'># # rm(tibBalancedN120to200)</span></span>
<span><span class='co'># # rm(tibBalancedN250to500)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/load.html'>load</a></span><span class='op'>(</span><span class='st'>"tibBalancedN40to200"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># getBootCICSC2 &lt;- function (nNHS, nHS, meanNHS, meanHS, sdNHS, sdHS,</span></span>
<span><span class='co'>#                            bootReps = 1000, conf = 0.95,</span></span>
<span><span class='co'>#                            useParallel = "multicore", nCPUs = 12) {</span></span>
<span><span class='co'>#   RNG &lt;- RNGkind()</span></span>
<span><span class='co'>#   seed &lt;- .Random.seed</span></span>
<span><span class='co'>#   trueCSC &lt;- (sdHS*meanNHS + sdNHS*meanHS) / (sdHS + sdNHS)</span></span>
<span><span class='co'>#   scoresNHS &lt;- rnorm(nNHS, mean = meanNHS, sd = sdNHS)</span></span>
<span><span class='co'>#   scoresHS &lt;- rnorm(nHS, mean = meanHS, sd = sdHS)</span></span>
<span><span class='co'>#   scores &lt;- c(scoresNHS, scoresHS)</span></span>
<span><span class='co'>#   groups &lt;- c(rep("NHS", nNHS), rep("HS", nHS))</span></span>
<span><span class='co'>#   tibble(scores = scores,</span></span>
<span><span class='co'>#          grp = groups) %&gt;%</span></span>
<span><span class='co'>#     mutate(grp = ordered(grp,</span></span>
<span><span class='co'>#                          levels = c("NHS", "HS"),</span></span>
<span><span class='co'>#                          labels = c("NHS", "HS")),</span></span>
<span><span class='co'>#            grpN = as.numeric(grp)) -&gt; tmpDat</span></span>
<span><span class='co'># </span></span>
<span><span class='co'>#   getCSClocal &lt;- function(tmpDat) {</span></span>
<span><span class='co'>#     tmpDat %&gt;%</span></span>
<span><span class='co'>#       dplyr::group_by(grp) %&gt;%</span></span>
<span><span class='co'>#       dplyr::summarise(n = n(),</span></span>
<span><span class='co'>#                        mean = mean(scores),</span></span>
<span><span class='co'>#                        sd = sd(scores)) -&gt; tibStats</span></span>
<span><span class='co'>#     tibStats %&gt;%</span></span>
<span><span class='co'>#       dplyr::summarise(denominator = sum(sd)) %&gt;%</span></span>
<span><span class='co'>#       dplyr::pull() -&gt; denominator</span></span>
<span><span class='co'># </span></span>
<span><span class='co'>#     tibStats$mean[2] * tibStats$sd[1] + tibStats$mean[1] * tibStats$sd[2] -&gt; numerator</span></span>
<span><span class='co'># </span></span>
<span><span class='co'>#     numerator/denominator</span></span>
<span><span class='co'>#   }</span></span>
<span><span class='co'># </span></span>
<span><span class='co'>#   getCSCforBoot &lt;- function(tmpDat, i) {</span></span>
<span><span class='co'>#     getCSClocal(tmpDat[i, ])</span></span>
<span><span class='co'>#   }</span></span>
<span><span class='co'># </span></span>
<span><span class='co'>#   tmpDat &lt;- as.data.frame(tmpDat)</span></span>
<span><span class='co'># </span></span>
<span><span class='co'>#   tmpBootRes &lt;- boot::boot(tmpDat,</span></span>
<span><span class='co'>#                            statistic = getCSCforBoot,</span></span>
<span><span class='co'>#                            stype = "i",</span></span>
<span><span class='co'>#                            strata = tmpDat[, 2],</span></span>
<span><span class='co'>#                            R = bootReps,</span></span>
<span><span class='co'>#                            parallel = useParallel,</span></span>
<span><span class='co'>#                            ncpus = nCPUs)</span></span>
<span><span class='co'>#   ### OK, now you've got the bootstrap replications</span></span>
<span><span class='co'>#   ### now extract CI by each bootstrap method inside tryCatch()</span></span>
<span><span class='co'># </span></span>
<span><span class='co'>#   ### first the percentile method</span></span>
<span><span class='co'>#   getPercCI &lt;- function(tmpBootRes, conf = conf){</span></span>
<span><span class='co'>#     tryCatch({</span></span>
<span><span class='co'>#         tmpCI &lt;- boot::boot.ci(tmpBootRes, type = 'perc', conf = conf)</span></span>
<span><span class='co'>#         return(list(percLCLCSC = tmpCI$percent[4],</span></span>
<span><span class='co'>#                     percUCLCSC = tmpCI$percent[5]))</span></span>
<span><span class='co'>#       },</span></span>
<span><span class='co'>#       error = function(tmp) {</span></span>
<span><span class='co'>#         tmp &lt;- NA</span></span>
<span><span class='co'>#         return(list(percLCLCSC = NA,</span></span>
<span><span class='co'>#                     percUCLCSC = NA))</span></span>
<span><span class='co'>#       }</span></span>
<span><span class='co'>#     )</span></span>
<span><span class='co'>#   }</span></span>
<span><span class='co'>#   percCI &lt;- unlist(getPercCI(tmpBootRes, conf = conf))</span></span>
<span><span class='co'>#   percLCLCSC &lt;- percCI[1]</span></span>
<span><span class='co'>#   percUCLCSC &lt;- percCI[2]</span></span>
<span><span class='co'># </span></span>
<span><span class='co'>#   ### now the basic method</span></span>
<span><span class='co'>#   getBasicCI &lt;- function(tmpBootRes, conf = conf){</span></span>
<span><span class='co'>#     tryCatch(</span></span>
<span><span class='co'>#       {tmpCI &lt;- boot::boot.ci(tmpBootRes, type = 'basic', conf = conf)</span></span>
<span><span class='co'>#       return(list(basicLCLCSC = tmpCI$basic[4],</span></span>
<span><span class='co'>#                   basicUCLCSC = tmpCI$basic[5]))},</span></span>
<span><span class='co'>#       error = function(tmp) {</span></span>
<span><span class='co'>#         tmp &lt;- NA</span></span>
<span><span class='co'>#         return(list(basicLCLCSC = NA,</span></span>
<span><span class='co'>#                     basicUCLCSC = NA))</span></span>
<span><span class='co'>#       }</span></span>
<span><span class='co'>#     )</span></span>
<span><span class='co'>#   }</span></span>
<span><span class='co'>#   basicCI &lt;- unlist(getBasicCI(tmpBootRes, conf = conf))</span></span>
<span><span class='co'>#   basicLCLCSC &lt;- basicCI[1]</span></span>
<span><span class='co'>#   basicUCLCSC &lt;- basicCI[2]</span></span>
<span><span class='co'># </span></span>
<span><span class='co'>#   ### now the bca method</span></span>
<span><span class='co'>#   getBcaCI &lt;- function(tmpBootRes, conf = conf){</span></span>
<span><span class='co'>#     tryCatch(</span></span>
<span><span class='co'>#       {tmpCI &lt;- boot::boot.ci(tmpBootRes, type = 'bca', conf = conf)</span></span>
<span><span class='co'>#       return(list(bcaLCLCSC = tmpCI$bca[4],</span></span>
<span><span class='co'>#                   bcaUCLCSC = tmpCI$bca[5]))},</span></span>
<span><span class='co'>#       error = function(tmp) {</span></span>
<span><span class='co'>#         tmp &lt;- NA</span></span>
<span><span class='co'>#         return(list(bcaLCLCSC = NA,</span></span>
<span><span class='co'>#                     bcaUCLCSC = NA))</span></span>
<span><span class='co'>#       }</span></span>
<span><span class='co'>#     )</span></span>
<span><span class='co'>#   }</span></span>
<span><span class='co'>#   bcaCI &lt;- unlist(getBcaCI(tmpBootRes, conf = conf))</span></span>
<span><span class='co'>#   bcaLCLCSC &lt;- bcaCI[1]</span></span>
<span><span class='co'>#   bcaUCLCSC &lt;- bcaCI[2]</span></span>
<span><span class='co'># </span></span>
<span><span class='co'>#   ### now the normal method</span></span>
<span><span class='co'>#   getNormCI &lt;- function(tmpBootRes, conf = conf){</span></span>
<span><span class='co'>#     tryCatch(</span></span>
<span><span class='co'>#       {tmpCI &lt;- boot::boot.ci(tmpBootRes, type = 'norm', conf = conf)</span></span>
<span><span class='co'>#         return(list(normLCLCSC = tmpCI$normal[2],</span></span>
<span><span class='co'>#                     normUCLCSC = tmpCI$normal[3]))},</span></span>
<span><span class='co'>#       error = function(tmp) {</span></span>
<span><span class='co'>#         tmp &lt;- NA</span></span>
<span><span class='co'>#         return(list(normLCLCSC = NA,</span></span>
<span><span class='co'>#                     normUCLCSC = NA))</span></span>
<span><span class='co'>#       }</span></span>
<span><span class='co'>#     )</span></span>
<span><span class='co'>#   }</span></span>
<span><span class='co'>#   normCI &lt;- unlist(getNormCI(tmpBootRes, conf = conf))</span></span>
<span><span class='co'>#   normLCLCSC &lt;- normCI[1]</span></span>
<span><span class='co'>#   normUCLCSC &lt;- normCI[2]</span></span>
<span><span class='co'># </span></span>
<span><span class='co'>#   t &lt;- tmpBootRes$t[, 1]</span></span>
<span><span class='co'>#   t &lt;- as.vector(t)</span></span>
<span><span class='co'>#   ### name it to make unnesting it later not scream out for names_sep!!!</span></span>
<span><span class='co'>#   names(t) &lt;- paste0("t", 1:length(t))</span></span>
<span><span class='co'># </span></span>
<span><span class='co'>#   retVal &lt;- list(</span></span>
<span><span class='co'>#     ### RNG parameters</span></span>
<span><span class='co'>#     RNG = RNG,</span></span>
<span><span class='co'>#     seed = seed,</span></span>
<span><span class='co'>#     ### simulation parameters (population values)</span></span>
<span><span class='co'>#     trueCSC = trueCSC,</span></span>
<span><span class='co'>#     ### setup</span></span>
<span><span class='co'>#     parallel = useParallel,</span></span>
<span><span class='co'>#     nCPUs = nCPUs,</span></span>
<span><span class='co'>#     ### CI extraction</span></span>
<span><span class='co'>#     bootReps = bootReps,</span></span>
<span><span class='co'>#     t0 = as.numeric(tmpBootRes$t0),</span></span>
<span><span class='co'>#     t = t,</span></span>
<span><span class='co'>#     ### CIs</span></span>
<span><span class='co'>#     percLCLCSC = percLCLCSC,</span></span>
<span><span class='co'>#     percUCLCSC = percUCLCSC,</span></span>
<span><span class='co'>#     basicLCLCSC = basicLCLCSC,</span></span>
<span><span class='co'>#     basicUCLCSC = basicUCLCSC,</span></span>
<span><span class='co'>#     bcaLCLCSC = bcaLCLCSC,</span></span>
<span><span class='co'>#     bcaUCLCSC = bcaUCLCSC,</span></span>
<span><span class='co'>#     normLCLCSC = normLCLCSC,</span></span>
<span><span class='co'>#     normUCLCSC = normUCLCSC)</span></span>
<span><span class='co'>#   ### return that</span></span>
<span><span class='co'>#   retVal</span></span>
<span><span class='co'># }</span></span>
<span><span class='co'># </span></span>
<span><span class='va'>nReps</span> <span class='op'>&lt;-</span> <span class='fl'>1000</span></span>
<span><span class='co'># set.seed(12345)</span></span>
<span><span class='co'># startTime &lt;- proc.time()</span></span>
<span><span class='co'># tibble(iterN = list(1:nReps),</span></span>
<span><span class='co'>#        nNHS = list(n &lt;- seq(40, 200, 20)),</span></span>
<span><span class='co'>#        meanNHS = 1,</span></span>
<span><span class='co'>#        meanHS = 2.6,</span></span>
<span><span class='co'>#        sdNHS = 1,</span></span>
<span><span class='co'>#        sdHS = 1) %&gt;%</span></span>
<span><span class='co'>#   unnest_longer(nNHS) %&gt;%</span></span>
<span><span class='co'>#   mutate(nHS = nNHS) %&gt;%</span></span>
<span><span class='co'>#   unnest_longer(iterN) %&gt;%</span></span>
<span><span class='co'>#   rowwise() %&gt;%</span></span>
<span><span class='co'>#   mutate(dateStamp = date(),</span></span>
<span><span class='co'>#          res = list(getBootCICSC2(nNHS = nNHS, nHS = nHS, meanNHS = meanNHS, meanHS = meanHS, sdNHS = sdNHS, sdHS = sdHS,</span></span>
<span><span class='co'>#                                   bootReps = 1000, conf = 0.95,</span></span>
<span><span class='co'>#                                   useParallel = "multicore", nCPUs = 10))) %&gt;%</span></span>
<span><span class='co'>#   unnest_wider(res) -&gt; tibBalancedN40to200</span></span>
<span><span class='co'># endTime &lt;- proc.time()</span></span>
<span><span class='co'># timeTakenBalancedN40to200 &lt;- endTime - startTime</span></span>
<span><span class='co'># save(tibBalancedN40to200, file = "tibBalancedN40to200")</span></span>
<span></span>
<span><span class='va'>tibBalancedN40to200</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>nNHS</span> <span class='op'>==</span> <span class='fl'>40</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibBalanced</span></span>
<span></span>
<span><span class='va'>tibBalanced</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>nNHS</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/distinct.html'>distinct</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>valNNHS</span></span>
<span></span>
<span><span class='va'>tibBalanced</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>meanNHS</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/distinct.html'>distinct</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>valMeanNHS</span></span>
<span></span>
<span><span class='va'>tibBalanced</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>meanHS</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/distinct.html'>distinct</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>valMeanHS</span></span>
<span></span>
<span><span class='va'>tibBalanced</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>trueCSC</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/distinct.html'>distinct</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>valTrueCSC</span></span></code></pre>
</div>
</details>
</div>
<p>How do we assess coverage? In the simulation above I created
1000 simulation samples each of size
40 sampling from a population NHS mean of
1
and HS mean
2.6. Those means, with the SDs which were set to 1.0 mean that we know the population CSC is
1.8 so the coverage for each CI method is what percentage of the
1000 simulations contained that population value.</p>
<p>To visualise this, this plot shows the first ten percentile bootstrap estimated 95% CIs.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibBalanced</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>percInclTrue <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>percLCLCSC</span> <span class='op'>&lt;</span> <span class='va'>trueCSC</span> <span class='op'>&amp;</span> <span class='va'>percUCLCSC</span> <span class='op'>&gt;</span> <span class='va'>trueCSC</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>         percCIhigh <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>percLCLCSC</span> <span class='op'>&gt;</span> <span class='va'>trueCSC</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>         percCIlow <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>percUCLCSC</span> <span class='op'>&lt;</span> <span class='va'>trueCSC</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>         percCentre <span class='op'>=</span> <span class='op'>(</span><span class='va'>percLCLCSC</span> <span class='op'>+</span> <span class='va'>percUCLCSC</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>         percWidth <span class='op'>=</span> <span class='va'>percUCLCSC</span> <span class='op'>-</span> <span class='va'>percLCLCSC</span>,</span>
<span>         basicInclTrue <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>basicLCLCSC</span> <span class='op'>&lt;</span> <span class='va'>trueCSC</span> <span class='op'>&amp;</span> <span class='va'>basicUCLCSC</span> <span class='op'>&gt;</span> <span class='va'>trueCSC</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>         basicCIhigh <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>basicLCLCSC</span> <span class='op'>&gt;</span> <span class='va'>trueCSC</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>         basicCIlow <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>basicUCLCSC</span> <span class='op'>&lt;</span> <span class='va'>trueCSC</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>         basicCentre <span class='op'>=</span> <span class='op'>(</span><span class='va'>basicLCLCSC</span> <span class='op'>+</span> <span class='va'>basicUCLCSC</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>         basicWidth <span class='op'>=</span> <span class='va'>basicUCLCSC</span> <span class='op'>-</span> <span class='va'>basicLCLCSC</span>,</span>
<span>         bcaInclTrue <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>bcaLCLCSC</span> <span class='op'>&lt;</span> <span class='va'>trueCSC</span> <span class='op'>&amp;</span> <span class='va'>bcaUCLCSC</span> <span class='op'>&gt;</span> <span class='va'>trueCSC</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>         bcaCIhigh <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>bcaLCLCSC</span> <span class='op'>&gt;</span> <span class='va'>trueCSC</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>         bcaCIlow <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>bcaUCLCSC</span> <span class='op'>&lt;</span> <span class='va'>trueCSC</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>         bcaCentre <span class='op'>=</span> <span class='op'>(</span><span class='va'>bcaLCLCSC</span> <span class='op'>+</span> <span class='va'>bcaUCLCSC</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>         bcaWidth <span class='op'>=</span> <span class='va'>bcaUCLCSC</span> <span class='op'>-</span> <span class='va'>bcaLCLCSC</span>,</span>
<span>         normInclTrue <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>normLCLCSC</span> <span class='op'>&lt;</span> <span class='va'>trueCSC</span> <span class='op'>&amp;</span> <span class='va'>normUCLCSC</span> <span class='op'>&gt;</span> <span class='va'>trueCSC</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>         normCIhigh <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>normLCLCSC</span> <span class='op'>&gt;</span> <span class='va'>trueCSC</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>         normCIlow <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>normUCLCSC</span> <span class='op'>&lt;</span> <span class='va'>trueCSC</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>         normCentre <span class='op'>=</span> <span class='op'>(</span><span class='va'>normLCLCSC</span> <span class='op'>+</span> <span class='va'>normUCLCSC</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>         normWidth <span class='op'>=</span> <span class='va'>normUCLCSC</span> <span class='op'>-</span> <span class='va'>normLCLCSC</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibBalanced2</span></span>
<span></span>
<span><span class='va'>tibBalanced2</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>iterN</span>, <span class='va'>t0</span>, <span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>ends_with</a></span><span class='op'>(</span><span class='st'>"LCLCSC"</span><span class='op'>)</span>, <span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>ends_with</a></span><span class='op'>(</span><span class='st'>"UCLCSC"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span>cols <span class='op'>=</span> <span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>ends_with</a></span><span class='op'>(</span><span class='st'>"CSC"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>limit <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>name</span>, <span class='fu'><a href='https://stringr.tidyverse.org/reference/modifiers.html'>fixed</a></span><span class='op'>(</span><span class='st'>"LCL"</span><span class='op'>)</span><span class='op'>)</span>, <span class='st'>"LCL"</span>, <span class='st'>"UCL"</span><span class='op'>)</span>,</span>
<span>         method <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>name</span>, <span class='fu'><a href='https://stringr.tidyverse.org/reference/modifiers.html'>fixed</a></span><span class='op'>(</span><span class='st'>"perc"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"Percentile"</span>,</span>
<span>                            <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>name</span>, <span class='fu'><a href='https://stringr.tidyverse.org/reference/modifiers.html'>fixed</a></span><span class='op'>(</span><span class='st'>"basic"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"Basic"</span>,</span>
<span>                            <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>name</span>, <span class='fu'><a href='https://stringr.tidyverse.org/reference/modifiers.html'>fixed</a></span><span class='op'>(</span><span class='st'>"norm"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"Normal"</span>,</span>
<span>                            <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>name</span>, <span class='fu'><a href='https://stringr.tidyverse.org/reference/modifiers.html'>fixed</a></span><span class='op'>(</span><span class='st'>"bca"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"bca"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>name</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_wider.html'>pivot_wider</a></span><span class='op'>(</span>names_from <span class='op'>=</span> <span class='va'>limit</span>, values_from <span class='op'>=</span> <span class='va'>value</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibBalancedLong</span></span>
<span></span>
<span><span class='va'>tibBalancedLong</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>CIinclTrueCSC <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>    <span class='op'>(</span><span class='va'>LCL</span> <span class='op'>&lt;</span> <span class='va'>valTrueCSC</span> <span class='op'>&amp;</span> <span class='va'>UCL</span> <span class='op'>&gt;</span> <span class='va'>valTrueCSC</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"CI includes population CSC"</span>,</span>
<span>    <span class='va'>LCL</span> <span class='op'>&gt;</span> <span class='va'>valTrueCSC</span> <span class='op'>~</span> <span class='st'>"CI high (LCL &gt; population CSC)"</span>,</span>
<span>    <span class='va'>UCL</span> <span class='op'>&lt;</span> <span class='va'>valTrueCSC</span> <span class='op'>~</span> <span class='st'>"CI low (UCL &lt; population CSC)"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>obsCSC <span class='op'>=</span> <span class='va'>t0</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibBalancedLong2</span></span>
<span></span>
<span><span class='va'>tibBalancedLong2</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>method</span> <span class='op'>==</span> <span class='st'>"Percentile"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>iterN</span> <span class='op'>&lt;</span> <span class='fl'>11</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span></span>
<span><span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/autofit.html'>autofit</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-31a81f78{}.cl-31a331fc{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-31a5541e{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-31a55428{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-31a562d8{width:0.659in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31a562e2{width:0.866in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31a562e3{width:1.048in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31a562ec{width:0.723in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31a562ed{width:2.66in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31a562f6{width:0.659in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31a562f7{width:0.866in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31a562f8{width:1.048in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31a56300{width:0.723in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31a56301{width:2.66in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31a56302{width:0.659in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31a5630a{width:0.866in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31a5630b{width:1.048in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31a5630c{width:0.723in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31a5630d{width:2.66in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-31a81f78'><thead><tr style="overflow-wrap:break-word;"><th class="cl-31a562d8"><p class="cl-31a5541e"><span class="cl-31a331fc">iterN</span></p></th><th class="cl-31a562e2"><p class="cl-31a5541e"><span class="cl-31a331fc">obsCSC</span></p></th><th class="cl-31a562e3"><p class="cl-31a55428"><span class="cl-31a331fc">method</span></p></th><th class="cl-31a562ec"><p class="cl-31a5541e"><span class="cl-31a331fc">LCL</span></p></th><th class="cl-31a562ec"><p class="cl-31a5541e"><span class="cl-31a331fc">UCL</span></p></th><th class="cl-31a562ed"><p class="cl-31a55428"><span class="cl-31a331fc">CIinclTrueCSC</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-31a562f6"><p class="cl-31a5541e"><span class="cl-31a331fc">1</span></p></td><td class="cl-31a562f7"><p class="cl-31a5541e"><span class="cl-31a331fc">1.945</span></p></td><td class="cl-31a562f8"><p class="cl-31a55428"><span class="cl-31a331fc">Percentile</span></p></td><td class="cl-31a56300"><p class="cl-31a5541e"><span class="cl-31a331fc">1.692</span></p></td><td class="cl-31a56300"><p class="cl-31a5541e"><span class="cl-31a331fc">2.255</span></p></td><td class="cl-31a56301"><p class="cl-31a55428"><span class="cl-31a331fc">CI includes population CSC</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-31a562f6"><p class="cl-31a5541e"><span class="cl-31a331fc">2</span></p></td><td class="cl-31a562f7"><p class="cl-31a5541e"><span class="cl-31a331fc">1.981</span></p></td><td class="cl-31a562f8"><p class="cl-31a55428"><span class="cl-31a331fc">Percentile</span></p></td><td class="cl-31a56300"><p class="cl-31a5541e"><span class="cl-31a331fc">1.735</span></p></td><td class="cl-31a56300"><p class="cl-31a5541e"><span class="cl-31a331fc">2.204</span></p></td><td class="cl-31a56301"><p class="cl-31a55428"><span class="cl-31a331fc">CI includes population CSC</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-31a562f6"><p class="cl-31a5541e"><span class="cl-31a331fc">3</span></p></td><td class="cl-31a562f7"><p class="cl-31a5541e"><span class="cl-31a331fc">1.894</span></p></td><td class="cl-31a562f8"><p class="cl-31a55428"><span class="cl-31a331fc">Percentile</span></p></td><td class="cl-31a56300"><p class="cl-31a5541e"><span class="cl-31a331fc">1.608</span></p></td><td class="cl-31a56300"><p class="cl-31a5541e"><span class="cl-31a331fc">2.162</span></p></td><td class="cl-31a56301"><p class="cl-31a55428"><span class="cl-31a331fc">CI includes population CSC</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-31a562f6"><p class="cl-31a5541e"><span class="cl-31a331fc">4</span></p></td><td class="cl-31a562f7"><p class="cl-31a5541e"><span class="cl-31a331fc">1.922</span></p></td><td class="cl-31a562f8"><p class="cl-31a55428"><span class="cl-31a331fc">Percentile</span></p></td><td class="cl-31a56300"><p class="cl-31a5541e"><span class="cl-31a331fc">1.667</span></p></td><td class="cl-31a56300"><p class="cl-31a5541e"><span class="cl-31a331fc">2.188</span></p></td><td class="cl-31a56301"><p class="cl-31a55428"><span class="cl-31a331fc">CI includes population CSC</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-31a562f6"><p class="cl-31a5541e"><span class="cl-31a331fc">5</span></p></td><td class="cl-31a562f7"><p class="cl-31a5541e"><span class="cl-31a331fc">1.686</span></p></td><td class="cl-31a562f8"><p class="cl-31a55428"><span class="cl-31a331fc">Percentile</span></p></td><td class="cl-31a56300"><p class="cl-31a5541e"><span class="cl-31a331fc">1.463</span></p></td><td class="cl-31a56300"><p class="cl-31a5541e"><span class="cl-31a331fc">1.902</span></p></td><td class="cl-31a56301"><p class="cl-31a55428"><span class="cl-31a331fc">CI includes population CSC</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-31a562f6"><p class="cl-31a5541e"><span class="cl-31a331fc">6</span></p></td><td class="cl-31a562f7"><p class="cl-31a5541e"><span class="cl-31a331fc">1.857</span></p></td><td class="cl-31a562f8"><p class="cl-31a55428"><span class="cl-31a331fc">Percentile</span></p></td><td class="cl-31a56300"><p class="cl-31a5541e"><span class="cl-31a331fc">1.613</span></p></td><td class="cl-31a56300"><p class="cl-31a5541e"><span class="cl-31a331fc">2.100</span></p></td><td class="cl-31a56301"><p class="cl-31a55428"><span class="cl-31a331fc">CI includes population CSC</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-31a562f6"><p class="cl-31a5541e"><span class="cl-31a331fc">7</span></p></td><td class="cl-31a562f7"><p class="cl-31a5541e"><span class="cl-31a331fc">2.002</span></p></td><td class="cl-31a562f8"><p class="cl-31a55428"><span class="cl-31a331fc">Percentile</span></p></td><td class="cl-31a56300"><p class="cl-31a5541e"><span class="cl-31a331fc">1.710</span></p></td><td class="cl-31a56300"><p class="cl-31a5541e"><span class="cl-31a331fc">2.279</span></p></td><td class="cl-31a56301"><p class="cl-31a55428"><span class="cl-31a331fc">CI includes population CSC</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-31a562f6"><p class="cl-31a5541e"><span class="cl-31a331fc">8</span></p></td><td class="cl-31a562f7"><p class="cl-31a5541e"><span class="cl-31a331fc">1.995</span></p></td><td class="cl-31a562f8"><p class="cl-31a55428"><span class="cl-31a331fc">Percentile</span></p></td><td class="cl-31a56300"><p class="cl-31a5541e"><span class="cl-31a331fc">1.754</span></p></td><td class="cl-31a56300"><p class="cl-31a5541e"><span class="cl-31a331fc">2.257</span></p></td><td class="cl-31a56301"><p class="cl-31a55428"><span class="cl-31a331fc">CI includes population CSC</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-31a562f6"><p class="cl-31a5541e"><span class="cl-31a331fc">9</span></p></td><td class="cl-31a562f7"><p class="cl-31a5541e"><span class="cl-31a331fc">2.097</span></p></td><td class="cl-31a562f8"><p class="cl-31a55428"><span class="cl-31a331fc">Percentile</span></p></td><td class="cl-31a56300"><p class="cl-31a5541e"><span class="cl-31a331fc">1.831</span></p></td><td class="cl-31a56300"><p class="cl-31a5541e"><span class="cl-31a331fc">2.398</span></p></td><td class="cl-31a56301"><p class="cl-31a55428"><span class="cl-31a331fc">CI high (LCL &gt; population CSC)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-31a56302"><p class="cl-31a5541e"><span class="cl-31a331fc">10</span></p></td><td class="cl-31a5630a"><p class="cl-31a5541e"><span class="cl-31a331fc">1.812</span></p></td><td class="cl-31a5630b"><p class="cl-31a55428"><span class="cl-31a331fc">Percentile</span></p></td><td class="cl-31a5630c"><p class="cl-31a5541e"><span class="cl-31a331fc">1.568</span></p></td><td class="cl-31a5630c"><p class="cl-31a5541e"><span class="cl-31a331fc">2.054</span></p></td><td class="cl-31a5630d"><p class="cl-31a55428"><span class="cl-31a331fc">CI includes population CSC</span></p></td></tr></tbody></table></div>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>LCL</span> <span class='op'>&gt;</span> <span class='va'>valTrueCSC</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib2</span></span>
<span></span>
<span><span class='va'>tmpTib2</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpNhigh</span></span></code></pre>
</div>
</details>
</div>
<p>So
one of the ten had correct coverage, i.e. the CI included the population CSC but one CI was high with its lower confidence limit (LCL)
1.831: clearly above the population value of
1.8.</p>
<p>I actually created
1000 samples and we have three possible coverage results per sample: CI includes population CSC, CI high (LCL &gt; population CSC) and CI low (UCL &lt; population CSC). Here I have shown the first two simulations for each of the possible coverages.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibBalancedLong2</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>method</span> <span class='op'>==</span> <span class='st'>"Percentile"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>CIinclTrueCSC</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>indInGrp <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/row_number.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>indInGrp</span> <span class='op'>&lt;</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>indInGrp</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span></span>
<span><span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/autofit.html'>autofit</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-31eebb22{}.cl-31ea2396{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-31ec1d90{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-31ec1d91{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-31ec2ad8{width:0.659in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31ec2ae2{width:0.866in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31ec2ae3{width:1.048in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31ec2ae4{width:0.723in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31ec2aec{width:2.66in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31ec2aed{width:0.659in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31ec2aee{width:0.866in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31ec2af6{width:1.048in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31ec2af7{width:0.723in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31ec2af8{width:2.66in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31ec2b00{width:0.659in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31ec2b01{width:0.866in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31ec2b0a{width:1.048in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31ec2b0b{width:0.723in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-31ec2b0c{width:2.66in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-31eebb22'><thead><tr style="overflow-wrap:break-word;"><th class="cl-31ec2ad8"><p class="cl-31ec1d90"><span class="cl-31ea2396">iterN</span></p></th><th class="cl-31ec2ae2"><p class="cl-31ec1d90"><span class="cl-31ea2396">obsCSC</span></p></th><th class="cl-31ec2ae3"><p class="cl-31ec1d91"><span class="cl-31ea2396">method</span></p></th><th class="cl-31ec2ae4"><p class="cl-31ec1d90"><span class="cl-31ea2396">LCL</span></p></th><th class="cl-31ec2ae4"><p class="cl-31ec1d90"><span class="cl-31ea2396">UCL</span></p></th><th class="cl-31ec2aec"><p class="cl-31ec1d91"><span class="cl-31ea2396">CIinclTrueCSC</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-31ec2aed"><p class="cl-31ec1d90"><span class="cl-31ea2396">1</span></p></td><td class="cl-31ec2aee"><p class="cl-31ec1d90"><span class="cl-31ea2396">1.945</span></p></td><td class="cl-31ec2af6"><p class="cl-31ec1d91"><span class="cl-31ea2396">Percentile</span></p></td><td class="cl-31ec2af7"><p class="cl-31ec1d90"><span class="cl-31ea2396">1.692</span></p></td><td class="cl-31ec2af7"><p class="cl-31ec1d90"><span class="cl-31ea2396">2.255</span></p></td><td class="cl-31ec2af8"><p class="cl-31ec1d91"><span class="cl-31ea2396">CI includes population CSC</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-31ec2aed"><p class="cl-31ec1d90"><span class="cl-31ea2396">2</span></p></td><td class="cl-31ec2aee"><p class="cl-31ec1d90"><span class="cl-31ea2396">1.981</span></p></td><td class="cl-31ec2af6"><p class="cl-31ec1d91"><span class="cl-31ea2396">Percentile</span></p></td><td class="cl-31ec2af7"><p class="cl-31ec1d90"><span class="cl-31ea2396">1.735</span></p></td><td class="cl-31ec2af7"><p class="cl-31ec1d90"><span class="cl-31ea2396">2.204</span></p></td><td class="cl-31ec2af8"><p class="cl-31ec1d91"><span class="cl-31ea2396">CI includes population CSC</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-31ec2aed"><p class="cl-31ec1d90"><span class="cl-31ea2396">9</span></p></td><td class="cl-31ec2aee"><p class="cl-31ec1d90"><span class="cl-31ea2396">2.097</span></p></td><td class="cl-31ec2af6"><p class="cl-31ec1d91"><span class="cl-31ea2396">Percentile</span></p></td><td class="cl-31ec2af7"><p class="cl-31ec1d90"><span class="cl-31ea2396">1.831</span></p></td><td class="cl-31ec2af7"><p class="cl-31ec1d90"><span class="cl-31ea2396">2.398</span></p></td><td class="cl-31ec2af8"><p class="cl-31ec1d91"><span class="cl-31ea2396">CI high (LCL &gt; population CSC)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-31ec2aed"><p class="cl-31ec1d90"><span class="cl-31ea2396">18</span></p></td><td class="cl-31ec2aee"><p class="cl-31ec1d90"><span class="cl-31ea2396">1.554</span></p></td><td class="cl-31ec2af6"><p class="cl-31ec1d91"><span class="cl-31ea2396">Percentile</span></p></td><td class="cl-31ec2af7"><p class="cl-31ec1d90"><span class="cl-31ea2396">1.327</span></p></td><td class="cl-31ec2af7"><p class="cl-31ec1d90"><span class="cl-31ea2396">1.785</span></p></td><td class="cl-31ec2af8"><p class="cl-31ec1d91"><span class="cl-31ea2396">CI low (UCL &lt; population CSC)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-31ec2aed"><p class="cl-31ec1d90"><span class="cl-31ea2396">45</span></p></td><td class="cl-31ec2aee"><p class="cl-31ec1d90"><span class="cl-31ea2396">1.491</span></p></td><td class="cl-31ec2af6"><p class="cl-31ec1d91"><span class="cl-31ea2396">Percentile</span></p></td><td class="cl-31ec2af7"><p class="cl-31ec1d90"><span class="cl-31ea2396">1.257</span></p></td><td class="cl-31ec2af7"><p class="cl-31ec1d90"><span class="cl-31ea2396">1.720</span></p></td><td class="cl-31ec2af8"><p class="cl-31ec1d91"><span class="cl-31ea2396">CI low (UCL &lt; population CSC)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-31ec2b00"><p class="cl-31ec1d90"><span class="cl-31ea2396">82</span></p></td><td class="cl-31ec2b01"><p class="cl-31ec1d90"><span class="cl-31ea2396">2.098</span></p></td><td class="cl-31ec2b0a"><p class="cl-31ec1d91"><span class="cl-31ea2396">Percentile</span></p></td><td class="cl-31ec2b0b"><p class="cl-31ec1d90"><span class="cl-31ea2396">1.864</span></p></td><td class="cl-31ec2b0b"><p class="cl-31ec1d90"><span class="cl-31ea2396">2.350</span></p></td><td class="cl-31ec2b0c"><p class="cl-31ec1d91"><span class="cl-31ea2396">CI high (LCL &gt; population CSC)</span></p></td></tr></tbody></table></div>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>LCL</span> <span class='op'>&gt;</span> <span class='va'>valTrueCSC</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>iterN</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>iterN <span class='op'>=</span> <span class='fu'>nombre</span><span class='fu'>::</span><span class='fu'><a href='https://nombre.rossellhayes.com/reference/ordinal.html'>ordinal</a></span><span class='op'>(</span><span class='va'>iterN</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpVecIterNHigh</span></span>
<span></span>
<span><span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>UCL</span> <span class='op'>&lt;</span> <span class='va'>valTrueCSC</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>iterN</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>iterN <span class='op'>=</span> <span class='fu'>nombre</span><span class='fu'>::</span><span class='fu'><a href='https://nombre.rossellhayes.com/reference/ordinal.html'>ordinal</a></span><span class='op'>(</span><span class='va'>iterN</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpVecIterNLow</span></span></code></pre>
</div>
</details>
</div>
<p>It can be seen that the high CIs don’t occur until the
ninth and eighty-second samples and the low CIs by the
eighteenth and forty-fifth.</p>
<p>A better sense of this is probably given by plotting a forest plot of the first 100 CIs (of the total of
1000).</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibBalancedLong2</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>method</span> <span class='op'>==</span> <span class='st'>"Percentile"</span> <span class='op'>&amp;</span> <span class='va'>iterN</span> <span class='op'>&lt;=</span> <span class='fl'>100</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>linewidth <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>CIinclTrueCSC</span> <span class='op'>==</span> <span class='st'>"CI includes population CSC"</span>, <span class='st'>"1"</span>, <span class='st'>"2"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span></span>
<span><span class='va'>vecLineWidths</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"1"</span> <span class='op'>=</span> <span class='fl'>.8</span>, <span class='st'>"2"</span> <span class='op'>=</span> <span class='fl'>1.5</span><span class='op'>)</span></span>
<span><span class='va'>vecCover</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"CI high (LCL &gt; population CSC)"</span> <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>              <span class='st'>"CI includes population CSC"</span> <span class='op'>=</span> <span class='st'>"green"</span>,</span>
<span>              <span class='st'>"CI low (UCL &lt; population CSC)"</span> <span class='op'>=</span> <span class='st'>"blue"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTib</span>,</span>
<span>       <span class='co'># aes(x = reorder(iterN, obsCSC), y = obsCSC)) +</span></span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>iterN</span>, y <span class='op'>=</span> <span class='va'>obsCSC</span>, colour <span class='op'>=</span> <span class='va'>CIinclTrueCSC</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>shape <span class='op'>=</span> <span class='fl'>18</span>,</span>
<span>             size <span class='op'>=</span> <span class='fl'>2.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_linerange.html'>geom_linerange</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>ymin <span class='op'>=</span> <span class='va'>LCL</span>, ymax <span class='op'>=</span> <span class='va'>UCL</span>, linewidth <span class='op'>=</span> <span class='va'>linewidth</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='va'>valTrueCSC</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span><span class='st'>"Simulation index number"</span>,</span>
<span>                     breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>100</span>, <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span><span class='st'>"CSC"</span>,</span>
<span>                     breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>.8</span>, <span class='fl'>1.8</span>, <span class='fl'>.2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span><span class='st'>"CI coverage"</span>,</span>
<span>                      values <span class='op'>=</span> <span class='va'>vecCover</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_linewidth_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>vecLineWidths</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>linewidth <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Coverage of first 100 simulations, percentile CI(CSC)"</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<img src="explaining-the-bootstrap-cicsc-simulation_files/figure-html5/coverage3-1.png" width="1536" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>LCL</span> <span class='op'>&gt;</span> <span class='va'>valTrueCSC</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpNHigh</span></span>
<span></span>
<span><span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>UCL</span> <span class='op'>&lt;</span> <span class='va'>valTrueCSC</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpNLow</span></span></code></pre>
</div>
</details>
</div>
<p>Two of the simulations resulted in high CIs and
two resulted in low CIs. Across the full
1000 simulations the breakdown is as follows.</p>
<p>Here the coverage is a little under the target value of 95% but sufficiently close that the bootstrap CI is clearly acceptable (at least for this particular simulation of balanced samples of <em>n</em> = 40, equal population SDs of 1.0, population NHS mean 1.0 and HS population mean 1.6.) We can compare coverage across the four methods.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibBalancedLong2</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>method</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>totN <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>method</span>, <span class='va'>CIinclTrueCSC</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>            totN <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/nth.html'>first</a></span><span class='op'>(</span><span class='va'>totN</span><span class='op'>)</span>, </span>
<span>            perc <span class='op'>=</span> <span class='fl'>100</span> <span class='op'>*</span> <span class='va'>n</span> <span class='op'>/</span> <span class='va'>totN</span>,</span>
<span>            perc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span><span class='op'>(</span><span class='st'>"%4.1f"</span>, <span class='va'>perc</span><span class='op'>)</span>, <span class='st'>"%"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/as_grouped_data.html'>as_grouped_data</a></span><span class='op'>(</span>groups <span class='op'>=</span> <span class='st'>"method"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/autofit.html'>autofit</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-3284fab0{}.cl-32800910{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-32821aac{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-32821ab6{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-3282286c{width:1.048in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3282286d{width:2.66in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3282286e{width:0.577in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-32822876{width:0.723in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-32822877{width:0.771in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-32822880{width:1.048in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-32822881{width:2.66in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-32822882{width:0.577in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3282288a{width:0.723in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3282288b{width:0.771in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3282288c{width:1.048in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-32822894{width:2.66in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-32822895{width:0.577in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3282289e{width:0.723in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3282289f{width:0.771in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-328228a0{width:1.048in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-328228a8{width:2.66in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-328228a9{width:0.577in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-328228aa{width:0.723in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-328228ab{width:0.771in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-3284fab0'><thead><tr style="overflow-wrap:break-word;"><th class="cl-3282286c"><p class="cl-32821aac"><span class="cl-32800910">method</span></p></th><th class="cl-3282286d"><p class="cl-32821aac"><span class="cl-32800910">CIinclTrueCSC</span></p></th><th class="cl-3282286e"><p class="cl-32821ab6"><span class="cl-32800910">n</span></p></th><th class="cl-32822876"><p class="cl-32821ab6"><span class="cl-32800910">totN</span></p></th><th class="cl-32822877"><p class="cl-32821aac"><span class="cl-32800910">perc</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-32822880"><p class="cl-32821aac"><span class="cl-32800910">Basic</span></p></td><td class="cl-32822881"><p class="cl-32821aac"><span class="cl-32800910"></span></p></td><td class="cl-32822882"><p class="cl-32821ab6"><span class="cl-32800910"></span></p></td><td class="cl-3282288a"><p class="cl-32821ab6"><span class="cl-32800910"></span></p></td><td class="cl-3282288b"><p class="cl-32821aac"><span class="cl-32800910"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3282288c"><p class="cl-32821aac"><span class="cl-32800910"></span></p></td><td class="cl-32822894"><p class="cl-32821aac"><span class="cl-32800910">CI high (LCL &gt; population CSC)</span></p></td><td class="cl-32822895"><p class="cl-32821ab6"><span class="cl-32800910">35</span></p></td><td class="cl-3282289e"><p class="cl-32821ab6"><span class="cl-32800910">1,000</span></p></td><td class="cl-3282289f"><p class="cl-32821aac"><span class="cl-32800910"> 3.5%</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3282288c"><p class="cl-32821aac"><span class="cl-32800910"></span></p></td><td class="cl-32822894"><p class="cl-32821aac"><span class="cl-32800910">CI includes population CSC</span></p></td><td class="cl-32822895"><p class="cl-32821ab6"><span class="cl-32800910">927</span></p></td><td class="cl-3282289e"><p class="cl-32821ab6"><span class="cl-32800910">1,000</span></p></td><td class="cl-3282289f"><p class="cl-32821aac"><span class="cl-32800910">92.7%</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3282288c"><p class="cl-32821aac"><span class="cl-32800910"></span></p></td><td class="cl-32822894"><p class="cl-32821aac"><span class="cl-32800910">CI low (UCL &lt; population CSC)</span></p></td><td class="cl-32822895"><p class="cl-32821ab6"><span class="cl-32800910">38</span></p></td><td class="cl-3282289e"><p class="cl-32821ab6"><span class="cl-32800910">1,000</span></p></td><td class="cl-3282289f"><p class="cl-32821aac"><span class="cl-32800910"> 3.8%</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-32822880"><p class="cl-32821aac"><span class="cl-32800910">Normal</span></p></td><td class="cl-32822881"><p class="cl-32821aac"><span class="cl-32800910"></span></p></td><td class="cl-32822882"><p class="cl-32821ab6"><span class="cl-32800910"></span></p></td><td class="cl-3282288a"><p class="cl-32821ab6"><span class="cl-32800910"></span></p></td><td class="cl-3282288b"><p class="cl-32821aac"><span class="cl-32800910"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3282288c"><p class="cl-32821aac"><span class="cl-32800910"></span></p></td><td class="cl-32822894"><p class="cl-32821aac"><span class="cl-32800910">CI high (LCL &gt; population CSC)</span></p></td><td class="cl-32822895"><p class="cl-32821ab6"><span class="cl-32800910">36</span></p></td><td class="cl-3282289e"><p class="cl-32821ab6"><span class="cl-32800910">1,000</span></p></td><td class="cl-3282289f"><p class="cl-32821aac"><span class="cl-32800910"> 3.6%</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3282288c"><p class="cl-32821aac"><span class="cl-32800910"></span></p></td><td class="cl-32822894"><p class="cl-32821aac"><span class="cl-32800910">CI includes population CSC</span></p></td><td class="cl-32822895"><p class="cl-32821ab6"><span class="cl-32800910">924</span></p></td><td class="cl-3282289e"><p class="cl-32821ab6"><span class="cl-32800910">1,000</span></p></td><td class="cl-3282289f"><p class="cl-32821aac"><span class="cl-32800910">92.4%</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3282288c"><p class="cl-32821aac"><span class="cl-32800910"></span></p></td><td class="cl-32822894"><p class="cl-32821aac"><span class="cl-32800910">CI low (UCL &lt; population CSC)</span></p></td><td class="cl-32822895"><p class="cl-32821ab6"><span class="cl-32800910">40</span></p></td><td class="cl-3282289e"><p class="cl-32821ab6"><span class="cl-32800910">1,000</span></p></td><td class="cl-3282289f"><p class="cl-32821aac"><span class="cl-32800910"> 4.0%</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-32822880"><p class="cl-32821aac"><span class="cl-32800910">Percentile</span></p></td><td class="cl-32822881"><p class="cl-32821aac"><span class="cl-32800910"></span></p></td><td class="cl-32822882"><p class="cl-32821ab6"><span class="cl-32800910"></span></p></td><td class="cl-3282288a"><p class="cl-32821ab6"><span class="cl-32800910"></span></p></td><td class="cl-3282288b"><p class="cl-32821aac"><span class="cl-32800910"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3282288c"><p class="cl-32821aac"><span class="cl-32800910"></span></p></td><td class="cl-32822894"><p class="cl-32821aac"><span class="cl-32800910">CI high (LCL &gt; population CSC)</span></p></td><td class="cl-32822895"><p class="cl-32821ab6"><span class="cl-32800910">32</span></p></td><td class="cl-3282289e"><p class="cl-32821ab6"><span class="cl-32800910">1,000</span></p></td><td class="cl-3282289f"><p class="cl-32821aac"><span class="cl-32800910"> 3.2%</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3282288c"><p class="cl-32821aac"><span class="cl-32800910"></span></p></td><td class="cl-32822894"><p class="cl-32821aac"><span class="cl-32800910">CI includes population CSC</span></p></td><td class="cl-32822895"><p class="cl-32821ab6"><span class="cl-32800910">929</span></p></td><td class="cl-3282289e"><p class="cl-32821ab6"><span class="cl-32800910">1,000</span></p></td><td class="cl-3282289f"><p class="cl-32821aac"><span class="cl-32800910">92.9%</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3282288c"><p class="cl-32821aac"><span class="cl-32800910"></span></p></td><td class="cl-32822894"><p class="cl-32821aac"><span class="cl-32800910">CI low (UCL &lt; population CSC)</span></p></td><td class="cl-32822895"><p class="cl-32821ab6"><span class="cl-32800910">39</span></p></td><td class="cl-3282289e"><p class="cl-32821ab6"><span class="cl-32800910">1,000</span></p></td><td class="cl-3282289f"><p class="cl-32821aac"><span class="cl-32800910"> 3.9%</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-32822880"><p class="cl-32821aac"><span class="cl-32800910">bca</span></p></td><td class="cl-32822881"><p class="cl-32821aac"><span class="cl-32800910"></span></p></td><td class="cl-32822882"><p class="cl-32821ab6"><span class="cl-32800910"></span></p></td><td class="cl-3282288a"><p class="cl-32821ab6"><span class="cl-32800910"></span></p></td><td class="cl-3282288b"><p class="cl-32821aac"><span class="cl-32800910"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3282288c"><p class="cl-32821aac"><span class="cl-32800910"></span></p></td><td class="cl-32822894"><p class="cl-32821aac"><span class="cl-32800910">CI high (LCL &gt; population CSC)</span></p></td><td class="cl-32822895"><p class="cl-32821ab6"><span class="cl-32800910">37</span></p></td><td class="cl-3282289e"><p class="cl-32821ab6"><span class="cl-32800910">1,000</span></p></td><td class="cl-3282289f"><p class="cl-32821aac"><span class="cl-32800910"> 3.7%</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3282288c"><p class="cl-32821aac"><span class="cl-32800910"></span></p></td><td class="cl-32822894"><p class="cl-32821aac"><span class="cl-32800910">CI includes population CSC</span></p></td><td class="cl-32822895"><p class="cl-32821ab6"><span class="cl-32800910">923</span></p></td><td class="cl-3282289e"><p class="cl-32821ab6"><span class="cl-32800910">1,000</span></p></td><td class="cl-3282289f"><p class="cl-32821aac"><span class="cl-32800910">92.3%</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-328228a0"><p class="cl-32821aac"><span class="cl-32800910"></span></p></td><td class="cl-328228a8"><p class="cl-32821aac"><span class="cl-32800910">CI low (UCL &lt; population CSC)</span></p></td><td class="cl-328228a9"><p class="cl-32821ab6"><span class="cl-32800910">40</span></p></td><td class="cl-328228aa"><p class="cl-32821ab6"><span class="cl-32800910">1,000</span></p></td><td class="cl-328228ab"><p class="cl-32821aac"><span class="cl-32800910"> 4.0%</span></p></td></tr></tbody></table></div>
</div>
<p>So the coverage is very similar across the four methods and we can already see that the bias is pretty near zero.</p>
<p>We can also extend the simulation to consider a range of sample sizes and see if they are related to coverage.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibBalancedN40to200</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>percInclTrue <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>percLCLCSC</span> <span class='op'>&lt;</span> <span class='va'>trueCSC</span> <span class='op'>&amp;</span> <span class='va'>percUCLCSC</span> <span class='op'>&gt;</span> <span class='va'>trueCSC</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>         percCIhigh <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>percLCLCSC</span> <span class='op'>&gt;</span> <span class='va'>trueCSC</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>         percCIlow <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>percUCLCSC</span> <span class='op'>&lt;</span> <span class='va'>trueCSC</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>         percCentre <span class='op'>=</span> <span class='op'>(</span><span class='va'>percLCLCSC</span> <span class='op'>+</span> <span class='va'>percUCLCSC</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>         percWidth <span class='op'>=</span> <span class='va'>percUCLCSC</span> <span class='op'>-</span> <span class='va'>percLCLCSC</span>,</span>
<span>         basicInclTrue <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>basicLCLCSC</span> <span class='op'>&lt;</span> <span class='va'>trueCSC</span> <span class='op'>&amp;</span> <span class='va'>basicUCLCSC</span> <span class='op'>&gt;</span> <span class='va'>trueCSC</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>         basicCIhigh <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>basicLCLCSC</span> <span class='op'>&gt;</span> <span class='va'>trueCSC</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>         basicCIlow <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>basicUCLCSC</span> <span class='op'>&lt;</span> <span class='va'>trueCSC</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>         basicCentre <span class='op'>=</span> <span class='op'>(</span><span class='va'>basicLCLCSC</span> <span class='op'>+</span> <span class='va'>basicUCLCSC</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>         basicWidth <span class='op'>=</span> <span class='va'>basicUCLCSC</span> <span class='op'>-</span> <span class='va'>basicLCLCSC</span>,</span>
<span>         bcaInclTrue <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>bcaLCLCSC</span> <span class='op'>&lt;</span> <span class='va'>trueCSC</span> <span class='op'>&amp;</span> <span class='va'>bcaUCLCSC</span> <span class='op'>&gt;</span> <span class='va'>trueCSC</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>         bcaCIhigh <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>bcaLCLCSC</span> <span class='op'>&gt;</span> <span class='va'>trueCSC</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>         bcaCIlow <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>bcaUCLCSC</span> <span class='op'>&lt;</span> <span class='va'>trueCSC</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>         bcaCentre <span class='op'>=</span> <span class='op'>(</span><span class='va'>bcaLCLCSC</span> <span class='op'>+</span> <span class='va'>bcaUCLCSC</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>         bcaWidth <span class='op'>=</span> <span class='va'>bcaUCLCSC</span> <span class='op'>-</span> <span class='va'>bcaLCLCSC</span>,</span>
<span>         normInclTrue <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>normLCLCSC</span> <span class='op'>&lt;</span> <span class='va'>trueCSC</span> <span class='op'>&amp;</span> <span class='va'>normUCLCSC</span> <span class='op'>&gt;</span> <span class='va'>trueCSC</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>         normCIhigh <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>normLCLCSC</span> <span class='op'>&gt;</span> <span class='va'>trueCSC</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>         normCIlow <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>normUCLCSC</span> <span class='op'>&lt;</span> <span class='va'>trueCSC</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>         normCentre <span class='op'>=</span> <span class='op'>(</span><span class='va'>normLCLCSC</span> <span class='op'>+</span> <span class='va'>normUCLCSC</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>2</span>,</span>
<span>         normWidth <span class='op'>=</span> <span class='va'>normUCLCSC</span> <span class='op'>-</span> <span class='va'>normLCLCSC</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibBalanced2</span></span>
<span></span>
<span><span class='va'>tibBalanced2</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>iterN</span>, <span class='va'>nNHS</span>, <span class='va'>t0</span>, <span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>ends_with</a></span><span class='op'>(</span><span class='st'>"LCLCSC"</span><span class='op'>)</span>, <span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>ends_with</a></span><span class='op'>(</span><span class='st'>"UCLCSC"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span>cols <span class='op'>=</span> <span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>ends_with</a></span><span class='op'>(</span><span class='st'>"CSC"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>limit <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>name</span>, <span class='fu'><a href='https://stringr.tidyverse.org/reference/modifiers.html'>fixed</a></span><span class='op'>(</span><span class='st'>"LCL"</span><span class='op'>)</span><span class='op'>)</span>, <span class='st'>"LCL"</span>, <span class='st'>"UCL"</span><span class='op'>)</span>,</span>
<span>         method <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>name</span>, <span class='fu'><a href='https://stringr.tidyverse.org/reference/modifiers.html'>fixed</a></span><span class='op'>(</span><span class='st'>"perc"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"Percentile"</span>,</span>
<span>                            <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>name</span>, <span class='fu'><a href='https://stringr.tidyverse.org/reference/modifiers.html'>fixed</a></span><span class='op'>(</span><span class='st'>"basic"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"Basic"</span>,</span>
<span>                            <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>name</span>, <span class='fu'><a href='https://stringr.tidyverse.org/reference/modifiers.html'>fixed</a></span><span class='op'>(</span><span class='st'>"norm"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"Normal"</span>,</span>
<span>                            <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>name</span>, <span class='fu'><a href='https://stringr.tidyverse.org/reference/modifiers.html'>fixed</a></span><span class='op'>(</span><span class='st'>"bca"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"bca"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>name</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_wider.html'>pivot_wider</a></span><span class='op'>(</span>names_from <span class='op'>=</span> <span class='va'>limit</span>, values_from <span class='op'>=</span> <span class='va'>value</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibBalancedLong</span></span>
<span></span>
<span><span class='va'>tibBalancedLong</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>nNHS</span> <span class='op'>&lt;</span> <span class='fl'>1000</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>CIinclTrueCSC <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>    <span class='op'>(</span><span class='va'>LCL</span> <span class='op'>&lt;</span> <span class='va'>valTrueCSC</span> <span class='op'>&amp;</span> <span class='va'>UCL</span> <span class='op'>&gt;</span> <span class='va'>valTrueCSC</span><span class='op'>)</span> <span class='op'>~</span> <span class='st'>"CI includes population CSC"</span>,</span>
<span>    <span class='va'>LCL</span> <span class='op'>&gt;</span> <span class='va'>valTrueCSC</span> <span class='op'>~</span> <span class='st'>"CI high (LCL &gt; population CSC)"</span>,</span>
<span>    <span class='va'>UCL</span> <span class='op'>&lt;</span> <span class='va'>valTrueCSC</span> <span class='op'>~</span> <span class='st'>"CI low (UCL &lt; population CSC)"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>obsCSC <span class='op'>=</span> <span class='va'>t0</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibBalancedLong2</span></span>
<span></span>
<span><span class='va'>tibBalancedLong2</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>nNHS</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/distinct.html'>distinct</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpVecNs</span></span>
<span></span>
<span><span class='va'>tibBalancedLong2</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>method</span>, <span class='va'>nNHS</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>            nHigh <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>CIinclTrueCSC</span> <span class='op'>==</span> <span class='st'>"CI high (LCL &gt; population CSC)"</span><span class='op'>)</span>,</span>
<span>            nOK <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>CIinclTrueCSC</span> <span class='op'>==</span> <span class='st'>"CI includes population CSC"</span><span class='op'>)</span>,</span>
<span>            nLow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>CIinclTrueCSC</span> <span class='op'>==</span> <span class='st'>"CI low (UCL &lt; population CSC)"</span><span class='op'>)</span>,</span>
<span>            percOK <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fl'>100</span> <span class='op'>*</span> <span class='fu'>Hmisc</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/Hmisc/man/binconf.html'>binconf</a></span><span class='op'>(</span><span class='va'>nOK</span>, <span class='va'>n</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span>,<span class='op'>]</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/unnest_wider.html'>unnest_wider</a></span><span class='op'>(</span><span class='va'>percOK</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span></span>
<span><span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>method</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>mean <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>PointEst</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib2</span></span>
<span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTib</span>,</span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>nNHS</span>, y <span class='op'>=</span> <span class='va'>PointEst</span>, colour <span class='op'>=</span> <span class='va'>method</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_grid.html'>facet_grid</a></span><span class='op'>(</span>rows <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/vars.html'>vars</a></span><span class='op'>(</span><span class='va'>method</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_linerange.html'>geom_linerange</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>ymin <span class='op'>=</span> <span class='va'>Lower</span>, ymax <span class='op'>=</span> <span class='va'>Upper</span><span class='op'>)</span>,</span>
<span>                 linewidth <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fl'>95</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>             linewidth <span class='op'>=</span> <span class='fl'>2.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTib2</span>,</span>
<span>             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='va'>mean</span>, colour <span class='op'>=</span> <span class='va'>method</span><span class='op'>)</span>,</span>
<span>             linewidth <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Coverage"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span><span class='st'>"Sample size (balanced)"</span>,</span>
<span>                     breaks <span class='op'>=</span> <span class='va'>tmpVecNs</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Forest plot of coverage against (balanced) sample sizes, by method"</span>,</span>
<span>          subtitle <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Vertical error bars are 95% CIs for the observed rates, n = "</span>, </span>
<span>                            <span class='va'>nReps</span>, </span>
<span>                            <span class='st'>" per sample size"</span>,</span>
<span>                            <span class='st'>"\nDotted horizontal line marks 95% rate and solid lines are mean coverage per method"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="explaining-the-bootstrap-cicsc-simulation_files/figure-html5/coverage6-1.png" width="1536" /></p>
</div>
<p>So the coverage rates vary across the sample sizes with a suggestion that it’s smallest for the first two, the smallest, sample sizes. However, that’s not a very strong suggestion of relationship and it doesn’t seem to continue across the larger sample sizes. This shows coverage by method aggregated across those sample sizes.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibBalancedLong2</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>method</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>            nOK <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>CIinclTrueCSC</span> <span class='op'>==</span> <span class='st'>"CI includes population CSC"</span><span class='op'>)</span>,</span>
<span>            percOK <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fl'>100</span> <span class='op'>*</span> <span class='fu'>Hmisc</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/Hmisc/man/binconf.html'>binconf</a></span><span class='op'>(</span><span class='va'>nOK</span>, <span class='va'>n</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span>,<span class='op'>]</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/unnest_wider.html'>unnest_wider</a></span><span class='op'>(</span><span class='va'>percOK</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span></span>
<span><span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>Coverage <span class='op'>=</span> <span class='va'>PointEst</span>,</span>
<span>         `LCL(coverage)` <span class='op'>=</span> <span class='va'>Lower</span>,</span>
<span>         `UCL(coverage)` <span class='op'>=</span> <span class='va'>Upper</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-33758278{}.cl-3370f3a2{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-3372f210{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-3372f21a{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-3372fec2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3372fec3{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3372fecc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3372fed6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3372fed7{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3372fee0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-33758278'><thead><tr style="overflow-wrap:break-word;"><th class="cl-3372fec2"><p class="cl-3372f210"><span class="cl-3370f3a2">method</span></p></th><th class="cl-3372fec3"><p class="cl-3372f21a"><span class="cl-3370f3a2">n</span></p></th><th class="cl-3372fec3"><p class="cl-3372f21a"><span class="cl-3370f3a2">nOK</span></p></th><th class="cl-3372fec3"><p class="cl-3372f21a"><span class="cl-3370f3a2">Coverage</span></p></th><th class="cl-3372fec3"><p class="cl-3372f21a"><span class="cl-3370f3a2">LCL(coverage)</span></p></th><th class="cl-3372fec3"><p class="cl-3372f21a"><span class="cl-3370f3a2">UCL(coverage)</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-3372fecc"><p class="cl-3372f210"><span class="cl-3370f3a2">Basic</span></p></td><td class="cl-3372fed6"><p class="cl-3372f21a"><span class="cl-3370f3a2">9,000</span></p></td><td class="cl-3372fed6"><p class="cl-3372f21a"><span class="cl-3370f3a2">8,498</span></p></td><td class="cl-3372fed6"><p class="cl-3372f21a"><span class="cl-3370f3a2">94.42</span></p></td><td class="cl-3372fed6"><p class="cl-3372f21a"><span class="cl-3370f3a2">93.93</span></p></td><td class="cl-3372fed6"><p class="cl-3372f21a"><span class="cl-3370f3a2">94.88</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3372fecc"><p class="cl-3372f210"><span class="cl-3370f3a2">Normal</span></p></td><td class="cl-3372fed6"><p class="cl-3372f21a"><span class="cl-3370f3a2">9,000</span></p></td><td class="cl-3372fed6"><p class="cl-3372f21a"><span class="cl-3370f3a2">8,489</span></p></td><td class="cl-3372fed6"><p class="cl-3372f21a"><span class="cl-3370f3a2">94.32</span></p></td><td class="cl-3372fed6"><p class="cl-3372f21a"><span class="cl-3370f3a2">93.82</span></p></td><td class="cl-3372fed6"><p class="cl-3372f21a"><span class="cl-3370f3a2">94.78</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3372fecc"><p class="cl-3372f210"><span class="cl-3370f3a2">Percentile</span></p></td><td class="cl-3372fed6"><p class="cl-3372f21a"><span class="cl-3370f3a2">9,000</span></p></td><td class="cl-3372fed6"><p class="cl-3372f21a"><span class="cl-3370f3a2">8,483</span></p></td><td class="cl-3372fed6"><p class="cl-3372f21a"><span class="cl-3370f3a2">94.26</span></p></td><td class="cl-3372fed6"><p class="cl-3372f21a"><span class="cl-3370f3a2">93.76</span></p></td><td class="cl-3372fed6"><p class="cl-3372f21a"><span class="cl-3370f3a2">94.72</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3372fed7"><p class="cl-3372f210"><span class="cl-3370f3a2">bca</span></p></td><td class="cl-3372fee0"><p class="cl-3372f21a"><span class="cl-3370f3a2">9,000</span></p></td><td class="cl-3372fee0"><p class="cl-3372f21a"><span class="cl-3370f3a2">8,493</span></p></td><td class="cl-3372fee0"><p class="cl-3372f21a"><span class="cl-3370f3a2">94.37</span></p></td><td class="cl-3372fee0"><p class="cl-3372f21a"><span class="cl-3370f3a2">93.87</span></p></td><td class="cl-3372fee0"><p class="cl-3372f21a"><span class="cl-3370f3a2">94.82</span></p></td></tr></tbody></table></div>
</div>
<p>The same as a very small forest plot:</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTib</span>,</span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>method</span>, y <span class='op'>=</span> <span class='va'>PointEst</span>, colour <span class='op'>=</span> <span class='va'>method</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_linerange.html'>geom_linerange</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>ymin <span class='op'>=</span> <span class='va'>Lower</span>, ymax <span class='op'>=</span> <span class='va'>Upper</span><span class='op'>)</span>,</span>
<span>                 linewidth <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fl'>95</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>             linewidth <span class='op'>=</span> <span class='fl'>1.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Coverage (and 95% CI)"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Method of computing bootstrap CI(CSC)"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Forest plot of coverage across (balanced) sizes against method"</span>,</span>
<span>          subtitle <span class='op'>=</span> <span class='st'>"Dotted horizontal reference line marks 95%"</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<img src="explaining-the-bootstrap-cicsc-simulation_files/figure-html5/coverage8-1.png" width="1536" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibBalancedLong2</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>method</span> <span class='op'>==</span> <span class='st'>"Percentile"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpN</span></span></code></pre>
</div>
</details>
</div>
<p>The 95% CIs for the coverage, now across
9000 simulations
1000 per sample size for each method, are tight; all the observed coverage rates fall below the 95% which was sought and the 95% confidence intervals around those rates all fall entirely below 95% so coverage is conservative but only very slightly at around 94% not 95%.</p>
<h3 id="summarising-assessment-of-coverage">Summarising assessment of coverage</h3>
<ul>
<li><p>Coverage is what it says: do the CIs you are seeing have the coverage you asked for (usually 95%)? A small deviation from the desired rate is usually not an issue but sometimes a poor CI can give very poor coverage: parametric CIs for correlations can be badly out for very non-Gaussian distributions of the correlated variables for example and for such data, bootstrap CIs for the correlations will be very much closer to the desired coverage. For CSC statistics here and the Gaussian simulation data all four bootstrap CIs show very slightly conservative coverage (i.e. slightly less than the desired rate).</p></li>
<li><p>It is possible to compare coverage by method of calculation of the CI or by population parameters in the simulated data or by sample design factors such as sample size.</p></li>
</ul>
<h2 id="bias">Bias</h2>
<p>Coverage can be good, as here, or even precise, giving the desired inclusion rate within random sampling error every time. However, a method of getting a CI, here bootstrapping to get the CI of the CSC, can still be poor if it is biased. For any CI there are two ways of looking at bias. The first is to compare the values of each bootstrap replication value for the statistic of interest (here the CSC) against the population value. If the method is biased the estimated values will have a mean value above, or below, the population value and further away than you would expect given your sample sizes. The second way is to compare the rates of high CIs versus the rate of low CIs. These should be approximately equal if the method is unbiased, but will be different if there is bias.</p>
<p>I’m following the bias methods in Tibbe, T. D., &amp; Montoya, A. K. (2022). Correcting the Bias Correction for the Bootstrap Confidence Interval in Mediation Analysis. Frontiers in Psychology, 13, 810258. <a href="https://doi.org/10.3389/fpsyg.2022.810258" class="uri">https://doi.org/10.3389/fpsyg.2022.810258</a> here and using the same simulation data as in the coverage example. The statistics Tibbe &amp; Montoya use are:</p>
<ul>
<li><p><strong>Sample mean bias</strong>: the mean difference between the observed statistic in each (cell of) the simulation and the population value. As far as I can see, this is a reflection of the sampling or, more precisely, of the method used to simulate the population model: if this is biased, using it as the next step means that the boostrap CI calculation method is not penalised by this method.</p></li>
<li><p>** So Tibbe &amp; Montoya have the <strong>bootstrap mean bias</strong> which is the mean difference across each bootstrap resample value of the statistic and that <strong>sample mean bias</strong> above thus removing its bias from being attributed to the bootstrap computation. I can’t really see, assuming that the resampling is truly random, how this is ever going to show marked bias, at least not for the simple bootstrap methods I understand but I guess it is checking that the resampling is at random and it is certainly an index of bias.</p></li>
</ul>
<p>Both sample mean bias and bootstrap mean bias are only looking at the value of the statistic, here the CSC, not any CI based on the bootstrap resampling so they can’t be used to compare methods.</p>
<ul>
<li>Finally the have <strong>balance</strong> and I can’t do better than their summary of this:</li>
</ul>
<blockquote>
<blockquote>
<p>For each bootstrap method within each condition, <strong>balance</strong> was calculated by recording the number of times the confidence interval was either above or below the true indirect effect (i.e., did not capture the true indirect effect). These tallies were then counted across iterations to give the total number of confidence intervals that fell above the true effect and the total number that fell below the true effect in each condition. Finally, the total number of confidence intervals that fell above the true effect was divided by the total number of confidence intervals that excluded the true effect (i.e., the number above the true effect plus the number below it). If this value was equal to 0.50, the method was perfectly balanced, and balance decreased as the value’s distance from 0.50 increased. Values greater than 0.50 indicated that the confidence interval fell above the true effect more often than it fell below, and values smaller than 0.50 indicated the confidence interval fell below the true effect more often than it fell above. A binomial significance test was also applied to the balance values to see which were significantly different from 0.50 at an α-level of 0.05.</p>
</blockquote>
</blockquote>
<p>That uses the bootstrap CI so it can be used to compare methods.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>getSampleMeanBias</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>t0</span>, <span class='va'>popCSC</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='co'>### function that gets the sample mean bias across a set of simulations given a known population CSC </span></span>
<span>  <span class='co'>### assuming that in the data, tibDat, produced by getBootCICSC2() or similar so that t0 is the sample CSC</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>t0</span><span class='op'>)</span> <span class='op'>-</span> <span class='va'>popCSC</span></span>
<span><span class='op'>}</span></span>
<span><span class='va'>tibBalanced</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>sampleMeanBias <span class='op'>=</span> <span class='fu'>getSampleMeanBias</span><span class='op'>(</span><span class='va'>t0</span>, <span class='va'>valTrueCSC</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>valSampleMeanBias</span></span></code></pre>
</div>
</details>
</div>
<p>For the single sample size of <em>n</em> = 40 and
1000 samples the sample mean bias, i.e. deviation from the population CSC is
0.00047 so, as you’d expect, there seems to be nothing biased about the sample generation process.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>getBootMeanBias</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>tibDat</span>, <span class='va'>iterN</span> <span class='op'>=</span> <span class='st'>"iterN"</span>, <span class='va'>t0</span> <span class='op'>=</span> <span class='st'>"t0"</span>, <span class='va'>t</span> <span class='op'>=</span> <span class='st'>"t"</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='co'>### function that will get the mean bootstrap bias</span></span>
<span>  <span class='co'>### assumes that the data, tibDat, have been produced by getBootCICSC2() or similar and that</span></span>
<span>  <span class='co'>### iterN is the sample iteration count)</span></span>
<span>  <span class='co'>### t0 is the sample CSC</span></span>
<span>  <span class='co'>### t is a vector of the individual bootstrap replication CSCs</span></span>
<span>  <span class='va'>iterN</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rlang.r-lib.org/reference/enquo.html'>enquo</a></span><span class='op'>(</span><span class='va'>iterN</span><span class='op'>)</span></span>
<span>  <span class='va'>t0</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rlang.r-lib.org/reference/enquo.html'>enquo</a></span><span class='op'>(</span><span class='va'>t0</span><span class='op'>)</span></span>
<span>  <span class='va'>t</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rlang.r-lib.org/reference/enquo.html'>enquo</a></span><span class='op'>(</span><span class='va'>t</span><span class='op'>)</span></span>
<span></span>
<span>  <span class='va'>tibDat</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>!</span><span class='op'>!</span><span class='va'>iterN</span>, <span class='op'>!</span><span class='op'>!</span><span class='va'>t0</span>, <span class='op'>!</span><span class='op'>!</span><span class='va'>t</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>    <span class='fu'><a href='https://tidyr.tidyverse.org/reference/unnest_longer.html'>unnest_longer</a></span><span class='op'>(</span><span class='op'>!</span><span class='op'>!</span><span class='va'>t</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>bootBias <span class='op'>=</span> <span class='va'>t</span> <span class='op'>-</span> <span class='va'>t0</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='op'>!</span><span class='op'>!</span><span class='va'>iterN</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>bootMeanBias <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>bootBias</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>bootMeanBias</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='op'>)</span> </span>
<span><span class='op'>}</span></span>
<span><span class='va'>tibBalanced</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>bootMeanBias <span class='op'>=</span> <span class='fu'>getBootMeanBias</span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/pick.html'>pick</a></span><span class='op'>(</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='va'>iterN</span>, <span class='va'>t0</span>, <span class='va'>t</span>, <span class='va'>trueCSC</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>valBootMeanBias</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span><span class='st'>"scipen"</span> <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span></span></code></pre>
</div>
</details>
</div>
<p>The bootstrap mean bias is
-0.0000247 so again, as that’s absolutely tiny, it appears that bootstrap resampling isn’t creating any bias.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span><span class='st'>"scipen"</span> <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span></span>
<span><span class='va'>getBalance1</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>tibDat</span>, <span class='va'>LCL</span>, <span class='va'>UCL</span>, <span class='va'>trueCSC</span>, <span class='va'>ci</span> <span class='op'>=</span> <span class='fl'>.95</span>, <span class='va'>returnWider</span> <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='co'>### function that will get the bootstrap bias balance value</span></span>
<span>  <span class='co'>### the balance value is the proportion of the CIs that *do not* include the population/true CSC</span></span>
<span>  <span class='co'>### that are high</span></span>
<span>  <span class='co'>### so it's n(high)/(n(high) + n(low)))</span></span>
<span>  <span class='co'>### assumes that the data, tibDat, have been produced by getBootCICSC2() or similar and that</span></span>
<span>  <span class='co'>### LCL is the lower confidence limit</span></span>
<span>  <span class='co'>### UCL is the upper confidence limit</span></span>
<span>  <span class='co'>### trueCSC is the known population CSC</span></span>
<span>  <span class='co'>### it gives you the balance (i.e. that simple proportion), its CI and it's p value</span></span>
<span>  <span class='co'>### ci is, surprise, surprise, the width of the binomial CI you want around the observed proportion</span></span>
<span>  <span class='va'>alpha</span> <span class='op'>&lt;-</span> <span class='fl'>1</span> <span class='op'>-</span> <span class='va'>ci</span></span>
<span>  <span class='va'>LCL</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rlang.r-lib.org/reference/enquo.html'>enquo</a></span><span class='op'>(</span><span class='va'>LCL</span><span class='op'>)</span></span>
<span>  <span class='va'>UCL</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rlang.r-lib.org/reference/enquo.html'>enquo</a></span><span class='op'>(</span><span class='va'>UCL</span><span class='op'>)</span></span>
<span></span>
<span>  <span class='va'>tibDat</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>!</span><span class='op'>!</span><span class='va'>LCL</span>, <span class='op'>!</span><span class='op'>!</span><span class='va'>UCL</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rowwise.html'>rowwise</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>popCSC <span class='op'>=</span> <span class='va'>trueCSC</span>,</span>
<span>           CIperc <span class='op'>=</span> <span class='va'>ci</span>,</span>
<span>           isHigh <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='op'>!</span><span class='op'>!</span><span class='va'>LCL</span> <span class='op'>&gt;</span> <span class='va'>popCSC</span><span class='op'>)</span>,</span>
<span>           isLow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='op'>!</span><span class='op'>!</span><span class='va'>UCL</span> <span class='op'>&lt;</span> <span class='va'>popCSC</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpDat1</span></span>
<span>  </span>
<span>  <span class='va'>tmpDat1</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span>,</span>
<span>              popCSC <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/nth.html'>first</a></span><span class='op'>(</span><span class='va'>popCSC</span><span class='op'>)</span>,</span>
<span>              CIwidth <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/nth.html'>first</a></span><span class='op'>(</span><span class='va'>CIperc</span><span class='op'>)</span>,</span>
<span>              nHigh <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>isHigh</span><span class='op'>)</span>,</span>
<span>              nLow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>isLow</span><span class='op'>)</span>,</span>
<span>              nHighOrLow <span class='op'>=</span> <span class='va'>nHigh</span> <span class='op'>+</span> <span class='va'>nLow</span>,</span>
<span>              Balance <span class='op'>=</span> <span class='va'>nHigh</span> <span class='op'>/</span> <span class='va'>nHighOrLow</span>,</span>
<span>              ciBalance <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'>Hmisc</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/Hmisc/man/binconf.html'>binconf</a></span><span class='op'>(</span><span class='va'>nHigh</span>, <span class='va'>nHighOrLow</span>, <span class='va'>alpha</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span>, <span class='op'>]</span><span class='op'>)</span>,</span>
<span>              pBalance <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/binom.test.html'>binom.test</a></span><span class='op'>(</span><span class='va'>nHigh</span>, <span class='va'>nHighOrLow</span><span class='op'>)</span><span class='op'>$</span><span class='va'>p.value</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://tidyr.tidyverse.org/reference/unnest_wider.html'>unnest_wider</a></span><span class='op'>(</span><span class='va'>ciBalance</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>PointEst</span>, <span class='va'>nHighOrLow</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='va'>popCSC</span>, <span class='va'>nHigh</span>, <span class='va'>nLow</span>, <span class='va'>Balance</span>, <span class='va'>CIwidth</span>, <span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpRes</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>returnWider</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>tmpRes</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span></span>
<span>    <span class='va'>tmpRes</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span>cols <span class='op'>=</span> <span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span><span class='op'>}</span></span>
<span><span class='va'>tibBalancedLong</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>nNHS</span> <span class='op'>==</span> <span class='fl'>40</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>method</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>balance <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'>getBalance1</span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/pick.html'>pick</a></span><span class='op'>(</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>, <span class='va'>LCL</span>, <span class='va'>UCL</span>, <span class='va'>valTrueCSC</span>, returnWider <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/unnest_wider.html'>unnest_wider</a></span><span class='op'>(</span><span class='va'>balance</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>popCSC</span>, <span class='va'>CIwidth</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>nReps <span class='op'>=</span> <span class='va'>n</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/across.html'>across</a></span><span class='op'>(</span><span class='va'>nReps</span><span class='op'>:</span><span class='va'>nLow</span>, <span class='va'>as.integer</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span>  </span>
<span></span>
<span><span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-34460ee8{}.cl-34416384{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-34436508{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-34436512{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-3443720a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3443720b{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-34437214{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-34437215{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3443721e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-3443721f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-34460ee8'><thead><tr style="overflow-wrap:break-word;"><th class="cl-3443720a"><p class="cl-34436508"><span class="cl-34416384">method</span></p></th><th class="cl-3443720b"><p class="cl-34436512"><span class="cl-34416384">nReps</span></p></th><th class="cl-3443720b"><p class="cl-34436512"><span class="cl-34416384">nHigh</span></p></th><th class="cl-3443720b"><p class="cl-34436512"><span class="cl-34416384">nLow</span></p></th><th class="cl-3443720b"><p class="cl-34436512"><span class="cl-34416384">Balance</span></p></th><th class="cl-3443720b"><p class="cl-34436512"><span class="cl-34416384">Lower</span></p></th><th class="cl-3443720b"><p class="cl-34436512"><span class="cl-34416384">Upper</span></p></th><th class="cl-3443720b"><p class="cl-34436512"><span class="cl-34416384">pBalance</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-34437214"><p class="cl-34436508"><span class="cl-34416384">Basic</span></p></td><td class="cl-34437215"><p class="cl-34436512"><span class="cl-34416384">1,000</span></p></td><td class="cl-34437215"><p class="cl-34436512"><span class="cl-34416384">35</span></p></td><td class="cl-34437215"><p class="cl-34436512"><span class="cl-34416384">38</span></p></td><td class="cl-34437215"><p class="cl-34436512"><span class="cl-34416384">0.479</span></p></td><td class="cl-34437215"><p class="cl-34436512"><span class="cl-34416384">0.369</span></p></td><td class="cl-34437215"><p class="cl-34436512"><span class="cl-34416384">0.592</span></p></td><td class="cl-34437215"><p class="cl-34436512"><span class="cl-34416384">0.815</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-34437214"><p class="cl-34436508"><span class="cl-34416384">Normal</span></p></td><td class="cl-34437215"><p class="cl-34436512"><span class="cl-34416384">1,000</span></p></td><td class="cl-34437215"><p class="cl-34436512"><span class="cl-34416384">36</span></p></td><td class="cl-34437215"><p class="cl-34436512"><span class="cl-34416384">40</span></p></td><td class="cl-34437215"><p class="cl-34436512"><span class="cl-34416384">0.474</span></p></td><td class="cl-34437215"><p class="cl-34436512"><span class="cl-34416384">0.365</span></p></td><td class="cl-34437215"><p class="cl-34436512"><span class="cl-34416384">0.584</span></p></td><td class="cl-34437215"><p class="cl-34436512"><span class="cl-34416384">0.731</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-34437214"><p class="cl-34436508"><span class="cl-34416384">Percentile</span></p></td><td class="cl-34437215"><p class="cl-34436512"><span class="cl-34416384">1,000</span></p></td><td class="cl-34437215"><p class="cl-34436512"><span class="cl-34416384">32</span></p></td><td class="cl-34437215"><p class="cl-34436512"><span class="cl-34416384">39</span></p></td><td class="cl-34437215"><p class="cl-34436512"><span class="cl-34416384">0.451</span></p></td><td class="cl-34437215"><p class="cl-34436512"><span class="cl-34416384">0.340</span></p></td><td class="cl-34437215"><p class="cl-34436512"><span class="cl-34416384">0.566</span></p></td><td class="cl-34437215"><p class="cl-34436512"><span class="cl-34416384">0.477</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-3443721e"><p class="cl-34436508"><span class="cl-34416384">bca</span></p></td><td class="cl-3443721f"><p class="cl-34436512"><span class="cl-34416384">1,000</span></p></td><td class="cl-3443721f"><p class="cl-34436512"><span class="cl-34416384">37</span></p></td><td class="cl-3443721f"><p class="cl-34436512"><span class="cl-34416384">40</span></p></td><td class="cl-3443721f"><p class="cl-34436512"><span class="cl-34416384">0.481</span></p></td><td class="cl-3443721f"><p class="cl-34436512"><span class="cl-34416384">0.373</span></p></td><td class="cl-3443721f"><p class="cl-34436512"><span class="cl-34416384">0.590</span></p></td><td class="cl-3443721f"><p class="cl-34436512"><span class="cl-34416384">0.820</span></p></td></tr></tbody></table></div>
</div>
<p>So all the methods give a slightly low balance value so slightly more CIs are low than are high but the binomial p values are way above .05 and the confidence intervals, though quite wide all embrace .5 so no evidence of bias here for any of the methods for <em>n</em> = 40.</p>
<p>Here’s the same as a forest plot for those who prefer plots to tables (me!).</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTib</span>,</span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>method</span>, y <span class='op'>=</span> <span class='va'>Balance</span>, colour <span class='op'>=</span> <span class='va'>method</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_linerange.html'>geom_linerange</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>ymin <span class='op'>=</span> <span class='va'>Lower</span>, ymax <span class='op'>=</span> <span class='va'>Upper</span><span class='op'>)</span>,</span>
<span>                 linewidth <span class='op'>=</span> <span class='fl'>2.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fl'>.5</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>             linewidth <span class='op'>=</span> <span class='fl'>2.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Balance"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Bootstrap CI method"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Forest plot of balance against method for sample sizes of 40"</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="explaining-the-bootstrap-cicsc-simulation_files/figure-html5/balance2-1.png" width="1536" /></p>
</div>
<p>We can look at whether bias is affected by sample size.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibBalancedLong</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>nNHS</span>, <span class='va'>method</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>balance <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'>getBalance1</span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/pick.html'>pick</a></span><span class='op'>(</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>, <span class='va'>LCL</span>, <span class='va'>UCL</span>, <span class='va'>valTrueCSC</span>, returnWider <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/unnest_wider.html'>unnest_wider</a></span><span class='op'>(</span><span class='va'>balance</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>popCSC</span>, <span class='va'>CIwidth</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>nReps <span class='op'>=</span> <span class='va'>n</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/across.html'>across</a></span><span class='op'>(</span><span class='va'>nReps</span><span class='op'>:</span><span class='va'>nLow</span>, <span class='va'>as.integer</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span></span>
<span><span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>method</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>mean <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>Balance</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib2</span></span>
<span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTib</span>,</span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>nNHS</span>, y <span class='op'>=</span> <span class='va'>Balance</span>, colour <span class='op'>=</span> <span class='va'>method</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_grid.html'>facet_grid</a></span><span class='op'>(</span>rows <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/vars.html'>vars</a></span><span class='op'>(</span><span class='va'>method</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_linerange.html'>geom_linerange</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>ymin <span class='op'>=</span> <span class='va'>Lower</span>, ymax <span class='op'>=</span> <span class='va'>Upper</span><span class='op'>)</span>,</span>
<span>                 linewidth <span class='op'>=</span> <span class='fl'>2.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fl'>.5</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>             linewidth <span class='op'>=</span> <span class='fl'>2.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTib2</span>,</span>
<span>             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='va'>mean</span>, colour <span class='op'>=</span> <span class='va'>method</span><span class='op'>)</span>,</span>
<span>             linewidth<span class='op'>=</span> <span class='fl'>2.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Sample size"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Forest plot of balance against sample size"</span>,</span>
<span>          subtitle <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Vertical error bars are 95% binomial CI for the balance value"</span>,</span>
<span>                            <span class='st'>"\nDotted horizontal reference line is zero bias, i.e. balance = .5,"</span>,</span>
<span>                            <span class='st'>"\nsolid horizontal reference lines are mean balance values per method"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="explaining-the-bootstrap-cicsc-simulation_files/figure-html5/balance3-1.png" width="1536" /></p>
</div>
<p>That shows clearly that all balance values are very close to .5: no bias here!</p>
<p>Note: the confidence intervals are wide because they are binomial, i.e. count based, CIs but more importantly, because they are only counting across the simulation runs where the CI did <em>not</em> include the population value here we have a usable sample size of in the range 71 to 77 despite using 1,000 replications for each simulation design.</p>
<h1 id="summary">Summary</h1>
<ul>
<li><p>All four bootstrap CI methods are very slightly conservative with coverage around 94% instead of 95%. This is unimportant for the kinds of data on which CSCs are computed as sampling issues will have far more impact on values than this tiny undercoverage.</p></li>
<li><p>The simple percentile bootstrap CI method seems no worse than the other three method.</p></li>
<li><p>Bootstrapping shows no bias whether by mean deviation from the sample CSC or in terms of balance.</p></li>
<li><p>Basically the bootstrap CI works for Gaussian distributions and, on the grounds of simplicity, I would recommend the percentile method as its performance was no meaningfully different from the other three methods.</p></li>
<li><p>This work only looks balanced sample sizes with the same SDs and only looks at one population CSC. The full simulation looks at the impacts of varying the effect size and hence the population CSC, at using unbalanced sample sizes and at populations where the NHS and HS SDs differ (heteroscadisticity).</p></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="reuse">Reuse</h3>
<p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
