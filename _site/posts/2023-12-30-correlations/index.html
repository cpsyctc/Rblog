<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
<title>Chris (Evans) R SAFAQ: Correlation coefficients (1)</title>

<meta property="description" itemprop="description" content="Exploration of the differences between different correlation coefficients."/>

<link rel="canonical" href="https://www.psyctc.org/R_blog/posts/2023-12-30-correlations/"/>
<link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"/>
<link rel="icon" type="image/png" href="../../Rblog_logo.png"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2023-12-30"/>
<meta property="article:created" itemprop="dateCreated" content="2023-12-30"/>
<meta name="article:author" content="Chris Evans"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Chris (Evans) R SAFAQ: Correlation coefficients (1)"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Exploration of the differences between different correlation coefficients."/>
<meta property="og:url" content="https://www.psyctc.org/R_blog/posts/2023-12-30-correlations/"/>
<meta property="og:image" content="https://www.psyctc.org/R_blog/posts/2023-12-30-correlations/correlations_files/figure-html5/plot1n4-1.png"/>
<meta property="og:image:width" content="3072"/>
<meta property="og:image:height" content="2304"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Chris (Evans) R SAFAQ"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="Chris (Evans) R SAFAQ: Correlation coefficients (1)"/>
<meta property="twitter:description" content="Exploration of the differences between different correlation coefficients."/>
<meta property="twitter:url" content="https://www.psyctc.org/R_blog/posts/2023-12-30-correlations/"/>
<meta property="twitter:image" content="https://www.psyctc.org/R_blog/posts/2023-12-30-correlations/correlations_files/figure-html5/plot1n4-1.png"/>
<meta property="twitter:image:width" content="3072"/>
<meta property="twitter:image:height" content="2304"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="Chris (Evans) R SAFAQ: Correlation coefficients (1)"/>
<meta name="citation_fulltext_html_url" content="https://www.psyctc.org/R_blog/posts/2023-12-30-correlations/"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2023/12/30"/>
<meta name="citation_publication_date" content="2023/12/30"/>
<meta name="citation_author" content="Chris Evans"/>
<meta name="citation_author_institution" content="PSYCTC.org"/>
<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","categories","output","creative_commons","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["Correlation coefficients (1)"]},{"type":"character","attributes":{},"value":["Exploration of the differences between different correlation coefficients."]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation","affiliation_url","orcid_id"]}},"value":[{"type":"character","attributes":{},"value":["Chris Evans"]},{"type":"character","attributes":{},"value":["https://www.psyctc.org/R_blog/"]},{"type":"character","attributes":{},"value":["PSYCTC.org"]},{"type":"character","attributes":{},"value":["https://www.psyctc.org/psyctc/"]},{"type":"character","attributes":{},"value":["0000-0002-4197-4202"]}]}]},{"type":"character","attributes":{},"value":["2023-12-30"]},{"type":"character","attributes":{},"value":["Correlation","Null hypothesis tests (NHSTs)"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","toc_depth","highlight_downlit","self_contained","code_folding","includes"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[4]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["in_header"]}},"value":[{"type":"character","attributes":{},"value":["../../Gurgle.Rhtml"]}]}]}]},{"type":"character","attributes":{},"value":["CC BY-SA"]},{"type":"character","attributes":{},"value":["https://www.psyctc.org/R_blog/posts/2023-12-30-correlations/"]},{"type":"character","attributes":{},"value":["https://www.psyctc.org/R_blog/posts/2023-12-30-correlations/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["correlations_files/anchor-4.2.2/anchor.min.js","correlations_files/bowser-1.9.3/bowser.min.js","correlations_files/clipboard-2.0.6/clipboard.min.js","correlations_files/distill-2.2.21/template.v2.js","correlations_files/figure-html5/Kendall2N4-1.png","correlations_files/figure-html5/plot1n4-1.png","correlations_files/figure-html5/plot2n4-1.png","correlations_files/figure-html5/Spearman3N4-1.png","correlations_files/figure-html5/transformations1-1.png","correlations_files/figure-html5/transformations3-1.png","correlations_files/figure-html5/transformations5-1.png","correlations_files/font-awesome-6.4.2/css/all.css","correlations_files/font-awesome-6.4.2/css/all.min.css","correlations_files/font-awesome-6.4.2/css/v4-shims.css","correlations_files/font-awesome-6.4.2/css/v4-shims.min.css","correlations_files/font-awesome-6.4.2/webfonts/fa-brands-400.ttf","correlations_files/font-awesome-6.4.2/webfonts/fa-brands-400.woff2","correlations_files/font-awesome-6.4.2/webfonts/fa-regular-400.ttf","correlations_files/font-awesome-6.4.2/webfonts/fa-regular-400.woff2","correlations_files/font-awesome-6.4.2/webfonts/fa-solid-900.ttf","correlations_files/font-awesome-6.4.2/webfonts/fa-solid-900.woff2","correlations_files/font-awesome-6.4.2/webfonts/fa-v4compatibility.ttf","correlations_files/font-awesome-6.4.2/webfonts/fa-v4compatibility.woff2","correlations_files/header-attrs-2.25/header-attrs.js","correlations_files/header-attrs-2.27/header-attrs.js","correlations_files/jquery-3.6.0/jquery-3.6.0.js","correlations_files/jquery-3.6.0/jquery-3.6.0.min.js","correlations_files/jquery-3.6.0/jquery-3.6.0.min.map","correlations_files/popper-2.6.0/popper.min.js","correlations_files/tabwid-1.1.3/tabwid.css","correlations_files/tabwid-1.1.3/tabwid.js","correlations_files/tippy-6.2.7/tippy-bundle.umd.min.js","correlations_files/tippy-6.2.7/tippy-light-border.css","correlations_files/tippy-6.2.7/tippy.css","correlations_files/tippy-6.2.7/tippy.umd.min.js","correlations_files/webcomponents-2.0.0/webcomponents.js","correlations_files/xaringanExtra-clipboard-0.2.6/xaringanExtra-clipboard.css","correlations_files/xaringanExtra-clipboard-0.2.6/xaringanExtra-clipboard.js","distill-preview.png","tibDat1N4.csv"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.1/jquery-3.6.1.min.js"></script>
<link href="../../site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */
@import url('https://fonts.googleapis.com/css2?family=Amiri');
@import url('https://fonts.googleapis.com/css2?family=Bitter');
@import url('https://fonts.googleapis.com/css2?family=DM+Mono');


html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8); 
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  --background-color: #ffff99;
  --bkgd-color: #ffff99;
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       "DM Mono", monospace;
  --body-font:       "Bitter", sans-serif;
  --navbar-font:     "Amiri", serif;
}

body {
  background-color: #ffff99;
  bkgd-color: #ffff99;
}

p {
  background-color: #ffff99;
  bkgd-color: #ffff99;
}


/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
.d-article{
  background-color: #ffff99;
}

/* making code chunks with scroll bar */

/* the code below will change output chunk properties */
d-article pre { 
  border-radius: 5px; /* rounded chunk window*/
  font-size: 12px; /* output text size */
  color: black; /* output text colour */
  background-color: #F5F5F5; /* output chunk background colour */
  padding: 5px 5px 5px 18px; /* top,right,bottom,left padding values */
  overflow: auto !important; /* enables scroll bar */ 
}

/* the code below will change source code chunk properties */
d-article div.sourceCode pre { 
  border-radius: 5px;
  background-color: #F8F8FF;
  color: black;
  padding: 5px 5px 5px 18px;
  overflow: auto !important;
}
</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.27/header-attrs.js"></script>
  <script src="../../site_libs/clipboard-2.0.6/clipboard.min.js"></script>
  <link href="../../site_libs/xaringanExtra-clipboard-0.2.6/xaringanExtra-clipboard.css" rel="stylesheet" />
  <script src="../../site_libs/xaringanExtra-clipboard-0.2.6/xaringanExtra-clipboard.js"></script>
  <script>window.xaringanExtraClipboard(null, {"button":"<i class=\"fa fa-clone fa-2x\" style=\"color: #301e64\"><\/i>","success":"<i class=\"fa fa-check fa-2x\" style=\"color: #90BE6D\"><\/i>","error":"<i class=\"fa fa-times fa-2x\" style=\"color: #F94144\"><\/i>"})</script>
  <link href="../../site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
  <link href="../../site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />
  <link href="../../site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
  <script src="../../site_libs/tabwid-1.1.3/tabwid.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<script>
   document.addEventListener("DOMContentLoaded", function () {
     if (!/posts/.test(location.pathname)) {
       return;
     }

     var script = document.createElement("script");
     script.src = "https://giscus.app/client.js";
     script.setAttribute("data-repo", "cpsyctc/Rblog");
     script.setAttribute("data-repo-id", "MDEwOlJlcG9zaXRvcnkzMzM1Mzg4OTA=");
     script.setAttribute("data-category", "General");
     script.setAttribute("data-category-id", "DIC_kwDOE-FmSs4CYdgN");
     script.setAttribute("data-mapping", "pathname");
     script.setAttribute("data-reactions-enabled", "0");
     script.setAttribute("data-emit-metadata", "0");
     script.setAttribute("data-theme", "light");
     script.setAttribute("data-lang", "en");

     /* wait for article to load, append script to article element */
     var observer = new MutationObserver(function (mutations, observer) {
       var article = document.querySelector("d-article");
       if (article) {
         observer.disconnect();
         /* HACK: article scroll */
         article.setAttribute("style", "overflow-y: hidden");
         article.appendChild(script);
       }
     });

     observer.observe(document.body, { childList: true });
   });
 </script>
<script type="text/javascript" src="https://www.cookieconsent.com/releases/3.1.0/cookie-consent.js"></script>
<script type="text/javascript">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
'notice_banner_type':'simple',
'consent_type': 'express',
'palette': 'light',
'language': 'en',
'website_name': 'test2',
'cookies_policy_url': 'url',
'change_preferences_selector':'#CookiePreferences'
});});</script>
<script type="text/plain" cookie-consent="tracking" async src="https://www.googletagmanager.com/gtag/js?id=G-DCC14CYB3V"></script>
<script type="text/plain" cookie-consent="tracking">
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-DCC14CYB3V');
</script>
<!--/radix_placeholder_site_in_header-->
   <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-8J44BR18S7"></script>
  <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-8J44BR18S7');
  </script> 


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Correlation coefficients (1)","description":"Exploration of the differences between different correlation coefficients.","authors":[{"author":"Chris Evans","authorURL":"https://www.psyctc.org/R_blog/","affiliation":"PSYCTC.org","affiliationURL":"https://www.psyctc.org/psyctc/","orcidID":"0000-0002-4197-4202"}],"publishedDate":"2023-12-30T00:00:00.000+00:00","citationText":"Evans, 2023"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="https://www.psyctc.org/Rblog/">
<img src="../../Rblog_logo.png" alt="Logo"/>
</a>
<a href="../../index.html" class="title">Chris (Evans) R SAFAQ</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../Welcome.html">Welcome</a>
<a href="../../about.html">About</a>
<a href="../../Copyright_and_permissions.html">Copyright/permissions</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Correlation coefficients (1)</h1>

<!--radix_placeholder_categories-->
<div class="dt-tags">
  <a href="../../index.html#category:Correlation" class="dt-tag">Correlation</a>
  <a href="../../index.html#category:Null_hypothesis_tests_(NHSTs)" class="dt-tag">Null hypothesis tests (NHSTs)</a>
</div>
<!--/radix_placeholder_categories-->
<p><p>Exploration of the differences between different correlation coefficients.</p></p>
</div>

<div class="d-byline">
  Chris Evans <a href="https://www.psyctc.org/R_blog/" class="uri">https://www.psyctc.org/R_blog/</a> (PSYCTC.org)<a href="https://www.psyctc.org/psyctc/" class="uri">https://www.psyctc.org/psyctc/</a>
  
<br/>2023-12-30
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#what-correlation-coefficients-are-doing" id="toc-what-correlation-coefficients-are-doing">What correlation coefficients are doing</a></li>
<li><a href="#the-scaling-of-our-variables" id="toc-the-scaling-of-our-variables">The scaling of our variables</a></li>
<li><a href="#pearsons-correlation-coefficient" id="toc-pearsons-correlation-coefficient">Pearson’s correlation coefficient</a>
<ul>
<li><a href="#how-does-this-work" id="toc-how-does-this-work">How does this work?</a></li>
<li><a href="#so-we-always-divide-the-sum-of-the-crossproducts-by-n---1-related-to-getting-an-unbiased-estimate-of-a-variance-or-sd" id="toc-so-we-always-divide-the-sum-of-the-crossproducts-by-n---1-related-to-getting-an-unbiased-estimate-of-a-variance-or-sd">So we always divide the sum of the crossproducts by <em>n</em> - 1: related to getting an unbiased estimate of a variance or SD</a></li>
<li><a href="#summarising-the-pearson-correlation-coefficient" id="toc-summarising-the-pearson-correlation-coefficient">Summarising the Pearson correlation coefficient</a></li>
</ul></li>
<li><a href="#rank-correlation" id="toc-rank-correlation">Rank correlation</a>
<ul>
<li><a href="#spearman-rank-correlation-coefficient" id="toc-spearman-rank-correlation-coefficient">Spearman rank correlation coefficient</a></li>
<li><a href="#summarising-the-spearman-correlation-coefficient" id="toc-summarising-the-spearman-correlation-coefficient">Summarising the Spearman correlation coefficient</a></li>
<li><a href="#kendalls-tau-correlation-coefficients-tau" id="toc-kendalls-tau-correlation-coefficients-tau">Kendall’s tau correlation coefficients <span class="math inline">\(\tau\)</span></a></li>
</ul></li>
<li><a href="#but-what-about-ties-why-are-there-multiple-kendall-correlation-coefficients" id="toc-but-what-about-ties-why-are-there-multiple-kendall-correlation-coefficients">But what about ties? Why are there multiple Kendall correlation coefficients?</a>
<ul>
<li><a href="#kendalls-tau-c-correlation-coefficient" id="toc-kendalls-tau-c-correlation-coefficient">Kendall’s tau c correlation coefficient</a></li>
<li><a href="#summarising-kendalls-tau-correlation-coefficients" id="toc-summarising-kendalls-tau-correlation-coefficients">Summarising Kendall’s tau correlation coefficients</a></li>
</ul></li>
<li><a href="#are-the-values-comparable-across-the-different-coefficients-for-the-same-data" id="toc-are-the-values-comparable-across-the-different-coefficients-for-the-same-data">Are the values comparable across the different coefficients for the same data?</a></li>
<li><a href="#effects-of-transformations-of-the-data" id="toc-effects-of-transformations-of-the-data">Effects of transformations of the data</a>
<ul>
<li><a href="#linear-transforms" id="toc-linear-transforms">Linear transforms</a></li>
<li><a href="#non-linear-transforms" id="toc-non-linear-transforms">Non-linear transforms</a></li>
<li><a href="#tie-creating-transforms" id="toc-tie-creating-transforms">Tie creating transforms</a></li>
</ul></li>
<li><a href="#summarising-the-different-correlation-coefficients" id="toc-summarising-the-different-correlation-coefficients">Summarising the different correlation coefficients</a></li>
<li><a href="#conclusions" id="toc-conclusions">Conclusions</a></li>
<li><a href="#history" id="toc-history">History</a>
<ul>
<li><a href="#last-updated" id="toc-last-updated">Last updated</a></li>
</ul></li>
</ul>
</nav>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>### this is just the code that creates the "copy to clipboard" function in the code blocks</span></span>
<span><span class='fu'>htmltools</span><span class='fu'>::</span><span class='fu'><a href='https://rstudio.github.io/htmltools/reference/tagList.html'>tagList</a></span><span class='op'>(</span></span>
<span>  <span class='fu'>xaringanExtra</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/xaringanExtra/man/clipboard.html'>use_clipboard</a></span><span class='op'>(</span></span>
<span>    button_text <span class='op'>=</span> <span class='st'>"&lt;i class=\"fa fa-clone fa-2x\" style=\"color: #301e64\"&gt;&lt;/i&gt;"</span>,</span>
<span>    success_text <span class='op'>=</span> <span class='st'>"&lt;i class=\"fa fa-check fa-2x\" style=\"color: #90BE6D\"&gt;&lt;/i&gt;"</span>,</span>
<span>    error_text <span class='op'>=</span> <span class='st'>"&lt;i class=\"fa fa-times fa-2x\" style=\"color: #F94144\"&gt;&lt;/i&gt;"</span></span>
<span>  <span class='op'>)</span>,</span>
<span>  <span class='fu'>rmarkdown</span><span class='fu'>::</span><span class='fu'><a href='https://pkgs.rstudio.com/rmarkdown/reference/html-dependencies.html'>html_dependency_font_awesome</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
</details>
</div>
<p>At various times in my research career I think I have made use of the Pearson correlation coefficient (often), Spearman ditto (often), Kendall tau b (rarely) and I don’t think I have ever used Kendall’s tau c but I knew it existed but I don’t think I’d ever been able to explain when it was best to use it or why. I don’t think I knew that Kendall’s tau a existed. This is an attempt to get the differences sorted out. However, I am also going to look at:</p>
<ul>
<li>the basics of what these coefficients are doing</li>
<li>how this relates to issues of “scaling” and to Steven’s hierarchy of scaling properties</li>
<li>hence the distinction between rank order correlations and Pearson’s correlation coefficient</li>
<li>comparing values across the different coefficients</li>
<li>effects of transformations of the data on the coefficients</li>
</ul>
<p>Those issues form the bases for the following further issues:</p>
<ul>
<li>issues about “testing” a correlation, technically, testing whether a correlation as strong as, or stronger than, the one seen in the dataset might by unlikely to have arisen in chance sampling of that dataset from a null population model, i.e. p values and the NHST (Null Hypothesis Significance Test) of an observed correlation</li>
<li>how this relates to distributions: in the dataset and in any postulated population from which the dataset came</li>
<li>touching a bit on estimation: the precision with which a correlation from give dataset might estimate a (not necessarily null) population correlation, i.e. finding a confidence interval around an observed correlation value.</li>
</ul>
<p>I picked up those in a separate post: <a href="https://www.psyctc.org/Rblog/posts/2024-01-03-correlations2/">correlations (2)</a> as this was getting long enough already!</p>
<h2 id="what-correlation-coefficients-are-doing">What correlation coefficients are doing</h2>
<p>So why are we computing correlations? Or more technically “why are we computing correlation <em>coefficients</em>?”</p>
<p>This seems obvious: we want to know whether the values of one variable in a dataset seem to be systematically related to the values of another variable. This is going to take us to scaling!</p>
<h2 id="the-scaling-of-our-variables">The scaling of our variables</h2>
<p>If we want to know whether the values of one variable in a dataset seem to be systematically related to the values of another variable we are clearly into questions of scalin and the classic story about scaling, at least in the psychological realm, is Steven’s levels of measurement, keeping things in the house, I hope <a href="https://www.psyctc.org/psyctc/glossary2/ratio-scaling/">this entry</a> in the <a href="https://www.psyctc.org/psyctc/book/glossary/">glossary</a> for Jo-anne’s and my <a href="https://www.psyctc.org/psyctc/book/">OMbook</a>.</p>
<p>Different correlation coefficients depend on different assumptions about the scaling we can believe applicable to our data. Let’s start with the paradigmatic correlation coefficient: Pearson’s coefficient.</p>
<h2 id="pearsons-correlation-coefficient">Pearson’s correlation coefficient</h2>
<p>Let’s start with an example with a tiny dataset to make it easy to show how the various correlation coefficients are calculated.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>12345</span><span class='op'>)</span></span>
<span><span class='va'>totN</span> <span class='op'>&lt;-</span> <span class='fl'>4</span></span>
<span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>totN</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>ID <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/row_number.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>         y <span class='op'>=</span> <span class='va'>x</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>totN</span>, sd <span class='op'>=</span> <span class='fl'>.5</span><span class='op'>)</span>,</span>
<span>         meanX <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,</span>
<span>         meanY <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>,</span>
<span>         sdX <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,</span>
<span>         sdY <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>,</span>
<span>         devX <span class='op'>=</span> <span class='va'>x</span> <span class='op'>-</span> <span class='va'>meanX</span>,</span>
<span>         devY <span class='op'>=</span> <span class='va'>y</span> <span class='op'>-</span> <span class='va'>meanY</span>,</span>
<span>         stdX <span class='op'>=</span> <span class='va'>devX</span> <span class='op'>/</span> <span class='va'>sdX</span>,</span>
<span>         stdY <span class='op'>=</span> <span class='va'>devY</span> <span class='op'>/</span> <span class='va'>sdY</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibDat1N4</span></span>
<span></span>
<span><span class='va'>tibDat1N4</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-4fbe16b2{}.cl-4fb841d8{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-4fbad038{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-4fbad042{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-4fbadf24{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4fbadf2e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4fbadf2f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4fbadf30{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4fbadf38{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-4fbadf39{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-4fbe16b2'><thead><tr style="overflow-wrap:break-word;"><th class="cl-4fbadf24"><p class="cl-4fbad038"><span class="cl-4fb841d8">ID</span></p></th><th class="cl-4fbadf2e"><p class="cl-4fbad042"><span class="cl-4fb841d8">x</span></p></th><th class="cl-4fbadf2e"><p class="cl-4fbad042"><span class="cl-4fb841d8">y</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-4fbadf2f"><p class="cl-4fbad038"><span class="cl-4fb841d8">1</span></p></td><td class="cl-4fbadf30"><p class="cl-4fbad042"><span class="cl-4fb841d8">-0.45</span></p></td><td class="cl-4fbadf30"><p class="cl-4fbad042"><span class="cl-4fb841d8">-0.15</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4fbadf2f"><p class="cl-4fbad038"><span class="cl-4fb841d8">2</span></p></td><td class="cl-4fbadf30"><p class="cl-4fbad042"><span class="cl-4fb841d8">-0.11</span></p></td><td class="cl-4fbadf30"><p class="cl-4fbad042"><span class="cl-4fb841d8">-1.02</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4fbadf2f"><p class="cl-4fbad038"><span class="cl-4fb841d8">3</span></p></td><td class="cl-4fbadf30"><p class="cl-4fbad042"><span class="cl-4fb841d8">0.59</span></p></td><td class="cl-4fbadf30"><p class="cl-4fbad042"><span class="cl-4fb841d8">0.90</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-4fbadf38"><p class="cl-4fbad038"><span class="cl-4fb841d8">4</span></p></td><td class="cl-4fbadf39"><p class="cl-4fbad042"><span class="cl-4fb841d8">0.71</span></p></td><td class="cl-4fbadf39"><p class="cl-4fbad042"><span class="cl-4fb841d8">0.57</span></p></td></tr></tbody></table></div>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>valPearson1N4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>tibDat1N4</span><span class='op'>$</span><span class='va'>x</span>, <span class='va'>tibDat1N4</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span></span></code></pre>
</div>
</details>
</div>
<p>That tiny <em>n</em> = 4 dataset has a Pearson correlation coefficient of
0.74</p>
<p>A scattergram of the data looks like this.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibDat1N4</span>, </span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>meanX</span>, y <span class='op'>=</span> <span class='va'>meanY</span><span class='op'>)</span>,</span>
<span>             shape <span class='op'>=</span> <span class='fl'>23</span>,</span>
<span>             size <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             fill <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>ID</span><span class='op'>)</span>,</span>
<span>            nudge_x <span class='op'>=</span> <span class='fl'>.05</span>,</span>
<span>            nudge_y <span class='op'>=</span> <span class='fl'>.05</span>,</span>
<span>            size <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span>                  ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Scattergram of n = "</span>,</span>
<span>                 <span class='va'>totN</span>,</span>
<span>                 <span class='st'>" dataset, numbered by x values"</span><span class='op'>)</span>,</span>
<span>          subtitle <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Reference lines mark zero on x and y axes"</span>,</span>
<span>                            <span class='st'>"\nRed diamond marks mean for both x and y"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>aspect.ratio <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="correlations_files/figure-html5/plot1n4-1.png" width="1536" /></p>
</div>
<p>We get to the Pearson correlation coefficient in effect by standardising each of the variables, i.e. replacing the scores by their deviation from their mean score and then dividing those deviations by the standard deviation of each variable. For our little dataset that gives us this.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibDat1N4</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-505c1704{}.cl-50570c28{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-50592a12{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-50592a1c{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-505939c6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-505939da{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-505939e4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-505939e5{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-505939ee{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-505939ef{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-505c1704'><thead><tr style="overflow-wrap:break-word;"><th class="cl-505939c6"><p class="cl-50592a12"><span class="cl-50570c28">ID</span></p></th><th class="cl-505939da"><p class="cl-50592a1c"><span class="cl-50570c28">x</span></p></th><th class="cl-505939da"><p class="cl-50592a1c"><span class="cl-50570c28">y</span></p></th><th class="cl-505939da"><p class="cl-50592a1c"><span class="cl-50570c28">meanX</span></p></th><th class="cl-505939da"><p class="cl-50592a1c"><span class="cl-50570c28">meanY</span></p></th><th class="cl-505939da"><p class="cl-50592a1c"><span class="cl-50570c28">sdX</span></p></th><th class="cl-505939da"><p class="cl-50592a1c"><span class="cl-50570c28">sdY</span></p></th><th class="cl-505939da"><p class="cl-50592a1c"><span class="cl-50570c28">devX</span></p></th><th class="cl-505939da"><p class="cl-50592a1c"><span class="cl-50570c28">devY</span></p></th><th class="cl-505939da"><p class="cl-50592a1c"><span class="cl-50570c28">stdX</span></p></th><th class="cl-505939da"><p class="cl-50592a1c"><span class="cl-50570c28">stdY</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-505939e4"><p class="cl-50592a12"><span class="cl-50570c28">1</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">-0.45</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">-0.15</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">0.18</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">0.08</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">0.56</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">0.85</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">-0.64</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">-0.23</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">-1.14</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">-0.27</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-505939e4"><p class="cl-50592a12"><span class="cl-50570c28">2</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">-0.11</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">-1.02</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">0.18</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">0.08</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">0.56</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">0.85</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">-0.29</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">-1.09</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">-0.53</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">-1.29</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-505939e4"><p class="cl-50592a12"><span class="cl-50570c28">3</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">0.59</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">0.90</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">0.18</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">0.08</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">0.56</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">0.85</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">0.40</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">0.82</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">0.72</span></p></td><td class="cl-505939e5"><p class="cl-50592a1c"><span class="cl-50570c28">0.97</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-505939ee"><p class="cl-50592a12"><span class="cl-50570c28">4</span></p></td><td class="cl-505939ef"><p class="cl-50592a1c"><span class="cl-50570c28">0.71</span></p></td><td class="cl-505939ef"><p class="cl-50592a1c"><span class="cl-50570c28">0.57</span></p></td><td class="cl-505939ef"><p class="cl-50592a1c"><span class="cl-50570c28">0.18</span></p></td><td class="cl-505939ef"><p class="cl-50592a1c"><span class="cl-50570c28">0.08</span></p></td><td class="cl-505939ef"><p class="cl-50592a1c"><span class="cl-50570c28">0.56</span></p></td><td class="cl-505939ef"><p class="cl-50592a1c"><span class="cl-50570c28">0.85</span></p></td><td class="cl-505939ef"><p class="cl-50592a1c"><span class="cl-50570c28">0.53</span></p></td><td class="cl-505939ef"><p class="cl-50592a1c"><span class="cl-50570c28">0.50</span></p></td><td class="cl-505939ef"><p class="cl-50592a1c"><span class="cl-50570c28">0.95</span></p></td><td class="cl-505939ef"><p class="cl-50592a1c"><span class="cl-50570c28">0.58</span></p></td></tr></tbody></table></div>
</div>
<p>That shows the mean values for each variable, the deviations of the scores from those means (for each variable) and then the standardised deviations. If we now plot these standardised values we get this.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibDat1N4</span>, </span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>stdX</span>, y <span class='op'>=</span> <span class='va'>stdY</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>0</span>, y <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>             shape <span class='op'>=</span> <span class='fl'>23</span>,</span>
<span>             size <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             fill <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>ID</span><span class='op'>)</span>,</span>
<span>            nudge_x <span class='op'>=</span> <span class='fl'>.05</span>,</span>
<span>            nudge_y <span class='op'>=</span> <span class='fl'>.05</span>,</span>
<span>            size <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1.2</span>, <span class='fl'>1.2</span><span class='op'>)</span>,</span>
<span>                  ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1.2</span>, <span class='fl'>1.2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Scattergram of standardised deviations from mean values"</span>,</span>
<span>          subtitle <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Reference lines mark zero deviations on x and y axes"</span>,</span>
<span>                            <span class='st'>"\nRed diamond marks mean for both x and y which must be zero"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>aspect.ratio <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="correlations_files/figure-html5/plot2n4-1.png" width="1536" /></p>
</div>
<p>One relatively simple way to understand the calculation of the Pearson correlation coefficient is that it starts with the sum of the products of the standardised deviation scores, i.e. of the product of the deviations of the values from their means divided by their standard deviations. This next table shows the deviation data (<em>devX</em> and <em>devY</em>) i.e. the deviations of each of the above scores from the mean for that variable. The next two columns (<em>stdX</em> and <em>stdY</em>) “standardise” these deviations, i.e. dividing those deviations by the standard deviations for each variable. The next column <em>productStdXStdY</em> is the products of those standardised deviations. The sum of these products is shown in the bottom row: 2.23 To get the Pearson correlation this total is divided by a denominator which is the square root of the products of the sums of those deviations (i.e. of <em>stdX</em> and <em>stdY</em> after squaring them) as shown in the last two columns.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibDat1N4</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>productStdXStdY <span class='op'>=</span> <span class='va'>stdX</span> <span class='op'>*</span> <span class='va'>stdY</span>,</span>
<span>         sqStdX <span class='op'>=</span> <span class='va'>stdX</span><span class='op'>^</span><span class='fl'>2</span>,</span>
<span>         sqStdY <span class='op'>=</span> <span class='va'>stdY</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibDat1N4</span></span>
<span></span>
<span><span class='va'>tibDat1N4</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>devX</span> <span class='op'>:</span> <span class='va'>sqStdY</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/across.html'>across</a></span><span class='op'>(</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='va'>sum</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>ID <span class='op'>=</span> <span class='st'>"Sum"</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibSumValues</span></span>
<span></span>
<span><span class='va'>tibDat1N4</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>devX</span> <span class='op'>:</span> <span class='va'>sqStdY</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind_rows.html'>bind_rows</a></span><span class='op'>(</span><span class='va'>tibSumValues</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-50d7bada{}.cl-50d1d49e{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-50d4a52a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-50d4a534{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-50d4b2ae{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-50d4b2b8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-50d4b2c2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-50d4b2c3{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-50d4b2c4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-50d4b2c5{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-50d7bada'><thead><tr style="overflow-wrap:break-word;"><th class="cl-50d4b2ae"><p class="cl-50d4a52a"><span class="cl-50d1d49e">ID</span></p></th><th class="cl-50d4b2b8"><p class="cl-50d4a534"><span class="cl-50d1d49e">devX</span></p></th><th class="cl-50d4b2b8"><p class="cl-50d4a534"><span class="cl-50d1d49e">devY</span></p></th><th class="cl-50d4b2b8"><p class="cl-50d4a534"><span class="cl-50d1d49e">stdX</span></p></th><th class="cl-50d4b2b8"><p class="cl-50d4a534"><span class="cl-50d1d49e">stdY</span></p></th><th class="cl-50d4b2b8"><p class="cl-50d4a534"><span class="cl-50d1d49e">productStdXStdY</span></p></th><th class="cl-50d4b2b8"><p class="cl-50d4a534"><span class="cl-50d1d49e">sqStdX</span></p></th><th class="cl-50d4b2b8"><p class="cl-50d4a534"><span class="cl-50d1d49e">sqStdY</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-50d4b2c2"><p class="cl-50d4a52a"><span class="cl-50d1d49e">1</span></p></td><td class="cl-50d4b2c3"><p class="cl-50d4a534"><span class="cl-50d1d49e">-0.64</span></p></td><td class="cl-50d4b2c3"><p class="cl-50d4a534"><span class="cl-50d1d49e">-0.23</span></p></td><td class="cl-50d4b2c3"><p class="cl-50d4a534"><span class="cl-50d1d49e">-1.14</span></p></td><td class="cl-50d4b2c3"><p class="cl-50d4a534"><span class="cl-50d1d49e">-0.27</span></p></td><td class="cl-50d4b2c3"><p class="cl-50d4a534"><span class="cl-50d1d49e">0.30</span></p></td><td class="cl-50d4b2c3"><p class="cl-50d4a534"><span class="cl-50d1d49e">1.31</span></p></td><td class="cl-50d4b2c3"><p class="cl-50d4a534"><span class="cl-50d1d49e">0.07</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-50d4b2c2"><p class="cl-50d4a52a"><span class="cl-50d1d49e">2</span></p></td><td class="cl-50d4b2c3"><p class="cl-50d4a534"><span class="cl-50d1d49e">-0.29</span></p></td><td class="cl-50d4b2c3"><p class="cl-50d4a534"><span class="cl-50d1d49e">-1.09</span></p></td><td class="cl-50d4b2c3"><p class="cl-50d4a534"><span class="cl-50d1d49e">-0.53</span></p></td><td class="cl-50d4b2c3"><p class="cl-50d4a534"><span class="cl-50d1d49e">-1.29</span></p></td><td class="cl-50d4b2c3"><p class="cl-50d4a534"><span class="cl-50d1d49e">0.67</span></p></td><td class="cl-50d4b2c3"><p class="cl-50d4a534"><span class="cl-50d1d49e">0.28</span></p></td><td class="cl-50d4b2c3"><p class="cl-50d4a534"><span class="cl-50d1d49e">1.65</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-50d4b2c2"><p class="cl-50d4a52a"><span class="cl-50d1d49e">3</span></p></td><td class="cl-50d4b2c3"><p class="cl-50d4a534"><span class="cl-50d1d49e">0.40</span></p></td><td class="cl-50d4b2c3"><p class="cl-50d4a534"><span class="cl-50d1d49e">0.82</span></p></td><td class="cl-50d4b2c3"><p class="cl-50d4a534"><span class="cl-50d1d49e">0.72</span></p></td><td class="cl-50d4b2c3"><p class="cl-50d4a534"><span class="cl-50d1d49e">0.97</span></p></td><td class="cl-50d4b2c3"><p class="cl-50d4a534"><span class="cl-50d1d49e">0.70</span></p></td><td class="cl-50d4b2c3"><p class="cl-50d4a534"><span class="cl-50d1d49e">0.52</span></p></td><td class="cl-50d4b2c3"><p class="cl-50d4a534"><span class="cl-50d1d49e">0.94</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-50d4b2c2"><p class="cl-50d4a52a"><span class="cl-50d1d49e">4</span></p></td><td class="cl-50d4b2c3"><p class="cl-50d4a534"><span class="cl-50d1d49e">0.53</span></p></td><td class="cl-50d4b2c3"><p class="cl-50d4a534"><span class="cl-50d1d49e">0.50</span></p></td><td class="cl-50d4b2c3"><p class="cl-50d4a534"><span class="cl-50d1d49e">0.95</span></p></td><td class="cl-50d4b2c3"><p class="cl-50d4a534"><span class="cl-50d1d49e">0.58</span></p></td><td class="cl-50d4b2c3"><p class="cl-50d4a534"><span class="cl-50d1d49e">0.55</span></p></td><td class="cl-50d4b2c3"><p class="cl-50d4a534"><span class="cl-50d1d49e">0.89</span></p></td><td class="cl-50d4b2c3"><p class="cl-50d4a534"><span class="cl-50d1d49e">0.34</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-50d4b2c4"><p class="cl-50d4a52a"><span class="cl-50d1d49e">Sum</span></p></td><td class="cl-50d4b2c5"><p class="cl-50d4a534"><span class="cl-50d1d49e">0.00</span></p></td><td class="cl-50d4b2c5"><p class="cl-50d4a534"><span class="cl-50d1d49e">0.00</span></p></td><td class="cl-50d4b2c5"><p class="cl-50d4a534"><span class="cl-50d1d49e">0.00</span></p></td><td class="cl-50d4b2c5"><p class="cl-50d4a534"><span class="cl-50d1d49e">0.00</span></p></td><td class="cl-50d4b2c5"><p class="cl-50d4a534"><span class="cl-50d1d49e">2.23</span></p></td><td class="cl-50d4b2c5"><p class="cl-50d4a534"><span class="cl-50d1d49e">3.00</span></p></td><td class="cl-50d4b2c5"><p class="cl-50d4a534"><span class="cl-50d1d49e">3.00</span></p></td></tr></tbody></table></div>
</div>
<p>So the Pearson correlation coefficient here is:</p>
<p><span class="math display">\[ \text{Pearson R}=\frac{\text{2.23}}{3} \]</span></p>
<p>which is the value
0.74 we saw earlier.</p>
<h3 id="how-does-this-work">How does this work?</h3>
<ul>
<li>Taking the deviations from the means for each variable transforms values above that variable’s mean to positive values and values below that mean to negative <em>for each variable</em>.</li>
<li>Multiplying these deviations for the one variable by the one for the other variable (called “getting their crossproduct”) ensures that you have a single new variable that is positive when both deviations are positive <em>and also</em> positive when both are negative so you have an index of agreement: both values above the pertinent mean contribute positively as do pairs where both are below the pertinent mean and <em>vice versa</em>.</li>
<li>Now taking the squares of the deviations and summing them removes any influence of the scale of both variables: this ensures that the possible strongest possible correlation must be 1.0 and the strongest negative correlation must be -1.0.</li>
</ul>
<p>Neat!</p>
<h3 id="so-we-always-divide-the-sum-of-the-crossproducts-by-n---1-related-to-getting-an-unbiased-estimate-of-a-variance-or-sd">So we always divide the sum of the crossproducts by <em>n</em> - 1: related to getting an unbiased estimate of a variance or SD</h3>
<p>You can see this resulted in dividing the sum of the crossproducts by 3 and it will always be dividing <em>n</em> - 1 just because of the arithmetic? Because the sample variance and SD are biased estimates of the population variance and SD and we want a correlation coefficient that is an unbiased estimate of the population correlation coefficient so the divisor is <em>n</em> - 1 not <em>n</em>: the usual and completely robust correction for bias in estimating variances/SDs.</p>
<p>In an earlier version of this post (up to 7.viii.24) I said this gave us an unbiased estimate of the population correlation: not so, sorry. See the wikipedia section for some ways of getting an approximation to an unbiased estimate of the population correlation coefficient: <a href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient#Adjusted_correlation_coefficient" class="uri">https://en.wikipedia.org/wiki/Pearson_correlation_coefficient#Adjusted_correlation_coefficient</a>.</p>
<h3 id="summarising-the-pearson-correlation-coefficient">Summarising the Pearson correlation coefficient</h3>
<ul>
<li>This is the standardised covariance of the two sets of values in the dataset.<br />
</li>
<li>It is bounded by -1 for perfect negative correlation and +1 for perfect positive correlation and is zero if there is no simple correlation.</li>
<li>A zero value does not mean there is no systematic relationship between the two variables, just that there is no simple correlation.</li>
<li>The “standardised” ensures it is independent of the scale of the variables so any linear transform of either or both leaves the correlation unchanged.</li>
<li><strong>The big caveat</strong>: Because it is using the raw values of the data points it implicitly assumes that the scaling of each variable can be meaningfully interpreted as equal interval, i.e. that the a score of say 7 is as much bigger than a score of say 5 than is 12 from 10. Technically this is Stevens’s “interval scaling” and assumes, and permits, all linear transforms. This is clearly true if the variables are count data, however for most scores from questionnaires this is clearly <em>not</em> formally true. Stevens “levels of measurement” mapped failure to have at least interval scaling to an obligation to use non-parametric rather than parametric statistical methods but that was rather confounding the issue of scaling with the issue of distribution. That was understandable as things like the maths of Gaussian “Normal” distributions only really make sense if you have interval scaling. However, Lord’s glorious paper Lord, F. M. (1953). <em>On the statistical treatment of football numbers</em>. The American Psychologist, 8, 750–751, showed that not all parametric tests require more than nominal scaling and to me the issue has always seemed to be about the meanings that we attach to our analyses and to the statistics they give us. Using the Pearson correlation coefficient means that we do believe the raw numbers have some some “soft” or “approximate” interval scaling, and always measured with unreliability, but ignoring the raw numbers and just looking at their rank relationships would be losing some of the scaling that you have in your data. On the other hand we should certainly be cautious and not attribute to our analyses precision that really isn’t there: these are not true interval scales. (I’m deferring the issues about formal NHST p values and/or confidence intervals for now.)</li>
</ul>
<h2 id="rank-correlation">Rank correlation</h2>
<p>If we don’t assume that the raw data have the real or my “soft” interval scaling then analysing the raw scores with Pearson’s correlation coefficient, as it relies on the raw scores and their scaling, makes no sense. However, we can look at rank correlation. A positive Pearson correlation coefficient tells us is how much scores on the one variable are associated with scores on the other assuming at least interval scaling, i.e. weighting by the sizes of the values. By contrast a positive rank correlation coefficient only tells is whether a value ranked higher on one variable is likely to be ranked higher on the other. This brings us to the issue that there are a number of ways of indexing rank correlation each with their own advantages. It will also get us to ranking with ties <em>versus</em> perfect ranking. But first the three rank correlation coefficients most used in the mental health, psychology and therapy realms:</p>
<ul>
<li>Spearman rank correlation coefficient</li>
<li>Kendall’s tau b correlation coefficient</li>
<li>Kendall’s tau c correlation coefficient</li>
</ul>
<h3 id="spearman-rank-correlation-coefficient">Spearman rank correlation coefficient</h3>
<p>This is usually given the Greek letter rho (<span class="math inline">\(\rho\)</span>) or sometimes <span class="math inline">\(R_{s}\)</span> and it is simply the Pearson correlation not of the raw scores but of their ranks (within each variable). Here are our data showing the ranks.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibDat1N4</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>rankX <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,</span>
<span>         rankY <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibDat1N4</span></span>
<span></span>
<span><span class='va'>tibDat1N4</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>x</span>, <span class='va'>y</span>, <span class='va'>rankX</span>, <span class='va'>rankY</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-50f2b6be{}.cl-50ed56a6{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-50ef7d50{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-50ef7d5a{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-50ef8a8e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-50ef8a98{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-50ef8a99{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-50ef8a9a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-50ef8a9b{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-50ef8aa2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-50f2b6be'><thead><tr style="overflow-wrap:break-word;"><th class="cl-50ef8a8e"><p class="cl-50ef7d50"><span class="cl-50ed56a6">ID</span></p></th><th class="cl-50ef8a98"><p class="cl-50ef7d5a"><span class="cl-50ed56a6">x</span></p></th><th class="cl-50ef8a98"><p class="cl-50ef7d5a"><span class="cl-50ed56a6">y</span></p></th><th class="cl-50ef8a98"><p class="cl-50ef7d5a"><span class="cl-50ed56a6">rankX</span></p></th><th class="cl-50ef8a98"><p class="cl-50ef7d5a"><span class="cl-50ed56a6">rankY</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-50ef8a99"><p class="cl-50ef7d50"><span class="cl-50ed56a6">1</span></p></td><td class="cl-50ef8a9a"><p class="cl-50ef7d5a"><span class="cl-50ed56a6">-0.45</span></p></td><td class="cl-50ef8a9a"><p class="cl-50ef7d5a"><span class="cl-50ed56a6">-0.15</span></p></td><td class="cl-50ef8a9a"><p class="cl-50ef7d5a"><span class="cl-50ed56a6">1</span></p></td><td class="cl-50ef8a9a"><p class="cl-50ef7d5a"><span class="cl-50ed56a6">2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-50ef8a99"><p class="cl-50ef7d50"><span class="cl-50ed56a6">2</span></p></td><td class="cl-50ef8a9a"><p class="cl-50ef7d5a"><span class="cl-50ed56a6">-0.11</span></p></td><td class="cl-50ef8a9a"><p class="cl-50ef7d5a"><span class="cl-50ed56a6">-1.02</span></p></td><td class="cl-50ef8a9a"><p class="cl-50ef7d5a"><span class="cl-50ed56a6">2</span></p></td><td class="cl-50ef8a9a"><p class="cl-50ef7d5a"><span class="cl-50ed56a6">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-50ef8a99"><p class="cl-50ef7d50"><span class="cl-50ed56a6">3</span></p></td><td class="cl-50ef8a9a"><p class="cl-50ef7d5a"><span class="cl-50ed56a6">0.59</span></p></td><td class="cl-50ef8a9a"><p class="cl-50ef7d5a"><span class="cl-50ed56a6">0.90</span></p></td><td class="cl-50ef8a9a"><p class="cl-50ef7d5a"><span class="cl-50ed56a6">3</span></p></td><td class="cl-50ef8a9a"><p class="cl-50ef7d5a"><span class="cl-50ed56a6">4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-50ef8a9b"><p class="cl-50ef7d50"><span class="cl-50ed56a6">4</span></p></td><td class="cl-50ef8aa2"><p class="cl-50ef7d5a"><span class="cl-50ed56a6">0.71</span></p></td><td class="cl-50ef8aa2"><p class="cl-50ef7d5a"><span class="cl-50ed56a6">0.57</span></p></td><td class="cl-50ef8aa2"><p class="cl-50ef7d5a"><span class="cl-50ed56a6">4</span></p></td><td class="cl-50ef8aa2"><p class="cl-50ef7d5a"><span class="cl-50ed56a6">3</span></p></td></tr></tbody></table></div>
</div>
<p>Using the Pearson correlation of the ranks ensures a positive correlation if as the values are higher on the one variable they also tend to be higher on the other. However it ignores the sizes of the differences of scores on the raw variables. This trivial code shows that the asking for the Pearson correlation of the rank data gets you exactly the same value as if you ask for the Spearman correlation of the raw data (that calculation will ignore the raw values of course).</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>### get the Spearman correlation by asking for the Pearson correlation of the ranks</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Pearson correlation of the ranks of x and y is:"</span>, <span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span><span class='op'>(</span><span class='st'>"%5.3f"</span>, <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>tibDat1N4</span><span class='op'>$</span><span class='va'>rankX</span>, <span class='va'>tibDat1N4</span><span class='op'>$</span><span class='va'>rankY</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>[1] &quot;Pearson correlation of the ranks of x and y is: 0.600&quot;</code></pre>
</div>
<p>And …</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>### get the Spearman correlation by asking for it to be computed directly from raw data</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Spearman correlation of the raw values is:"</span>, <span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span><span class='op'>(</span><span class='st'>"%5.3f"</span>, <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>tibDat1N4</span><span class='op'>$</span><span class='va'>x</span>, <span class='va'>tibDat1N4</span><span class='op'>$</span><span class='va'>y</span>, method <span class='op'>=</span> <span class='st'>"spearman"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>[1] &quot;Spearman correlation of the raw values is: 0.600&quot;</code></pre>
</div>
<p>The scattergram of the ranks is very simple.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibDat1N4</span>,</span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>rankX</span>, y <span class='op'>=</span> <span class='va'>rankY</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fl'>2.5</span>, y <span class='op'>=</span> <span class='fl'>2.5</span>,</span>
<span>             shape <span class='op'>=</span> <span class='fl'>23</span>,</span>
<span>             size <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             fill <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fl'>2.5</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='fl'>2.5</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>ID</span><span class='op'>)</span>,</span>
<span>            nudge_x <span class='op'>=</span> <span class='fl'>.1</span>,</span>
<span>            nudge_y <span class='op'>=</span> <span class='fl'>.1</span>,</span>
<span>            size <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>4</span><span class='op'>)</span>,</span>
<span>                  ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Scattergram of ranks of values"</span>,</span>
<span>          subtitle <span class='op'>=</span> <span class='st'>"Red diamond and reference line mark mean ranks"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>aspect.ratio <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="correlations_files/figure-html5/Spearman3N4-1.png" width="1536" /></p>
</div>
<p>I think the Spearman correlation coefficient is very easy to understand once someone has been taught about the Pearson correlation coefficient. That perhaps explains why There’s a good <a href="https://en.wikipedia.org/wiki/Spearman%27s_rank_correlation_coefficient">Wikipedia page about the Spearman coefficient</a> if you want more about it but some of that anticipates what I’ll come to after looking at Kendall’s correlation coefficients.</p>
<h3 id="summarising-the-spearman-correlation-coefficient">Summarising the Spearman correlation coefficient</h3>
<ul>
<li>It’s a very simple idea: get the Pearson correlation not of the raw data but of the ranks of the data within each variable.</li>
</ul>
<h3 id="kendalls-tau-correlation-coefficients-tau">Kendall’s tau correlation coefficients <span class="math inline">\(\tau\)</span></h3>
<p>This takes a different approach from that of the Spearman coefficient that involves looking at all possible <em>pairs</em> of points and then at whether they are “concordant” or “discordant”. In a concordant pair both variables in the same rank order and in a discordant pair the variables are ranked in the opposite order. With our tiny dataset of four points there are four distinct pairs of points and their concordance is shown in this table.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibDat1N4</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span></span>
<span></span>
<span><span class='co'>### one way to get all combinations of the IDs</span></span>
<span><span class='fu'><a href='https://tidyr.tidyverse.org/reference/expand_grid.html'>expand_grid</a></span><span class='op'>(</span>ID1 <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span>, ID2 <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>ID2</span> <span class='op'>&gt;</span> <span class='va'>ID1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>ID1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>ID1</span><span class='op'>)</span>,</span>
<span>         ID2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>ID2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='co'>### rename ID1 to ID and pull in the first set of data</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>ID <span class='op'>=</span> <span class='va'>ID1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>tmpTib</span>, by <span class='op'>=</span> <span class='st'>"ID"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>x1 <span class='op'>=</span> <span class='va'>x</span>,</span>
<span>         y1 <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='co'>### rename ID1 back again and then ID2 to ID and pull in the second set of data</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>ID1 <span class='op'>=</span> <span class='va'>ID</span>,</span>
<span>         ID <span class='op'>=</span> <span class='va'>ID2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>tmpTib</span>, by <span class='op'>=</span> <span class='st'>"ID"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>x2 <span class='op'>=</span> <span class='va'>x</span>,</span>
<span>         y2 <span class='op'>=</span> <span class='va'>y</span>,</span>
<span>         ID2 <span class='op'>=</span> <span class='va'>ID</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>pairN <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/row_number.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>pairN</span>, <span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibPairs</span></span>
<span></span>
<span><span class='va'>tibPairs</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>tiedX <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Logic.html'>isTRUE</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/all_equal.html'>all_equal</a></span><span class='op'>(</span><span class='va'>x1</span>, <span class='va'>x2</span><span class='op'>)</span><span class='op'>)</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>         tiedY <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Logic.html'>isTRUE</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/all_equal.html'>all_equal</a></span><span class='op'>(</span><span class='va'>y1</span>, <span class='va'>y2</span><span class='op'>)</span><span class='op'>)</span>, <span class='fl'>1</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>         Concordant <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>x1</span> <span class='op'>&lt;</span> <span class='va'>x2</span> <span class='op'>&amp;</span> <span class='va'>y1</span> <span class='op'>&lt;</span> <span class='va'>y2</span><span class='op'>)</span> <span class='op'>|</span> <span class='op'>(</span><span class='va'>x1</span> <span class='op'>&gt;</span> <span class='va'>x2</span> <span class='op'>&amp;</span> <span class='va'>y1</span> <span class='op'>&gt;</span> <span class='va'>y2</span><span class='op'>)</span>, <span class='st'>"Concordant"</span>, <span class='st'>"Discordant"</span><span class='op'>)</span>,</span>
<span>         Pair <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Pair "</span>, <span class='va'>pairN</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibPairs</span></span>
<span></span>
<span><span class='va'>tibPairs</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>Pair</span>, <span class='va'>ID1</span>, <span class='va'>ID2</span>, <span class='va'>x1</span>, <span class='va'>y1</span>, <span class='va'>x2</span>, <span class='va'>y2</span>, <span class='va'>Concordant</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-517c5cca{}.cl-51767c6a{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-51798590{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-5179859a{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-517993b4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-517993be{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-517993bf{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-517993c0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-517993c1{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-517993c8{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-517c5cca'><thead><tr style="overflow-wrap:break-word;"><th class="cl-517993b4"><p class="cl-51798590"><span class="cl-51767c6a">Pair</span></p></th><th class="cl-517993b4"><p class="cl-51798590"><span class="cl-51767c6a">ID1</span></p></th><th class="cl-517993b4"><p class="cl-51798590"><span class="cl-51767c6a">ID2</span></p></th><th class="cl-517993be"><p class="cl-5179859a"><span class="cl-51767c6a">x1</span></p></th><th class="cl-517993be"><p class="cl-5179859a"><span class="cl-51767c6a">y1</span></p></th><th class="cl-517993be"><p class="cl-5179859a"><span class="cl-51767c6a">x2</span></p></th><th class="cl-517993be"><p class="cl-5179859a"><span class="cl-51767c6a">y2</span></p></th><th class="cl-517993b4"><p class="cl-51798590"><span class="cl-51767c6a">Concordant</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-517993bf"><p class="cl-51798590"><span class="cl-51767c6a">Pair 1</span></p></td><td class="cl-517993bf"><p class="cl-51798590"><span class="cl-51767c6a">1</span></p></td><td class="cl-517993bf"><p class="cl-51798590"><span class="cl-51767c6a">2</span></p></td><td class="cl-517993c0"><p class="cl-5179859a"><span class="cl-51767c6a">-0.45</span></p></td><td class="cl-517993c0"><p class="cl-5179859a"><span class="cl-51767c6a">-0.15</span></p></td><td class="cl-517993c0"><p class="cl-5179859a"><span class="cl-51767c6a">-0.11</span></p></td><td class="cl-517993c0"><p class="cl-5179859a"><span class="cl-51767c6a">-1.02</span></p></td><td class="cl-517993bf"><p class="cl-51798590"><span class="cl-51767c6a">Discordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-517993bf"><p class="cl-51798590"><span class="cl-51767c6a">Pair 2</span></p></td><td class="cl-517993bf"><p class="cl-51798590"><span class="cl-51767c6a">1</span></p></td><td class="cl-517993bf"><p class="cl-51798590"><span class="cl-51767c6a">3</span></p></td><td class="cl-517993c0"><p class="cl-5179859a"><span class="cl-51767c6a">-0.45</span></p></td><td class="cl-517993c0"><p class="cl-5179859a"><span class="cl-51767c6a">-0.15</span></p></td><td class="cl-517993c0"><p class="cl-5179859a"><span class="cl-51767c6a">0.59</span></p></td><td class="cl-517993c0"><p class="cl-5179859a"><span class="cl-51767c6a">0.90</span></p></td><td class="cl-517993bf"><p class="cl-51798590"><span class="cl-51767c6a">Concordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-517993bf"><p class="cl-51798590"><span class="cl-51767c6a">Pair 3</span></p></td><td class="cl-517993bf"><p class="cl-51798590"><span class="cl-51767c6a">1</span></p></td><td class="cl-517993bf"><p class="cl-51798590"><span class="cl-51767c6a">4</span></p></td><td class="cl-517993c0"><p class="cl-5179859a"><span class="cl-51767c6a">-0.45</span></p></td><td class="cl-517993c0"><p class="cl-5179859a"><span class="cl-51767c6a">-0.15</span></p></td><td class="cl-517993c0"><p class="cl-5179859a"><span class="cl-51767c6a">0.71</span></p></td><td class="cl-517993c0"><p class="cl-5179859a"><span class="cl-51767c6a">0.57</span></p></td><td class="cl-517993bf"><p class="cl-51798590"><span class="cl-51767c6a">Concordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-517993bf"><p class="cl-51798590"><span class="cl-51767c6a">Pair 4</span></p></td><td class="cl-517993bf"><p class="cl-51798590"><span class="cl-51767c6a">2</span></p></td><td class="cl-517993bf"><p class="cl-51798590"><span class="cl-51767c6a">3</span></p></td><td class="cl-517993c0"><p class="cl-5179859a"><span class="cl-51767c6a">-0.11</span></p></td><td class="cl-517993c0"><p class="cl-5179859a"><span class="cl-51767c6a">-1.02</span></p></td><td class="cl-517993c0"><p class="cl-5179859a"><span class="cl-51767c6a">0.59</span></p></td><td class="cl-517993c0"><p class="cl-5179859a"><span class="cl-51767c6a">0.90</span></p></td><td class="cl-517993bf"><p class="cl-51798590"><span class="cl-51767c6a">Concordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-517993bf"><p class="cl-51798590"><span class="cl-51767c6a">Pair 5</span></p></td><td class="cl-517993bf"><p class="cl-51798590"><span class="cl-51767c6a">2</span></p></td><td class="cl-517993bf"><p class="cl-51798590"><span class="cl-51767c6a">4</span></p></td><td class="cl-517993c0"><p class="cl-5179859a"><span class="cl-51767c6a">-0.11</span></p></td><td class="cl-517993c0"><p class="cl-5179859a"><span class="cl-51767c6a">-1.02</span></p></td><td class="cl-517993c0"><p class="cl-5179859a"><span class="cl-51767c6a">0.71</span></p></td><td class="cl-517993c0"><p class="cl-5179859a"><span class="cl-51767c6a">0.57</span></p></td><td class="cl-517993bf"><p class="cl-51798590"><span class="cl-51767c6a">Concordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-517993c1"><p class="cl-51798590"><span class="cl-51767c6a">Pair 6</span></p></td><td class="cl-517993c1"><p class="cl-51798590"><span class="cl-51767c6a">3</span></p></td><td class="cl-517993c1"><p class="cl-51798590"><span class="cl-51767c6a">4</span></p></td><td class="cl-517993c8"><p class="cl-5179859a"><span class="cl-51767c6a">0.59</span></p></td><td class="cl-517993c8"><p class="cl-5179859a"><span class="cl-51767c6a">0.90</span></p></td><td class="cl-517993c8"><p class="cl-5179859a"><span class="cl-51767c6a">0.71</span></p></td><td class="cl-517993c8"><p class="cl-5179859a"><span class="cl-51767c6a">0.57</span></p></td><td class="cl-517993c1"><p class="cl-51798590"><span class="cl-51767c6a">Discordant</span></p></td></tr></tbody></table></div>
</div>
<p>If you prefer plots to tables this plot may be easier to understand. It shows the original scattergram of the four points but adds lines marking the six distinct pairs of points and colour codes the lines to show the concordance of the pairs.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibPairs</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>midX <span class='op'>=</span> <span class='va'>x1</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>x2</span> <span class='op'>-</span> <span class='va'>x1</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>4</span>,</span>
<span>         midY <span class='op'>=</span> <span class='va'>y1</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>y2</span> <span class='op'>-</span> <span class='va'>y1</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibPairs</span></span>
<span></span>
<span><span class='va'>vecPairColours</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Concordant"</span> <span class='op'>=</span> <span class='st'>"green"</span>,</span>
<span>                    <span class='st'>"Discordant"</span> <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibPairs</span>,</span>
<span>       <span class='co'>### put the lines in with arrowheads</span></span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='va'>pairN</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x1</span>, xend <span class='op'>=</span> <span class='va'>x2</span>,</span>
<span>                   y <span class='op'>=</span> <span class='va'>y1</span>, yend <span class='op'>=</span> <span class='va'>y2</span>,</span>
<span>                   colour <span class='op'>=</span> <span class='va'>Concordant</span><span class='op'>)</span>,</span>
<span>               arrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/arrow.html'>arrow</a></span><span class='op'>(</span>length <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>.02</span>, <span class='st'>"native"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'>### label the lines</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>midX</span>, y <span class='op'>=</span> <span class='va'>midY</span>, label <span class='op'>=</span> <span class='va'>Pair</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='co'>### now put the points in</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibDat1N4</span>,</span>
<span>             inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibDat1N4</span>,</span>
<span>            inherit.aes <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>            <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, label <span class='op'>=</span> <span class='va'>ID</span><span class='op'>)</span>,</span>
<span>            nudge_x <span class='op'>=</span> <span class='op'>-</span><span class='fl'>.04</span>,</span>
<span>            nudge_y <span class='op'>=</span> <span class='fl'>.03</span>,</span>
<span>            size <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"x"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"y"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_color_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>vecPairColours</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_cartesian.html'>coord_cartesian</a></span><span class='op'>(</span>xlim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span>                  ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Scattergram of points showing their pairs"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>aspect.ratio <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="correlations_files/figure-html5/Kendall2N4-1.png" width="1536" /></p>
</div>
<p>You can see, as you can in the table above, that pair 1 which couples point 1 with point 2 is discordant because the x values increase from point 1 to point 2 but the y values decrease. The same is true for pair 6 but the other four pairs are concordant. The formula for Kendall’s tau (<span class="math inline">\(\tau\)</span>) is</p>
<p><span class="math display">\[ \tau = \frac{\text{(number of concordant pairs)} - \text{(number of discordant pairs)}}{\text{(total number of pairs)}} \]</span></p>
<p>So here that is</p>
<p><span class="math display">\[ \tau = \frac{4 - 2}{6} = .33 \]</span></p>
<p>This formula for <span class="math inline">\(\tau\)</span> nicely ensures that if all pairs are concordant the value is +1 and if all pairs are discordant the value is -1: the behaviour we want of a correlation coefficient. This simple formula is also sometimes called Kendall’s tau a.</p>
<h2 id="but-what-about-ties-why-are-there-multiple-kendall-correlation-coefficients">But what about ties? Why are there multiple Kendall correlation coefficients?</h2>
<p>Where there is perfect ranking, i.e. no ties on either variable, then the Spearman and the Kendall (or Kendall a) coefficients are fine. However, we often have ties in real data and a tied pair of values on either variable can no longer be either concordant or discordant: they are simply tied on one or both variables, this is going to bias Kendall’s tau. There are actually two ways of “correcting” for this and these give us Kendall’s tau b and Kendall’s tau c. The first applies when the likelihood of ties in of the two variables is not markedly different from that for the other variable. The second applies when the likelihood is different which typically arises when one variable has a different range of possible scores from the other variable.</p>
<p>Let’s create some ties in our tiny dataset. I simply duplicated point 1 and called it point 5.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibDat1N4</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/row_number.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>ID <span class='op'>=</span> <span class='st'>"5"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind_rows.html'>bind_rows</a></span><span class='op'>(</span><span class='va'>tibDat1N4</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibDat2N5</span></span>
<span></span>
<span><span class='va'>tibDat2N5</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/autofit.html'>autofit</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-5222ffe4{}.cl-521e4f30{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-52206310{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-52206311{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-52207044{width:0.448in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5220704e{width:0.68in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5220704f{width:0.448in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-52207058{width:0.68in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-52207059{width:0.448in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5220705a{width:0.68in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-5222ffe4'><thead><tr style="overflow-wrap:break-word;"><th class="cl-52207044"><p class="cl-52206310"><span class="cl-521e4f30">ID</span></p></th><th class="cl-5220704e"><p class="cl-52206311"><span class="cl-521e4f30">x</span></p></th><th class="cl-5220704e"><p class="cl-52206311"><span class="cl-521e4f30">y</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-5220704f"><p class="cl-52206310"><span class="cl-521e4f30">5</span></p></td><td class="cl-52207058"><p class="cl-52206311"><span class="cl-521e4f30">-0.45</span></p></td><td class="cl-52207058"><p class="cl-52206311"><span class="cl-521e4f30">-0.15</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5220704f"><p class="cl-52206310"><span class="cl-521e4f30">1</span></p></td><td class="cl-52207058"><p class="cl-52206311"><span class="cl-521e4f30">-0.45</span></p></td><td class="cl-52207058"><p class="cl-52206311"><span class="cl-521e4f30">-0.15</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5220704f"><p class="cl-52206310"><span class="cl-521e4f30">2</span></p></td><td class="cl-52207058"><p class="cl-52206311"><span class="cl-521e4f30">-0.11</span></p></td><td class="cl-52207058"><p class="cl-52206311"><span class="cl-521e4f30">-1.02</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5220704f"><p class="cl-52206310"><span class="cl-521e4f30">3</span></p></td><td class="cl-52207058"><p class="cl-52206311"><span class="cl-521e4f30">0.59</span></p></td><td class="cl-52207058"><p class="cl-52206311"><span class="cl-521e4f30">0.90</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-52207059"><p class="cl-52206310"><span class="cl-521e4f30">4</span></p></td><td class="cl-5220705a"><p class="cl-52206311"><span class="cl-521e4f30">0.71</span></p></td><td class="cl-5220705a"><p class="cl-52206311"><span class="cl-521e4f30">0.57</span></p></td></tr></tbody></table></div>
</div>
<p>Kendall’s tau b is:</p>
<p><span class="math display">\[ \tau b = \frac{\text{(number of concordant pairs)} - \text{(number of discordant pairs)}}{\sqrt{\text{(total number of pairs)}-\text{(number of ties on first variable)}}\sqrt{\text{(total number of pairs)}-\text{(number of ties on second variable)}}} \]</span></p>
<p>Slightly confusingly the number of ties is the number of duplicating values so here when we have one x value that occurs twice, i.e. tied but other three x values are distinct we have one x tie. You might think that we have two ties as we have two x values of -.45 but a moment tells us that’s only one tie. If we had three observations with the same x value they would be two x ties and if the other two x values had also been tied (but different from the first three!) then they would add another one tie and the total number of x ties, i.e. ties on the first variable, would be 3.</p>
<p>The denominator in that equation (the divisor, below the line in the equation) ensures that the coefficient will still be bounded by -1 and +1. Here is the new table of pairs.</p>
<p>Here is the new table of pairs.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibDat2N5</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span></span>
<span><span class='co'>### one way to get all combinations of the IDs</span></span>
<span><span class='fu'><a href='https://tidyr.tidyverse.org/reference/expand_grid.html'>expand_grid</a></span><span class='op'>(</span>ID1 <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>, ID2 <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>ID2</span> <span class='op'>&gt;</span> <span class='va'>ID1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>ID1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>ID1</span><span class='op'>)</span>,</span>
<span>         ID2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>ID2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='co'>### rename ID1 to ID and pull in the first set of data</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>ID <span class='op'>=</span> <span class='va'>ID1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>tmpTib</span>, by <span class='op'>=</span> <span class='st'>"ID"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>x1 <span class='op'>=</span> <span class='va'>x</span>,</span>
<span>         y1 <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='co'>### rename ID1 back again and then ID2 to ID and pull in the second set of data</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>ID1 <span class='op'>=</span> <span class='va'>ID</span>,</span>
<span>         ID <span class='op'>=</span> <span class='va'>ID2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>tmpTib</span>, by <span class='op'>=</span> <span class='st'>"ID"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>x2 <span class='op'>=</span> <span class='va'>x</span>,</span>
<span>         y2 <span class='op'>=</span> <span class='va'>y</span>,</span>
<span>         ID2 <span class='op'>=</span> <span class='va'>ID</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>pairN <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/row_number.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>pairN</span>, <span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibPairs5</span></span>
<span></span>
<span><span class='va'>tibPairs5</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rowwise.html'>rowwise</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>tiedX <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Logic.html'>isTRUE</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>x1</span>, <span class='va'>x2</span><span class='op'>)</span><span class='op'>)</span>, <span class='st'>"tie"</span>, <span class='st'>"not tie"</span><span class='op'>)</span>,</span>
<span>         tiedY <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Logic.html'>isTRUE</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>y1</span>, <span class='va'>y2</span><span class='op'>)</span><span class='op'>)</span>, <span class='st'>"tie"</span>, <span class='st'>"not tie"</span><span class='op'>)</span>,</span>
<span>         Concordant <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>x1</span> <span class='op'>&lt;</span> <span class='va'>x2</span> <span class='op'>&amp;</span> <span class='va'>y1</span> <span class='op'>&lt;</span> <span class='va'>y2</span><span class='op'>)</span> <span class='op'>|</span> <span class='op'>(</span><span class='va'>x1</span> <span class='op'>&gt;</span> <span class='va'>x2</span> <span class='op'>&amp;</span> <span class='va'>y1</span> <span class='op'>&gt;</span> <span class='va'>y2</span><span class='op'>)</span>, <span class='st'>"Concordant"</span>, <span class='st'>"Discordant"</span><span class='op'>)</span>,</span>
<span>         Pair <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Pair "</span>, <span class='va'>pairN</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibPairs5</span></span>
<span></span>
<span></span>
<span><span class='va'>tibPairs5</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>Pair</span>, <span class='va'>ID1</span>, <span class='va'>ID2</span>, <span class='va'>x1</span>, <span class='va'>y1</span>, <span class='va'>x2</span>, <span class='va'>y2</span>, <span class='va'>tiedX</span>, <span class='va'>tiedY</span>, <span class='va'>Concordant</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-524a454a{}.cl-5244a1b2{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-5246eed6{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-5246eeea{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-5246fd86{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5246fd90{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5246fd91{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5246fd9a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5246fd9b{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5246fd9c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-524a454a'><thead><tr style="overflow-wrap:break-word;"><th class="cl-5246fd86"><p class="cl-5246eed6"><span class="cl-5244a1b2">Pair</span></p></th><th class="cl-5246fd86"><p class="cl-5246eed6"><span class="cl-5244a1b2">ID1</span></p></th><th class="cl-5246fd86"><p class="cl-5246eed6"><span class="cl-5244a1b2">ID2</span></p></th><th class="cl-5246fd90"><p class="cl-5246eeea"><span class="cl-5244a1b2">x1</span></p></th><th class="cl-5246fd90"><p class="cl-5246eeea"><span class="cl-5244a1b2">y1</span></p></th><th class="cl-5246fd90"><p class="cl-5246eeea"><span class="cl-5244a1b2">x2</span></p></th><th class="cl-5246fd90"><p class="cl-5246eeea"><span class="cl-5244a1b2">y2</span></p></th><th class="cl-5246fd86"><p class="cl-5246eed6"><span class="cl-5244a1b2">tiedX</span></p></th><th class="cl-5246fd86"><p class="cl-5246eed6"><span class="cl-5244a1b2">tiedY</span></p></th><th class="cl-5246fd86"><p class="cl-5246eed6"><span class="cl-5244a1b2">Concordant</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">Pair 1</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">1</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">2</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">-0.45</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">-0.15</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">-0.11</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">-1.02</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">not tie</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">not tie</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">Discordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">Pair 2</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">1</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">3</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">-0.45</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">-0.15</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">0.59</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">0.90</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">not tie</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">not tie</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">Concordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">Pair 3</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">1</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">4</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">-0.45</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">-0.15</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">0.71</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">0.57</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">not tie</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">not tie</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">Concordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">Pair 4</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">1</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">5</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">-0.45</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">-0.15</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">-0.45</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">-0.15</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">tie</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">tie</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">Discordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">Pair 5</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">2</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">3</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">-0.11</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">-1.02</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">0.59</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">0.90</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">not tie</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">not tie</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">Concordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">Pair 6</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">2</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">4</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">-0.11</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">-1.02</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">0.71</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">0.57</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">not tie</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">not tie</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">Concordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">Pair 7</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">2</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">5</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">-0.11</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">-1.02</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">-0.45</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">-0.15</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">not tie</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">not tie</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">Discordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">Pair 8</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">3</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">4</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">0.59</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">0.90</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">0.71</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">0.57</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">not tie</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">not tie</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">Discordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">Pair 9</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">3</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">5</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">0.59</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">0.90</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">-0.45</span></p></td><td class="cl-5246fd9a"><p class="cl-5246eeea"><span class="cl-5244a1b2">-0.15</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">not tie</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">not tie</span></p></td><td class="cl-5246fd91"><p class="cl-5246eed6"><span class="cl-5244a1b2">Concordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5246fd9b"><p class="cl-5246eed6"><span class="cl-5244a1b2">Pair 10</span></p></td><td class="cl-5246fd9b"><p class="cl-5246eed6"><span class="cl-5244a1b2">4</span></p></td><td class="cl-5246fd9b"><p class="cl-5246eed6"><span class="cl-5244a1b2">5</span></p></td><td class="cl-5246fd9c"><p class="cl-5246eeea"><span class="cl-5244a1b2">0.71</span></p></td><td class="cl-5246fd9c"><p class="cl-5246eeea"><span class="cl-5244a1b2">0.57</span></p></td><td class="cl-5246fd9c"><p class="cl-5246eeea"><span class="cl-5244a1b2">-0.45</span></p></td><td class="cl-5246fd9c"><p class="cl-5246eeea"><span class="cl-5244a1b2">-0.15</span></p></td><td class="cl-5246fd9b"><p class="cl-5246eed6"><span class="cl-5244a1b2">not tie</span></p></td><td class="cl-5246fd9b"><p class="cl-5246eed6"><span class="cl-5244a1b2">not tie</span></p></td><td class="cl-5246fd9b"><p class="cl-5246eed6"><span class="cl-5244a1b2">Concordant</span></p></td></tr></tbody></table></div>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># cor.test(tibDat1N4$x, tibDat1N4$y, method = "kendall")</span></span>
<span><span class='co'># cor.test(tibDat2N5$x, tibDat2N5$y, method = "kendall")</span></span>
<span><span class='co'># </span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='fu'>DescTools</span><span class='fu'>::</span><span class='fu'><a href='https://andrisignorell.github.io/DescTools/reference/KendallTauB.html'>KendallTauB</a></span><span class='op'>(</span><span class='va'>tibDat1N4</span><span class='op'>$</span><span class='va'>x</span>, <span class='va'>tibDat1N4</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>valTauA</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='fu'>DescTools</span><span class='fu'>::</span><span class='fu'><a href='https://andrisignorell.github.io/DescTools/reference/KendallTauB.html'>KendallTauB</a></span><span class='op'>(</span><span class='va'>tibDat2N5</span><span class='op'>$</span><span class='va'>x</span>, <span class='va'>tibDat2N5</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>valTauB</span></span></code></pre>
</div>
</details>
</div>
<p>This gives us a tau b of 0.33, exactly the same as for the four observation dataset without the duplicated row added.</p>
<h3 id="kendalls-tau-c-correlation-coefficient">Kendall’s tau c correlation coefficient</h3>
<p>This is often treated as if it were only a correlation coefficient for a rectangular contingency table with differing numbers of rows (variable 1) from columns (variable 2) but it can be used for any situation in which one or both variables have a limited number of possible values (hence many ties if the dataset isn’t tiny) and where the numbers of possible values for one variable is different from that for the other. Let’s use our five observation dataset to create such a situation.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibDat2N5</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>ID</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>binaryX <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>x</span> <span class='op'>&lt;</span> <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>,</span>
<span>         threeLevelY <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span><span class='va'>y</span> <span class='op'>&lt;</span> <span class='op'>-</span><span class='fl'>1</span> <span class='op'>~</span> <span class='fl'>1</span>,</span>
<span>                                 <span class='va'>y</span> <span class='op'>&gt;=</span> <span class='op'>-</span><span class='fl'>1</span> <span class='op'>&amp;</span> <span class='va'>y</span> <span class='op'>&lt;</span> <span class='fl'>0</span> <span class='op'>~</span> <span class='fl'>2</span>,</span>
<span>                                 <span class='va'>y</span> <span class='op'>&gt;=</span> <span class='fl'>0</span> <span class='op'>~</span> <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>x</span>, <span class='va'>y</span>, <span class='va'>binaryX</span>, <span class='va'>threeLevelY</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibTauC</span></span>
<span></span>
<span><span class='va'>tibTauC</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-532693b0{}.cl-5321b872{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-5323e548{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-5323e552{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-5323f254{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5323f255{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5323f25e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5323f25f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5323f260{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5323f268{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-532693b0'><thead><tr style="overflow-wrap:break-word;"><th class="cl-5323f254"><p class="cl-5323e548"><span class="cl-5321b872">ID</span></p></th><th class="cl-5323f255"><p class="cl-5323e552"><span class="cl-5321b872">x</span></p></th><th class="cl-5323f255"><p class="cl-5323e552"><span class="cl-5321b872">y</span></p></th><th class="cl-5323f255"><p class="cl-5323e552"><span class="cl-5321b872">binaryX</span></p></th><th class="cl-5323f255"><p class="cl-5323e552"><span class="cl-5321b872">threeLevelY</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-5323f25e"><p class="cl-5323e548"><span class="cl-5321b872">1</span></p></td><td class="cl-5323f25f"><p class="cl-5323e552"><span class="cl-5321b872">-0.45</span></p></td><td class="cl-5323f25f"><p class="cl-5323e552"><span class="cl-5321b872">-0.15</span></p></td><td class="cl-5323f25f"><p class="cl-5323e552"><span class="cl-5321b872">0.00</span></p></td><td class="cl-5323f25f"><p class="cl-5323e552"><span class="cl-5321b872">2.00</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5323f25e"><p class="cl-5323e548"><span class="cl-5321b872">2</span></p></td><td class="cl-5323f25f"><p class="cl-5323e552"><span class="cl-5321b872">-0.11</span></p></td><td class="cl-5323f25f"><p class="cl-5323e552"><span class="cl-5321b872">-1.02</span></p></td><td class="cl-5323f25f"><p class="cl-5323e552"><span class="cl-5321b872">0.00</span></p></td><td class="cl-5323f25f"><p class="cl-5323e552"><span class="cl-5321b872">1.00</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5323f25e"><p class="cl-5323e548"><span class="cl-5321b872">3</span></p></td><td class="cl-5323f25f"><p class="cl-5323e552"><span class="cl-5321b872">0.59</span></p></td><td class="cl-5323f25f"><p class="cl-5323e552"><span class="cl-5321b872">0.90</span></p></td><td class="cl-5323f25f"><p class="cl-5323e552"><span class="cl-5321b872">1.00</span></p></td><td class="cl-5323f25f"><p class="cl-5323e552"><span class="cl-5321b872">3.00</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5323f25e"><p class="cl-5323e548"><span class="cl-5321b872">4</span></p></td><td class="cl-5323f25f"><p class="cl-5323e552"><span class="cl-5321b872">0.71</span></p></td><td class="cl-5323f25f"><p class="cl-5323e552"><span class="cl-5321b872">0.57</span></p></td><td class="cl-5323f25f"><p class="cl-5323e552"><span class="cl-5321b872">1.00</span></p></td><td class="cl-5323f25f"><p class="cl-5323e552"><span class="cl-5321b872">3.00</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-5323f260"><p class="cl-5323e548"><span class="cl-5321b872">5</span></p></td><td class="cl-5323f268"><p class="cl-5323e552"><span class="cl-5321b872">-0.45</span></p></td><td class="cl-5323f268"><p class="cl-5323e552"><span class="cl-5321b872">-0.15</span></p></td><td class="cl-5323f268"><p class="cl-5323e552"><span class="cl-5321b872">0.00</span></p></td><td class="cl-5323f268"><p class="cl-5323e552"><span class="cl-5321b872">2.00</span></p></td></tr></tbody></table></div>
</div>
<p>The contingency table from those new variables is this.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibTauC</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>binaryX</span>, </span>
<span>         y <span class='op'>=</span> <span class='va'>threeLevelY</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibTauC</span></span>
<span></span>
<span><span class='va'>tibTauC</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://sfirke.github.io/janitor/reference/tabyl.html'>tabyl</a></span><span class='op'>(</span><span class='va'>y</span>, <span class='va'>x</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-533d2f08{}.cl-53382026{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-533a58a0{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-533a6656{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-533a6660{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-533a666a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-533d2f08'><thead><tr style="overflow-wrap:break-word;"><th class="cl-533a6656"><p class="cl-533a58a0"><span class="cl-53382026">y</span></p></th><th class="cl-533a6656"><p class="cl-533a58a0"><span class="cl-53382026">0</span></p></th><th class="cl-533a6656"><p class="cl-533a58a0"><span class="cl-53382026">1</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-533a6660"><p class="cl-533a58a0"><span class="cl-53382026">1</span></p></td><td class="cl-533a6660"><p class="cl-533a58a0"><span class="cl-53382026">1</span></p></td><td class="cl-533a6660"><p class="cl-533a58a0"><span class="cl-53382026">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-533a6660"><p class="cl-533a58a0"><span class="cl-53382026">2</span></p></td><td class="cl-533a6660"><p class="cl-533a58a0"><span class="cl-53382026">2</span></p></td><td class="cl-533a6660"><p class="cl-533a58a0"><span class="cl-53382026">0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-533a666a"><p class="cl-533a58a0"><span class="cl-53382026">3</span></p></td><td class="cl-533a666a"><p class="cl-533a58a0"><span class="cl-53382026">0</span></p></td><td class="cl-533a666a"><p class="cl-533a58a0"><span class="cl-53382026">2</span></p></td></tr></tbody></table></div>
</div>
<p>The binaryX variable is being counted in column entries and the threeLevelY variable in the rows: we have a 3x2 table. As it happens, all six pairs of values are.</p>
<p>And now the table of pairs of values looks like this.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibTauC</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>ID</span>, <span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span></span>
<span><span class='co'>### one way to get all combinations of the IDs</span></span>
<span><span class='fu'><a href='https://tidyr.tidyverse.org/reference/expand_grid.html'>expand_grid</a></span><span class='op'>(</span>ID1 <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>, ID2 <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>ID2</span> <span class='op'>&gt;</span> <span class='va'>ID1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>ID1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>ID1</span><span class='op'>)</span>,</span>
<span>         ID2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>ID2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='co'>### rename ID1 to ID and pull in the first set of data</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>ID <span class='op'>=</span> <span class='va'>ID1</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>tmpTib</span>, by <span class='op'>=</span> <span class='st'>"ID"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>x1 <span class='op'>=</span> <span class='va'>x</span>,</span>
<span>         y1 <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='co'>### rename ID1 back again and then ID2 to ID and pull in the second set of data</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>ID1 <span class='op'>=</span> <span class='va'>ID</span>,</span>
<span>         ID <span class='op'>=</span> <span class='va'>ID2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>tmpTib</span>, by <span class='op'>=</span> <span class='st'>"ID"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>x2 <span class='op'>=</span> <span class='va'>x</span>,</span>
<span>         y2 <span class='op'>=</span> <span class='va'>y</span>,</span>
<span>         ID2 <span class='op'>=</span> <span class='va'>ID</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>pairN <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/row_number.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>pairN</span>, <span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibPairs5</span></span>
<span></span>
<span><span class='va'>tibPairs5</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rowwise.html'>rowwise</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>tiedX <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Logic.html'>isTRUE</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>x1</span>, <span class='va'>x2</span><span class='op'>)</span><span class='op'>)</span>, <span class='st'>"tie"</span>, <span class='st'>"not tie"</span><span class='op'>)</span>,</span>
<span>         tiedY <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Logic.html'>isTRUE</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>y1</span>, <span class='va'>y2</span><span class='op'>)</span><span class='op'>)</span>, <span class='st'>"tie"</span>, <span class='st'>"not tie"</span><span class='op'>)</span>,</span>
<span>         Concordant <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>x1</span> <span class='op'>&lt;</span> <span class='va'>x2</span> <span class='op'>&amp;</span> <span class='va'>y1</span> <span class='op'>&lt;</span> <span class='va'>y2</span><span class='op'>)</span> <span class='op'>|</span> <span class='op'>(</span><span class='va'>x1</span> <span class='op'>&gt;</span> <span class='va'>x2</span> <span class='op'>&amp;</span> <span class='va'>y1</span> <span class='op'>&gt;</span> <span class='va'>y2</span><span class='op'>)</span>, <span class='st'>"Concordant"</span>, <span class='st'>"Discordant"</span><span class='op'>)</span>,</span>
<span>         Pair <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Pair "</span>, <span class='va'>pairN</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibPairs5</span></span>
<span></span>
<span></span>
<span><span class='va'>tibPairs5</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>Pair</span>, <span class='va'>ID1</span>, <span class='va'>ID2</span>, <span class='va'>x1</span>, <span class='va'>y1</span>, <span class='va'>x2</span>, <span class='va'>y2</span>, <span class='va'>tiedX</span>, <span class='va'>tiedY</span>, <span class='va'>Concordant</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-53d1b146{}.cl-53cc5a2a{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-53ce94de{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-53ce94e8{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-53cea302{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-53cea30c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-53cea316{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-53cea317{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-53cea318{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-53cea319{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-53d1b146'><thead><tr style="overflow-wrap:break-word;"><th class="cl-53cea302"><p class="cl-53ce94de"><span class="cl-53cc5a2a">Pair</span></p></th><th class="cl-53cea302"><p class="cl-53ce94de"><span class="cl-53cc5a2a">ID1</span></p></th><th class="cl-53cea302"><p class="cl-53ce94de"><span class="cl-53cc5a2a">ID2</span></p></th><th class="cl-53cea30c"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">x1</span></p></th><th class="cl-53cea30c"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">y1</span></p></th><th class="cl-53cea30c"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">x2</span></p></th><th class="cl-53cea30c"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">y2</span></p></th><th class="cl-53cea302"><p class="cl-53ce94de"><span class="cl-53cc5a2a">tiedX</span></p></th><th class="cl-53cea302"><p class="cl-53ce94de"><span class="cl-53cc5a2a">tiedY</span></p></th><th class="cl-53cea302"><p class="cl-53ce94de"><span class="cl-53cc5a2a">Concordant</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">Pair 1</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">1</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">2</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">0.00</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">2.00</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">0.00</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">1.00</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">tie</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">not tie</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">Discordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">Pair 2</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">1</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">3</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">0.00</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">2.00</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">1.00</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">3.00</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">not tie</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">not tie</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">Concordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">Pair 3</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">1</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">4</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">0.00</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">2.00</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">1.00</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">3.00</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">not tie</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">not tie</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">Concordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">Pair 4</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">1</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">5</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">0.00</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">2.00</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">0.00</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">2.00</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">tie</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">tie</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">Discordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">Pair 5</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">2</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">3</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">0.00</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">1.00</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">1.00</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">3.00</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">not tie</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">not tie</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">Concordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">Pair 6</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">2</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">4</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">0.00</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">1.00</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">1.00</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">3.00</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">not tie</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">not tie</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">Concordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">Pair 7</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">2</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">5</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">0.00</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">1.00</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">0.00</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">2.00</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">tie</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">not tie</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">Discordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">Pair 8</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">3</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">4</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">1.00</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">3.00</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">1.00</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">3.00</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">tie</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">tie</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">Discordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">Pair 9</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">3</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">5</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">1.00</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">3.00</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">0.00</span></p></td><td class="cl-53cea317"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">2.00</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">not tie</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">not tie</span></p></td><td class="cl-53cea316"><p class="cl-53ce94de"><span class="cl-53cc5a2a">Concordant</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-53cea318"><p class="cl-53ce94de"><span class="cl-53cc5a2a">Pair 10</span></p></td><td class="cl-53cea318"><p class="cl-53ce94de"><span class="cl-53cc5a2a">4</span></p></td><td class="cl-53cea318"><p class="cl-53ce94de"><span class="cl-53cc5a2a">5</span></p></td><td class="cl-53cea319"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">1.00</span></p></td><td class="cl-53cea319"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">3.00</span></p></td><td class="cl-53cea319"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">0.00</span></p></td><td class="cl-53cea319"><p class="cl-53ce94e8"><span class="cl-53cc5a2a">2.00</span></p></td><td class="cl-53cea318"><p class="cl-53ce94de"><span class="cl-53cc5a2a">not tie</span></p></td><td class="cl-53cea318"><p class="cl-53ce94de"><span class="cl-53cc5a2a">not tie</span></p></td><td class="cl-53cea318"><p class="cl-53ce94de"><span class="cl-53cc5a2a">Concordant</span></p></td></tr></tbody></table></div>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>DescTools</span><span class='fu'>::</span><span class='fu'><a href='https://andrisignorell.github.io/DescTools/reference/StuartTauC.html'>StuartTauC</a></span><span class='op'>(</span><span class='va'>tibTauC</span><span class='op'>$</span><span class='va'>x</span>, <span class='va'>tibTauC</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>valTauC</span></span>
<span><span class='fu'>DescTools</span><span class='fu'>::</span><span class='fu'><a href='https://andrisignorell.github.io/DescTools/reference/KendallTauA.html'>KendallTauA</a></span><span class='op'>(</span><span class='va'>tibTauC</span><span class='op'>$</span><span class='va'>x</span>, <span class='va'>tibTauC</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span>  <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>valTauA</span></span>
<span><span class='fu'>DescTools</span><span class='fu'>::</span><span class='fu'><a href='https://andrisignorell.github.io/DescTools/reference/KendallTauB.html'>KendallTauB</a></span><span class='op'>(</span><span class='va'>tibTauC</span><span class='op'>$</span><span class='va'>x</span>, <span class='va'>tibTauC</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>valTauB</span></span></code></pre>
</div>
</details>
</div>
<p>Here the Kendall tau values are:</p>
<ul>
<li>tau a = 0.6: biased down by the ties</li>
<li>tau b = 0.87: effect of ties reduced</li>
<li>tau c = 0.96: ditto</li>
</ul>
<h3 id="summarising-kendalls-tau-correlation-coefficients">Summarising Kendall’s tau correlation coefficients</h3>
<ul>
<li>Kendall’s idea was to get a correlation by using the concordance of the rank relationships of all possible distinct pairs of points in the dataset: perfect corcordance gives a coefficient of +1, perfect discordance gives a coefficient of -1. Equally balanced concordant and discordant correlations give a correlation of zero.</li>
<li>There are three Kendall tau correlation coefficients
<ul>
<li>tau a will produce a low absolute correlation if the data are not perfectly ranked on either or both variables, i.e. if there are ties, I’ve never seen it used.</li>
<li>tau b applies a correction which stops the coefficient being attenuated by ties</li>
<li>tau c applies a different correction which applies a bit better than the tau b correction if there are only a very limited number of possible scores on one or both variables</li>
</ul></li>
</ul>
<h1 id="are-the-values-comparable-across-the-different-coefficients-for-the-same-data">Are the values comparable across the different coefficients for the same data?</h1>
<p>Well why would they be: they’re measuring different things! Well, the Pearson coefficient is clearly measuring a very different aspect of the data from the rank correlation coefficients. You might expect them to be fairly similar or identical but, at least when we have ties in the data, they are deriving their values rather differently so comparability is clearly not going to be simple or perfect.</p>
<p>One thing that is simple is that all the coefficients are bounded at -1 and +1 and those should index perfect negative and positive correlations and for all the coefficients you’d expect 0 to mark the absence of correlation (whether raw value or rank).</p>
<p>Let’s move from our tiny dataset to somewhat larger ones to see how the values of the coefficients compare across samples from defined population models. This shows the results of analysing a sample from the zero correlation model.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>### null model</span></span>
<span><span class='va'>totN</span> <span class='op'>&lt;-</span> <span class='fl'>200</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>12345</span><span class='op'>)</span></span>
<span><span class='va'>startTime</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/proc.time.html'>proc.time</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>ID <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='va'>totN</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>totN</span><span class='op'>)</span>,</span>
<span>         y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>totN</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibNull200</span></span>
<span></span>
<span><span class='va'>tibNull200</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>Pearson <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, method <span class='op'>=</span> <span class='st'>"pearson"</span><span class='op'>)</span>,</span>
<span>            Spearman <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, method <span class='op'>=</span> <span class='st'>"spearman"</span><span class='op'>)</span>,</span>
<span>            KendallB <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, method <span class='op'>=</span> <span class='st'>"kendall"</span><span class='op'>)</span>,</span>
<span>            KendallC <span class='op'>=</span> <span class='fu'>DescTools</span><span class='fu'>::</span><span class='fu'><a href='https://andrisignorell.github.io/DescTools/reference/StuartTauC.html'>StuartTauC</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibCorrsNull</span></span>
<span><span class='va'>stopTime</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/proc.time.html'>proc.time</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='va'>elapsedTime</span> <span class='op'>&lt;-</span> <span class='va'>stopTime</span> <span class='op'>-</span> <span class='va'>startTime</span></span>
<span></span>
<span><span class='va'>tibCorrsNull</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-6c5834ba{}.cl-6c5332bc{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-6c556b04{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6c557734{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6c557735{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-6c5834ba'><thead><tr style="overflow-wrap:break-word;"><th class="cl-6c557734"><p class="cl-6c556b04"><span class="cl-6c5332bc">Pearson</span></p></th><th class="cl-6c557734"><p class="cl-6c556b04"><span class="cl-6c5332bc">Spearman</span></p></th><th class="cl-6c557734"><p class="cl-6c556b04"><span class="cl-6c5332bc">KendallB</span></p></th><th class="cl-6c557734"><p class="cl-6c556b04"><span class="cl-6c5332bc">KendallC</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-6c557735"><p class="cl-6c556b04"><span class="cl-6c5332bc">0.037</span></p></td><td class="cl-6c557735"><p class="cl-6c556b04"><span class="cl-6c5332bc">0.087</span></p></td><td class="cl-6c557735"><p class="cl-6c556b04"><span class="cl-6c5332bc">0.065</span></p></td><td class="cl-6c557735"><p class="cl-6c556b04"><span class="cl-6c5332bc">0.065</span></p></td></tr></tbody></table></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>12345</span><span class='op'>)</span></span>
<span><span class='va'>startTime</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/proc.time.html'>proc.time</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='va'>nTot</span> <span class='op'>&lt;-</span> <span class='fl'>300</span></span>
<span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>popCorr <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>.9</span>, <span class='fl'>.1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rowwise.html'>rowwise</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>tmp <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/holodeck/man/sim_covar.html'>sim_covar</a></span><span class='op'>(</span>n_obs <span class='op'>=</span> <span class='va'>nTot</span>, n_vars <span class='op'>=</span> <span class='fl'>2</span>, var <span class='op'>=</span> <span class='fl'>1</span>, cov <span class='op'>=</span> <span class='va'>popCorr</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/unnest.html'>unnest</a></span><span class='op'>(</span><span class='va'>tmp</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>popCorr</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>obsPearson <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>V1</span>, <span class='va'>V2</span><span class='op'>)</span>,</span>
<span>            obsSpearman <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>V1</span>, <span class='va'>V2</span>, method <span class='op'>=</span> <span class='st'>"spearman"</span><span class='op'>)</span>,</span>
<span>            obsKendall <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>V1</span>, <span class='va'>V2</span>, method <span class='op'>=</span> <span class='st'>"kendall"</span><span class='op'>)</span>,</span>
<span>            obsKendallC <span class='op'>=</span> <span class='fu'>DescTools</span><span class='fu'>::</span><span class='fu'><a href='https://andrisignorell.github.io/DescTools/reference/StuartTauC.html'>StuartTauC</a></span><span class='op'>(</span><span class='va'>V1</span>, <span class='va'>V2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibCorrs</span></span>
<span><span class='va'>stopTime</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/proc.time.html'>proc.time</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='va'>elapsedTime</span> <span class='op'>&lt;-</span> <span class='va'>stopTime</span> <span class='op'>-</span> <span class='va'>startTime</span></span>
<span><span class='va'>elapsedTime</span></span></code></pre>
</div>
</details>
<pre><code>    user   system  elapsed 
2117.406    0.509 2119.244 </code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibCorrs</span></span></code></pre>
</div>
</details>
<pre><code># A tibble: 10 × 5
   popCorr obsPearson obsSpearman obsKendall obsKendallC
     &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;
 1     0       0.0658      0.0538     0.0373      0.0373
 2     0.1     0.0727      0.0706     0.0435      0.0435
 3     0.2     0.216       0.233      0.151       0.151 
 4     0.3     0.276       0.279      0.186       0.186 
 5     0.4     0.357       0.356      0.242       0.242 
 6     0.5     0.483       0.470      0.323       0.323 
 7     0.6     0.592       0.583      0.409       0.409 
 8     0.7     0.737       0.723      0.527       0.527 
 9     0.8     0.809       0.797      0.603       0.603 
10     0.9     0.905       0.897      0.721       0.721 </code></pre>
</div>
<h1 id="effects-of-transformations-of-the-data">Effects of transformations of the data</h1>
<h2 id="linear-transforms">Linear transforms</h2>
<p>This is a trivial demonstration that any linear transform of effective continuous data with no ties doesn’t change any of the coefficient coefficients. The transformations are doubling the y values (“DoubleY”) and doubling the y value and adding a constant, 2, to that value (“DoubleYplus2”). These transformation examples all start with the same raw x and y values and a sample size of 200 sampling from a Gaussian population with means of zero, variances of one and population correlation of .75.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/Aariq/holodeck'>holodeck</a></span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>12345</span><span class='op'>)</span></span>
<span><span class='va'>nTot</span> <span class='op'>&lt;-</span> <span class='fl'>200</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/holodeck/man/sim_covar.html'>sim_covar</a></span><span class='op'>(</span>n_obs <span class='op'>=</span> <span class='va'>nTot</span>, n_vars <span class='op'>=</span> <span class='fl'>2</span>, var <span class='op'>=</span> <span class='fl'>1</span>, cov <span class='op'>=</span> <span class='fl'>.75</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>V1</span>,</span>
<span>         RawY <span class='op'>=</span> <span class='va'>V2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>DoubleY <span class='op'>=</span> <span class='fl'>2</span> <span class='op'>*</span> <span class='va'>RawY</span>,</span>
<span>         DoubleYplus2 <span class='op'>=</span> <span class='va'>DoubleY</span> <span class='op'>+</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span>cols <span class='op'>=</span> <span class='va'>RawY</span> <span class='op'>:</span> <span class='va'>DoubleYplus2</span>, names_to <span class='op'>=</span> <span class='st'>"Transform"</span>, values_to <span class='op'>=</span> <span class='st'>"y"</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibTransforms1</span></span>
<span></span>
<span><span class='va'>tibTransforms1</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>Transform</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>meanX <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,</span>
<span>            meanY <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTibMeans</span></span>
<span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibTransforms1</span>,</span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_grid.html'>facet_grid</a></span><span class='op'>(</span>rows <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/vars.html'>vars</a></span><span class='op'>(</span><span class='va'>Transform</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"lm"</span>,</span>
<span>              colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>              se <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>              linewidth <span class='op'>=</span> <span class='fl'>.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>tmpTibMeans</span><span class='op'>$</span><span class='va'>meanX</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTibMeans</span>,</span>
<span>             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='va'>meanY</span><span class='op'>)</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTibMeans</span>,</span>
<span>             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>meanX</span>, y <span class='op'>=</span> <span class='va'>meanY</span><span class='op'>)</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             fill <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             alpha <span class='op'>=</span> <span class='fl'>.4</span>,</span>
<span>             shape <span class='op'>=</span> <span class='fl'>23</span>,</span>
<span>             size <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>.4</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"lm"</span>,</span>
<span>              colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>              se <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>              linewidth <span class='op'>=</span> <span class='fl'>.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Scattergram illustrating effects of linear transforms on data"</span>,</span>
<span>          subtitle <span class='op'>=</span> <span class='st'>"Dotted reference lines and diamond mark means, solid red lines are linear regression fits"</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="correlations_files/figure-html5/transformations1-1.png" width="1536" /></p>
</div>
<p>I put the linear regression lines in top show that the slopes and intercepts are shifted by the transforms but this next table is what we wanted.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>startTime</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/proc.time.html'>proc.time</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='va'>tibTransforms1</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>Transform</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>obsPearson <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span>,</span>
<span>            obsSpearman <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, method <span class='op'>=</span> <span class='st'>"spearman"</span><span class='op'>)</span>,</span>
<span>            obsKendall <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, method <span class='op'>=</span> <span class='st'>"kendall"</span><span class='op'>)</span>,</span>
<span>            obsKendallC <span class='op'>=</span> <span class='fu'>DescTools</span><span class='fu'>::</span><span class='fu'><a href='https://andrisignorell.github.io/DescTools/reference/StuartTauC.html'>StuartTauC</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibTransformCorrs</span></span>
<span><span class='va'>stopTime</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/proc.time.html'>proc.time</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='va'>elapsedTime</span> <span class='op'>&lt;-</span> <span class='va'>stopTime</span> <span class='op'>-</span> <span class='va'>startTime</span></span>
<span><span class='va'>elapsedTime</span></span></code></pre>
</div>
</details>
<pre><code>   user  system elapsed 
125.897   0.020 125.981 </code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibTransformCorrs</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-a75bbdde{}.cl-a7573a2a{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-a7592eca{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-a7592ed4{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-a7593b36{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a7593b40{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a7593b41{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a7593b4a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a7593b4b{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-a7593b4c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-a75bbdde'><thead><tr style="overflow-wrap:break-word;"><th class="cl-a7593b36"><p class="cl-a7592eca"><span class="cl-a7573a2a">Transform</span></p></th><th class="cl-a7593b40"><p class="cl-a7592ed4"><span class="cl-a7573a2a">obsPearson</span></p></th><th class="cl-a7593b40"><p class="cl-a7592ed4"><span class="cl-a7573a2a">obsSpearman</span></p></th><th class="cl-a7593b40"><p class="cl-a7592ed4"><span class="cl-a7573a2a">obsKendall</span></p></th><th class="cl-a7593b40"><p class="cl-a7592ed4"><span class="cl-a7573a2a">obsKendallC</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-a7593b41"><p class="cl-a7592eca"><span class="cl-a7573a2a">DoubleY</span></p></td><td class="cl-a7593b4a"><p class="cl-a7592ed4"><span class="cl-a7573a2a">0.76</span></p></td><td class="cl-a7593b4a"><p class="cl-a7592ed4"><span class="cl-a7573a2a">0.75</span></p></td><td class="cl-a7593b4a"><p class="cl-a7592ed4"><span class="cl-a7573a2a">0.55</span></p></td><td class="cl-a7593b4a"><p class="cl-a7592ed4"><span class="cl-a7573a2a">0.55</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a7593b41"><p class="cl-a7592eca"><span class="cl-a7573a2a">DoubleYplus2</span></p></td><td class="cl-a7593b4a"><p class="cl-a7592ed4"><span class="cl-a7573a2a">0.76</span></p></td><td class="cl-a7593b4a"><p class="cl-a7592ed4"><span class="cl-a7573a2a">0.75</span></p></td><td class="cl-a7593b4a"><p class="cl-a7592ed4"><span class="cl-a7573a2a">0.55</span></p></td><td class="cl-a7593b4a"><p class="cl-a7592ed4"><span class="cl-a7573a2a">0.55</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-a7593b4b"><p class="cl-a7592eca"><span class="cl-a7573a2a">RawY</span></p></td><td class="cl-a7593b4c"><p class="cl-a7592ed4"><span class="cl-a7573a2a">0.76</span></p></td><td class="cl-a7593b4c"><p class="cl-a7592ed4"><span class="cl-a7573a2a">0.75</span></p></td><td class="cl-a7593b4c"><p class="cl-a7592ed4"><span class="cl-a7573a2a">0.55</span></p></td><td class="cl-a7593b4c"><p class="cl-a7592ed4"><span class="cl-a7573a2a">0.55</span></p></td></tr></tbody></table></div>
</div>
<p>That shows that linear transforms have no effect on any of the coefficient. Linear transforms can’t change the Pearson coefficients as the standardisation of both variables for the Pearson correlation removes any constant and any multiplier of the values. Equally, linear transforms never change the rank order of values so can’t change rank correlation coefficients.</p>
<p>More importantly really, that table shows that where there are no ties and a Gaussian distribution the Pearson and Spearman coefficients are very similar as the effects of outliers are small. It shows that the Kendall tau b and c are essentially identical again as there are no ties. Finally, it shows that the Kendall coefficients are markedly smaller than the Spearman and Pearson. That is a fairly generally finding as the actual index being used to measure rank correlation is really very different between the two methods, the Spearman method effectively looking at differences in ranks where the Kendall methods only look at concordance (or not) of directions of difference between pairs points (pairs of observations) thus losing compressing all differences in ranks to binary “concordant”/“discordant” values.</p>
<h2 id="non-linear-transforms">Non-linear transforms</h2>
<p>Here are a series of monotonic but non-linear transforms: raising the y values to the power 6 or cubing them and taking the logarithm (to base 2) of the y values (all after adding 3 to the y values to make them all positive).</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>12345</span><span class='op'>)</span></span>
<span><span class='va'>nTot</span> <span class='op'>&lt;-</span> <span class='fl'>200</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/holodeck/man/sim_covar.html'>sim_covar</a></span><span class='op'>(</span>n_obs <span class='op'>=</span> <span class='va'>nTot</span>, n_vars <span class='op'>=</span> <span class='fl'>2</span>, var <span class='op'>=</span> <span class='fl'>1</span>, cov <span class='op'>=</span> <span class='fl'>.75</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>V1</span>,</span>
<span>         RawY <span class='op'>=</span> <span class='va'>V2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Pwr6Y <span class='op'>=</span> <span class='op'>(</span><span class='va'>RawY</span> <span class='op'>+</span> <span class='fl'>3</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>6</span>,</span>
<span>         CubeY <span class='op'>=</span> <span class='op'>(</span><span class='va'>RawY</span> <span class='op'>+</span> <span class='fl'>3</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>3</span>,</span>
<span>         Log2Y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>RawY</span> <span class='op'>+</span> <span class='fl'>3</span><span class='op'>)</span>, base <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span>cols <span class='op'>=</span> <span class='va'>RawY</span> <span class='op'>:</span> <span class='va'>Log2Y</span>, names_to <span class='op'>=</span> <span class='st'>"Transform"</span>, values_to <span class='op'>=</span> <span class='st'>"y"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Transform <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>ordered</a></span><span class='op'>(</span><span class='va'>Transform</span>,</span>
<span>                             levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Pwr6Y"</span>,</span>
<span>                                        <span class='st'>"CubeY"</span>,</span>
<span>                                        <span class='st'>"Log2Y"</span>,</span>
<span>                                        <span class='st'>"RawY"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibTransforms2</span></span>
<span></span>
<span><span class='va'>tibTransforms2</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>Transform</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>meanX <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,</span>
<span>            meanY <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTibMeans2</span></span>
<span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibTransforms2</span>,</span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_grid.html'>facet_grid</a></span><span class='op'>(</span>rows <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/vars.html'>vars</a></span><span class='op'>(</span><span class='va'>Transform</span><span class='op'>)</span>,</span>
<span>             scale <span class='op'>=</span> <span class='st'>"free_y"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>tmpTibMeans2</span><span class='op'>$</span><span class='va'>meanX</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTibMeans2</span>,</span>
<span>             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='va'>meanY</span><span class='op'>)</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTibMeans2</span>,</span>
<span>             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>meanX</span>, y <span class='op'>=</span> <span class='va'>meanY</span><span class='op'>)</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             fill <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             alpha <span class='op'>=</span> <span class='fl'>.4</span>,</span>
<span>             shape <span class='op'>=</span> <span class='fl'>23</span>,</span>
<span>             size <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>.4</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>              se <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>              linewidth <span class='op'>=</span> <span class='fl'>.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Scattergram illustrating effects of non-linear transforms on data"</span>,</span>
<span>          subtitle <span class='op'>=</span> <span class='st'>"Dotted reference lines and diamond mark means, solid red lines are non-linear regression fits"</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="correlations_files/figure-html5/transformations3-1.png" width="1536" /></p>
</div>
<p>Here the regression lines are the default loess smoothed regression which help show up that the transforms are not linear.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>startTime</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/proc.time.html'>proc.time</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='va'>tibTransforms2</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>Transform</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>obsPearson <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span>,</span>
<span>            obsSpearman <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, method <span class='op'>=</span> <span class='st'>"spearman"</span><span class='op'>)</span>,</span>
<span>            obsKendall <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, method <span class='op'>=</span> <span class='st'>"kendall"</span><span class='op'>)</span>,</span>
<span>            obsKendallC <span class='op'>=</span> <span class='fu'>DescTools</span><span class='fu'>::</span><span class='fu'><a href='https://andrisignorell.github.io/DescTools/reference/StuartTauC.html'>StuartTauC</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibTransformCorrs2</span></span>
<span><span class='va'>stopTime</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/proc.time.html'>proc.time</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='va'>elapsedTime</span> <span class='op'>&lt;-</span> <span class='va'>stopTime</span> <span class='op'>-</span> <span class='va'>startTime</span></span>
<span><span class='va'>tibTransformCorrs2</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-0bf62a5e{}.cl-0bf18ac6{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-0bf3857e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-0bf38588{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-0bf391e0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0bf391e1{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0bf391ea{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0bf391eb{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0bf391f4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0bf391f5{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-0bf62a5e'><thead><tr style="overflow-wrap:break-word;"><th class="cl-0bf391e0"><p class="cl-0bf3857e"><span class="cl-0bf18ac6">Transform</span></p></th><th class="cl-0bf391e1"><p class="cl-0bf38588"><span class="cl-0bf18ac6">obsPearson</span></p></th><th class="cl-0bf391e1"><p class="cl-0bf38588"><span class="cl-0bf18ac6">obsSpearman</span></p></th><th class="cl-0bf391e1"><p class="cl-0bf38588"><span class="cl-0bf18ac6">obsKendall</span></p></th><th class="cl-0bf391e1"><p class="cl-0bf38588"><span class="cl-0bf18ac6">obsKendallC</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-0bf391ea"><p class="cl-0bf3857e"><span class="cl-0bf18ac6">Pwr6Y</span></p></td><td class="cl-0bf391eb"><p class="cl-0bf38588"><span class="cl-0bf18ac6">0.58</span></p></td><td class="cl-0bf391eb"><p class="cl-0bf38588"><span class="cl-0bf18ac6">0.75</span></p></td><td class="cl-0bf391eb"><p class="cl-0bf38588"><span class="cl-0bf18ac6">0.55</span></p></td><td class="cl-0bf391eb"><p class="cl-0bf38588"><span class="cl-0bf18ac6">0.55</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0bf391ea"><p class="cl-0bf3857e"><span class="cl-0bf18ac6">CubeY</span></p></td><td class="cl-0bf391eb"><p class="cl-0bf38588"><span class="cl-0bf18ac6">0.72</span></p></td><td class="cl-0bf391eb"><p class="cl-0bf38588"><span class="cl-0bf18ac6">0.75</span></p></td><td class="cl-0bf391eb"><p class="cl-0bf38588"><span class="cl-0bf18ac6">0.55</span></p></td><td class="cl-0bf391eb"><p class="cl-0bf38588"><span class="cl-0bf18ac6">0.55</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0bf391ea"><p class="cl-0bf3857e"><span class="cl-0bf18ac6">Log2Y</span></p></td><td class="cl-0bf391eb"><p class="cl-0bf38588"><span class="cl-0bf18ac6">0.75</span></p></td><td class="cl-0bf391eb"><p class="cl-0bf38588"><span class="cl-0bf18ac6">0.75</span></p></td><td class="cl-0bf391eb"><p class="cl-0bf38588"><span class="cl-0bf18ac6">0.55</span></p></td><td class="cl-0bf391eb"><p class="cl-0bf38588"><span class="cl-0bf18ac6">0.55</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-0bf391f4"><p class="cl-0bf3857e"><span class="cl-0bf18ac6">RawY</span></p></td><td class="cl-0bf391f5"><p class="cl-0bf38588"><span class="cl-0bf18ac6">0.76</span></p></td><td class="cl-0bf391f5"><p class="cl-0bf38588"><span class="cl-0bf18ac6">0.75</span></p></td><td class="cl-0bf391f5"><p class="cl-0bf38588"><span class="cl-0bf18ac6">0.55</span></p></td><td class="cl-0bf391f5"><p class="cl-0bf38588"><span class="cl-0bf18ac6">0.55</span></p></td></tr></tbody></table></div>
</div>
<p>That table shows very simply how non-linear transforms change the Pearson correlation but, as these are monotonic transforms, they don’t change the rank correlation coefficients at all.</p>
<h2 id="tie-creating-transforms">Tie creating transforms</h2>
<p>What I have done here is to recode the y variable into a binary, four levels, six, eight and ten levels. All splits are approximately equal in size of the tie groups they create, i.e. the binary split the data approximately half/half and the ten level into tie groups each containing about 10% of the data.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>12345</span><span class='op'>)</span></span>
<span><span class='va'>nTot</span> <span class='op'>&lt;-</span> <span class='fl'>200</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/holodeck/man/sim_covar.html'>sim_covar</a></span><span class='op'>(</span>n_obs <span class='op'>=</span> <span class='va'>nTot</span>, n_vars <span class='op'>=</span> <span class='fl'>2</span>, var <span class='op'>=</span> <span class='fl'>1</span>, cov <span class='op'>=</span> <span class='fl'>.75</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>V1</span>,</span>
<span>         RawY <span class='op'>=</span> <span class='va'>V2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>bucket02Y <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/ntile.html'>ntile</a></span><span class='op'>(</span><span class='va'>RawY</span>, n <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>,</span>
<span>         bucket04Y <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/ntile.html'>ntile</a></span><span class='op'>(</span><span class='va'>RawY</span>, n <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span>,</span>
<span>         bucket06Y <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/ntile.html'>ntile</a></span><span class='op'>(</span><span class='va'>RawY</span>, n <span class='op'>=</span> <span class='fl'>6</span><span class='op'>)</span>,</span>
<span>         bucket08Y <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/ntile.html'>ntile</a></span><span class='op'>(</span><span class='va'>RawY</span>, n <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span>,</span>
<span>         bucket10Y <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/ntile.html'>ntile</a></span><span class='op'>(</span><span class='va'>RawY</span>, n <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span>cols <span class='op'>=</span> <span class='va'>RawY</span> <span class='op'>:</span> <span class='va'>bucket10Y</span>, names_to <span class='op'>=</span> <span class='st'>"Transform"</span>, values_to <span class='op'>=</span> <span class='st'>"y"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Transform <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>ordered</a></span><span class='op'>(</span><span class='va'>Transform</span>,</span>
<span>                             levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"bucket02Y"</span>,</span>
<span>                                        <span class='st'>"bucket04Y"</span>,</span>
<span>                                        <span class='st'>"bucket06Y"</span>,</span>
<span>                                        <span class='st'>"bucket08Y"</span>,</span>
<span>                                        <span class='st'>"bucket10Y"</span>,</span>
<span>                                        <span class='st'>"RawY"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibTransforms3</span></span>
<span></span>
<span><span class='va'>tibTransforms3</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>Transform</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>meanX <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,</span>
<span>            meanY <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTibMeans3</span></span>
<span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibTransforms3</span>,</span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_grid.html'>facet_grid</a></span><span class='op'>(</span>rows <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/vars.html'>vars</a></span><span class='op'>(</span><span class='va'>Transform</span><span class='op'>)</span>,</span>
<span>             scale <span class='op'>=</span> <span class='st'>"free_y"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>tmpTibMeans3</span><span class='op'>$</span><span class='va'>meanX</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTibMeans3</span>,</span>
<span>             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='va'>meanY</span><span class='op'>)</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             linetype <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span>  </span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTibMeans3</span>,</span>
<span>             <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>meanX</span>, y <span class='op'>=</span> <span class='va'>meanY</span><span class='op'>)</span>,</span>
<span>             colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             fill <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             alpha <span class='op'>=</span> <span class='fl'>.4</span>,</span>
<span>             shape <span class='op'>=</span> <span class='fl'>23</span>,</span>
<span>             size <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>.4</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>              se <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>              linewidth <span class='op'>=</span> <span class='fl'>.5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Scattergram illustrating effects of transforms creating ties in the y data"</span>,</span>
<span>          subtitle <span class='op'>=</span> <span class='st'>"Dotted reference lines and diamond mark means, solid red lines are non-linear regression fits"</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="correlations_files/figure-html5/transformations5-1.png" width="1536" /></p>
</div>
<p>The non-linear smoothed regression lines are a bit silly but perhaps help convey the impacts of the reduction in numbers of values.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>startTime</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/proc.time.html'>proc.time</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='va'>tibTransforms3</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>Transform</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>obsPearson <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span>,</span>
<span>            obsSpearman <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, method <span class='op'>=</span> <span class='st'>"spearman"</span><span class='op'>)</span>,</span>
<span>            obsKendall <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, method <span class='op'>=</span> <span class='st'>"kendall"</span><span class='op'>)</span>,</span>
<span>            obsKendallC <span class='op'>=</span> <span class='fu'>DescTools</span><span class='fu'>::</span><span class='fu'><a href='https://andrisignorell.github.io/DescTools/reference/StuartTauC.html'>StuartTauC</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibTransformCorrs3</span></span>
<span><span class='va'>stopTime</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/proc.time.html'>proc.time</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='va'>elapsedTime</span> <span class='op'>&lt;-</span> <span class='va'>stopTime</span> <span class='op'>-</span> <span class='va'>startTime</span></span>
<span><span class='va'>tibTransformCorrs3</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-26618384{}.cl-265c01b6{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-265ed81e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-265ed828{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-265ee674{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-265ee67e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-265ee67f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-265ee680{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-265ee688{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-265ee689{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-26618384'><thead><tr style="overflow-wrap:break-word;"><th class="cl-265ee674"><p class="cl-265ed81e"><span class="cl-265c01b6">Transform</span></p></th><th class="cl-265ee67e"><p class="cl-265ed828"><span class="cl-265c01b6">obsPearson</span></p></th><th class="cl-265ee67e"><p class="cl-265ed828"><span class="cl-265c01b6">obsSpearman</span></p></th><th class="cl-265ee67e"><p class="cl-265ed828"><span class="cl-265c01b6">obsKendall</span></p></th><th class="cl-265ee67e"><p class="cl-265ed828"><span class="cl-265c01b6">obsKendallC</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-265ee67f"><p class="cl-265ed81e"><span class="cl-265c01b6">bucket02Y</span></p></td><td class="cl-265ee680"><p class="cl-265ed828"><span class="cl-265c01b6">0.59</span></p></td><td class="cl-265ee680"><p class="cl-265ed828"><span class="cl-265c01b6">0.60</span></p></td><td class="cl-265ee680"><p class="cl-265ed828"><span class="cl-265c01b6">0.49</span></p></td><td class="cl-265ee680"><p class="cl-265ed828"><span class="cl-265c01b6">0.69</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-265ee67f"><p class="cl-265ed81e"><span class="cl-265c01b6">bucket04Y</span></p></td><td class="cl-265ee680"><p class="cl-265ed828"><span class="cl-265c01b6">0.71</span></p></td><td class="cl-265ee680"><p class="cl-265ed828"><span class="cl-265c01b6">0.71</span></p></td><td class="cl-265ee680"><p class="cl-265ed828"><span class="cl-265c01b6">0.57</span></p></td><td class="cl-265ee680"><p class="cl-265ed828"><span class="cl-265c01b6">0.65</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-265ee67f"><p class="cl-265ed81e"><span class="cl-265c01b6">bucket06Y</span></p></td><td class="cl-265ee680"><p class="cl-265ed828"><span class="cl-265c01b6">0.73</span></p></td><td class="cl-265ee680"><p class="cl-265ed828"><span class="cl-265c01b6">0.74</span></p></td><td class="cl-265ee680"><p class="cl-265ed828"><span class="cl-265c01b6">0.58</span></p></td><td class="cl-265ee680"><p class="cl-265ed828"><span class="cl-265c01b6">0.63</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-265ee67f"><p class="cl-265ed81e"><span class="cl-265c01b6">bucket08Y</span></p></td><td class="cl-265ee680"><p class="cl-265ed828"><span class="cl-265c01b6">0.74</span></p></td><td class="cl-265ee680"><p class="cl-265ed828"><span class="cl-265c01b6">0.74</span></p></td><td class="cl-265ee680"><p class="cl-265ed828"><span class="cl-265c01b6">0.57</span></p></td><td class="cl-265ee680"><p class="cl-265ed828"><span class="cl-265c01b6">0.60</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-265ee67f"><p class="cl-265ed81e"><span class="cl-265c01b6">bucket10Y</span></p></td><td class="cl-265ee680"><p class="cl-265ed828"><span class="cl-265c01b6">0.74</span></p></td><td class="cl-265ee680"><p class="cl-265ed828"><span class="cl-265c01b6">0.74</span></p></td><td class="cl-265ee680"><p class="cl-265ed828"><span class="cl-265c01b6">0.56</span></p></td><td class="cl-265ee680"><p class="cl-265ed828"><span class="cl-265c01b6">0.59</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-265ee688"><p class="cl-265ed81e"><span class="cl-265c01b6">RawY</span></p></td><td class="cl-265ee689"><p class="cl-265ed828"><span class="cl-265c01b6">0.76</span></p></td><td class="cl-265ee689"><p class="cl-265ed828"><span class="cl-265c01b6">0.75</span></p></td><td class="cl-265ee689"><p class="cl-265ed828"><span class="cl-265c01b6">0.55</span></p></td><td class="cl-265ee689"><p class="cl-265ed828"><span class="cl-265c01b6">0.55</span></p></td></tr></tbody></table></div>
</div>
<p>That table shows how reducing the number of possible scores attenuates the Pearson coefficient and quite markedly when the scores are reduced to a dichotomy. That’s the classic issue that Cohen described so clearly in Cohen, J. (1983). The cost of dichotomization. Applied Psychological Measurement, 7, 249–253. There is an almost identical impact on the Spearman coefficient as the sizes of the possible rank differences are dropping with the decreasing numbers of possible scores. The Kendall tau b coefficient hardly changes until it drops markedly for the dichotomised scores. By contrast Kendall’s tau actually increases a bit with the decreasing numbers of possible scores as the correction for the effects of ties it uses is particularly strong when the number of possible scores drops to just two (in either or both of the variables though only on the y variable here).</p>
<h1 id="summarising-the-different-correlation-coefficients">Summarising the different correlation coefficients</h1>
<p><strong>Naming the two types</strong>: we have two fundamentally different sorts of correlation coefficients: the Pearson correlation which uses raw data and, really, three rank correlation coefficients: Spearman’s and Kendall’s tau b and tau c. These are often referred to as a parametric and three non-parametric correlation coefficients and that makes some sense, more on that below, but it’s really about a null hypothesis testing of the coefficients so I think it’s better to call them “Pearson’s” and then “the rank correlation coefficient x” where “x” is one of those three. That grounds things in what matters.</p>
<p><strong>Bounds/range</strong>: all share the desirable property that they can range from -1 to +1 and those bounds mark perfect negative and positive correlations and their zero values mark the absence of correlation.</p>
<p>However, they are measuring different things and even the three rank correlation coefficients are measuring different things so, beyond the shared meanings of -1, 0 and +1 there is no direct comparability of values across the four.</p>
<p>Another point of difference between the coefficients is in the effects of non-linear transformations and particularly of discretisation affect one or both variables.</p>
<h1 id="conclusions">Conclusions</h1>
<ul>
<li>Though all these correlation coefficients share the bounds of -1 and +1 and that a zero value indicates no correlation (by the method chosen) they are not otherwise comparable.<br />
</li>
<li>Non-linear transformations of one or both variables (including discretisation) can have marked impacts on Pearson correlation values and, by implication, if the scaling of one or both variables is not additive/linear Pearson correlations will change if a different scaling is imposed. As our rating variables are probably not additive/linear, or at least, we really have almost no ways to show they are, we should be cautious about treating them as overly precise indicators of any correlations in our data.</li>
<li>The rank correlation coefficients don’t have this issue but are not simply equivalents for the Pearson. However, if the variables are near continuous and have few or no ties then the Spearman coefficient is generally not radically dissimilar to the Pearson for the same data.</li>
<li>However, as the number of possible scores drops there is an argument that one of Kendall’s tau b or c coefficients become better measures as their values are less affected by differences in numbers of possible scores, and hence numbers of ties.</li>
<li>Where the numbers of possible scores gets very low (single figures or low single figures), Kendall’s tau c arguably resists attenuation better than Kendall’s tau b.</li>
<li>All this leads into questions about significance testing correlation coefficients and into estimation: putting confidence intervals around observed coefficients but those are for one or two further posts …</li>
<li>… and they will take us back to the ever crucial question of what we are doing when using correlation coefficents, what questions are we trying to explore with the coefficients.</li>
</ul>
<center>
Visit count
</center>
<center>
<div id="sfcf6nkxgdxp8248lmh6yza2p5m9lx971s8">

</div>
<script type="text/javascript" src="https://counter11.optistats.ovh/private/counter.js?c=f6nkxgdxp8248lmh6yza2p5m9lx971s8&down=async" async></script>
<br><a href="https://www.freecounterstat.com">website hits counter</a><noscript><a href="https://www.freecounterstat.com" title="website hits counter"><img src="https://counter11.optistats.ovh/private/freecounterstat.php?c=f6nkxgdxp8248lmh6yza2p5m9lx971s8" border="0" title="website hits counter" alt="website hits counter"></a></noscript>
</div>
</center>
<h1 id="history">History</h1>
<ul>
<li>30.xii.23: created</li>
<li>7.viii.24: corrected “variances” to “SDs” in denominator of the Pearson coefficient</li>
<li>8.viii.24: improved the headings to map more sensibly to the <a href="https://www.psyctc.org/psyctc/glossary2/pearson-correlation-coefficient/">entry for the Pearson coefficient</a> in <a href="https://www.psyctc.org/psyctc/book/glossary/">my glossary</a> for Jo-anne’s and my <a href="https://www.psyctc.org/psyctc/book/">OMbook</a>.</li>
</ul>
<h2 class="appendix" id="last-updated">Last updated</h2>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='st'>"%d/%m/%Y"</span><span class='op'>)</span>, <span class='st'>"at"</span>, <span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='st'>"%H:%M"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>07/04/2024 at 19:56</code></pre>
</div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Evans (2023, Dec. 30). Chris (Evans) R SAFAQ: Correlation coefficients (1). Retrieved from https://www.psyctc.org/R_blog/posts/2023-12-30-correlations/</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@misc{evans2023correlation,
  author = {Evans, Chris},
  title = {Chris (Evans) R SAFAQ: Correlation coefficients (1)},
  url = {https://www.psyctc.org/R_blog/posts/2023-12-30-correlations/},
  year = {2023}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
