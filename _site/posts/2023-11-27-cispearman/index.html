<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
<title>Chris (Evans) R SAFAQ: Confidence interval around Spearman correlation coefficient</title>

<meta property="description" itemprop="description" content="Explores four methods of estimating a CI around an observed Spearman correlation."/>

<link rel="canonical" href="https://www.psyctc.org/R_blog/posts/2023-11-27-cispearman/"/>
<link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"/>
<link rel="icon" type="image/png" href="../../Rblog_logo.png"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2023-11-27"/>
<meta property="article:created" itemprop="dateCreated" content="2023-11-27"/>
<meta name="article:author" content="Chris Evans"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Chris (Evans) R SAFAQ: Confidence interval around Spearman correlation coefficient"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Explores four methods of estimating a CI around an observed Spearman correlation."/>
<meta property="og:url" content="https://www.psyctc.org/R_blog/posts/2023-11-27-cispearman/"/>
<meta property="og:image" content="https://www.psyctc.org/R_blog/posts/2023-11-27-cispearman/cispearman_files/figure-html5/plot1-1.png"/>
<meta property="og:image:width" content="1248"/>
<meta property="og:image:height" content="1344"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Chris (Evans) R SAFAQ"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="Chris (Evans) R SAFAQ: Confidence interval around Spearman correlation coefficient"/>
<meta property="twitter:description" content="Explores four methods of estimating a CI around an observed Spearman correlation."/>
<meta property="twitter:url" content="https://www.psyctc.org/R_blog/posts/2023-11-27-cispearman/"/>
<meta property="twitter:image" content="https://www.psyctc.org/R_blog/posts/2023-11-27-cispearman/cispearman_files/figure-html5/plot1-1.png"/>
<meta property="twitter:image:width" content="1248"/>
<meta property="twitter:image:height" content="1344"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="Chris (Evans) R SAFAQ: Confidence interval around Spearman correlation coefficient"/>
<meta name="citation_fulltext_html_url" content="https://www.psyctc.org/R_blog/posts/2023-11-27-cispearman/"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2023/11/27"/>
<meta name="citation_publication_date" content="2023/11/27"/>
<meta name="citation_author" content="Chris Evans"/>
<meta name="citation_author_institution" content="PSYCTC.org"/>
<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","categories","output","creative_commons","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["Confidence interval around Spearman correlation coefficient"]},{"type":"character","attributes":{},"value":["Explores four methods of estimating a CI around an observed Spearman correlation."]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation","affiliation_url","orcid_id"]}},"value":[{"type":"character","attributes":{},"value":["Chris Evans"]},{"type":"character","attributes":{},"value":["https://www.psyctc.org/R_blog/"]},{"type":"character","attributes":{},"value":["PSYCTC.org"]},{"type":"character","attributes":{},"value":["https://www.psyctc.org/psyctc/"]},{"type":"character","attributes":{},"value":["0000-0002-4197-4202"]}]}]},{"type":"character","attributes":{},"value":["2023-11-27"]},{"type":"character","attributes":{},"value":["CECPfuns package","Correlation","Confidence intervals","Non-parametric statistics","Rank methods"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","toc_depth","hightlight_downlit","self_contained","code_folding","includes"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[4]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["in_header"]}},"value":[{"type":"character","attributes":{},"value":["../../Gurgle.Rhtml"]}]}]}]},{"type":"character","attributes":{},"value":["CC BY-SA"]},{"type":"character","attributes":{},"value":["https://www.psyctc.org/R_blog/posts/2023-11-27-cispearman/"]},{"type":"character","attributes":{},"value":["https://www.psyctc.org/R_blog/posts/2023-11-27-cispearman/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["cispearman_files/anchor-4.2.2/anchor.min.js","cispearman_files/bowser-1.9.3/bowser.min.js","cispearman_files/distill-2.2.21/template.v2.js","cispearman_files/figure-html5/plot1-1.png","cispearman_files/figure-html5/plot2-1.png","cispearman_files/figure-html5/plot3-1.png","cispearman_files/figure-html5/plot4-1.png","cispearman_files/header-attrs-2.25/header-attrs.js","cispearman_files/jquery-3.6.0/jquery-3.6.0.js","cispearman_files/jquery-3.6.0/jquery-3.6.0.min.js","cispearman_files/jquery-3.6.0/jquery-3.6.0.min.map","cispearman_files/popper-2.6.0/popper.min.js","cispearman_files/tabwid-1.1.3/tabwid.css","cispearman_files/tabwid-1.1.3/tabwid.js","cispearman_files/tippy-6.2.7/tippy-bundle.umd.min.js","cispearman_files/tippy-6.2.7/tippy-light-border.css","cispearman_files/tippy-6.2.7/tippy.css","cispearman_files/tippy-6.2.7/tippy.umd.min.js","cispearman_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */
@import url('https://fonts.googleapis.com/css2?family=Amiri');
@import url('https://fonts.googleapis.com/css2?family=Bitter');
@import url('https://fonts.googleapis.com/css2?family=DM+Mono');


html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8); 
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  --background-color: #ffff99;
  --bkgd-color: #ffff99;
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       "DM Mono", monospace;
  --body-font:       "Bitter", sans-serif;
  --navbar-font:     "Amiri", serif;
}

body {
  background-color: #ffff99;
  bkgd-color: #ffff99;
}

p {
  background-color: #ffff99;
  bkgd-color: #ffff99;
}


/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
.d-article{
  background-color: #ffff99;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.25/header-attrs.js"></script>
  <link href="../../site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
  <script src="../../site_libs/tabwid-1.1.3/tabwid.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<script>
   document.addEventListener("DOMContentLoaded", function () {
     if (!/posts/.test(location.pathname)) {
       return;
     }

     var script = document.createElement("script");
     script.src = "https://giscus.app/client.js";
     script.setAttribute("data-repo", "cpsyctc/Rblog");
     script.setAttribute("data-repo-id", "MDEwOlJlcG9zaXRvcnkzMzM1Mzg4OTA=");
     script.setAttribute("data-category", "General");
     script.setAttribute("data-category-id", "DIC_kwDOE-FmSs4CYdgN");
     script.setAttribute("data-mapping", "pathname");
     script.setAttribute("data-reactions-enabled", "0");
     script.setAttribute("data-emit-metadata", "0");
     script.setAttribute("data-theme", "light");
     script.setAttribute("data-lang", "en");

     /* wait for article to load, append script to article element */
     var observer = new MutationObserver(function (mutations, observer) {
       var article = document.querySelector("d-article");
       if (article) {
         observer.disconnect();
         /* HACK: article scroll */
         article.setAttribute("style", "overflow-y: hidden");
         article.appendChild(script);
       }
     });

     observer.observe(document.body, { childList: true });
   });
 </script>
<script type="text/javascript" src="https://www.cookieconsent.com/releases/3.1.0/cookie-consent.js"></script>
<script type="text/javascript">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
'notice_banner_type':'simple',
'consent_type': 'express',
'palette': 'light',
'language': 'en',
'website_name': 'test2',
'cookies_policy_url': 'url',
'change_preferences_selector':'#CookiePreferences'
});});</script>
<script type="text/plain" cookie-consent="tracking" async src="https://www.googletagmanager.com/gtag/js?id=G-DCC14CYB3V"></script>
<script type="text/plain" cookie-consent="tracking">
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-DCC14CYB3V');
</script>
<!--/radix_placeholder_site_in_header-->
   <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-8J44BR18S7"></script>
  <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-8J44BR18S7');
  </script> 


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Confidence interval around Spearman correlation coefficient","description":"Explores four methods of estimating a CI around an observed Spearman correlation.","authors":[{"author":"Chris Evans","authorURL":"https://www.psyctc.org/R_blog/","affiliation":"PSYCTC.org","affiliationURL":"https://www.psyctc.org/psyctc/","orcidID":"0000-0002-4197-4202"}],"publishedDate":"2023-11-27T00:00:00.000+01:00","citationText":"Evans, 2023"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="https://www.psyctc.org/Rblog/">
<img src="../../Rblog_logo.png" alt="Logo"/>
</a>
<a href="../../index.html" class="title">Chris (Evans) R SAFAQ</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../Welcome.html">Welcome</a>
<a href="../../about.html">About</a>
<a href="../../Copyright_and_permissions.html">Copyright/permissions</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Confidence interval around Spearman correlation coefficient</h1>

<!--radix_placeholder_categories-->
<div class="dt-tags">
  <a href="../../index.html#category:CECPfuns_package" class="dt-tag">CECPfuns package</a>
  <a href="../../index.html#category:Correlation" class="dt-tag">Correlation</a>
  <a href="../../index.html#category:Confidence_intervals" class="dt-tag">Confidence intervals</a>
  <a href="../../index.html#category:Non-parametric_statistics" class="dt-tag">Non-parametric statistics</a>
  <a href="../../index.html#category:Rank_methods" class="dt-tag">Rank methods</a>
</div>
<!--/radix_placeholder_categories-->
<p><p>Explores four methods of estimating a CI around an observed Spearman correlation.</p></p>
</div>

<div class="d-byline">
  Chris Evans <a href="https://www.psyctc.org/R_blog/" class="uri">https://www.psyctc.org/R_blog/</a> (PSYCTC.org)<a href="https://www.psyctc.org/psyctc/" class="uri">https://www.psyctc.org/psyctc/</a>
  
<br/>2023-11-27
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#shiny-app" id="toc-shiny-app">Shiny app</a></li>
<li><a href="#this-post" id="toc-this-post">This post</a></li>
<li><a href="#summary" id="toc-summary">Summary</a></li>
<li><a href="#geeky-stuff" id="toc-geeky-stuff">Geeky stuff</a></li>
<li><a href="#acknowledgements" id="toc-acknowledgements">Acknowledgements</a></li>
</ul>
</nav>
</div>
<h1 id="shiny-app">Shiny app</h1>
<p>There is now a shiny app using this function <a href="https://shiny.psyctc.org/apps/CISpearman/">here</a>.</p>
<h1 id="this-post">This post</h1>
<p>Until last week (November 2023!) if I wanted a confidence interval (CI) for a Spearman correlation given the <em>n</em> that created it I used an analytic, parametric method which is actually for the Pearson correlation and I think I was not alone in doing that. However, I have just discovered that there are better approaches and that work on them goes back to the mid 20th Century. Ooops.</p>
<p>They are all approximations that drew on parametric models and if you have raw data, you are far better off using a bootstrap method to get your CI. However, if you are looking at a Spearman correlation in the literature and only have that and the <em>n</em> then you can get a CI but you seem to have a choice of four ways of doing this.</p>
<p>So here are the 95% CIs for observed correlations of zero, .5 and .8 for <em>n</em> from 8 to 100.</p>
<div class="layout-chunk" data-layout="l-page">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fl'>8</span><span class='op'>:</span><span class='fl'>100</span><span class='op'>)</span>, rs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fl'>.8</span>, <span class='fl'>.5</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/unnest_longer.html'>unnest_longer</a></span><span class='op'>(</span><span class='va'>rs</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/unnest_longer.html'>unnest_longer</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rowwise.html'>rowwise</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>CIGBW <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/CECPfuns/man/getCISpearman.html'>getCISpearman</a></span><span class='op'>(</span><span class='va'>rs</span>, <span class='va'>n</span>, Gaussian <span class='op'>=</span> <span class='cn'>TRUE</span>, FHP <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>         CItBW <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/CECPfuns/man/getCISpearman.html'>getCISpearman</a></span><span class='op'>(</span><span class='va'>rs</span>, <span class='va'>n</span>, Gaussian <span class='op'>=</span> <span class='cn'>FALSE</span>, FHP <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>         CIGFieller <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/CECPfuns/man/getCISpearman.html'>getCISpearman</a></span><span class='op'>(</span><span class='va'>rs</span>, <span class='va'>n</span>, Gaussian <span class='op'>=</span> <span class='cn'>TRUE</span>, FHP <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>         CItFieller <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/CECPfuns/man/getCISpearman.html'>getCISpearman</a></span><span class='op'>(</span><span class='va'>rs</span>, <span class='va'>n</span>, Gaussian <span class='op'>=</span> <span class='cn'>FALSE</span>, FHP <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/unnest_longer.html'>unnest_longer</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>starts_with</a></span><span class='op'>(</span><span class='st'>"CI"</span><span class='op'>)</span>, simplify <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>limit <span class='op'>=</span> <span class='va'>CIGBW_id</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>ends_with</a></span><span class='op'>(</span><span class='st'>"_id"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='va'>rs</span>, <span class='va'>limit</span>, <span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibCLs</span></span>
<span></span>
<span><span class='co'># tibCLs %&gt;%</span></span>
<span><span class='co'>#   mutate(diffGauss = CIGBW - CIGFieller,</span></span>
<span><span class='co'>#          sqDiffGauss = diffGauss^2,</span></span>
<span><span class='co'>#          difft = CItBW - CItFieller,</span></span>
<span><span class='co'>#          sqDifft = difft^2) %&gt;%</span></span>
<span><span class='co'>#   summarise(across(diffGauss : sqDifft, mean))</span></span>
<span></span>
<span><span class='va'>tibCLs</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span>cols <span class='op'>=</span> <span class='fu'><a href='https://tidyselect.r-lib.org/reference/starts_with.html'>starts_with</a></span><span class='op'>(</span><span class='st'>"CI"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='va'>name</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Method <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>    <span class='va'>method</span> <span class='op'>==</span> <span class='st'>"CIGBW"</span> <span class='op'>~</span> <span class='st'>"B&amp;W, Gaussian"</span>,</span>
<span>    <span class='va'>method</span> <span class='op'>==</span> <span class='st'>"CItBW"</span> <span class='op'>~</span> <span class='st'>"B&amp;W, t dist."</span>,</span>
<span>    <span class='va'>method</span> <span class='op'>==</span> <span class='st'>"CIGFieller"</span> <span class='op'>~</span> <span class='st'>"FH&amp;P, Gaussian"</span>,</span>
<span>    <span class='va'>method</span> <span class='op'>==</span> <span class='st'>"CItFieller"</span> <span class='op'>~</span> <span class='st'>"FH&amp;P, t dist."</span><span class='op'>)</span>,</span>
<span>    approx <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>Method</span>, <span class='fu'><a href='https://stringr.tidyverse.org/reference/modifiers.html'>fixed</a></span><span class='op'>(</span><span class='st'>"B&amp;W"</span><span class='op'>)</span><span class='op'>)</span>, <span class='st'>"B&amp;W"</span>, <span class='st'>"FH&amp;P"</span><span class='op'>)</span>,</span>
<span>    distribn <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_detect.html'>str_detect</a></span><span class='op'>(</span><span class='va'>Method</span>, <span class='fu'><a href='https://stringr.tidyverse.org/reference/modifiers.html'>fixed</a></span><span class='op'>(</span><span class='st'>"Gaussian"</span><span class='op'>)</span><span class='op'>)</span>, <span class='st'>"Gaussian"</span>, <span class='st'>"t dist."</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibCLsLong</span></span>
<span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibCLsLong</span>,</span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>n</span>, y <span class='op'>=</span> <span class='va'>value</span>, colour <span class='op'>=</span> <span class='va'>method</span>, shape <span class='op'>=</span> <span class='va'>method</span><span class='op'>)</span><span class='op'>)</span>  <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_grid.html'>facet_grid</a></span><span class='op'>(</span>rows <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/vars.html'>vars</a></span><span class='op'>(</span><span class='va'>rs</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>.4</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='va'>rs</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>ylim</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="cispearman_files/figure-html5/plot1-1.png" width="624" /></p>
</div>
<p>That illustrates several things:</p>
<ul>
<li><p>Of course the CI is symmetrical around zero for the null case of no correlation but it is asymmetrical around the observed correlation for non-zero observed correlations, more so the stronger the correlation.</p></li>
<li><p>The methods differ in the widths of their CIs more for smaller <em>n</em> and for stronger correlations.</p></li>
<li><p>By <em>n</em> = 100 the differences between the methods are negligible.</p></li>
<li><p>It looks as if the differences between the methods are consistent across the values for <em>n</em> within each observed correlation and confidence limit (i.e. LCL or UCL) but it’s hard to eyeball that from the plot.</p></li>
</ul>
<p>So here is the same plot but just for <em>n</em> from 8 to 15.</p>
<div class="layout-chunk" data-layout="l-page">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibCLsLong</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>n</span> <span class='op'>&lt;=</span> <span class='fl'>15</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTib</span>,</span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>n</span>, y <span class='op'>=</span> <span class='va'>value</span>, colour <span class='op'>=</span> <span class='va'>method</span>, shape <span class='op'>=</span> <span class='va'>method</span><span class='op'>)</span><span class='op'>)</span>  <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_grid.html'>facet_grid</a></span><span class='op'>(</span>rows <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/vars.html'>vars</a></span><span class='op'>(</span><span class='va'>rs</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>.4</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='va'>rs</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>ylim</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>.85</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="cispearman_files/figure-html5/plot2-1.png" width="624" /></p>
</div>
<p>The four methods involve two different changes: the approximation to the standard error of the correlation and whether to look that up against the Gaussian distribution or against the t distribution with df = n - 2. The next two plots facet the issues in the two possible different orders.</p>
<p>This first plot pulls the issue of looking up against the Gaussian or t distributions to the columns in the facetted plot allowing a clearer comparison of the two approximations to the SE of the correlation.</p>
<div class="layout-chunk" data-layout="l-page">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibCLsLong</span>,</span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>n</span>, y <span class='op'>=</span> <span class='va'>value</span>, colour <span class='op'>=</span> <span class='va'>approx</span><span class='op'>)</span><span class='op'>)</span>  <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_grid.html'>facet_grid</a></span><span class='op'>(</span>rows <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/vars.html'>vars</a></span><span class='op'>(</span><span class='va'>rs</span><span class='op'>)</span>,</span>
<span>             cols <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/vars.html'>vars</a></span><span class='op'>(</span><span class='va'>distribn</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>.4</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='va'>rs</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>ylim</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="cispearman_files/figure-html5/plot3-1.png" width="624" /></p>
</div>
<p>That seems to show fairly clearly that for the zero correlation case the B&amp;W, i.e. the Bonett &amp; White (2000) approximation gives slightly tighter CIs than the FH&amp;P, i.e. the Fieller, Hartley &amp; Pearson (1957) one but that the approximations have the reverse relationship with CI widths for the non-zero correlations.</p>
<p>This next plot makes it easy to look at how the choice of lookup, against the Gaussian or the t distributions affects the CIs.</p>
<div class="layout-chunk" data-layout="l-page">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibCLsLong</span>,</span>
<span>       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>n</span>, y <span class='op'>=</span> <span class='va'>value</span>, colour <span class='op'>=</span> <span class='va'>distribn</span><span class='op'>)</span><span class='op'>)</span>  <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_grid.html'>facet_grid</a></span><span class='op'>(</span>rows <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/vars.html'>vars</a></span><span class='op'>(</span><span class='va'>rs</span><span class='op'>)</span>,</span>
<span>             cols <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/vars.html'>vars</a></span><span class='op'>(</span><span class='va'>approx</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>.4</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='va'>rs</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>ylim</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="cispearman_files/figure-html5/plot4-1.png" width="624" /></p>
</div>
<p>So the Gaussian method gives tighter CIs. However, simulation work I think suggests that these are slightly too tight and that the t distribution method gives coverage closer to 95% in simulations.</p>
<h1 id="summary">Summary</h1>
<ul>
<li><p>The <code>getCISpearman()</code> function from the CECPfuns package gives you the four methods of getting a CI around an observed Spearman correlation coefficient.</p></li>
<li><p>I have set the default to <code>getCISpearman(rs, n, ci = .95, Gaussian = FALSE, FHP = FALSE)</code> which gets you the Bonett &amp; White (2000) approximation to the SE of the Spearman correlation rather than the Fieller, Hartley &amp; Pearson (1957) method and gets the coverage by looking up the desired coverage (default .95, i.e. 95%) against the t distribution rather than the Gaussian.</p></li>
<li><p>However, the differences between any of the four possible methods depend on the observed correlation and are trivial for any sensible therapy/MH data and questions for <em>n</em> &gt;= 25 and the methods are known to be very approximate for <em>n</em> &lt; 25.</p></li>
<li><p>I haven’t explored this here but the methods known to have poor coverage accuracy as the absolute population correlation goes above .95 so it’s wise to interpret CIs very cautiously for observed correlations above .9.</p></li>
<li><p>However, there is evidence from simulations that Pearson correlation CIs are highly sensitive to deviations from bivariate Gaussian population distributions so when data are either clearly not Gaussian or where linear measurement is probably not present, use of these CI estimates for rank correlation methods like the Spearman correlation may be more robust than simple parametric CIs for the Pearson correlation.</p></li>
<li><p>However (again!) if you have raw data then bca (“bias correction and acceleration”) bootstrap estimation of a CI around either the observed Pearson or Spearman correlation (depending on your interests and belief about linearity of measurement) will be more robust than these CI estimates that only use the observed correlation and <em>n</em>.</p></li>
</ul>
<h1 id="geeky-stuff">Geeky stuff</h1>
<p>This compares the ordering of the CLs from the four methods. It’s pretty geeky as realistically the differences don’t matter for typical therapy/MH work but I have kept this because it interests me and I like the use of <code>order()</code> in the code, but this is angels on the head of a pin stuff!</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibCLs</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>limit</span> <span class='op'>==</span> <span class='st'>"LCL"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>n</span> <span class='op'>&lt;=</span> <span class='fl'>10</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rowwise.html'>rowwise</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>rs</span>, <span class='va'>n</span>, <span class='va'>limit</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>rs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span><span class='op'>(</span><span class='st'>"%3.1f"</span>, <span class='va'>rs</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>rs</span>, <span class='va'>n</span>, <span class='va'>limit</span>, <span class='va'>CItFieller</span>, <span class='va'>CItBW</span>, <span class='va'>CIGFieller</span>, <span class='va'>CIGBW</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/as_grouped_data.html'>as_grouped_data</a></span><span class='op'>(</span>groups <span class='op'>=</span> <span class='st'>"rs"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-cf14d6a4{}.cl-cf0efcfc{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-cf117108{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-cf117126{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-cf118238{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cf11824c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cf118256{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cf11826a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cf11827e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cf118288{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-cf14d6a4'><thead><tr style="overflow-wrap:break-word;"><th class="cl-cf118238"><p class="cl-cf117108"><span class="cl-cf0efcfc">rs</span></p></th><th class="cl-cf11824c"><p class="cl-cf117126"><span class="cl-cf0efcfc">n</span></p></th><th class="cl-cf118238"><p class="cl-cf117108"><span class="cl-cf0efcfc">limit</span></p></th><th class="cl-cf11824c"><p class="cl-cf117126"><span class="cl-cf0efcfc">CItFieller</span></p></th><th class="cl-cf11824c"><p class="cl-cf117126"><span class="cl-cf0efcfc">CItBW</span></p></th><th class="cl-cf11824c"><p class="cl-cf117126"><span class="cl-cf0efcfc">CIGFieller</span></p></th><th class="cl-cf11824c"><p class="cl-cf117126"><span class="cl-cf0efcfc">CIGBW</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-cf118256"><p class="cl-cf117108"><span class="cl-cf0efcfc">0.0</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc"></span></p></td><td class="cl-cf118256"><p class="cl-cf117108"><span class="cl-cf0efcfc"></span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc"></span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc"></span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc"></span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf118256"><p class="cl-cf117108"><span class="cl-cf0efcfc"></span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">8</span></p></td><td class="cl-cf118256"><p class="cl-cf117108"><span class="cl-cf0efcfc">LCL</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">-0.8099</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">-0.7984</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">-0.7175</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">-0.7047</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf118256"><p class="cl-cf117108"><span class="cl-cf0efcfc"></span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">9</span></p></td><td class="cl-cf118256"><p class="cl-cf117108"><span class="cl-cf0efcfc">LCL</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">-0.7590</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">-0.7467</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">-0.6771</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">-0.6641</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf118256"><p class="cl-cf117108"><span class="cl-cf0efcfc"></span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">10</span></p></td><td class="cl-cf118256"><p class="cl-cf117108"><span class="cl-cf0efcfc">LCL</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">-0.7150</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">-0.7022</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">-0.6427</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">-0.6296</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf118256"><p class="cl-cf117108"><span class="cl-cf0efcfc">0.5</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc"></span></p></td><td class="cl-cf118256"><p class="cl-cf117108"><span class="cl-cf0efcfc"></span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc"></span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc"></span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc"></span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf118256"><p class="cl-cf117108"><span class="cl-cf0efcfc"></span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">8</span></p></td><td class="cl-cf118256"><p class="cl-cf117108"><span class="cl-cf0efcfc">LCL</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">-0.5207</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">-0.5451</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">-0.3391</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">-0.3630</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf118256"><p class="cl-cf117108"><span class="cl-cf0efcfc"></span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">9</span></p></td><td class="cl-cf118256"><p class="cl-cf117108"><span class="cl-cf0efcfc">LCL</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">-0.4174</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">-0.4419</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">-0.2678</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">-0.2907</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf118256"><p class="cl-cf117108"><span class="cl-cf0efcfc"></span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">10</span></p></td><td class="cl-cf118256"><p class="cl-cf117108"><span class="cl-cf0efcfc">LCL</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">-0.3346</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">-0.3585</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">-0.2102</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">-0.2321</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf118256"><p class="cl-cf117108"><span class="cl-cf0efcfc">0.8</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc"></span></p></td><td class="cl-cf118256"><p class="cl-cf117108"><span class="cl-cf0efcfc"></span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc"></span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc"></span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc"></span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf118256"><p class="cl-cf117108"><span class="cl-cf0efcfc"></span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">8</span></p></td><td class="cl-cf118256"><p class="cl-cf117108"><span class="cl-cf0efcfc">LCL</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">-0.0280</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">-0.1573</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">0.1937</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">0.0913</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf118256"><p class="cl-cf117108"><span class="cl-cf0efcfc"></span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">9</span></p></td><td class="cl-cf118256"><p class="cl-cf117108"><span class="cl-cf0efcfc">LCL</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">0.1043</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">-0.0105</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">0.2681</span></p></td><td class="cl-cf11826a"><p class="cl-cf117126"><span class="cl-cf0efcfc">0.1774</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf11827e"><p class="cl-cf117108"><span class="cl-cf0efcfc"></span></p></td><td class="cl-cf118288"><p class="cl-cf117126"><span class="cl-cf0efcfc">10</span></p></td><td class="cl-cf11827e"><p class="cl-cf117108"><span class="cl-cf0efcfc">LCL</span></p></td><td class="cl-cf118288"><p class="cl-cf117126"><span class="cl-cf0efcfc">0.1986</span></p></td><td class="cl-cf118288"><p class="cl-cf117126"><span class="cl-cf0efcfc">0.0969</span></p></td><td class="cl-cf118288"><p class="cl-cf117126"><span class="cl-cf0efcfc">0.3238</span></p></td><td class="cl-cf118288"><p class="cl-cf117126"><span class="cl-cf0efcfc">0.2426</span></p></td></tr></tbody></table></div>
</div>
<p>That shows that the ordering of the lower CLs is not consistent across observed correlations even for that limited range of <em>n</em>. Here’s the same for the UCL.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibCLs</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>limit</span> <span class='op'>==</span> <span class='st'>"UCL"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>n</span> <span class='op'>&lt;=</span> <span class='fl'>10</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rowwise.html'>rowwise</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>rs</span>, <span class='va'>n</span>, <span class='va'>limit</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>rs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span><span class='op'>(</span><span class='st'>"%3.1f"</span>, <span class='va'>rs</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>rs</span>, <span class='va'>n</span>, <span class='va'>limit</span>, <span class='va'>CItFieller</span>, <span class='va'>CItBW</span>, <span class='va'>CIGFieller</span>, <span class='va'>CIGBW</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/as_grouped_data.html'>as_grouped_data</a></span><span class='op'>(</span>groups <span class='op'>=</span> <span class='st'>"rs"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/colformat_double.html'>colformat_double</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-cf35de76{}.cl-cf30b3f6{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-cf32f490{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-cf32f4a4{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-cf3301e2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cf3301ec{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cf3301f6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cf330200{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cf330214{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cf33021e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-cf35de76'><thead><tr style="overflow-wrap:break-word;"><th class="cl-cf3301e2"><p class="cl-cf32f490"><span class="cl-cf30b3f6">rs</span></p></th><th class="cl-cf3301ec"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">n</span></p></th><th class="cl-cf3301e2"><p class="cl-cf32f490"><span class="cl-cf30b3f6">limit</span></p></th><th class="cl-cf3301ec"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">CItFieller</span></p></th><th class="cl-cf3301ec"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">CItBW</span></p></th><th class="cl-cf3301ec"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">CIGFieller</span></p></th><th class="cl-cf3301ec"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">CIGBW</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-cf3301f6"><p class="cl-cf32f490"><span class="cl-cf30b3f6">0.0</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6"></span></p></td><td class="cl-cf3301f6"><p class="cl-cf32f490"><span class="cl-cf30b3f6"></span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6"></span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6"></span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6"></span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf3301f6"><p class="cl-cf32f490"><span class="cl-cf30b3f6"></span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">8</span></p></td><td class="cl-cf3301f6"><p class="cl-cf32f490"><span class="cl-cf30b3f6">UCL</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.8099</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.7984</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.7175</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.7047</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf3301f6"><p class="cl-cf32f490"><span class="cl-cf30b3f6"></span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">9</span></p></td><td class="cl-cf3301f6"><p class="cl-cf32f490"><span class="cl-cf30b3f6">UCL</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.7590</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.7467</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.6771</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.6641</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf3301f6"><p class="cl-cf32f490"><span class="cl-cf30b3f6"></span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">10</span></p></td><td class="cl-cf3301f6"><p class="cl-cf32f490"><span class="cl-cf30b3f6">UCL</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.7150</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.7022</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.6427</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.6296</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf3301f6"><p class="cl-cf32f490"><span class="cl-cf30b3f6">0.5</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6"></span></p></td><td class="cl-cf3301f6"><p class="cl-cf32f490"><span class="cl-cf30b3f6"></span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6"></span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6"></span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6"></span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf3301f6"><p class="cl-cf32f490"><span class="cl-cf30b3f6"></span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">8</span></p></td><td class="cl-cf3301f6"><p class="cl-cf32f490"><span class="cl-cf30b3f6">UCL</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.9323</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.9366</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.8960</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.9013</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf3301f6"><p class="cl-cf32f490"><span class="cl-cf30b3f6"></span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">9</span></p></td><td class="cl-cf3301f6"><p class="cl-cf32f490"><span class="cl-cf30b3f6">UCL</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.9127</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.9175</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.8794</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.8849</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf3301f6"><p class="cl-cf32f490"><span class="cl-cf30b3f6"></span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">10</span></p></td><td class="cl-cf3301f6"><p class="cl-cf32f490"><span class="cl-cf30b3f6">UCL</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.8950</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.9003</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.8648</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.8705</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf3301f6"><p class="cl-cf32f490"><span class="cl-cf30b3f6">0.8</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6"></span></p></td><td class="cl-cf3301f6"><p class="cl-cf32f490"><span class="cl-cf30b3f6"></span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6"></span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6"></span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6"></span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf3301f6"><p class="cl-cf32f490"><span class="cl-cf30b3f6"></span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">8</span></p></td><td class="cl-cf3301f6"><p class="cl-cf32f490"><span class="cl-cf30b3f6">UCL</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.9769</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.9822</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.9641</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.9708</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf3301f6"><p class="cl-cf32f490"><span class="cl-cf30b3f6"></span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">9</span></p></td><td class="cl-cf3301f6"><p class="cl-cf32f490"><span class="cl-cf30b3f6">UCL</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.9700</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.9761</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.9581</span></p></td><td class="cl-cf330200"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.9653</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf330214"><p class="cl-cf32f490"><span class="cl-cf30b3f6"></span></p></td><td class="cl-cf33021e"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">10</span></p></td><td class="cl-cf330214"><p class="cl-cf32f490"><span class="cl-cf30b3f6">UCL</span></p></td><td class="cl-cf33021e"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.9637</span></p></td><td class="cl-cf33021e"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.9705</span></p></td><td class="cl-cf33021e"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.9528</span></p></td><td class="cl-cf33021e"><p class="cl-cf32f4a4"><span class="cl-cf30b3f6">0.9603</span></p></td></tr></tbody></table></div>
</div>
<p>Just to confirm that I turned those limits into rank order across the four methods as shown here for the LCLs and <em>n</em> from 8 to 15.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibCLsLong</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>limit</span> <span class='op'>==</span> <span class='st'>"LCL"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>n</span> <span class='op'>&lt;</span> <span class='fl'>16</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>rs</span>, <span class='va'>n</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>order <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>value</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>value</span>, <span class='va'>Method</span>, <span class='va'>approx</span>, <span class='va'>distribn</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='co'># mutate(rowN = row_number()) %&gt;%</span></span>
<span>  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_wider.html'>pivot_wider</a></span><span class='op'>(</span>names_from <span class='op'>=</span> <span class='st'>"method"</span>, values_from <span class='op'>=</span> <span class='st'>"order"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>rs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span><span class='op'>(</span><span class='st'>"%3.1f"</span>, <span class='va'>rs</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/as_grouped_data.html'>as_grouped_data</a></span><span class='op'>(</span>groups <span class='op'>=</span> <span class='st'>"rs"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://davidgohel.github.io/flextable/reference/flextable.html'>flextable</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<div class="tabwid"><style>.cl-cf5a8172{}.cl-cf53ef92{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-cf5640ee{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-cf564102{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-cf565016{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cf565020{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cf565034{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cf56503e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cf565052{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cf56505c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-cf5a8172'><thead><tr style="overflow-wrap:break-word;"><th class="cl-cf565016"><p class="cl-cf5640ee"><span class="cl-cf53ef92">rs</span></p></th><th class="cl-cf565020"><p class="cl-cf564102"><span class="cl-cf53ef92">n</span></p></th><th class="cl-cf565016"><p class="cl-cf5640ee"><span class="cl-cf53ef92">limit</span></p></th><th class="cl-cf565020"><p class="cl-cf564102"><span class="cl-cf53ef92">CIGBW</span></p></th><th class="cl-cf565020"><p class="cl-cf564102"><span class="cl-cf53ef92">CItBW</span></p></th><th class="cl-cf565020"><p class="cl-cf564102"><span class="cl-cf53ef92">CIGFieller</span></p></th><th class="cl-cf565020"><p class="cl-cf564102"><span class="cl-cf53ef92">CItFieller</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92">0.8</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">8</span></p></td><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92">LCL</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">2</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">4</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">1</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">3</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">9</span></p></td><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92">LCL</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">2</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">4</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">1</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">3</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">10</span></p></td><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92">LCL</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">2</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">4</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">1</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">3</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">11</span></p></td><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92">LCL</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">2</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">4</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">1</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">3</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">12</span></p></td><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92">LCL</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">2</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">4</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">1</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">3</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">13</span></p></td><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92">LCL</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">2</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">4</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">1</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">3</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">14</span></p></td><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92">LCL</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">2</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">1</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">4</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">3</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">15</span></p></td><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92">LCL</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">2</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">1</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">4</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">3</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92">0.5</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">8</span></p></td><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92">LCL</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">2</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">4</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">1</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">3</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">9</span></p></td><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92">LCL</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">2</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">4</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">1</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">3</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">10</span></p></td><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92">LCL</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">2</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">4</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">1</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">3</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">11</span></p></td><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92">LCL</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">2</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">4</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">1</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">3</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">12</span></p></td><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92">LCL</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">2</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">4</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">1</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">3</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">13</span></p></td><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92">LCL</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">2</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">4</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">1</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">3</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">14</span></p></td><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92">LCL</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">2</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">4</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">1</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">3</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">15</span></p></td><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92">LCL</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">2</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">4</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">1</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">3</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92">0.0</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">8</span></p></td><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92">LCL</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">4</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">2</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">3</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">9</span></p></td><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92">LCL</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">4</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">2</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">3</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">10</span></p></td><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92">LCL</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">4</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">2</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">3</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">11</span></p></td><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92">LCL</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">4</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">2</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">3</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">12</span></p></td><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92">LCL</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">4</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">2</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">3</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">13</span></p></td><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92">LCL</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">4</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">2</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">3</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">14</span></p></td><td class="cl-cf565034"><p class="cl-cf5640ee"><span class="cl-cf53ef92">LCL</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">4</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">2</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">3</span></p></td><td class="cl-cf56503e"><p class="cl-cf564102"><span class="cl-cf53ef92">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf565052"><p class="cl-cf5640ee"><span class="cl-cf53ef92"></span></p></td><td class="cl-cf56505c"><p class="cl-cf564102"><span class="cl-cf53ef92">15</span></p></td><td class="cl-cf565052"><p class="cl-cf5640ee"><span class="cl-cf53ef92">LCL</span></p></td><td class="cl-cf56505c"><p class="cl-cf564102"><span class="cl-cf53ef92">4</span></p></td><td class="cl-cf56505c"><p class="cl-cf564102"><span class="cl-cf53ef92">2</span></p></td><td class="cl-cf56505c"><p class="cl-cf564102"><span class="cl-cf53ef92">3</span></p></td><td class="cl-cf56505c"><p class="cl-cf564102"><span class="cl-cf53ef92">1</span></p></td></tr></tbody></table></div>
</div>
<p>Some of the differences in the LCL values that led to those orderings may have been tiny but it’s clear that the methods aren’t consistently ordering the LCLs within a given observed correlation nor are the orders the same for the different observed correlations.</p>
<h1 id="acknowledgements">Acknowledgements</h1>
<ul>
<li><p>This started from finding the excellent answers from <a href="https://stats.stackexchange.com/users/449/onestop">onestop</a> and <a href="https://stats.stackexchange.com/users/237402/retodomax">retodomax</a>
to the question <a href="https://stats.stackexchange.com/questions/18887/how-to-calculate-a-confidence-interval-for-spearmans-rank-correlation">How to calculate a confidence interval for Spearman’s rank correlation?</a> on <a href="https://stats.stackexchange.com/">CrossValidated</a>. As referenced there …</p></li>
<li><p>Bishara, A. J., &amp; Hittner, J. B. (2017). Confidence intervals for correlations when data are not normal. Behavior Research Methods, 49(1), 294–309. <a href="https://doi.org/10.3758/s13428-016-0702-8" class="uri">https://doi.org/10.3758/s13428-016-0702-8</a> gives extensive simulation work covering much more than these CIs. I checked my code against the results from the R code given in Supplement A to that paper. Then …</p></li>
<li><p>Bonett, D. G., &amp; Wright, T. A. (2000). Sample size requirements for estimating pearson, kendall and spearman correlations. Psychometrika, 65(1), 23–28. <a href="https://doi.org/10.1007/BF02294183" class="uri">https://doi.org/10.1007/BF02294183</a> is a classic (interesting to see how typesetting of equations has improved since 2000!) and …</p></li>
<li><p>Ruscio, J. (2008). Constructing Confidence Intervals for Spearman’s Rank Correlation with Ordinal Data: A Simulation Study Comparing Analytic and Bootstrap Methods. Journal of Modern Applied Statistical Methods, 7(2), 416–434. <a href="https://doi.org/10.22237/jmasm/1225512360" class="uri">https://doi.org/10.22237/jmasm/1225512360</a> was another excellent paper on the topic.</p></li>
</ul>
<p>Thanks to all those authors.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Evans (2023, Nov. 27). Chris (Evans) R SAFAQ: Confidence interval around Spearman correlation coefficient. Retrieved from https://www.psyctc.org/R_blog/posts/2023-11-27-cispearman/</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@misc{evans2023confidence,
  author = {Evans, Chris},
  title = {Chris (Evans) R SAFAQ: Confidence interval around Spearman correlation coefficient},
  url = {https://www.psyctc.org/R_blog/posts/2023-11-27-cispearman/},
  year = {2023}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
