<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
<title>Chris (Evans) R SAFAQ: Background on plotJacobson() function</title>

<meta property="description" itemprop="description" content="1.xi.23 This is very early work in progress and will evolve a lot over the next week and then get into CECPfuns R package on github."/>

<link rel="canonical" href="https://www.psyctc.org/R_blog/posts/2023-11-01-plotjacobson/"/>
<link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"/>
<link rel="icon" type="image/png" href="../../Rblog_logo.png"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2023-11-01"/>
<meta property="article:created" itemprop="dateCreated" content="2023-11-01"/>
<meta name="article:author" content="Chris Evans"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Chris (Evans) R SAFAQ: Background on plotJacobson() function"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="1.xi.23 This is very early work in progress and will evolve a lot over the next week and then get into CECPfuns R package on github."/>
<meta property="og:url" content="https://www.psyctc.org/R_blog/posts/2023-11-01-plotjacobson/"/>
<meta property="og:image" content="https://www.psyctc.org/R_blog/posts/2023-11-01-plotjacobson/plotjacobson_files/figure-html5/defaultPlot-1.png"/>
<meta property="og:image:width" content="1248"/>
<meta property="og:image:height" content="768"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Chris (Evans) R SAFAQ"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="Chris (Evans) R SAFAQ: Background on plotJacobson() function"/>
<meta property="twitter:description" content="1.xi.23 This is very early work in progress and will evolve a lot over the next week and then get into CECPfuns R package on github."/>
<meta property="twitter:url" content="https://www.psyctc.org/R_blog/posts/2023-11-01-plotjacobson/"/>
<meta property="twitter:image" content="https://www.psyctc.org/R_blog/posts/2023-11-01-plotjacobson/plotjacobson_files/figure-html5/defaultPlot-1.png"/>
<meta property="twitter:image:width" content="1248"/>
<meta property="twitter:image:height" content="768"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="Chris (Evans) R SAFAQ: Background on plotJacobson() function"/>
<meta name="citation_fulltext_html_url" content="https://www.psyctc.org/R_blog/posts/2023-11-01-plotjacobson/"/>
<meta name="citation_fulltext_world_readable" content=""/>
<meta name="citation_online_date" content="2023/11/01"/>
<meta name="citation_publication_date" content="2023/11/01"/>
<meta name="citation_author" content="Chris Evans"/>
<meta name="citation_author_institution" content="PSYCTC.org"/>
<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","preview","date","categories","output","creative_commons","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["Background on plotJacobson() function"]},{"type":"character","attributes":{},"value":["1.xi.23 This is very early work in progress and will evolve a lot over the next week and then get into CECPfuns R package on github."]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation","affiliation_url","orcid_id"]}},"value":[{"type":"character","attributes":{},"value":["Chris Evans"]},{"type":"character","attributes":{},"value":["https://www.psyctc.org/R_blog/"]},{"type":"character","attributes":{},"value":["PSYCTC.org"]},{"type":"character","attributes":{},"value":["https://www.psyctc.org/psyctc/"]},{"type":"character","attributes":{},"value":["0000-0002-4197-4202"]}]}]},{"type":"character","attributes":{},"value":["css.png"]},{"type":"character","attributes":{},"value":["2023-11-01"]},{"type":"character","attributes":{},"value":["RCSC paradigm","Jacobson plot","CECPfuns package","plots and graphs"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","toc_depth","hightlight_downlit","self_contained","code_folding"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[4]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["CC BY-SA"]},{"type":"character","attributes":{},"value":["https://www.psyctc.org/R_blog/posts/2023-11-01-plotjacobson/"]},{"type":"character","attributes":{},"value":["https://www.psyctc.org/R_blog/posts/2023-11-01-plotjacobson/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["plotjacobson_files/anchor-4.2.2/anchor.min.js","plotjacobson_files/bowser-1.9.3/bowser.min.js","plotjacobson_files/distill-2.2.21/template.v2.js","plotjacobson_files/figure-html5/defaultPlot-1.png","plotjacobson_files/figure-html5/direction-1.png","plotjacobson_files/figure-html5/direction-2.png","plotjacobson_files/figure-html5/direction2-1.png","plotjacobson_files/figure-html5/direction2-2.png","plotjacobson_files/figure-html5/direction2-3.png","plotjacobson_files/figure-html5/direction2-4.png","plotjacobson_files/figure-html5/direction2-5.png","plotjacobson_files/figure-html5/goodScorePos-1.png","plotjacobson_files/figure-html5/goodScorePosAlpha.1-1.png","plotjacobson_files/figure-html5/greyscale-1.png","plotjacobson_files/figure-html5/lineTypes-1.png","plotjacobson_files/figure-html5/noLegend-1.png","plotjacobson_files/figure-html5/pointIDs1-1.png","plotjacobson_files/figure-html5/pointIDs2-1.png","plotjacobson_files/figure-html5/pointIDs2detOnly-1.png","plotjacobson_files/figure-html5/pointIDs3-1.png","plotjacobson_files/figure-html5/pointIDs4-1.png","plotjacobson_files/figure-html5/pointMarkers1-1.png","plotjacobson_files/figure-html5/RCI3-1.png","plotjacobson_files/figure-html5/RCI3-2.png","plotjacobson_files/figure-html5/RCI3-3.png","plotjacobson_files/figure-html5/RCI3-4.png","plotjacobson_files/figure-html5/RCI3-5.png","plotjacobson_files/figure-html5/RCI3-6.png","plotjacobson_files/figure-html5/RCI3-7.png","plotjacobson_files/figure-html5/RCSC10-1.png","plotjacobson_files/figure-html5/RCSC10-2.png","plotjacobson_files/figure-html5/RCSC10-3.png","plotjacobson_files/figure-html5/RCSC5-1.png","plotjacobson_files/figure-html5/RCSC5-2.png","plotjacobson_files/figure-html5/RCSC5-3.png","plotjacobson_files/figure-html5/RCSC5-4.png","plotjacobson_files/figure-html5/RCSC7-1.png","plotjacobson_files/figure-html5/RCSC7-2.png","plotjacobson_files/figure-html5/RCSC7-3.png","plotjacobson_files/figure-html5/rubbishPlot-1.png","plotjacobson_files/figure-html5/rubbishPlot-2.png","plotjacobson_files/figure-html5/testFunction-1.png","plotjacobson_files/figure-html5/textArguments-1.png","plotjacobson_files/header-attrs-2.25/header-attrs.js","plotjacobson_files/jquery-3.6.0/jquery-3.6.0.js","plotjacobson_files/jquery-3.6.0/jquery-3.6.0.min.js","plotjacobson_files/jquery-3.6.0/jquery-3.6.0.min.map","plotjacobson_files/popper-2.6.0/popper.min.js","plotjacobson_files/tippy-6.2.7/tippy-bundle.umd.min.js","plotjacobson_files/tippy-6.2.7/tippy-light-border.css","plotjacobson_files/tippy-6.2.7/tippy.css","plotjacobson_files/tippy-6.2.7/tippy.umd.min.js","plotjacobson_files/webcomponents-2.0.0/webcomponents.js","tmpTib"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */
@import url('https://fonts.googleapis.com/css2?family=Amiri');
@import url('https://fonts.googleapis.com/css2?family=Bitter');
@import url('https://fonts.googleapis.com/css2?family=DM+Mono');


html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8); 
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  --background-color: #ffff99;
  --bkgd-color: #ffff99;
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       "DM Mono", monospace;
  --body-font:       "Bitter", sans-serif;
  --navbar-font:     "Amiri", serif;
}

body {
  background-color: #ffff99;
  bkgd-color: #ffff99;
}

p {
  background-color: #ffff99;
  bkgd-color: #ffff99;
}


/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
.d-article{
  background-color: #ffff99;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.25/header-attrs.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<script>
   document.addEventListener("DOMContentLoaded", function () {
     if (!/posts/.test(location.pathname)) {
       return;
     }

     var script = document.createElement("script");
     script.src = "https://giscus.app/client.js";
     script.setAttribute("data-repo", "cpsyctc/Rblog");
     script.setAttribute("data-repo-id", "MDEwOlJlcG9zaXRvcnkzMzM1Mzg4OTA=");
     script.setAttribute("data-category", "General");
     script.setAttribute("data-category-id", "DIC_kwDOE-FmSs4CYdgN");
     script.setAttribute("data-mapping", "pathname");
     script.setAttribute("data-reactions-enabled", "0");
     script.setAttribute("data-emit-metadata", "0");
     script.setAttribute("data-theme", "light");
     script.setAttribute("data-lang", "en");

     /* wait for article to load, append script to article element */
     var observer = new MutationObserver(function (mutations, observer) {
       var article = document.querySelector("d-article");
       if (article) {
         observer.disconnect();
         /* HACK: article scroll */
         article.setAttribute("style", "overflow-y: hidden");
         article.appendChild(script);
       }
     });

     observer.observe(document.body, { childList: true });
   });
 </script>
<script type="text/javascript" src="https://www.cookieconsent.com/releases/3.1.0/cookie-consent.js"></script>
<script type="text/javascript">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
'notice_banner_type':'simple',
'consent_type': 'express',
'palette': 'light',
'language': 'en',
'website_name': 'test2',
'cookies_policy_url': 'url',
'change_preferences_selector':'#CookiePreferences'
});});</script>
<script type="text/plain" cookie-consent="tracking" async src="https://www.googletagmanager.com/gtag/js?id=G-MTYJ7CVSSH"></script>
<script type="text/plain" cookie-consent="tracking">
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-MTYJ7CVSSH');
</script>
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Background on plotJacobson() function","description":"1.xi.23 This is very early work in progress and will evolve a lot over the next week and then get into CECPfuns R package on github.","authors":[{"author":"Chris Evans","authorURL":"https://www.psyctc.org/R_blog/","affiliation":"PSYCTC.org","affiliationURL":"https://www.psyctc.org/psyctc/","orcidID":"0000-0002-4197-4202"}],"publishedDate":"2023-11-01T00:00:00.000+01:00","citationText":"Evans, 2023"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="https://www.psyctc.org/Rblog/">
<img src="../../Rblog_logo.png" alt="Logo"/>
</a>
<a href="../../index.html" class="title">Chris (Evans) R SAFAQ</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../Welcome.html">Welcome</a>
<a href="../../about.html">About</a>
<a href="../../Copyright_and_permissions.html">Copyright/permissions</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Background on plotJacobson() function</h1>

<!--radix_placeholder_categories-->
<div class="dt-tags">
  <a href="../../index.html#category:RCSC_paradigm" class="dt-tag">RCSC paradigm</a>
  <a href="../../index.html#category:Jacobson_plot" class="dt-tag">Jacobson plot</a>
  <a href="../../index.html#category:CECPfuns_package" class="dt-tag">CECPfuns package</a>
  <a href="../../index.html#category:plots_and_graphs" class="dt-tag">plots and graphs</a>
</div>
<!--/radix_placeholder_categories-->
<p><p>1.xi.23 This is very early work in progress and will evolve a lot over the next week and then get into CECPfuns R package on github.</p></p>
</div>

<div class="d-byline">
  Chris Evans <a href="https://www.psyctc.org/R_blog/" class="uri">https://www.psyctc.org/R_blog/</a> (PSYCTC.org)<a href="https://www.psyctc.org/psyctc/" class="uri">https://www.psyctc.org/psyctc/</a>
  
<br/>2023-11-01
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a>
<ul>
<li><a href="#category-systems" id="toc-category-systems">Category systems</a></li>
<li><a href="#cueing-of-the-score-goodscorepos" id="toc-cueing-of-the-score-goodscorepos">Cueing of the score: <code>goodScorePos</code></a></li>
<li><a href="#categories-direction-rci-csc-and-rcsc" id="toc-categories-direction-rci-csc-and-rcsc">Categories: direction, RCI, CSC and RCSC</a>
<ul>
<li><a href="#direction" id="toc-direction">Direction</a></li>
<li><a href="#rci-categories-rci3" id="toc-rci-categories-rci3">RCI categories RCI3</a></li>
<li><a href="#rcsc-categories-rcsc5" id="toc-rcsc-categories-rcsc5">RCSC categories RCSC5</a></li>
<li><a href="#rcsc-categories-rcsc7" id="toc-rcsc-categories-rcsc7">RCSC categories RCSC7</a></li>
<li><a href="#rcsc-categories-rcsc10" id="toc-rcsc-categories-rcsc10">RCSC categories RCSC10</a></li>
</ul></li>
<li><a href="#all-the-arguments-for-getjacobsonplot" id="toc-all-the-arguments-for-getjacobsonplot">All the arguments for <code>getJacobsonPlot()</code></a></li>
</ul></li>
<li><a href="#optional-arguments-not-for-categories" id="toc-optional-arguments-not-for-categories">Optional arguments, not for categories</a>
<ul>
<li><a href="#text-options" id="toc-text-options">Text options</a></li>
<li><a href="#line-type-options" id="toc-line-type-options">Line type options</a></li>
<li><a href="#point-labelling" id="toc-point-labelling">Point labelling</a></li>
<li><a href="#point-labelling-options" id="toc-point-labelling-options">Point labelling options</a></li>
<li><a href="#point-marker-options" id="toc-point-marker-options">Point marker options</a></li>
<li><a href="#legend-options" id="toc-legend-options">Legend options</a></li>
</ul></li>
<li><a href="#saving-the-plot" id="toc-saving-the-plot">Saving the plot</a></li>
<li><a href="#technicalities-geek-stuff" id="toc-technicalities-geek-stuff">Technicalities (geek stuff)</a>
<ul>
<li><a href="#printvariables" id="toc-printvariables">printVariables</a></li>
<li><a href="#the-plot-areas" id="toc-the-plot-areas">The plot areas</a></li>
</ul></li>
<li><a href="#improvementstodo-list" id="toc-improvementstodo-list">Improvements/todo list</a>
<ul>
<li><a href="#rejected-options" id="toc-rejected-options">Rejected options</a></li>
<li><a href="#things-still-to-do-for-getjacobsonplot" id="toc-things-still-to-do-for-getjacobsonplot">Things still to do for getJacobsonPlot()</a></li>
</ul></li>
</ul>
</nav>
</div>
<p><em>[1.xi.23 This is work in progress and will evolve a lot over the next week and then get into CECPfuns R package on github. Latest updates 12.xi.23]</em></p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>### this is just getting the data and then  adding a few artificial points</span></span>
<span><span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/load.html'>load</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"./_posts/2023-11-01-plotjacobson/tmpTib"</span><span class='op'>)</span> <span class='co'># running interactively </span></span>
<span><span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/load.html'>load</a></span><span class='op'>(</span>file <span class='op'>=</span> <span class='st'>"tmpTib"</span><span class='op'>)</span> <span class='co'># in the full Rblog</span></span>
<span><span class='op'>}</span></span>
<span><span class='va'>tibDat</span> <span class='op'>&lt;-</span> <span class='va'>tmpTib</span></span>
<span><span class='va'>tmpTibDat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>997</span>, <span class='fl'>998</span>, <span class='fl'>999</span><span class='op'>)</span>,</span>
<span>                    firstScore <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.5</span>, <span class='fl'>.1</span>, <span class='fl'>1.1</span><span class='op'>)</span>,</span>
<span>                    lastScore <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>.7</span>, <span class='fl'>.1</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind_rows.html'>bind_rows</a></span><span class='op'>(</span><span class='va'>tmpTibDat</span>,</span>
<span>          <span class='va'>tibDat</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibDat</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='va'>tmpTib</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='va'>tmpTibDat</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>RCI</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/CECPfuns/man/getRCIfromSDandAlpha.html'>getRCIfromSDandAlpha</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span><span class='op'>)</span>, rel <span class='op'>=</span> <span class='fl'>0.943242</span><span class='op'>)</span></span>
<span><span class='va'>CSC</span> <span class='op'>&lt;-</span> <span class='fl'>1.26</span></span>
<span><span class='co'># minPossScore &lt;- NA</span></span>
<span><span class='co'># maxPossScore &lt;- NA</span></span>
<span><span class='co'># baselineScores &lt;- tibDat$firstScore</span></span>
<span><span class='co'># finalScores &lt;- tibDat$lastScore</span></span>
<span><span class='co'># pointNames &lt;- tibDat$id</span></span>
<span><span class='co'># goodScorePos &lt;- FALSE</span></span>
<span><span class='co'># </span></span>
<span><span class='co'># tibble(baselineScores = baselineScores,</span></span>
<span><span class='co'>#        finalScores = finalScores,</span></span>
<span><span class='co'>#        pointNames = pointNames) -&gt; tmpTib</span></span>
<span></span>
<span><span class='co'>### now we can define the function</span></span>
<span><span class='va'>getJacobsonPlot</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>baselineScores</span>, </span>
<span>                          <span class='va'>finalScores</span>, </span>
<span>                          <span class='va'>pointNames</span> <span class='op'>=</span> <span class='cn'>NA</span>, <span class='co'># can be used to label points</span></span>
<span>                          <span class='va'>namesNotPoints</span> <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='co'># only use labels, no points</span></span>
<span>                          <span class='va'>nameRCIDetOnly</span> <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='co'># only label deteriorators</span></span>
<span>                          <span class='va'>namesSize</span> <span class='op'>=</span> <span class='fl'>2</span>, <span class='co'># sets the font size for labels</span></span>
<span>                          <span class='va'>CSC</span> <span class='op'>=</span> <span class='cn'>NA</span>, <span class='co'># the CSC value to use</span></span>
<span>                          <span class='va'>RCI</span> <span class='op'>=</span> <span class='cn'>NA</span>, <span class='co'># the RCI value to use</span></span>
<span>                          <span class='va'>minPossScore</span> <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                          <span class='va'>maxPossScore</span> <span class='op'>=</span> <span class='fl'>4</span>, </span>
<span>                          <span class='va'>goodScorePos</span> <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='co'># set to TRUE/T if a better score is positive</span></span>
<span>                          <span class='va'>omitNHS</span> <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='co'># use to omit scores starting in non-help-seeking range</span></span>
<span>                          <span class='va'>title</span> <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='co'># to override the default title</span></span>
<span>                          <span class='va'>subtitle</span> <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='co'># ditto for subtitle</span></span>
<span>                          <span class='va'>titleJustificn</span> <span class='op'>=</span> <span class='fl'>.5</span>, <span class='co'># centre justifies titles, 0 for L, 1 for R</span></span>
<span>                          <span class='va'>xLab</span> <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='co'># overrides the default x axis label </span></span>
<span>                          <span class='va'>yLab</span> <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='co'># overrides the default y axis label</span></span>
<span>                          <span class='va'>noLegend</span> <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='co'># removes legends for colours</span></span>
<span>                          <span class='va'>labelCSClines</span> <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='co'># set to TRUE/T to label CSC lines with CSC value</span></span>
<span>                          <span class='va'>areaColourScheme</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"NONE"</span>, <span class='co'># mapping to use, see notes, schemes are:</span></span>
<span>                                               <span class='st'>"RCSC5"</span>,</span>
<span>                                               <span class='st'>"DIRECTION"</span>,</span>
<span>                                               <span class='st'>"RCI3"</span>,</span>
<span>                                               <span class='st'>"CSC4"</span>,</span>
<span>                                               <span class='st'>"RCSC7"</span>,</span>
<span>                                               <span class='st'>"RCSC10"</span>,</span>
<span>                                               <span class='st'>"POLYGONS"</span><span class='op'>)</span>, </span>
<span>                          <span class='va'>legendNameAreas</span> <span class='op'>=</span> <span class='st'>"Area mapping"</span>, <span class='co'># set title for area legend</span></span>
<span>                          <span class='va'>pointColourScheme</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"RCSC5"</span>,</span>
<span>                                                <span class='st'>"RCI3"</span>,</span>
<span>                                                <span class='st'>"DIRECTION"</span>,</span>
<span>                                                <span class='st'>"CSC4"</span>,</span>
<span>                                                <span class='st'>"RCSC7"</span>,</span>
<span>                                                <span class='st'>"RCSC10"</span>,</span>
<span>                                                <span class='st'>"NONE"</span><span class='op'>)</span>, <span class='co'># chose point colour mapping, as above</span></span>
<span>                          <span class='va'>legendNamePoints</span> <span class='op'>=</span> <span class='st'>"Point mapping"</span>, <span class='co'># title for point colours</span></span>
<span>                          <span class='co'>### now lots of mappings used by the above colour mappings</span></span>
<span>                          <span class='va'>coloursDirection</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"red"</span>, </span>
<span>                                               <span class='st'>"green"</span>, </span>
<span>                                               <span class='st'>"black"</span><span class='op'>)</span>,</span>
<span>                          <span class='co'>### you can override the labels to local choice and language</span></span>
<span>                          <span class='va'>labelsDirection</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Deterioration"</span>, </span>
<span>                                              <span class='st'>"Improvement"</span>, </span>
<span>                                              <span class='st'>"No change"</span><span class='op'>)</span>,</span>
<span>                          <span class='va'>coloursRCI3</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"grey"</span>, </span>
<span>                                          <span class='st'>"red"</span>, </span>
<span>                                          <span class='st'>"green"</span><span class='op'>)</span>,</span>
<span>                          <span class='va'>labelsRCI3</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"No reliable change"</span>, </span>
<span>                                         <span class='st'>"Reliable deterioration"</span>, </span>
<span>                                         <span class='st'>"Reliable improvement"</span><span class='op'>)</span>,</span>
<span>                          <span class='va'>coloursCSC4</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"green"</span>, </span>
<span>                                          <span class='st'>"red"</span>, </span>
<span>                                          <span class='st'>"orange"</span>, </span>
<span>                                          <span class='st'>"skyblue1"</span><span class='op'>)</span>,</span>
<span>                          <span class='va'>labelsCSC4</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"High to low"</span>, </span>
<span>                                         <span class='st'>"Low to high"</span>, </span>
<span>                                         <span class='st'>"Stayed high"</span>, </span>
<span>                                         <span class='st'>"Stayed low"</span><span class='op'>)</span>,</span>
<span>                          <span class='va'>coloursRCSC5</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"grey"</span>, </span>
<span>                                           <span class='st'>"red"</span>, </span>
<span>                                           <span class='st'>"skyblue1"</span>, </span>
<span>                                           <span class='st'>"green"</span>, </span>
<span>                                           <span class='st'>"chartreuse4"</span><span class='op'>)</span>,</span>
<span>                          <span class='va'>labelsRCSC5</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"No reliable change"</span>, </span>
<span>                                          <span class='st'>"Reliable deterioration"</span>, </span>
<span>                                          <span class='st'>"Reliable improvement, stayed high"</span>, </span>
<span>                                          <span class='st'>"Reliable improvement, high to low ('Recovered')"</span>, </span>
<span>                                          <span class='st'>"Reliable improvement, stayed low"</span><span class='op'>)</span>,</span>
<span>                          <span class='co'>### it's essentially impossible to code labels for the RCSC</span></span>
<span>                          <span class='co'>### that would be independent of the cueing of the scores</span></span>
<span>                          <span class='co'>### hence different labels (but same colours and order)</span></span>
<span>                          <span class='co'>### for positively cued measures</span></span>
<span>                          <span class='va'>labelsRCSC5pos</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"No reliable change"</span>, </span>
<span>                                             <span class='st'>"Reliable deterioration"</span>, </span>
<span>                                             <span class='st'>"Reliable improvement, stayed high"</span>, </span>
<span>                                             <span class='st'>"Reliable improvement, low to high ('Recovered')"</span>, </span>
<span>                                             <span class='st'>"Reliable improvement, stayed low"</span><span class='op'>)</span>,</span>
<span>                          <span class='va'>coloursRCSC7</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"grey"</span>, </span>
<span>                                           <span class='st'>"orange"</span>, </span>
<span>                                           <span class='st'>"red"</span>, </span>
<span>                                           <span class='st'>"sienna2"</span>, </span>
<span>                                           <span class='st'>"palegreen"</span>, </span>
<span>                                           <span class='st'>"green"</span>, </span>
<span>                                           <span class='st'>"skyblue1"</span><span class='op'>)</span>,</span>
<span>                          <span class='va'>labelsRCSC7</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"No reliable change"</span>, </span>
<span>                                          <span class='st'>"Reliable deterioration, stayed high"</span>, </span>
<span>                                          <span class='st'>"Reliable deterioration, low to high"</span>, </span>
<span>                                          <span class='st'>"Reliable deterioration, stayed low"</span>, </span>
<span>                                          <span class='st'>"Reliable improvement, stayed high"</span>, </span>
<span>                                          <span class='st'>"Reliable improvement, high to low ('Recovered')"</span>, </span>
<span>                                          <span class='st'>"Reliable improvement, stayed low"</span><span class='op'>)</span>,</span>
<span>                          <span class='va'>labelsRCSC7pos</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"No reliable change"</span>, </span>
<span>                                             <span class='st'>"Reliable deterioration, stayed low"</span>, </span>
<span>                                             <span class='st'>"Reliable deterioration, high to low"</span>, </span>
<span>                                             <span class='st'>"Reliable deterioration, stayed high"</span>, </span>
<span>                                             <span class='st'>"Reliable improvement, stayed low"</span>, </span>
<span>                                             <span class='st'>"Reliable improvement, low to high ('Recovered')"</span>, </span>
<span>                                             <span class='st'>"Reliable improvement, stayed high"</span><span class='op'>)</span>,</span>
<span>                          <span class='va'>coloursRCSC10</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"yellow"</span>, <span class='co'>#1</span></span>
<span>                                            <span class='st'>"blue"</span>, <span class='co'>#2</span></span>
<span>                                            <span class='st'>"purple"</span>, <span class='co'>#3</span></span>
<span>                                            <span class='st'>"grey"</span>, <span class='co'>#4</span></span>
<span>                                            <span class='st'>"orange"</span>, <span class='co'>#5</span></span>
<span>                                            <span class='st'>"red"</span>, <span class='co'>#6</span></span>
<span>                                            <span class='st'>"violetred4"</span>, <span class='co'>#7</span></span>
<span>                                            <span class='st'>"palegreen"</span>, <span class='co'>#8</span></span>
<span>                                            <span class='st'>"green"</span>, <span class='co'>#9</span></span>
<span>                                            <span class='st'>"chartreuse4"</span><span class='op'>)</span>, <span class='co'>#10</span></span>
<span>                          <span class='va'>labelsRCSC10</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"No reliable change, stayed high"</span>, <span class='co'>#1</span></span>
<span>                                           <span class='st'>"No reliable change, high to low"</span>, <span class='co'>#2</span></span>
<span>                                           <span class='st'>"No reliable change, low to high"</span>, <span class='co'>#3</span></span>
<span>                                           <span class='st'>"No reliable change, stayed low"</span>, <span class='co'>#4</span></span>
<span>                                           <span class='st'>"Reliable deterioration, stayed high"</span>, <span class='co'>#5 </span></span>
<span>                                           <span class='st'>"Reliable deterioration, low to high"</span>, <span class='co'>#6</span></span>
<span>                                           <span class='st'>"Reliable deterioration, stayed low"</span>, <span class='co'>#7</span></span>
<span>                                           <span class='st'>"Reliable improvement, stayed high"</span>, <span class='co'>#8</span></span>
<span>                                           <span class='st'>"Reliable improvement, high to low ('Recovered')"</span>, <span class='co'>#9</span></span>
<span>                                           <span class='st'>"Reliable improvement, stayed low"</span><span class='op'>)</span>, <span class='co'>#10</span></span>
<span>                          <span class='va'>labelsRCSC10pos</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"No reliable change, stayed low"</span>, <span class='co'>#1p</span></span>
<span>                                              <span class='st'>"No reliable change, low to high"</span>, <span class='co'>#2p</span></span>
<span>                                              <span class='st'>"No reliable change, high to low"</span>, <span class='co'>#3p</span></span>
<span>                                              <span class='st'>"No reliable change, stayed high"</span>, <span class='co'>#4p</span></span>
<span>                                              <span class='st'>"Reliable deterioration, stayed low"</span>, <span class='co'>#5p</span></span>
<span>                                              <span class='st'>"Reliable deterioration, low to high"</span>, <span class='co'>#6p</span></span>
<span>                                              <span class='st'>"Reliable deterioration, stayed high"</span>, <span class='co'>#7p</span></span>
<span>                                              <span class='st'>"Reliable improvement, stayed low"</span>, <span class='co'>#8p</span></span>
<span>                                              <span class='st'>"Reliable improvement, low to high ('Recovered')"</span>, <span class='co'>#9p</span></span>
<span>                                              <span class='st'>"Reliable improvement, stayed high"</span><span class='op'>)</span>, <span class='co'>#10p</span></span>
<span>                          <span class='co'>### you can also add mapping to point shapes</span></span>
<span>                          <span class='va'>pointShapeScheme</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"NONE"</span>,</span>
<span>                                               <span class='st'>"DIRECTION"</span>,</span>
<span>                                               <span class='st'>"RCI3"</span><span class='op'>)</span>,</span>
<span>                          <span class='co'>### these allow you to override the default mapping to </span></span>
<span>                          <span class='co'>### a square and arrows pointing the appropriate ways</span></span>
<span>                          <span class='co'>### NULL leaves the default mapping in place</span></span>
<span>                          <span class='co'>### I really don't advise overriding these but you can!</span></span>
<span>                          <span class='va'>pointShapeNoRelChange</span> <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>                          <span class='va'>pointShapeRelDet</span> <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>                          <span class='va'>pointShapeRelImp</span> <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>                          <span class='co'>### the following arguments control the aesthetics</span></span>
<span>                          <span class='va'>pointSize</span> <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>                          <span class='co'>### the default alpha settings allow both points and areas to be coloured</span></span>
<span>                          <span class='va'>pointAlpha</span> <span class='op'>=</span> <span class='fl'>1</span>, <span class='co'># 1 is no transparency, 0 is no colour</span></span>
<span>                          <span class='va'>areaAlpha</span> <span class='op'>=</span> <span class='fl'>.3</span>, <span class='co'># ditto, .3 is probably OK for a pale coloured ground</span></span>
<span>                          <span class='co'>### aesthetics for the no-change diagonal line</span></span>
<span>                          <span class='va'>lineTypeNoChange</span> <span class='op'>=</span> <span class='fl'>1</span>, <span class='co'># default is solid line</span></span>
<span>                          <span class='va'>lineWidthNoChange</span> <span class='op'>=</span> <span class='fl'>.5</span>, <span class='co'># default is ggplot default line thickness</span></span>
<span>                          <span class='va'>lineColourNoChange</span> <span class='op'>=</span> <span class='fl'>1</span>, <span class='co'># default is black</span></span>
<span>                          <span class='co'>### same for the CSC lines</span></span>
<span>                          <span class='va'>lineTypeCSC</span> <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>                          <span class='va'>lineWidthCSC</span> <span class='op'>=</span> <span class='fl'>.5</span>, </span>
<span>                          <span class='va'>lineColourCSC</span> <span class='op'>=</span> <span class='fl'>1</span>, </span>
<span>                          <span class='co'>### same for the RCI lines</span></span>
<span>                          <span class='va'>lineTypeRCI</span> <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>                          <span class='va'>lineWidthRCI</span> <span class='op'>=</span> <span class='fl'>.5</span>,</span>
<span>                          <span class='va'>lineColourRCI</span> <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>                          <span class='va'>themeToUse</span> <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='co'># set ggplot theme to use, unquoted</span></span>
<span>                          <span class='co'>### I can't imagine changing these myself but ...</span></span>
<span>                          <span class='co'>### these allow you to override the theme's colours</span></span>
<span>                          <span class='va'>plotColour</span> <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='co'># background colour of the plot area itself, e.g. "white"</span></span>
<span>                          <span class='va'>borderColour</span> <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='co'># and same for the border around it</span></span>
<span>                          <span class='co'>### you might want to use these to suppress messages and warnings</span></span>
<span>                          <span class='va'>noMessages</span> <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='co'># suppress messages</span></span>
<span>                          <span class='va'>noWarnings</span> <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='co'># suppress my warnings (not other R ones)</span></span>
<span>                          <span class='co'>### these are probably only useful to help me debug things</span></span>
<span>                          <span class='va'>printVariables</span> <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='co'># will give a print out of all internal variables</span></span>
<span>                          <span class='va'>warningsToErrors</span> <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='co'># makes warnings into errors, i.e. </span></span>
<span>                          <span class='co'>### this is really only for someone drilling into the code</span></span>
<span>                          <span class='co'>### it labels all twelve area polygons with their numbers</span></span>
<span>                          <span class='va'>labelAllPolygons</span> <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>                          <span class='co'>### arguments not implemented yet</span></span>
<span>                          <span class='va'>greyScale</span> <span class='op'>=</span> <span class='cn'>FALSE</span> <span class='co'># may be implemented to force B&amp;W/greyscale</span></span>
<span><span class='op'>)</span><span class='op'>{</span></span>
<span>  <span class='co'>### </span></span>
<span>  <span class='co'>### function to give single group Jacobson plot given vectors of pre and post scores</span></span>
<span>  <span class='co'>### and fixed CSC and RCI</span></span>
<span>  <span class='co'>### default, with goodScorePos == FALSE, is distress/dysfunction scoring i.e. higher scores worse</span></span>
<span>  <span class='co'>### but can override that by using goodScorePos == TRUE</span></span>
<span>  <span class='co'>### by default the function expects to be told minimum and maximum scores on the measure</span></span>
<span>  <span class='co'>### these are simple numerical min and max, i.e. ignores whether scale is positive or negative </span></span>
<span>  <span class='co'>### those default to zero and four as per original CORE scoring but can be overridden (doh!)</span></span>
<span>  <span class='co'>### fixing either or both minPossScore and maxPossScore to NULL means the observed minimum</span></span>
<span>  <span class='co'>### and maximum will be used, not recommended and may produce odd scale labelling</span></span>
<span>  <span class='co'>###</span></span>
<span>  <span class='co'>### get the arguments before anything is changed</span></span>
<span>  <span class='va'>listArgs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>as.list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/match.call.html'>match.call</a></span><span class='op'>(</span>expand.dots <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span></span>
<span></span>
<span>  <span class='co'>### handle warningsToErrors before other arguments</span></span>
<span>  <span class='co'>### test it</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/logical.html'>is.logical</a></span><span class='op'>(</span><span class='va'>warningsToErrors</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"You have given warningsToErrors as something other than a logical value (TRUE, FALSE, T or F).  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>warningsToErrors</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument warningsToErrors must be a single logical value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  <span class='va'>oldWarn</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"warn"</span><span class='op'>)</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>warningsToErrors</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span><span class='st'>"warn"</span> <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  <span class='co'>### handle noMessages before other arguments</span></span>
<span>  <span class='co'>### test it</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/logical.html'>is.logical</a></span><span class='op'>(</span><span class='va'>noMessages</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"You have given noMessages as something other than a logical value (TRUE, FALSE, T or F).  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>noMessages</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument noMessages must be a single logical value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  <span class='co'>### handle noWarnings before other arguments</span></span>
<span>  <span class='co'>### test it</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/logical.html'>is.logical</a></span><span class='op'>(</span><span class='va'>noWarnings</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"You have given noWarnings as something other than a logical value (TRUE, FALSE, T or F).  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>noWarnings</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument noWarnings must be a single logical value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  <span class='co'>### now match the arguments which are switch choices, these will have the default match.arg error trapping</span></span>
<span>  <span class='co'>###</span></span>
<span>  <span class='va'>areaColourScheme</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/case.html'>str_to_upper</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/match.arg.html'>match.arg</a></span><span class='op'>(</span><span class='va'>areaColourScheme</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='va'>pointColourScheme</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/case.html'>str_to_upper</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/match.arg.html'>match.arg</a></span><span class='op'>(</span><span class='va'>pointColourScheme</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='va'>pointShapeScheme</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/match.arg.html'>match.arg</a></span><span class='op'>(</span><span class='va'>pointShapeScheme</span><span class='op'>)</span> <span class='co'>### all three options start differently so can do this:</span></span>
<span>  <span class='va'>pointShapeScheme</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://stringr.tidyverse.org/reference/case.html'>str_to_upper</a></span><span class='op'>(</span><span class='va'>pointShapeScheme</span><span class='op'>)</span></span>
<span>  <span class='co'>###</span></span>
<span>  <span class='co'>### sanity testing of other arguments</span></span>
<span>  <span class='co'>###</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>baselineScores</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>finalScores</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"Length of baseline and final scores must be the same"</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>is.numeric</a></span><span class='op'>(</span><span class='va'>baselineScores</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"Baseline scores must be numeric"</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>is.numeric</a></span><span class='op'>(</span><span class='va'>finalScores</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"Final scores must be numeric"</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span>  </span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>pointNames</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>pointNames</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>baselineScores</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"When given, the length of labels (pointNames) must be same as lengths of scores"</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>pointNames</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>is.numeric</a></span><span class='op'>(</span><span class='va'>pointNames</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='va'>noWarnings</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='kw'><a href='https://rdrr.io/r/base/warning.html'>warning</a></span><span class='op'>(</span><span class='st'>"You have given a numeric vector for pointNames.  If you have many numbers this will be a mess!"</span><span class='op'>)</span></span>
<span>    <span class='op'>}</span></span>
<span>    <span class='va'>pointNames</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>pointNames</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>pointNames</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>pointNames</span><span class='op'>)</span>,</span>
<span>                                    <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>is.factor</a></span><span class='op'>(</span><span class='va'>pointNames</span><span class='op'>)</span>,</span>
<span>                                    <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>is.numeric</a></span><span class='op'>(</span><span class='va'>pointNames</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"You have given pointNames as something other than numeric (discouraged), character or factor. Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/logical.html'>is.logical</a></span><span class='op'>(</span><span class='va'>namesNotPoints</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"You have given namesNotPoints as something other than a logical value (TRUE, FALSE, T or F).  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>namesNotPoints</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument namesNotPoints must be a single logical value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/logical.html'>is.logical</a></span><span class='op'>(</span><span class='va'>nameRCIDetOnly</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"You have given nameRCIDetOnly as something other than a logical value (TRUE, FALSE, T or F).  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>nameRCIDetOnly</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument nameRCIDetOnly must be a single logical value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>is.numeric</a></span><span class='op'>(</span><span class='va'>namesSize</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The value for namesSize must be numeric. Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>namesSize</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument namesSize must be a single number. Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>namesSize</span> <span class='op'>&lt;</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The value for namesSize must be a positive number. Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>CSC</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>is.numeric</a></span><span class='op'>(</span><span class='va'>CSC</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"You have given CSC as something other than a numeric value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>CSC</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument CSC must be a single numeric value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>RCI</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>is.numeric</a></span><span class='op'>(</span><span class='va'>RCI</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"You have given RCI as something other than a numeric value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>RCI</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument RCI must be a single numeric value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>minPossScore</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"You have not given a value for minPossScore (NA is the default).  Sorry, but I set that default to force users to choose the appropriate value.  It must be the lowest numeric value possible for the score, not the worst score (which would be the lowest number possible for a positively cued measure).  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>minPossScore</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>is.numeric</a></span><span class='op'>(</span><span class='va'>minPossScore</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"You have given minPossScore as something other than a numeric value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>minPossScore</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument minPossScore must be a single numeric value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>maxPossScore</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"You have not given a value for maxPossScore (NA is the default).  Sorry, but I set that default to force users to choose the appropriate value.  It must be the highest numeric value possible for the score, not the best score (which would be the lowest number possible for a positively cued measure).  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>maxPossScore</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>is.numeric</a></span><span class='op'>(</span><span class='va'>maxPossScore</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"You have given maxPossScore as something other than a numeric value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>maxPossScore</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument maxPossScore must be a single numeric value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>maxPossScore</span> <span class='op'>&lt;</span> <span class='va'>minPossScore</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>msg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"You have given minPossScore as "</span>,</span>
<span>                  <span class='va'>minPossScore</span>,</span>
<span>                  <span class='st'>" and maxPossScore as "</span>,</span>
<span>                  <span class='va'>maxPossScore</span>,</span>
<span>                  <span class='st'>"\nbut these must be in order of actual scores not cueing of scores."</span>,</span>
<span>                  <span class='st'>"\ni.e. maxPossScore must be higher than minPossScore whether higher scores are better or worse than lower scores.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='va'>msg</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>CSC</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>(</span><span class='va'>CSC</span> <span class='op'>&lt;</span> <span class='va'>minPossScore</span> <span class='op'>|</span></span>
<span>                     <span class='va'>CSC</span> <span class='op'>&gt;</span> <span class='va'>maxPossScore</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>msg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"You have given CSC as "</span>,</span>
<span>                  <span class='va'>CSC</span>,</span>
<span>                  <span class='st'>" and minPossScore as "</span>,</span>
<span>                  <span class='va'>minPossScore</span>,</span>
<span>                  <span class='st'>" and maxPossScore as "</span>,</span>
<span>                  <span class='va'>maxPossScore</span>,</span>
<span>                  <span class='st'>"\nbut CSC must lie between the possible scores.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='va'>msg</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/logical.html'>is.logical</a></span><span class='op'>(</span><span class='va'>goodScorePos</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"You have given goodScorePos as something other than a logical value (TRUE, FALSE, T or F).  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>goodScorePos</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument goodScorePos must be a single logical value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/logical.html'>is.logical</a></span><span class='op'>(</span><span class='va'>omitNHS</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"You have given omitNHS as something other than a logical value (TRUE, FALSE, T or F).  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>omitNHS</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument omitNHS must be a single logical value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>title</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>title</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"If you are giving a title it must be a single character value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>title</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>title</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"If you are giving a title it must be a single value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>subtitle</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>subtitle</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"If you are giving a subtitle it must be a single character value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>subtitle</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>subtitle</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"If you are giving a subtitle it must be a single value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>is.numeric</a></span><span class='op'>(</span><span class='va'>titleJustificn</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument titleJustificn must be a single number. Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>titleJustificn</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument titleJustificn must be a single number. Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='op'>(</span><span class='va'>titleJustificn</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>.5</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>msg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"You gave titleJustificn as "</span>,</span>
<span>                  <span class='va'>titleJustificn</span>,</span>
<span>                  <span class='st'>"but it must be one of: 0 (left justified), .5 (centred) or 1 (right justified). Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='va'>msg</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>xLab</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>xLab</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"If you are giving a label for the x axis it must be a single character value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>xLab</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>xLab</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"If you are giving a label for the x axis it must be a single value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>yLab</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>yLab</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"If you are giving a label for the y axis it must be a single character value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>yLab</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>yLab</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"If you are giving a label for the y axis it must be a single value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/logical.html'>is.logical</a></span><span class='op'>(</span><span class='va'>noLegend</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"You have given noLegend as something other than a logical value (TRUE, FALSE, T or F).  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>noLegend</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument noLegend must be a single logical value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span>  </span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/logical.html'>is.logical</a></span><span class='op'>(</span><span class='va'>labelCSClines</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"You have given labelCSClines as something other than a logical value (TRUE, FALSE, T or F).  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>labelCSClines</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument labelCSClines must be a single logical value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span> </span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>legendNameAreas</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>legendNameAreas</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"If you are giving a new label to the area legend it must be a single character value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>legendNameAreas</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>legendNameAreas</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"If you are giving a new label to the area legend it must be a single value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>legendNamePoints</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>legendNamePoints</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"If you are giving a new label to the point legend it must be a single character value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>legendNamePoints</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>legendNamePoints</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"If you are giving a new label to the point it must be a single value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>coloursDirection</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument coloursDirection must be a character vector of length three.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>coloursDirection</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument coloursDirection must be a character vector of length three.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>labelsDirection</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument labelsDirection must be a character vector of length three.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>labelsDirection</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument labelsDirection must be a character vector of length three.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>coloursRCI3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument coloursRCI3 must be a character vector of length three.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>coloursRCI3</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument coloursRCI3 must be a character vector of length three.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>labelsRCI3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument labelsRCI3 must be a character vector of length three.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>labelsRCI3</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument labelsRCI3 must be a character vector of length three.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>coloursCSC4</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument coloursCSC4 must be a character vector of length four.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>coloursCSC4</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument coloursCSC4 must be a character vector of length four.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>labelsCSC4</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument labelsCSC4 must be a character vector of length four.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>labelsCSC4</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument labelsCSC4 must be a character vector of length four.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>coloursRCSC5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument labelsCSC4 must be a character vector of length five.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>coloursRCSC5</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument coloursRCSC5 must be a character vector of length five.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>labelsRCSC5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument labelsRCSC5 must be a character vector of length five.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>labelsRCSC5</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument labelsRCSC5 must be a character vector of length five.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>labelsRCSC5pos</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument labelsRCSC5pos must be a character vector of length five.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>labelsRCSC5pos</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>5</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument labelsRCSC5pos must be a character vector of length five.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>coloursRCSC7</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument coloursRCSC7 must be a character vector of length seven.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>coloursRCSC7</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>7</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument coloursRCSC7 must be a character vector of length seven.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>labelsRCSC7</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument labelsRCSC7 must be a character vector of length seven.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>labelsRCSC7</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>7</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument labelsRCSC7 must be a character vector of length seven.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>labelsRCSC7pos</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument labelsRCSC7pos must be a character vector of length seven.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>labelsRCSC7pos</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>7</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument labelsRCSC7pos must be a character vector of length seven.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>coloursRCSC10</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument coloursRCSC10 must be a character vector of length ten.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>coloursRCSC10</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>10</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument coloursRCSC10 must be a character vector of length ten.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>labelsRCSC10</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument labelsRCSC10 must be a character vector of length ten.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>labelsRCSC10</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>10</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument labelsRCSC10 must be a character vector of length ten.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>labelsRCSC10pos</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument labelsRCSC10pos must be a character vector of length ten.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>labelsRCSC10pos</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>10</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument labelsRCSC10pos must be a character vector of length ten.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>pointShapeNoRelChange</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>pointShapeNoRelChange</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument pointShapeNoRelChange must be an integer between 0 and 25 (inclusive). Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>    <span class='op'>}</span>    </span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>is.numeric</a></span><span class='op'>(</span><span class='va'>pointShapeNoRelChange</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='op'>(</span><span class='va'>pointShapeNoRelChange</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>25</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>        <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument pointShapeNoRelChange must be an integer between 0 and 25 (inclusive). Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>      <span class='op'>}</span></span>
<span>    <span class='op'>}</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>pointShapeRelDet</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>pointShapeRelDet</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument pointShapeRelDet must be an integer between 0 and 25 (inclusive). Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>    <span class='op'>}</span>    </span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>is.numeric</a></span><span class='op'>(</span><span class='va'>pointShapeRelDet</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='op'>(</span><span class='va'>pointShapeRelDet</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>25</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>        <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument pointShapeRelDet must be an integer between 0 and 25 (inclusive). Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>      <span class='op'>}</span></span>
<span>    <span class='op'>}</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>pointShapeRelImp</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>pointShapeRelImp</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument pointShapeRelImp must be an integer between 0 and 25 (inclusive). Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>    <span class='op'>}</span>    </span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>is.numeric</a></span><span class='op'>(</span><span class='va'>pointShapeRelImp</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='op'>(</span><span class='va'>pointShapeRelImp</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>25</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>        <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument pointShapeRelImp must be an integer between 0 and 25 (inclusive). Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>      <span class='op'>}</span></span>
<span>    <span class='op'>}</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>is.numeric</a></span><span class='op'>(</span><span class='va'>pointSize</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument pointSize must be an integer between 0 and 25 (inclusive). Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>pointSize</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument pointSize must be an integer between 0 and 25 (inclusive). Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>pointSize</span> <span class='op'>&lt;</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument pointSize must be a positive number. Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>is.numeric</a></span><span class='op'>(</span><span class='va'>pointAlpha</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument pointAlpha must be a number between 0 and 1 (inclusive). Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>pointAlpha</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument pointAlpha must be a number between 0 and 1 (inclusive). Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>pointAlpha</span> <span class='op'>&lt;</span> <span class='fl'>0</span> <span class='op'>|</span> <span class='va'>pointAlpha</span> <span class='op'>&gt;</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument pointAlpha must be a number between 0 and 1 (inclusive). Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>is.numeric</a></span><span class='op'>(</span><span class='va'>areaAlpha</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument areaAlpha must be a number between 0 and 1 (inclusive). Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>areaAlpha</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument areaAlpha must be a number between 0 and 1 (inclusive). Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>areaAlpha</span> <span class='op'>&lt;</span> <span class='fl'>0</span> <span class='op'>|</span> <span class='va'>areaAlpha</span> <span class='op'>&gt;</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument areaAlpha must be a number between 0 and 1 (inclusive). Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>is.numeric</a></span><span class='op'>(</span><span class='va'>lineTypeNoChange</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>lineTypeNoChange</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument lineTypeNoChange must be a character or number. Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>lineTypeNoChange</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument lineTypeNoChange must be a single value. Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>is.numeric</a></span><span class='op'>(</span><span class='va'>lineWidthNoChange</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument lineWidthNoChange must be a number. Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>lineWidthNoChange</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument lineWidthNoChange must be a single number. Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>is.numeric</a></span><span class='op'>(</span><span class='va'>lineColourNoChange</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>lineColourNoChange</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument lineColourNoChange must be a character or number. Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>lineColourNoChange</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument lineColourNoChange must be a single number or character. Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>is.numeric</a></span><span class='op'>(</span><span class='va'>lineTypeCSC</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>lineTypeCSC</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument lineTypeCSC must be a character or number. Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>lineTypeCSC</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument lineTypeCSC must be a single number or character. Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>is.numeric</a></span><span class='op'>(</span><span class='va'>lineWidthCSC</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument lineWidthCSC must be a number. Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>lineWidthCSC</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument lineWidthCSC must be a single number. Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>is.numeric</a></span><span class='op'>(</span><span class='va'>lineColourCSC</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>lineColourCSC</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument lineColourCSC must be a character or number. Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>lineColourCSC</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument lineColourCSC must be a single number or character. Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>is.numeric</a></span><span class='op'>(</span><span class='va'>lineTypeRCI</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>lineTypeRCI</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument lineTypeRCI must be a character or number. Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>lineTypeRCI</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument lineTypeRCI must be a single number or character. Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>is.numeric</a></span><span class='op'>(</span><span class='va'>lineWidthRCI</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument lineWidthRCI must be a number. Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>lineWidthRCI</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument lineWidthRCI must be a single number. Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>is.numeric</a></span><span class='op'>(</span><span class='va'>lineColourRCI</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>lineColourRCI</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument lineColourRCI must be a character or number. Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>lineColourRCI</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument lineColourRCI must be a single number or character. Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>is.list</a></span><span class='op'>(</span><span class='va'>themeToUse</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument themeToUse must be a list (actually a ggplot theme but I can't test for that!). Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/logical.html'>is.logical</a></span><span class='op'>(</span><span class='va'>labelAllPolygons</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"You have given labelAllPolygons as something other than a logical value (TRUE, FALSE, T or F).  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>plotColour</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>plotColour</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"If used, the argument plotColour must be a single character value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>plotColour</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>plotColour</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"If used, the argument plotColour must be a single character value not a vector.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>borderColour</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>is.character</a></span><span class='op'>(</span><span class='va'>borderColour</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"If used, the argument borderColour must be a single character value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>plotColour</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>plotColour</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"If used, the argument borderColour must be a single character value not a vector.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/logical.html'>is.logical</a></span><span class='op'>(</span><span class='va'>printVariables</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument printVariables must be a logical, i.e. TRUE | FALSE | T | F.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>printVariables</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument printVariables must be a single logical value, not a vector.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>labelAllPolygons</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument labelAllPolygons must be a single logical value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/logical.html'>is.logical</a></span><span class='op'>(</span><span class='va'>greyScale</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"You have given greyScale as something other than a logical value (TRUE, FALSE, T or F).  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>greyScale</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='st'>"The argument greyScale must be a single logical value.  Sorry: please go back and fix this."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='co'>### must have shape and point colour schemes the same if both set</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>pointShapeScheme</span> <span class='op'>!=</span> <span class='st'>"NONE"</span> <span class='op'>&amp;</span> <span class='va'>pointColourScheme</span> <span class='op'>!=</span> <span class='st'>"NONE"</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>pointShapeScheme</span> <span class='op'>!=</span> <span class='va'>pointColourScheme</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='va'>errTxt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"The plot is confusing if pointShapeScheme and pointColourScheme are not the same."</span>,</span>
<span>                       <span class='st'>"\n You input: \npointShapeScheme = "</span>,</span>
<span>                       <span class='va'>pointShapeScheme</span>,</span>
<span>                       <span class='st'>" and pointColourScheme = "</span>,</span>
<span>                       <span class='va'>pointColourScheme</span>,</span>
<span>                       <span class='st'>"\n either set one of them to 'NONE' or set both to the same value."</span><span class='op'>)</span></span>
<span>      <span class='kw'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span><span class='op'>(</span><span class='va'>errTxt</span><span class='op'>)</span></span>
<span>    <span class='op'>}</span></span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  </span>
<span>  <span class='co'>### trying to allow theme setting in the arguments</span></span>
<span>  <span class='va'>oldTheme</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme_get.html'>theme_get</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme_get.html'>theme_set</a></span><span class='op'>(</span><span class='va'>themeToUse</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='co'>### </span></span>
<span>  <span class='co'>### start to handle the arguments</span></span>
<span>  <span class='co'>###</span></span>
<span></span>
<span>  <span class='co'>###</span></span>
<span>  <span class='co'>### set point shapes</span></span>
<span>  <span class='co'>### makes sense to do this before handling the data?</span></span>
<span>  <span class='co'>###</span></span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='va'>pointShapeScheme</span> <span class='op'>==</span> <span class='st'>"NONE"</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='co'>### default point shape scheme is by RCI with filled circles</span></span>
<span>    <span class='va'>pointShape</span> <span class='op'>&lt;-</span> <span class='fl'>16</span></span>
<span>    <span class='va'>vecPointShapes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='va'>pointShape</span>, <span class='fl'>3</span><span class='op'>)</span></span>
<span>    <span class='co'>### obviously could have done that in one line but makes principle clear</span></span>
<span>  <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span></span>
<span>    <span class='co'>### alternative point shape scheme is by variables shapes in tmpTib (later)</span></span>
<span>    <span class='co'>### with these shapes</span></span>
<span>    <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>pointShapeNoRelChange</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='va'>pointShapeNoRelChange</span> <span class='op'>&lt;-</span> <span class='fl'>23</span></span>
<span>    <span class='op'>}</span></span>
<span>    <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>pointShapeRelDet</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='va'>goodScorePos</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>        <span class='va'>pointShapeRelDet</span> <span class='op'>&lt;-</span> <span class='fl'>24</span></span>
<span>      <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span></span>
<span>        <span class='va'>pointShapeRelDet</span> <span class='op'>&lt;-</span> <span class='fl'>25</span></span>
<span>      <span class='op'>}</span></span>
<span>    <span class='op'>}</span></span>
<span>    <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>pointShapeRelImp</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='va'>goodScorePos</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>        <span class='va'>pointShapeRelImp</span> <span class='op'>&lt;-</span> <span class='fl'>25</span></span>
<span>      <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span></span>
<span>        <span class='va'>pointShapeRelImp</span> <span class='op'>&lt;-</span> <span class='fl'>24</span></span>
<span>      <span class='op'>}</span></span>
<span>    <span class='op'>}</span></span>
<span>    <span class='co'>### set the mapping to be used in scale_shape_manual()</span></span>
<span>    <span class='va'>vecPointShapes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>pointShapeRelDet</span> , <span class='va'>pointShapeRelImp</span>, <span class='va'>pointShapeNoRelChange</span><span class='op'>)</span></span>
<span>    <span class='kw'>if</span><span class='op'>(</span><span class='va'>pointShapeScheme</span> <span class='op'>==</span> <span class='st'>"NONE"</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecPointShapes</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"default"</span>, <span class='fl'>3</span><span class='op'>)</span></span>
<span>      <span class='va'>vecShapeLabels</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>""</span>, <span class='fl'>3</span><span class='op'>)</span></span>
<span>    <span class='op'>}</span></span>
<span>    <span class='kw'>if</span><span class='op'>(</span><span class='va'>pointShapeScheme</span> <span class='op'>==</span> <span class='st'>"DIRECTION"</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecPointShapes</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Det"</span>, <span class='st'>"Imp"</span>, <span class='st'>"NoChange"</span><span class='op'>)</span></span>
<span>      <span class='va'>vecShapeLabels</span> <span class='op'>=</span> <span class='va'>labelsDirection</span></span>
<span>    <span class='op'>}</span></span>
<span>    <span class='kw'>if</span><span class='op'>(</span><span class='va'>pointShapeScheme</span> <span class='op'>==</span> <span class='st'>"RCI3"</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecPointShapes</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"RelDet"</span>, <span class='st'>"RelImp"</span>, <span class='st'>"NoRelChange"</span><span class='op'>)</span></span>
<span>      <span class='va'>vecShapeLabels</span> <span class='op'>&lt;-</span> <span class='va'>labelsRCI3</span></span>
<span>    <span class='op'>}</span></span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  <span class='co'>### </span></span>
<span>  <span class='co'>### OK now handle the data</span></span>
<span>  <span class='co'>###</span></span>
<span>   </span>
<span>  <span class='co'>### start of main function to use the score data</span></span>
<span>  <span class='co'>###</span></span>
<span>  <span class='co'>### start with names for points if supplied or not</span></span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>pointNames</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>pointNames</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>pointNames</span><span class='op'>)</span> </span>
<span>  <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span></span>
<span>    <span class='va'>pointNames</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>baselineScores</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  <span class='co'>### get score range (may come in useful positioning things on plot)</span></span>
<span>  <span class='va'>scoreRange</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>maxPossScore</span> <span class='op'>-</span> <span class='va'>minPossScore</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='co'>### OK now build the data</span></span>
<span>  <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>pointNames <span class='op'>=</span> <span class='va'>pointNames</span>,</span>
<span>         firstScore <span class='op'>=</span> <span class='va'>baselineScores</span>,</span>
<span>         lastScore <span class='op'>=</span> <span class='va'>finalScores</span>,</span>
<span>         goodScorePos <span class='op'>=</span> <span class='va'>goodScorePos</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span>  </span>
<span>  <span class='co'>### deal with situations of not having been given a CSC or RCI (or both missing)</span></span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>CSC</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>RCI</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='co'># transfer pertinent arguments which are really only:</span></span>
<span>    <span class='co'># tmpTib, minPoss &amp; maxPoss, noChangeline and default point and direction arguments</span></span>
<span>    <span class='co'># JacobsonPlotNoRCSC() </span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span> </span>
<span>  <span class='co'>### deal with not having been given an RCI</span></span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>RCI</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='co'># JacobsonPlotNoRCI() # transfer pertinent arguments</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>CSC</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='co'># JacobsonPlotNoCSC() # transfer pertinent arguments</span></span>
<span>    <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  <span class='co'>###</span></span>
<span>  <span class='co'>### now get the missing data summary information</span></span>
<span>  <span class='co'>###</span></span>
<span>  <span class='va'>Original_n</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>tmpTib</span><span class='op'>)</span></span>
<span>  <span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/reframe.html'>reframe</a></span><span class='op'>(</span>FirstMissing <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/CECPfuns/man/getNNA.html'>getNNA</a></span><span class='op'>(</span><span class='va'>firstScore</span><span class='op'>)</span>,</span>
<span>            LastMissing <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/CECPfuns/man/getNNA.html'>getNNA</a></span><span class='op'>(</span><span class='va'>lastScore</span><span class='op'>)</span>,</span>
<span>            <span class='co'>### now we are in the full RCSC situation with a CSC and RCI, so ...</span></span>
<span>            nStartTroubled <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>goodScorePos</span>, </span>
<span>                                     <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>firstScore</span> <span class='op'>&lt;=</span> <span class='va'>CSC</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,</span>
<span>                                     <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>firstScore</span> <span class='op'>&gt;=</span> <span class='va'>CSC</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>            nStartOK <span class='op'>=</span> <span class='va'>Original_n</span> <span class='op'>-</span> <span class='va'>nStartTroubled</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span>cols <span class='op'>=</span> <span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTibMissing</span></span>
<span>  </span>
<span>  <span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='co'>### get rid of those with missing scores</span></span>
<span>    <span class='fu'><a href='https://tidyr.tidyverse.org/reference/drop_na.html'>drop_na</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span>  <span class='va'>Complete</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>tmpTib</span><span class='op'>)</span></span>
<span>  <span class='va'>Incomplete</span> <span class='op'>&lt;-</span> <span class='va'>Original_n</span> <span class='op'>-</span> <span class='va'>Complete</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>Original_n <span class='op'>=</span> <span class='va'>Original_n</span>,</span>
<span>         Incomplete <span class='op'>=</span> <span class='va'>Incomplete</span>,</span>
<span>         Complete <span class='op'>=</span> <span class='va'>Complete</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>    <span class='fu'><a href='https://tidyr.tidyverse.org/reference/pivot_longer.html'>pivot_longer</a></span><span class='op'>(</span>cols <span class='op'>=</span> <span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib2</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind_rows.html'>bind_rows</a></span><span class='op'>(</span><span class='va'>tmpTibMissing</span>,</span>
<span>            <span class='va'>tmpTib2</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='va'>value</span>,</span>
<span>           What <span class='op'>=</span> <span class='va'>name</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>What <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>ordered</a></span><span class='op'>(</span><span class='va'>What</span>,</span>
<span>                          levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Original_n"</span>,</span>
<span>                                     <span class='st'>"FirstMissing"</span>,</span>
<span>                                     <span class='st'>"LastMissing"</span>,</span>
<span>                                     <span class='st'>"Incomplete"</span>,</span>
<span>                                     <span class='st'>"Complete"</span>,</span>
<span>                                     <span class='st'>"nStartOK"</span>,</span>
<span>                                     <span class='st'>"nStartTroubled"</span><span class='op'>)</span>,</span>
<span>                          labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Original data"</span>,</span>
<span>                                     <span class='st'>"Missing first score"</span>,</span>
<span>                                     <span class='st'>"Missing last score"</span>,</span>
<span>                                     <span class='st'>"Incomplete (either score missing)"</span>,</span>
<span>                                     <span class='st'>"Complete data"</span>,</span>
<span>                                     <span class='st'>"Started in non-help-seeking range"</span>,</span>
<span>                                     <span class='st'>"Started in help-seeking range"</span></span>
<span>                                     <span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>What</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTibMissing</span></span>
<span>  </span>
<span>  <span class='va'>tmpTibMissing</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>What</span> <span class='op'>==</span> <span class='st'>"Started in help-seeking range"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>nHelpSeeking</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/rm.html'>rm</a></span><span class='op'>(</span><span class='va'>tmpTib2</span><span class='op'>)</span></span>
<span>  <span class='co'>### finished summarising missing data</span></span>
<span>  </span>
<span>  <span class='co'>### start processing the data</span></span>
<span>  <span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>RCIcrit <span class='op'>=</span> <span class='va'>RCI</span>,</span>
<span>           CSCcrit <span class='op'>=</span> <span class='va'>CSC</span>, </span>
<span>           firstLastChange <span class='op'>=</span> <span class='va'>lastScore</span> <span class='op'>-</span> <span class='va'>firstScore</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span>  </span>
<span>  <span class='co'>### I don't like this but ...</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>omitNHS</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>startHS <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>goodScorePos</span>, </span>
<span>                              <span class='va'>firstScore</span> <span class='op'>&lt;=</span> <span class='va'>CSCcrit</span>,</span>
<span>                              <span class='va'>firstScore</span> <span class='op'>&gt;=</span> <span class='va'>CSCcrit</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>startHS</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span><span class='co'>### can now build the default subtitle</span></span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>subtitle</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>subtitle</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Showing "</span>, </span>
<span>                      <span class='va'>Complete</span>,</span>
<span>                      <span class='st'>" with first and last scores from "</span>,</span>
<span>                      <span class='va'>Original_n</span>,</span>
<span>                      <span class='st'>" rows in the dataset;\n"</span>,</span>
<span>                      <span class='va'>nHelpSeeking</span>,</span>
<span>                      <span class='st'>" in help-seeking score range, "</span>,</span>
<span>                      <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>tmpTib</span><span class='op'>)</span>,</span>
<span>                      <span class='st'>" used."</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  <span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span><span class='co'>### get direction</span></span>
<span>           direction3 <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span><span class='va'>firstLastChange</span> <span class='op'>==</span> <span class='fl'>0</span> <span class='op'>~</span> <span class='st'>"NoChange"</span>,</span>
<span>                                  <span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>firstLastChange</span> <span class='op'>&lt;</span> <span class='fl'>0</span> <span class='op'>~</span> <span class='st'>"Det"</span>,</span>
<span>                                  <span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>firstLastChange</span> <span class='op'>&gt;</span> <span class='fl'>0</span> <span class='op'>~</span> <span class='st'>"Imp"</span>,</span>
<span>                                  <span class='op'>!</span><span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>firstLastChange</span> <span class='op'>&lt;</span> <span class='fl'>0</span> <span class='op'>~</span> <span class='st'>"Imp"</span>,</span>
<span>                                  <span class='op'>!</span><span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>firstLastChange</span> <span class='op'>&gt;</span> <span class='fl'>0</span> <span class='op'>~</span> <span class='st'>"Det"</span><span class='op'>)</span>,</span>
<span>           <span class='co'>### now get RCI categories: </span></span>
<span>           RCIchange <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>firstLastChange</span><span class='op'>)</span> <span class='op'>&lt;</span> <span class='va'>RCIcrit</span>, <span class='st'>"NoRelChange"</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Rel"</span>, <span class='va'>direction3</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>           firstCSCstatus <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span><span class='op'>!</span><span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>firstScore</span> <span class='op'>&gt;=</span> <span class='va'>CSCcrit</span> <span class='op'>~</span> <span class='st'>"HS"</span>, </span>
<span>                                      <span class='op'>!</span><span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>firstScore</span> <span class='op'>&lt;</span> <span class='va'>CSCcrit</span> <span class='op'>~</span> <span class='st'>"NHS"</span>,</span>
<span>                                      <span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>firstScore</span> <span class='op'>&lt;</span> <span class='va'>CSCcrit</span> <span class='op'>~</span> <span class='st'>"HS"</span>, </span>
<span>                                      <span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>firstScore</span> <span class='op'>&gt;=</span> <span class='va'>CSCcrit</span> <span class='op'>~</span> <span class='st'>"NHS"</span><span class='op'>)</span>,</span>
<span>           lastCSCstatus <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span><span class='op'>!</span><span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>lastScore</span> <span class='op'>&gt;=</span> <span class='va'>CSCcrit</span> <span class='op'>~</span> <span class='st'>"HS"</span>, </span>
<span>                                     <span class='op'>!</span><span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>lastScore</span> <span class='op'>&lt;</span> <span class='va'>CSCcrit</span> <span class='op'>~</span> <span class='st'>"NHS"</span>,</span>
<span>                                     <span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>lastScore</span> <span class='op'>&lt;</span> <span class='va'>CSCcrit</span> <span class='op'>~</span> <span class='st'>"HS"</span>, </span>
<span>                                     <span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>lastScore</span> <span class='op'>&gt;=</span> <span class='va'>CSCcrit</span> <span class='op'>~</span> <span class='st'>"NHS"</span><span class='op'>)</span>,</span>
<span>           CSC4 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>firstCSCstatus</span>, <span class='st'>"To"</span>, <span class='va'>lastCSCstatus</span><span class='op'>)</span>,</span>
<span>           RCSC5 <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>             <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"NoRelChange"</span> <span class='op'>~</span> <span class='st'>"NoRelChange"</span>,</span>
<span>             <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"RelDet"</span>  <span class='op'>~</span> <span class='st'>"RelDet"</span>,</span>
<span>             <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"RelImp"</span> <span class='op'>&amp;</span> <span class='va'>CSC4</span> <span class='op'>==</span> <span class='st'>"HSToHS"</span> <span class='op'>~</span> <span class='st'>"RelImpHSToHS"</span>,</span>
<span>             <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"RelImp"</span> <span class='op'>&amp;</span> <span class='va'>CSC4</span> <span class='op'>==</span> <span class='st'>"HSToNHS"</span> <span class='op'>~</span> <span class='st'>"RelImpHSToNHS"</span>,</span>
<span>             <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"RelImp"</span> <span class='op'>&amp;</span> <span class='va'>CSC4</span> <span class='op'>==</span> <span class='st'>"NHSToNHS"</span> <span class='op'>~</span> <span class='st'>"RelImpNHSToNHS"</span><span class='op'>)</span>,</span>
<span>           RCSC7 <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>             <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"NoRelChange"</span> <span class='op'>~</span> <span class='st'>"NoRelChange"</span>,</span>
<span>             <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"RelDet"</span> <span class='op'>&amp;</span> <span class='va'>CSC4</span> <span class='op'>==</span> <span class='st'>"HSToHS"</span> <span class='op'>~</span> <span class='st'>"RelDetHSToHS"</span>,</span>
<span>             <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"RelDet"</span> <span class='op'>&amp;</span> <span class='va'>CSC4</span> <span class='op'>==</span> <span class='st'>"NHSToNHS"</span> <span class='op'>~</span> <span class='st'>"RelDetNHSToNHS"</span>,</span>
<span>             <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"RelDet"</span> <span class='op'>&amp;</span> <span class='va'>CSC4</span> <span class='op'>==</span> <span class='st'>"NHSToHS"</span> <span class='op'>~</span> <span class='st'>"RelDetNHSToHS"</span>,</span>
<span>             <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"RelImp"</span> <span class='op'>&amp;</span> <span class='va'>CSC4</span> <span class='op'>==</span> <span class='st'>"HSToHS"</span> <span class='op'>~</span> <span class='st'>"RelImpHSToHS"</span>,</span>
<span>             <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"RelImp"</span> <span class='op'>&amp;</span> <span class='va'>CSC4</span> <span class='op'>==</span> <span class='st'>"HSToNHS"</span> <span class='op'>~</span> <span class='st'>"RelImpHSToNHS"</span>,</span>
<span>             <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"RelImp"</span> <span class='op'>&amp;</span> <span class='va'>CSC4</span> <span class='op'>==</span> <span class='st'>"NHSToNHS"</span> <span class='op'>~</span> <span class='st'>"RelImpNHSToNHS"</span><span class='op'>)</span>,</span>
<span>           RCSC10 <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>             <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"NoRelChange"</span> <span class='op'>&amp;</span> <span class='va'>CSC4</span> <span class='op'>==</span> <span class='st'>"HSToHS"</span> <span class='op'>~</span> <span class='st'>"NoRelChangeHSToHS"</span>,</span>
<span>             <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"NoRelChange"</span> <span class='op'>&amp;</span> <span class='va'>CSC4</span> <span class='op'>==</span> <span class='st'>"HSToNHS"</span> <span class='op'>~</span> <span class='st'>"NoRelChangeHSToNHS"</span>,</span>
<span>             <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"NoRelChange"</span> <span class='op'>&amp;</span> <span class='va'>CSC4</span> <span class='op'>==</span> <span class='st'>"NHSToNHS"</span> <span class='op'>~</span> <span class='st'>"NoRelChangeNHSToNHS"</span>,</span>
<span>             <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"NoRelChange"</span> <span class='op'>&amp;</span> <span class='va'>CSC4</span> <span class='op'>==</span> <span class='st'>"NHSToHS"</span> <span class='op'>~</span> <span class='st'>"NoRelChangeNHSToHS"</span>,</span>
<span>             <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"RelDet"</span> <span class='op'>&amp;</span> <span class='va'>CSC4</span> <span class='op'>==</span> <span class='st'>"HSToHS"</span> <span class='op'>~</span> <span class='st'>"RelDetHSToHS"</span>,</span>
<span>             <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"RelDet"</span> <span class='op'>&amp;</span> <span class='va'>CSC4</span> <span class='op'>==</span> <span class='st'>"NHSToHS"</span> <span class='op'>~</span> <span class='st'>"RelDetNHSToHS"</span>,</span>
<span>             <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"RelDet"</span> <span class='op'>&amp;</span> <span class='va'>CSC4</span> <span class='op'>==</span> <span class='st'>"NHSToNHS"</span> <span class='op'>~</span> <span class='st'>"RelDetNHSToNHS"</span>,</span>
<span>             <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"RelImp"</span> <span class='op'>&amp;</span> <span class='va'>CSC4</span> <span class='op'>==</span> <span class='st'>"HSToHS"</span> <span class='op'>~</span> <span class='st'>"RelImpHSToHS"</span>,</span>
<span>             <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"RelImp"</span> <span class='op'>&amp;</span> <span class='va'>CSC4</span> <span class='op'>==</span> <span class='st'>"HSToNHS"</span> <span class='op'>~</span> <span class='st'>"RelImpHSToNHS"</span>,</span>
<span>             <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"RelImp"</span> <span class='op'>&amp;</span> <span class='va'>CSC4</span> <span class='op'>==</span> <span class='st'>"NHSToNHS"</span> <span class='op'>~</span> <span class='st'>"RelImpNHSToNHS"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span>  </span>
<span>  <span class='co'>### handle shapes</span></span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='va'>pointShapeScheme</span> <span class='op'>==</span> <span class='st'>"NONE"</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Shapes <span class='op'>=</span> <span class='st'>"default"</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span>  <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span></span>
<span>    <span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Shapes <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span><span class='va'>pointShapeScheme</span> <span class='op'>==</span> <span class='st'>"DIRECTION"</span> <span class='op'>~</span> <span class='va'>direction3</span>,</span>
<span>                              <span class='va'>pointShapeScheme</span> <span class='op'>==</span> <span class='st'>"RCI3"</span> <span class='op'>~</span> <span class='va'>RCIchange</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='co'>### now set up the shapes to use</span></span>
<span>  <span class='co'>### handle nameRCIDetOnly, i.e. labelling only of reliably deteriorated</span></span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='va'>nameRCIDetOnly</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='co'>### recode pointNames so only reliable deteriorators have an ID/name</span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>pointNames <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>RCIchange</span> <span class='op'>!=</span> <span class='st'>"RelDet"</span>, <span class='st'>""</span>, <span class='va'>pointNames</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  <span class='co'>### build tibAreas</span></span>
<span>  <span class='fu'><a href='https://tibble.tidyverse.org/reference/tribble.html'>tribble</a></span><span class='op'>(</span></span>
<span>    <span class='op'>~</span><span class='va'>iPolygon</span>, <span class='op'>~</span><span class='va'>namePolygon</span>, <span class='op'>~</span><span class='va'>RCI</span>, <span class='op'>~</span><span class='va'>direction</span>, <span class='op'>~</span><span class='va'>start</span>, <span class='op'>~</span><span class='va'>end</span>, <span class='op'>~</span><span class='va'>CSC4</span>,</span>
<span>    <span class='fl'>1</span>, <span class='st'>"RelDetHighToHigh"</span>,         <span class='st'>"RelDet"</span>,      <span class='st'>"Det"</span>, <span class='st'>"High"</span>, <span class='st'>"High"</span>, <span class='st'>"StayedHigh"</span>,</span>
<span>    <span class='fl'>2</span>, <span class='st'>"NoRelChangeDetHighToHigh"</span>, <span class='st'>"NoRelChange"</span>, <span class='st'>"Det"</span>, <span class='st'>"High"</span>, <span class='st'>"High"</span>, <span class='st'>"StayedHigh"</span>,</span>
<span>    <span class='fl'>3</span>, <span class='st'>"NoRelChangeImpHighToHigh"</span>, <span class='st'>"NoRelChange"</span>, <span class='st'>"Imp"</span>, <span class='st'>"High"</span>, <span class='st'>"High"</span>, <span class='st'>"StayedHigh"</span>,</span>
<span>    <span class='fl'>4</span>, <span class='st'>"RelImpHighToHigh"</span>,         <span class='st'>"RelImp"</span>,      <span class='st'>"Imp"</span>, <span class='st'>"High"</span>, <span class='st'>"High"</span>, <span class='st'>"StayedHigh"</span>,</span>
<span>    <span class='fl'>5</span>, <span class='st'>"RelImpHighToLow"</span>,          <span class='st'>"RelImp"</span>,      <span class='st'>"Imp"</span>, <span class='st'>"High"</span>, <span class='st'>"Low"</span>,   <span class='st'>"HighToLow"</span>,</span>
<span>    <span class='fl'>6</span>, <span class='st'>"RelImpLowToLow"</span>,           <span class='st'>"RelImp"</span>,      <span class='st'>"Imp"</span>, <span class='st'>"Low"</span>,  <span class='st'>"Low"</span>,   <span class='st'>"StayedLow"</span>,</span>
<span>    <span class='fl'>7</span>, <span class='st'>"NoRelChangeImpLowToLow"</span>,   <span class='st'>"NoRelChange"</span>, <span class='st'>"Imp"</span>, <span class='st'>"Low"</span>,  <span class='st'>"Low"</span>,   <span class='st'>"StayedLow"</span>,</span>
<span>    <span class='fl'>8</span>, <span class='st'>"NoRelChangeDetLowToLow"</span>,   <span class='st'>"NoRelChange"</span>, <span class='st'>"Det"</span>, <span class='st'>"Low"</span>,  <span class='st'>"Low"</span>,   <span class='st'>"StayedLow"</span>,</span>
<span>    <span class='fl'>9</span>, <span class='st'>"RelDetLowToLow"</span>,           <span class='st'>"RelDet"</span>,      <span class='st'>"Det"</span>, <span class='st'>"Low"</span>,  <span class='st'>"Low"</span>,   <span class='st'>"StayedLow"</span>,</span>
<span>    <span class='fl'>10</span>, <span class='st'>"RelDetLowToHigh"</span>,         <span class='st'>"RelDet"</span>,      <span class='st'>"Det"</span>, <span class='st'>"Low"</span>,  <span class='st'>"High"</span>,  <span class='st'>"LowToHigh"</span>,</span>
<span>    <span class='fl'>11</span>, <span class='st'>"NoRelChangeDetLowToHigh"</span>,  <span class='st'>"NoRelChange"</span>, <span class='st'>"Det"</span>, <span class='st'>"Low"</span>,  <span class='st'>"High"</span>,  <span class='st'>"LowToHigh"</span>,</span>
<span>    <span class='fl'>12</span>, <span class='st'>"NoRelChangeImpHighToLow"</span>, <span class='st'>"NoRelChange"</span>, <span class='st'>"Imp"</span>, <span class='st'>"High"</span>, <span class='st'>"Low"</span>,   <span class='st'>"HighToLow"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>areaAlpha <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='va'>areaAlpha</span>, <span class='fl'>12</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibAreas1</span></span>
<span></span>
<span>  <span class='co'>### handle goodScorePos for direction</span></span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='va'>goodScorePos</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>tibAreas1</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>direction <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>        <span class='va'>direction</span> <span class='op'>==</span> <span class='st'>"Det"</span> <span class='op'>~</span> <span class='st'>"Imp"</span>,</span>
<span>        <span class='va'>direction</span> <span class='op'>==</span> <span class='st'>"Imp"</span> <span class='op'>~</span> <span class='st'>"Det"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibAreas1</span></span>
<span>  <span class='op'>}</span></span>
<span>    <span class='co'>### handle goodScorePos for RCI</span></span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='va'>goodScorePos</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>tibAreas1</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>RCI <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>        <span class='va'>RCI</span> <span class='op'>==</span> <span class='st'>"RelDet"</span> <span class='op'>~</span> <span class='st'>"RelImp"</span>,</span>
<span>        <span class='va'>RCI</span> <span class='op'>==</span> <span class='st'>"RelImp"</span> <span class='op'>~</span> <span class='st'>"RelDet"</span>,</span>
<span>        <span class='va'>RCI</span> <span class='op'>==</span> <span class='st'>"NoRelChange"</span> <span class='op'>~</span> <span class='st'>"NoRelChange"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibAreas1</span></span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  <span class='co'># RCSC5 for areas:  </span></span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='va'>goodScorePos</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>tmpVecRCSC5</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"RelDet"</span>, <span class='co'>#1</span></span>
<span>                     <span class='st'>"NoRelChange"</span>, <span class='co'>#2</span></span>
<span>                     <span class='st'>"NoRelChange"</span>, <span class='co'>#3</span></span>
<span>                     <span class='st'>"RelImpHighToHigh"</span>, <span class='co'>#4</span></span>
<span>                     <span class='st'>"RelImpHighToLow"</span>, <span class='co'>#5</span></span>
<span>                     <span class='st'>"RelImpLowToLow"</span>, <span class='co'>#6</span></span>
<span>                     <span class='st'>"NoRelChange"</span>, <span class='co'>#7</span></span>
<span>                     <span class='st'>"NoRelChange"</span>, <span class='co'>#8</span></span>
<span>                     <span class='st'>"RelDet"</span>, <span class='co'>#9</span></span>
<span>                     <span class='st'>"RelDet"</span>, <span class='co'>#10</span></span>
<span>                     <span class='st'>"NoRelChange"</span>, <span class='co'>#11</span></span>
<span>                     <span class='st'>"NoRelChange"</span> <span class='co'>#12</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span></span>
<span>    <span class='va'>tmpVecRCSC5</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"RelImpHighToHigh"</span>, <span class='co'>#1</span></span>
<span>                     <span class='st'>"NoRelChange"</span>, <span class='co'>#2</span></span>
<span>                     <span class='st'>"NoRelChange"</span>, <span class='co'>#3</span></span>
<span>                     <span class='st'>"RelDet"</span>, <span class='co'>#4</span></span>
<span>                     <span class='st'>"RelDet"</span>, <span class='co'>#5</span></span>
<span>                     <span class='st'>"RelDet"</span>, <span class='co'>#6</span></span>
<span>                     <span class='st'>"NoRelChange"</span>, <span class='co'>#7</span></span>
<span>                     <span class='st'>"NoRelChange"</span>, <span class='co'>#8</span></span>
<span>                     <span class='st'>"RelImpLowToLow"</span>, <span class='co'>#9</span></span>
<span>                     <span class='st'>"RelImpLowToHigh"</span>, <span class='co'>#10</span></span>
<span>                     <span class='st'>"NoRelChange"</span>, <span class='co'>#11</span></span>
<span>                     <span class='st'>"NoRelChange"</span> <span class='co'>#12</span></span>
<span>    <span class='op'>)</span> </span>
<span>  <span class='op'>}</span></span>
<span>  <span class='va'>tibAreas1</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>RCSC5 <span class='op'>=</span> <span class='va'>tmpVecRCSC5</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibAreas1</span></span>
<span>  </span>
<span>  <span class='co'># RCSC7 for areas: </span></span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='va'>goodScorePos</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>tmpVecRCSC7</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"RelDetHSToHS"</span>, <span class='co'>#1</span></span>
<span>                     <span class='st'>"NoRelChange"</span>, <span class='co'>#2</span></span>
<span>                     <span class='st'>"NoRelChange"</span>, <span class='co'>#3</span></span>
<span>                     <span class='st'>"RelImpHSToHS"</span>, <span class='co'>#4</span></span>
<span>                     <span class='st'>"RelImpHSToNHS"</span>, <span class='co'>#5</span></span>
<span>                     <span class='st'>"RelImpNHSToNHS"</span>, <span class='co'>#6</span></span>
<span>                     <span class='st'>"NoRelChange"</span>, <span class='co'>#7</span></span>
<span>                     <span class='st'>"NoRelChange"</span>, <span class='co'>#8</span></span>
<span>                     <span class='st'>"RelDetNHSToNHS"</span>, <span class='co'>#9</span></span>
<span>                     <span class='st'>"RelDetNHSToHS"</span>, <span class='co'>#10</span></span>
<span>                     <span class='st'>"NoRelChange"</span>, <span class='co'>#11</span></span>
<span>                     <span class='st'>"NoRelChange"</span> <span class='co'>#12</span></span>
<span>    <span class='op'>)</span> </span>
<span>  <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span></span>
<span>    <span class='va'>tmpVecRCSC7</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"RelImpNHSToNHS"</span>, <span class='co'>#1</span></span>
<span>                     <span class='st'>"NoRelChange"</span>, <span class='co'>#2</span></span>
<span>                     <span class='st'>"NoRelChange"</span>, <span class='co'>#3</span></span>
<span>                     <span class='st'>"RelDetNHSToNHS"</span>, <span class='co'>#4</span></span>
<span>                     <span class='st'>"RelDetNHSToHS"</span>, <span class='co'>#5</span></span>
<span>                     <span class='st'>"RelDetHSToHS"</span>, <span class='co'>#6</span></span>
<span>                     <span class='st'>"NoRelChange"</span>, <span class='co'>#7</span></span>
<span>                     <span class='st'>"NoRelChange"</span>, <span class='co'>#8</span></span>
<span>                     <span class='st'>"RelImpHSToHS"</span>, <span class='co'>#9</span></span>
<span>                     <span class='st'>"RelImpHSToNHS"</span>, <span class='co'>#10</span></span>
<span>                     <span class='st'>"NoRelChange"</span>, <span class='co'>#11</span></span>
<span>                     <span class='st'>"NoRelChange"</span> <span class='co'>#12</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='va'>tibAreas1</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>RCSC7 <span class='op'>=</span> <span class='va'>tmpVecRCSC7</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibAreas1</span></span>
<span>  </span>
<span>  <span class='co'># RCSC10 for areas: </span></span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='va'>goodScorePos</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>tmpVecRCSC10</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"RelDetHSToHS"</span>,  <span class='co'>#1 </span></span>
<span>                      <span class='st'>"NoRelChangeHSToHS"</span>, <span class='co'>#2 </span></span>
<span>                      <span class='st'>"NoRelChangeHSToHS"</span>, <span class='co'>#3</span></span>
<span>                      <span class='st'>"RelImpHSToHS"</span>, <span class='co'>#4</span></span>
<span>                      <span class='st'>"RelImpHSToNHS"</span>, <span class='co'>#5</span></span>
<span>                      <span class='st'>"RelImpNHSToNHS"</span>, <span class='co'>#6</span></span>
<span>                      <span class='st'>"NoRelChangeNHSToNHS"</span>, <span class='co'>#7</span></span>
<span>                      <span class='st'>"NoRelChangeNHSToNHS"</span>, <span class='co'>#8</span></span>
<span>                      <span class='st'>"RelDetNHSToNHS"</span>, <span class='co'>#9</span></span>
<span>                      <span class='st'>"RelDetNHSToHS"</span>,  <span class='co'>#10,</span></span>
<span>                      <span class='st'>"NoRelChangeNHSToHS"</span>, <span class='co'>#11</span></span>
<span>                      <span class='co'># and finally for #12</span></span>
<span>                      <span class='st'>"NoRelChangeHSToNHS"</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span></span>
<span>    <span class='va'>tmpVecRCSC10</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"RelImpNHSToNHS"</span>,  <span class='co'>#1 </span></span>
<span>                      <span class='st'>"NoRelChangeNHSToNHS"</span>, <span class='co'>#2 </span></span>
<span>                      <span class='st'>"NoRelChangeNHSToNHS"</span>, <span class='co'>#3</span></span>
<span>                      <span class='st'>"RelDetNHSToNHS"</span>, <span class='co'>#4</span></span>
<span>                      <span class='st'>"RelDetNHSToHS"</span>, <span class='co'>#5</span></span>
<span>                      <span class='st'>"RelDetHSToHS"</span>, <span class='co'>#6</span></span>
<span>                      <span class='st'>"NoRelChangeHSToHS"</span>, <span class='co'>#7</span></span>
<span>                      <span class='st'>"NoRelChangeHSToHS"</span>, <span class='co'>#8</span></span>
<span>                      <span class='st'>"RelImpHSToHS"</span>, <span class='co'>#9</span></span>
<span>                      <span class='st'>"RelImpHSToNHS"</span>,  <span class='co'>#10,</span></span>
<span>                      <span class='st'>"NoRelChangeHSToNHS"</span>, <span class='co'>#11</span></span>
<span>                      <span class='co'># and finally for #12</span></span>
<span>      <span class='st'>"NoRelChangeNHSToHS"</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='va'>tibAreas1</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>RCSC10 <span class='op'>=</span> <span class='va'>tmpVecRCSC10</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibAreas1</span></span>
<span>  </span>
<span>  <span class='co'>### get names in correct order</span></span>
<span>  <span class='va'>tibAreas1</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>namePolygon</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>vecAreas</span></span>
<span>  <span class='va'>tibAreas1</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>namePolygon <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>ordered</a></span><span class='op'>(</span><span class='va'>namePolygon</span>,</span>
<span>                                 levels <span class='op'>=</span> <span class='va'>vecAreas</span>,</span>
<span>                                 labels <span class='op'>=</span> <span class='va'>vecAreas</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibAreas1</span></span>
<span>  </span>
<span>  <span class='co'>### use that to build the 12 tiling polygons</span></span>
<span>  <span class='co'>### I've done this rather clumsily, longhand!</span></span>
<span>  <span class='co'># 1 relDetHighToHigh</span></span>
<span>  <span class='va'>dfPolygonRelDetHighToHigh</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>CSC</span>,       <span class='va'>maxPossScore</span> <span class='op'>-</span> <span class='va'>RCI</span>, <span class='va'>CSC</span><span class='op'>)</span>,</span>
<span>                                          y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>CSC</span> <span class='op'>+</span> <span class='va'>RCI</span>, <span class='va'>maxPossScore</span>,       <span class='va'>maxPossScore</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='co'># 2 noRelChangeDetHighToHigh</span></span>
<span>  <span class='va'>dfPolygonNoRelChangeDetHighToHigh</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>CSC</span>, <span class='va'>maxPossScore</span>, <span class='va'>maxPossScore</span> <span class='op'>-</span> <span class='va'>RCI</span>, <span class='va'>CSC</span><span class='op'>)</span>,</span>
<span>                                                  y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>CSC</span>,  <span class='va'>maxPossScore</span>, <span class='va'>maxPossScore</span>, <span class='va'>CSC</span> <span class='op'>+</span> <span class='va'>RCI</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='co'># 3 noRelChangeImpHighToHigh</span></span>
<span>  <span class='va'>dfPolygonNoRelChangeImpHighToHigh</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>CSC</span>, <span class='va'>CSC</span> <span class='op'>+</span> <span class='va'>RCI</span>, <span class='va'>maxPossScore</span>,       <span class='va'>maxPossScore</span><span class='op'>)</span>,</span>
<span>                                                  y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>CSC</span>, <span class='va'>CSC</span>,       <span class='va'>maxPossScore</span> <span class='op'>-</span> <span class='va'>RCI</span>, <span class='va'>maxPossScore</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='co'># 4 relImpHighToHigh</span></span>
<span>  <span class='va'>dfPolygonRelImpHighToHigh</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>CSC</span> <span class='op'>+</span> <span class='va'>RCI</span>, <span class='va'>maxPossScore</span>, <span class='va'>maxPossScore</span><span class='op'>)</span>,</span>
<span>                                          y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>CSC</span>,       <span class='va'>CSC</span>,          <span class='va'>maxPossScore</span> <span class='op'>-</span> <span class='va'>RCI</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='co'># 5 relImpHighToLow</span></span>
<span>  <span class='va'>dfPolygonRelImpHighToLow</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>CSC</span>,          <span class='va'>CSC</span>,       <span class='va'>CSC</span> <span class='op'>+</span> <span class='va'>RCI</span>, <span class='va'>maxPossScore</span>, <span class='va'>maxPossScore</span><span class='op'>)</span>,</span>
<span>                                         y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>minPossScore</span>, <span class='va'>CSC</span> <span class='op'>-</span> <span class='va'>RCI</span>, <span class='va'>CSC</span>,       <span class='va'>CSC</span>,          <span class='va'>minPossScore</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='co'># 6 relImpLowToLow</span></span>
<span>  <span class='va'>dfPolygonRelImpLowToLow</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>minPossScore</span> <span class='op'>+</span> <span class='va'>RCI</span>, <span class='va'>CSC</span>,                <span class='va'>CSC</span><span class='op'>)</span>,</span>
<span>                                        y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>minPossScore</span>,       <span class='va'>minPossScore</span>, <span class='va'>CSC</span> <span class='op'>-</span> <span class='va'>RCI</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='co'># 7 noRelChangeImpLowToLow</span></span>
<span>  <span class='va'>dfPolygonNoRelChangeImpLowToLow</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>minPossScore</span>, <span class='va'>minPossScore</span> <span class='op'>+</span> <span class='va'>RCI</span>, <span class='va'>CSC</span>, <span class='va'>CSC</span><span class='op'>)</span>,</span>
<span>                                                y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>minPossScore</span>, <span class='va'>minPossScore</span>,       <span class='va'>CSC</span> <span class='op'>-</span> <span class='va'>RCI</span>, <span class='va'>CSC</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='co'># 8 noRelChangeDetLowToLow</span></span>
<span>  <span class='va'>dfPolygonNoRelChangeDetLowToLow</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>minPossScore</span>, <span class='va'>CSC</span>, <span class='va'>CSC</span> <span class='op'>-</span> <span class='va'>RCI</span>, <span class='va'>minPossScore</span><span class='op'>)</span>,</span>
<span>                                                y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>minPossScore</span>, <span class='va'>CSC</span>, <span class='va'>CSC</span>,       <span class='va'>RCI</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='co'># 9 relDetLowToLow</span></span>
<span>  <span class='va'>dfPolygonRelDetLowToLow</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>minPossScore</span>, <span class='va'>CSC</span> <span class='op'>-</span> <span class='va'>RCI</span>, <span class='va'>minPossScore</span><span class='op'>)</span>,</span>
<span>                                        y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>RCI</span>,          <span class='va'>CSC</span>,       <span class='va'>CSC</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='co'># 10 relDetLowToHigh</span></span>
<span>  <span class='va'>dfPolygonRelDetLowToHigh</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>minPossScore</span>, <span class='va'>CSC</span> <span class='op'>-</span> <span class='va'>RCI</span>, <span class='va'>CSC</span>,       <span class='va'>CSC</span>,          <span class='va'>minPossScore</span><span class='op'>)</span>,</span>
<span>                                         y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>CSC</span>,          <span class='va'>CSC</span>,       <span class='va'>CSC</span> <span class='op'>+</span> <span class='va'>RCI</span>, <span class='va'>maxPossScore</span>, <span class='va'>maxPossScore</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='co'># 11 noRelChangeDetLowToHigh</span></span>
<span>  <span class='va'>dfPolygonNoRelChangeDetLowToHigh</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>CSC</span> <span class='op'>-</span> <span class='va'>RCI</span>, <span class='va'>CSC</span>, <span class='va'>CSC</span><span class='op'>)</span>,</span>
<span>                                                 y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>CSC</span>,       <span class='va'>CSC</span>, <span class='va'>CSC</span> <span class='op'>+</span> <span class='va'>RCI</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='co'># 12 noRelChangeImpHighToLow</span></span>
<span>  <span class='va'>dfPolygonNoRelChangeImpHighToLow</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>CSC</span>,       <span class='va'>CSC</span>, <span class='va'>CSC</span> <span class='op'>+</span> <span class='va'>RCI</span><span class='op'>)</span>,</span>
<span>                                                 y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>CSC</span> <span class='op'>-</span> <span class='va'>RCI</span>, <span class='va'>CSC</span>, <span class='va'>CSC</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  </span>
<span>  <span class='va'>tibAreas1</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rowwise.html'>rowwise</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>nameFile <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"dfPolygon"</span>, <span class='va'>namePolygon</span><span class='op'>)</span>,</span>
<span>           tmpList <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/get.html'>get</a></span><span class='op'>(</span><span class='va'>nameFile</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://tidyr.tidyverse.org/reference/unnest.html'>unnest</a></span><span class='op'>(</span><span class='va'>tmpList</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>iPolygon</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>xCentre <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,</span>
<span>           yCentre <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>nameFile</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibAreas</span></span>
<span>  <span class='co'>### finished creating tibAreas</span></span>
<span>  <span class='co'>###</span></span>
<span>  <span class='co'>### area schemes</span></span>
<span>  <span class='co'>###</span></span>
<span>  <span class='co'>### default is to use same alpha for all 12 areas</span></span>
<span>  <span class='va'>vec12alphas</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='va'>areaAlpha</span>, <span class='fl'>12</span><span class='op'>)</span></span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='va'>areaColourScheme</span> <span class='op'>==</span> <span class='st'>"NONE"</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>areaColourScheme</span> <span class='op'>&lt;-</span> <span class='st'>"ALLWHITE"</span></span>
<span>    <span class='va'>vec12colours</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"white"</span>, <span class='fl'>12</span><span class='op'>)</span></span>
<span>    <span class='va'>vecAreaColours</span> <span class='op'>&lt;-</span> <span class='va'>vec12colours</span></span>
<span>    <span class='va'>vecAreaLabels</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>""</span>, <span class='fl'>12</span><span class='op'>)</span></span>
<span>    <span class='va'>tibAreas</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Areas <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibAreas</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='va'>areaColourScheme</span> <span class='op'>==</span> <span class='st'>"POLYGONS"</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>tibAreas</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='co'>### set the variable to use for the areas</span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Areas <span class='op'>=</span> <span class='va'>namePolygon</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibAreas</span></span>
<span>    <span class='va'>vecAreaColours</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#8DD3C7"</span>, <span class='st'>"#FFFFB3"</span>, <span class='st'>"#BEBADA"</span>, </span>
<span>                        <span class='st'>"#FB8072"</span>, <span class='st'>"#80B1D3"</span>, <span class='st'>"#FDB462"</span>,</span>
<span>                        <span class='st'>"#B3DE69"</span>, <span class='st'>"#FCCDE5"</span>, <span class='st'>"#D9D9D9"</span>, </span>
<span>                        <span class='st'>"#BC80BD"</span>, <span class='st'>"#CCEBC5"</span>, <span class='st'>"#FFED6F"</span><span class='op'>)</span></span>
<span>    <span class='co'>### now the area legend labels</span></span>
<span>    <span class='va'>vecAreaLabels</span> <span class='op'>&lt;-</span> <span class='va'>vecAreas</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='va'>areaColourScheme</span> <span class='op'>==</span> <span class='st'>"DIRECTION"</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>tibAreas</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='co'>### set the variable to use for the areas</span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Areas <span class='op'>=</span> <span class='va'>direction</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibAreas</span></span>
<span>    <span class='va'>vecAreaColours</span> <span class='op'>&lt;-</span> <span class='va'>coloursDirection</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecAreaColours</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Det"</span>, <span class='st'>"Imp"</span>, <span class='st'>"NoChange"</span><span class='op'>)</span></span>
<span>    <span class='co'>### now the legend label</span></span>
<span>    <span class='va'>vecAreaLabels</span> <span class='op'>&lt;-</span> <span class='va'>labelsDirection</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecAreaLabels</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Det"</span>, <span class='st'>"Imp"</span>, <span class='st'>"NoChange"</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='va'>areaColourScheme</span> <span class='op'>==</span> <span class='st'>"RCI3"</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>tibAreas</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='co'>### set the variable to use for the Areas</span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Areas <span class='op'>=</span> <span class='va'>RCI</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibAreas</span></span>
<span>    <span class='va'>vecAreaColours</span> <span class='op'>&lt;-</span> <span class='va'>coloursRCI3</span></span>
<span>    <span class='co'>### now the legend labels</span></span>
<span>    <span class='va'>vecAreaLabels</span> <span class='op'>&lt;-</span> <span class='va'>labelsRCI3</span></span>
<span>    <span class='co'>### and name the colours</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecAreaColours</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"NoRelChange"</span>, <span class='st'>"RelDet"</span>, <span class='st'>"RelImp"</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='va'>areaColourScheme</span> <span class='op'>==</span> <span class='st'>"CSC4"</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>tibAreas</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='co'>### set the variable to use for the Areas</span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Areas <span class='op'>=</span> <span class='va'>CSC4</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibAreas</span></span>
<span>    <span class='va'>vecAreaColours</span> <span class='op'>&lt;-</span> <span class='va'>coloursCSC4</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecAreaColours</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"HighToLow"</span>, <span class='st'>"LowToHigh"</span>, <span class='st'>"StayedHigh"</span>, <span class='st'>"StayedLow"</span><span class='op'>)</span></span>
<span>    <span class='co'>### now the legend label</span></span>
<span>    <span class='va'>vecAreaLabels</span> <span class='op'>&lt;-</span> <span class='va'>labelsCSC4</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecAreaLabels</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"HighToLow"</span>, <span class='st'>"LowToHigh"</span>, <span class='st'>"StayedHigh"</span>, <span class='st'>"StayedLow"</span><span class='op'>)</span></span>
<span>    <span class='kw'>if</span><span class='op'>(</span><span class='va'>goodScorePos</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='va'>vecAreaColours</span> <span class='op'>&lt;-</span> <span class='va'>coloursCSC4</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecAreaColours</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"LowToHigh"</span>, <span class='st'>"HighToLow"</span>, <span class='st'>"StayedLow"</span>, <span class='st'>"StayedHigh"</span><span class='op'>)</span></span>
<span>    <span class='op'>}</span></span>
<span>  <span class='op'>}</span>  </span>
<span>  </span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='va'>areaColourScheme</span> <span class='op'>==</span> <span class='st'>"RCSC5"</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>tibAreas</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='co'>### set the variable to use for the areas</span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Areas <span class='op'>=</span> <span class='va'>RCSC5</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibAreas</span></span>
<span>    <span class='va'>vecAreaColours</span> <span class='op'>&lt;-</span> <span class='va'>coloursRCSC5</span></span>
<span>    <span class='co'>### now the legend labels</span></span>
<span>    <span class='va'>vecAreaLabels</span> <span class='op'>&lt;-</span> <span class='va'>labelsRCSC5</span></span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>goodScorePos</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='va'>vecAreaLabels</span> <span class='op'>&lt;-</span> <span class='va'>labelsRCSC5pos</span></span>
<span>    <span class='op'>}</span></span>
<span>  <span class='op'>}</span>  </span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='va'>areaColourScheme</span> <span class='op'>==</span> <span class='st'>"RCSC7"</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='co'>### set the order of the colours</span></span>
<span>    <span class='va'>orderColours</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"NoRelChange"</span>,</span>
<span>                      <span class='st'>"RelDetHSToHS"</span>,</span>
<span>                      <span class='st'>"RelDetNHSToHS"</span>,</span>
<span>                      <span class='st'>"RelDetNHSToNHS"</span>,</span>
<span>                      <span class='st'>"RelImpHSToHS"</span>,</span>
<span>                      <span class='st'>"RelImpHSToNHS"</span>,</span>
<span>                      <span class='st'>"RelImpNHSToNHS"</span><span class='op'>)</span></span>
<span>    <span class='va'>tibAreas</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='co'>### set the variable to use for the areas</span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Areas <span class='op'>=</span> <span class='va'>RCSC7</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibAreas</span></span>
<span>    <span class='va'>vecAreaColours</span> <span class='op'>&lt;-</span> <span class='va'>coloursRCSC7</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecAreaColours</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>orderColours</span></span>
<span>    <span class='co'>### now the legend labels</span></span>
<span>    <span class='va'>vecAreaLabels</span> <span class='op'>&lt;-</span> <span class='va'>labelsRCSC7</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecAreaLabels</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>orderColours</span></span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>goodScorePos</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='va'>vecAreaLabels</span> <span class='op'>&lt;-</span> <span class='va'>labelsRCSC7pos</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecAreaLabels</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>orderColours</span></span>
<span>    <span class='op'>}</span></span>
<span>  <span class='op'>}</span>  </span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='va'>areaColourScheme</span> <span class='op'>==</span> <span class='st'>"RCSC10"</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='co'>### set order for colours</span></span>
<span>    <span class='va'>orderColours</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"NoRelChangeHSToHS"</span>,</span>
<span>                      <span class='st'>"NoRelChangeHSToNHS"</span>,</span>
<span>                      <span class='st'>"NoRelChangeNHSToHS"</span>,</span>
<span>                      <span class='st'>"NoRelChangeNHSToNHS"</span>,</span>
<span>                      <span class='st'>"RelDetHSToHS"</span>,</span>
<span>                      <span class='st'>"RelDetNHSToHS"</span>,</span>
<span>                      <span class='st'>"RelDetNHSToNHS"</span>,</span>
<span>                      <span class='st'>"RelImpHSToHS"</span>,</span>
<span>                      <span class='st'>"RelImpHSToNHS"</span>,</span>
<span>                      <span class='st'>"RelImpNHSToNHS"</span><span class='op'>)</span></span>
<span>    <span class='va'>tibAreas</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='co'>### set the variable to use for the areas</span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Areas <span class='op'>=</span> <span class='va'>RCSC10</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tibAreas</span></span>
<span>    <span class='va'>vecAreaColours</span> <span class='op'>&lt;-</span> <span class='va'>coloursRCSC10</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecAreaColours</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>orderColours</span></span>
<span>    <span class='co'>### now the legend label</span></span>
<span>    <span class='va'>vecAreaLabels</span> <span class='op'>&lt;-</span> <span class='va'>labelsRCSC10</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecAreaLabels</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>orderColours</span></span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>goodScorePos</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='va'>vecAreaLabels</span> <span class='op'>&lt;-</span> <span class='va'>labelsRCSC10pos</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecAreaLabels</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>orderColours</span></span>
<span>    <span class='op'>}</span></span>
<span>  <span class='op'>}</span>  </span>
<span>  </span>
<span>  <span class='co'>###</span></span>
<span>  <span class='co'>### line types</span></span>
<span>  <span class='co'>###</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>lineTypeCSC</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>lineTypeCSC</span> <span class='op'>=</span> <span class='fl'>1</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>lineTypeNoChange</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>lineTypeNoChange</span> <span class='op'>=</span> <span class='fl'>1</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>lineTypeRCI</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>lineTypeRCI</span> <span class='op'>=</span> <span class='fl'>1</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='co'>### line colours</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>lineColourCSC</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>lineColourCSC</span> <span class='op'>=</span> <span class='fl'>1</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>lineColourNoChange</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>lineColourNoChange</span> <span class='op'>=</span> <span class='fl'>1</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>lineColourRCI</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>lineColourRCI</span> <span class='op'>=</span> <span class='fl'>1</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='co'>### line widths</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>lineWidthCSC</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>lineWidthCSC</span> <span class='op'>=</span> <span class='fl'>.4</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>lineWidthNoChange</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>lineWidthNoChange</span> <span class='op'>=</span> <span class='fl'>.4</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>lineWidthRCI</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>lineWidthRCI</span> <span class='op'>=</span> <span class='fl'>.4</span></span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  <span class='co'>###</span></span>
<span>  <span class='co'>### axis labels</span></span>
<span>  <span class='co'>###</span></span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>xLab</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>xLab</span> <span class='op'>&lt;-</span> <span class='st'>"Baseline score"</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>yLab</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>yLab</span> <span class='op'>&lt;-</span> <span class='st'>"Last score"</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>title</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>title</span> <span class='op'>&lt;-</span> <span class='st'>"Jacobson plot"</span></span>
<span>  <span class='op'>}</span></span>
<span></span>
<span>  </span>
<span>  <span class='co'>###</span></span>
<span>  <span class='co'>### set point colours </span></span>
<span>  <span class='co'>###</span></span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='va'>pointColourScheme</span> <span class='op'>==</span> <span class='st'>"NONE"</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='co'>### set the variable to use for the points</span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Points <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span>    </span>
<span>    <span class='va'>vecPointColours</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"black"</span>, <span class='fl'>3</span><span class='op'>)</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecPointColours</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"black"</span>, <span class='fl'>3</span><span class='op'>)</span></span>
<span>    <span class='co'>### now the legend labels</span></span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>pointShapeScheme</span> <span class='op'>==</span> <span class='st'>"DIRECTION"</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='va'>vecPointLabels</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"No change"</span>, <span class='st'>"Deterioration"</span>, <span class='st'>"Improvement"</span><span class='op'>)</span></span>
<span>    <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span></span>
<span>      <span class='va'>vecPointLabels</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"No reliable change"</span>, <span class='st'>"Reliable deterioration"</span>, <span class='st'>"Reliable improvement"</span><span class='op'>)</span></span>
<span>    <span class='op'>}</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='va'>pointColourScheme</span> <span class='op'>==</span> <span class='st'>"DIRECTION"</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='co'>### set the variable to use for the points</span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Points <span class='op'>=</span> <span class='va'>direction3</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span>    <span class='va'>vecPointColours</span> <span class='op'>&lt;-</span> <span class='va'>coloursDirection</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecPointColours</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Det"</span>, <span class='st'>"Imp"</span>, <span class='st'>"NoChange"</span><span class='op'>)</span></span>
<span>    <span class='co'>### now the legend labels</span></span>
<span>    <span class='va'>vecPointLabels</span> <span class='op'>&lt;-</span> <span class='va'>labelsDirection</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecPointLabels</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Det"</span>, <span class='st'>"Imp"</span>, <span class='st'>"NoChange"</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='va'>pointColourScheme</span> <span class='op'>==</span> <span class='st'>"RCI3"</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='co'>### set the variable to use for the points</span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Points <span class='op'>=</span> <span class='va'>RCIchange</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span>    <span class='va'>vecPointColours</span> <span class='op'>&lt;-</span> <span class='va'>coloursRCI3</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecPointColours</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"NoRelChange"</span>, <span class='st'>"RelDet"</span>, <span class='st'>"RelImp"</span><span class='op'>)</span></span>
<span>    <span class='co'>### now the legend label</span></span>
<span>    <span class='va'>vecPointLabels</span> <span class='op'>&lt;-</span> <span class='va'>labelsRCI3</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecPointLabels</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"NoRelChange"</span>, <span class='st'>"RelDet"</span>, <span class='st'>"RelImp"</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='va'>pointColourScheme</span> <span class='op'>==</span> <span class='st'>"CSC4"</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='co'>### set the variable to use for the points</span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Points <span class='op'>=</span> <span class='va'>CSC4</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span>    <span class='va'>vecPointColours</span> <span class='op'>&lt;-</span> <span class='va'>coloursCSC4</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecPointColours</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"HSToNHS"</span>, <span class='st'>"NHSToHS"</span>, <span class='st'>"HSToHS"</span>, <span class='st'>"NHSToNHS"</span><span class='op'>)</span></span>
<span>    <span class='co'>### now the legend label</span></span>
<span>    <span class='va'>vecPointLabels</span> <span class='op'>&lt;-</span> <span class='va'>labelsCSC4</span> </span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecPointLabels</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"HSToNHS"</span>, <span class='st'>"NHSToHS"</span>, <span class='st'>"HSToHS"</span>, <span class='st'>"NHSToNHS"</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span>  </span>
<span>  </span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='va'>pointColourScheme</span> <span class='op'>==</span> <span class='st'>"RCSC5"</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='co'>### set the variable to use for the points</span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Points <span class='op'>=</span> <span class='va'>RCSC5</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span>    <span class='co'>### create vector of levels for negative cueing</span></span>
<span>    <span class='va'>vecPointsRCSC5</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"NoRelChange"</span>,</span>
<span>                        <span class='st'>"RelDet"</span>,</span>
<span>                        <span class='st'>"RelImpHSToHS"</span>,</span>
<span>                        <span class='st'>"RelImpHSToNHS"</span>,</span>
<span>                        <span class='st'>"RelImpNHSToNHS"</span><span class='op'>)</span></span>
<span>    <span class='co'>### create vector for colours</span></span>
<span>    <span class='va'>vecPointColours</span> <span class='op'>&lt;-</span> <span class='va'>coloursRCSC5</span></span>
<span>    <span class='co'>### name/label that vector</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecPointColours</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>vecPointsRCSC5</span></span>
<span>    <span class='co'>### now the legend label</span></span>
<span>    <span class='va'>vecPointLabels</span> <span class='op'>&lt;-</span> <span class='va'>labelsRCSC5</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecPointLabels</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>vecPointsRCSC5</span></span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>goodScorePos</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='co'>### create vector of levels for positive cueing</span></span>
<span>      <span class='va'>vecPointsRCSC5</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"NoRelChange"</span>,</span>
<span>                          <span class='st'>"RelDet"</span>,</span>
<span>                          <span class='st'>"RelImpNHSToNHS"</span>,</span>
<span>                          <span class='st'>"RelImpHSToNHS"</span>,</span>
<span>                          <span class='st'>"RelImpHSToHS"</span><span class='op'>)</span></span>
<span>      <span class='co'>### create vector for colours</span></span>
<span>      <span class='va'>vecPointColours</span> <span class='op'>&lt;-</span> <span class='va'>coloursRCSC5</span></span>
<span>      <span class='co'>### name/label that vector</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecPointColours</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>vecPointsRCSC5</span></span>
<span>      <span class='co'>### now the legend label</span></span>
<span>      <span class='va'>vecPointLabels</span> <span class='op'>&lt;-</span> <span class='va'>labelsRCSC5</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecPointLabels</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>vecPointsRCSC5</span></span>
<span>    <span class='op'>}</span></span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='va'>pointColourScheme</span> <span class='op'>==</span> <span class='st'>"RCSC7"</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='co'>### set the variable to use for the points</span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Points <span class='op'>=</span> <span class='va'>RCSC7</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span>    <span class='co'>### get vector of levels</span></span>
<span>    <span class='va'>vecPointsRCSC7</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"NoRelChange"</span>,</span>
<span>                        <span class='st'>"RelDetHSToHS"</span>,</span>
<span>                        <span class='st'>"RelDetNHSToHS"</span>,</span>
<span>                        <span class='st'>"RelDetNHSToNHS"</span>,                                         </span>
<span>                        <span class='st'>"RelImpHSToHS"</span>,</span>
<span>                        <span class='st'>"RelImpHSToNHS"</span>,</span>
<span>                        <span class='st'>"RelImpNHSToNHS"</span><span class='op'>)</span></span>
<span>    <span class='va'>vecPointsRCSC7</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>ordered</a></span><span class='op'>(</span><span class='va'>vecPointsRCSC7</span>,</span>
<span>                              levels <span class='op'>=</span> <span class='va'>vecPointsRCSC7</span>,</span>
<span>                              labels <span class='op'>=</span> <span class='va'>vecPointsRCSC7</span><span class='op'>)</span></span>
<span>    <span class='co'>### create vector for colours</span></span>
<span>    <span class='va'>vecPointColours</span> <span class='op'>&lt;-</span> <span class='va'>coloursRCSC7</span></span>
<span>    <span class='co'>### name/label that vector as this is what ggplot uses to map colours</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecPointColours</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>vecPointsRCSC7</span></span>
<span>    <span class='co'>### now the legend label</span></span>
<span>    <span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='va'>goodScorePos</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='va'>vecPointLabels</span> <span class='op'>&lt;-</span> <span class='va'>labelsRCSC7</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecPointLabels</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>vecPointsRCSC7</span></span>
<span>    <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span></span>
<span>      <span class='va'>vecPointLabels</span> <span class='op'>&lt;-</span> <span class='va'>labelsRCSC7pos</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecPointLabels</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>vecPointsRCSC7</span>  </span>
<span>    <span class='op'>}</span></span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='va'>pointColourScheme</span> <span class='op'>==</span> <span class='st'>"RCSC10"</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='co'>### set the variable to use for the points</span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>Points <span class='op'>=</span> <span class='va'>RCSC10</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpTib</span></span>
<span>    <span class='co'>### get vector of levels</span></span>
<span>    <span class='va'>vecPointsRCSC10</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"NoRelChangeHSToHS"</span>,</span>
<span>                         <span class='st'>"NoRelChangeHSToNHS"</span>,</span>
<span>                         <span class='st'>"NoRelChangeNHSToHS"</span>,</span>
<span>                         <span class='st'>"NoRelChangeNHSToNHS"</span>,</span>
<span>                         <span class='st'>"RelDetHSToHS"</span>,</span>
<span>                         <span class='st'>"RelDetNHSToHS"</span>,</span>
<span>                         <span class='st'>"RelDetNHSToNHS"</span>,                                         </span>
<span>                         <span class='st'>"RelImpHSToHS"</span>,</span>
<span>                         <span class='st'>"RelImpHSToNHS"</span>,</span>
<span>                         <span class='st'>"RelImpNHSToNHS"</span><span class='op'>)</span></span>
<span>    <span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='va'>goodScorePos</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='co'>### create vector for colours</span></span>
<span>      <span class='va'>vecPointColours</span> <span class='op'>&lt;-</span> <span class='va'>coloursRCSC10</span></span>
<span>      <span class='co'>### name/label that vector</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecPointColours</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>vecPointsRCSC10</span></span>
<span>      <span class='co'>### similar for the legend labels</span></span>
<span>      <span class='va'>vecPointLabels</span> <span class='op'>&lt;-</span> <span class='va'>labelsRCSC10</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecPointLabels</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>vecPointsRCSC10</span></span>
<span>    <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span></span>
<span>       <span class='co'>### create vector for colours</span></span>
<span>      <span class='va'>vecPointColours</span> <span class='op'>&lt;-</span> <span class='va'>coloursRCSC10</span></span>
<span>      <span class='co'>### name/label that vector</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecPointColours</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>vecPointsRCSC10</span></span>
<span>      <span class='va'>vecPointLabels</span> <span class='op'>&lt;-</span> <span class='va'>labelsRCSC10pos</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>vecPointLabels</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>vecPointsRCSC10</span></span>
<span>    <span class='op'>}</span></span>
<span>  <span class='op'>}</span> </span>
<span>  <span class='co'>### finally (!) start to build the plot    </span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTib</span>,</span>
<span>         <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>firstScore</span>, y <span class='op'>=</span> <span class='va'>lastScore</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='co'>### we never want a legend for alpha so kill that now </span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot</span></span>
<span>  </span>
<span>  <span class='co'>### set background and surround colours</span></span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>plotColour</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='co'># plot area</span></span>
<span>    <span class='va'>tmpPlot</span> <span class='op'>+</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>plotColour</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>borderColour</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='co'># plot area</span></span>
<span>    <span class='va'>tmpPlot</span> <span class='op'>+</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>borderColour</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot</span></span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  <span class='co'>### plot areas </span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>areaColourScheme</span> <span class='op'>!=</span> <span class='st'>"ALLWHITE"</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>tmpPlot</span> <span class='op'>+</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_polygon.html'>geom_polygon</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibAreas</span>,</span>
<span>                <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span>, group <span class='op'>=</span> <span class='va'>namePolygon</span>, fill <span class='op'>=</span> <span class='va'>Areas</span><span class='op'>)</span>,</span>
<span>                alpha <span class='op'>=</span> <span class='va'>areaAlpha</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='va'>legendNameAreas</span>,</span>
<span>                        values <span class='op'>=</span> <span class='va'>vecAreaColours</span>,</span>
<span>                        labels <span class='op'>=</span> <span class='va'>vecAreaLabels</span>,</span>
<span>                        guide <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guide_legend.html'>guide_legend</a></span><span class='op'>(</span>order <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>      <span class='co'>### allow use of new scales for colour and fill later</span></span>
<span>      <span class='fu'>ggnewscale</span><span class='fu'>::</span><span class='fu'><a href='https://eliocamp.github.io/ggnewscale/reference/new_scale.html'>new_scale_colour</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>      <span class='fu'>ggnewscale</span><span class='fu'>::</span><span class='fu'><a href='https://eliocamp.github.io/ggnewscale/reference/new_scale.html'>new_scale_fill</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot</span></span>
<span>  <span class='op'>}</span></span>
<span></span>
<span>  <span class='co'>### ### lines</span></span>
<span>  <span class='co'>### add leading diagonal of no change</span></span>
<span>  <span class='va'>tmpPlot</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_abline</a></span><span class='op'>(</span>slope <span class='op'>=</span> <span class='fl'>1</span>, intercept <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>                linetype <span class='op'>=</span> <span class='va'>lineTypeNoChange</span>,</span>
<span>                colour <span class='op'>=</span> <span class='va'>lineColourNoChange</span>,</span>
<span>                linewidth <span class='op'>=</span> <span class='va'>lineWidthNoChange</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot</span></span>
<span>  </span>
<span>  <span class='co'>### put in CSC lines</span></span>
<span>  <span class='va'>tmpPlot</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>CSC</span>,</span>
<span>               linetype <span class='op'>=</span> <span class='va'>lineTypeCSC</span>,</span>
<span>               colour <span class='op'>=</span> <span class='va'>lineColourCSC</span>,</span>
<span>               linewidth <span class='op'>=</span> <span class='va'>lineWidthCSC</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='va'>CSC</span>,</span>
<span>               linetype <span class='op'>=</span> <span class='va'>lineTypeCSC</span>,</span>
<span>               colour <span class='op'>=</span> <span class='va'>lineColourCSC</span>,</span>
<span>               linewidth <span class='op'>=</span> <span class='va'>lineWidthCSC</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot</span></span>
<span>  </span>
<span>  <span class='co'>### add RCI tramlines</span></span>
<span>  <span class='va'>tmpPlot</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_abline</a></span><span class='op'>(</span>slope <span class='op'>=</span> <span class='fl'>1</span>, intercept <span class='op'>=</span> <span class='op'>-</span><span class='va'>RCI</span>,</span>
<span>                linetype <span class='op'>=</span> <span class='va'>lineTypeRCI</span>,</span>
<span>                colour <span class='op'>=</span> <span class='va'>lineColourRCI</span>,</span>
<span>                linewidth <span class='op'>=</span> <span class='va'>lineWidthRCI</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_abline</a></span><span class='op'>(</span>slope <span class='op'>=</span> <span class='fl'>1</span>, intercept <span class='op'>=</span> <span class='va'>RCI</span>,</span>
<span>                linetype <span class='op'>=</span> <span class='va'>lineTypeRCI</span>,</span>
<span>                colour <span class='op'>=</span> <span class='va'>lineColourRCI</span>,</span>
<span>                linewidth <span class='op'>=</span> <span class='va'>lineWidthRCI</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot</span></span>
<span>  <span class='co'>### generate point mapping</span></span>
<span>  <span class='co'>### labelled points</span></span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='va'>namesNotPoints</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='va'>nameRCIDetOnly</span> <span class='op'>|</span> <span class='fu'><a href='https://rdrr.io/r/base/NULL.html'>is.null</a></span><span class='op'>(</span><span class='va'>nameRCIDetOnly</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='co'>### only makes sense to label fewer than 50 points</span></span>
<span>      <span class='kw'>if</span> <span class='op'>(</span><span class='va'>Complete</span> <span class='op'>&lt;</span> <span class='fl'>50</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>        <span class='va'>tmpPlot</span> <span class='op'>+</span></span>
<span>          <span class='fu'>ggrepel</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='va'>RCIchange</span>,</span>
<span>                                       label <span class='op'>=</span> <span class='va'>pointNames</span><span class='op'>)</span>,</span>
<span>                                   size <span class='op'>=</span> <span class='va'>namesSize</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot</span></span>
<span>      <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span></span>
<span>        <span class='co'>### got fewer than 50 points so label them</span></span>
<span>        <span class='va'>tmpPlot</span> <span class='op'>+</span></span>
<span>          <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='va'>RCIchange</span>,</span>
<span>                        label <span class='op'>=</span> <span class='va'>pointNames</span><span class='op'>)</span>,</span>
<span>                    size <span class='op'>=</span> <span class='va'>namesSize</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot</span></span>
<span>      <span class='op'>}</span></span>
<span>    <span class='op'>}</span></span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>nameRCIDetOnly</span><span class='op'>)</span><span class='op'>{</span></span>
<span>      <span class='va'>tmpPlot</span> <span class='op'>+</span></span>
<span>        <span class='fu'>ggrepel</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_text_repel</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='va'>RCIchange</span>,</span>
<span>                                     label <span class='op'>=</span> <span class='va'>pointNames</span><span class='op'>)</span>,</span>
<span>                                 size <span class='op'>=</span> <span class='va'>namesSize</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot</span></span>
<span>    <span class='op'>}</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='va'>namesNotPoints</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='co'>### this needs to be different if no point colour used</span></span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>pointColourScheme</span> <span class='op'>!=</span> <span class='st'>"NONE"</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='va'>tmpPlot</span> <span class='op'>+</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTib</span>,</span>
<span>                   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='va'>Points</span>,</span>
<span>                       fill <span class='op'>=</span> <span class='va'>Points</span>,</span>
<span>                       shape <span class='op'>=</span> <span class='va'>Shapes</span><span class='op'>)</span>,</span>
<span>                   alpha <span class='op'>=</span> <span class='va'>pointAlpha</span>,</span>
<span>                   size <span class='op'>=</span> <span class='va'>pointSize</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot</span></span>
<span>    <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span></span>
<span>      <span class='co'>### no colour scheme so:</span></span>
<span>      <span class='va'>tmpPlot</span> <span class='op'>+</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tmpTib</span>,</span>
<span>                   <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>shape <span class='op'>=</span> <span class='va'>Shapes</span><span class='op'>)</span>,</span>
<span>                   alpha <span class='op'>=</span> <span class='va'>pointAlpha</span>,</span>
<span>                   size <span class='op'>=</span> <span class='va'>pointSize</span>,</span>
<span>                   colour <span class='op'>=</span> <span class='st'>"black"</span>,</span>
<span>                   fill <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot</span></span>
<span>      <span class='co'>### I think fill and colour will default to black OK?</span></span>
<span>    <span class='op'>}</span></span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  <span class='co'>### scales</span></span>
<span>  <span class='va'>tmpPlot</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='va'>xLab</span>,</span>
<span>                       limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>minPossScore</span>, <span class='va'>maxPossScore</span><span class='op'>)</span>,</span>
<span>                       expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span> <span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='va'>yLab</span>,</span>
<span>                       limits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>minPossScore</span>, <span class='va'>maxPossScore</span><span class='op'>)</span>,</span>
<span>                       expand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span> <span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='va'>title</span>,</span>
<span>            subtitle <span class='op'>=</span> <span class='va'>subtitle</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='co'>### crucial setting to get square plot</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>aspect.ratio <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='va'>titleJustificn</span><span class='op'>)</span>,</span>
<span>          plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='va'>titleJustificn</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot</span></span>
<span>  </span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='va'>labelCSClines</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>CSC</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span> <span class='co'>### @@@</span></span>
<span>    <span class='va'>tmpPlot</span> <span class='op'>+</span></span>
<span>      <span class='co'>### these label the CSC lines.  I'm not sure they're very  informative or aesthetic.</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"CSC = "</span>,</span>
<span>                               <span class='va'>CSC</span><span class='op'>)</span>,</span>
<span>                <span class='co'># "\nfor last scores"),</span></span>
<span>                x <span class='op'>=</span> <span class='va'>scoreRange</span> <span class='op'>/</span> <span class='fl'>70</span>,</span>
<span>                y <span class='op'>=</span> <span class='va'>CSC</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>scoreRange</span> <span class='op'>/</span> <span class='fl'>70</span><span class='op'>)</span>,</span>
<span>                hjust <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>                size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"CSC = "</span>,</span>
<span>                               <span class='va'>CSC</span><span class='op'>)</span>,</span>
<span>                <span class='co'># "\nfor baseline scores"),</span></span>
<span>                x <span class='op'>=</span> <span class='va'>CSC</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>scoreRange</span> <span class='op'>/</span> <span class='fl'>70</span><span class='op'>)</span>,</span>
<span>                y <span class='op'>=</span> <span class='va'>maxPossScore</span> <span class='op'>-</span> <span class='op'>(</span><span class='va'>scoreRange</span> <span class='op'>/</span> <span class='fl'>70</span><span class='op'>)</span>,</span>
<span>                hjust <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>                size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot</span></span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  <span class='co'>### deal with legends to plot</span></span>
<span>  </span>
<span>  <span class='co'>### noLegend trumps all then ...</span></span>
<span>  <span class='co'>### otherwise select by n_distinct</span></span>
<span>  <span class='co'>### if n_distinct &gt; 0 only for area use fill and no other</span></span>
<span>  <span class='co'>### if n_distinct &gt; 0 for area and point but not shape do fill (area) and colour (points)</span></span>
<span>  <span class='co'>### if n_distinct &gt; 0 for all three </span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>noLegend</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>tmpPlot</span> <span class='op'>+</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"none"</span>,</span>
<span>             fill <span class='op'>=</span> <span class='st'>"none"</span>,</span>
<span>             shape <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot</span></span>
<span>  <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span></span>
<span>    <span class='co'>### do some counting to decide which guides you need and which legends</span></span>
<span>    <span class='va'>tibAreas</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>nAreaColours <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/n_distinct.html'>n_distinct</a></span><span class='op'>(</span><span class='va'>Areas</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>nAreaColours</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>nAreaColours</span></span>
<span>    <span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>nPointColours <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/n_distinct.html'>n_distinct</a></span><span class='op'>(</span><span class='va'>Points</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>nPointColours</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>nPointColours</span></span>
<span>    <span class='va'>tmpTib</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>nPointShapes <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/n_distinct.html'>n_distinct</a></span><span class='op'>(</span><span class='va'>Shapes</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>nPointShapes</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>      <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>nPointShapes</span></span>
<span></span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>nAreaColours</span>, <span class='va'>nPointColours</span>, <span class='va'>nPointShapes</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>{</span></span>
<span>      <span class='co'># got no variance so no legends</span></span>
<span>      <span class='va'>tmpPlot</span> <span class='op'>+</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"none"</span>,</span>
<span>               colour <span class='op'>=</span> <span class='st'>"none"</span>,</span>
<span>               shape <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot</span></span>
<span>    <span class='op'>}</span></span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>nAreaColours</span> <span class='op'>&gt;</span> <span class='fl'>1</span> <span class='op'>&amp;</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>nPointColours</span>, <span class='va'>nPointShapes</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>{</span></span>
<span>      <span class='co'># only got areas so legend only for fill</span></span>
<span>      <span class='co'>### rethink the whole setting of colour, fill &amp; shape maps</span></span>
<span>      <span class='co'>### they are done by using named values in a vector</span></span>
<span>      <span class='co'>### name by the levels of the things you are mapping i.e. direction, RCI etc.</span></span>
<span>      <span class='co'>### values are values to use, i.e. colours/fills and shapes</span></span>
<span>      <span class='co'>### set up the named vectors when you know the schemes</span></span>
<span>      <span class='va'>tmpPlot</span> <span class='op'>+</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span><span class='va'>legendNameAreas</span>,</span>
<span>                          values <span class='op'>=</span> <span class='va'>vecAreaColours</span>,</span>
<span>                          labels <span class='op'>=</span> <span class='va'>vecAreaLabels</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span><span class='va'>legendNamePoints</span>,</span>
<span>                      values <span class='op'>=</span> <span class='va'>vecPointColours</span>,</span>
<span>                      labels <span class='op'>=</span> <span class='va'>vecPointLabels</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"none"</span>,</span>
<span>               shape <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot</span></span>
<span>    <span class='op'>}</span></span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>nPointShapes</span> <span class='op'>&gt;</span> <span class='fl'>1</span> <span class='op'>&amp;</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>nPointColours</span>, <span class='va'>nAreaColours</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>{</span></span>
<span>      <span class='co'># only got shapes</span></span>
<span>      <span class='va'>tmpPlot</span> <span class='op'>+</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_shape_manual</a></span><span class='op'>(</span><span class='va'>legendNamePoints</span>,</span>
<span>                           values <span class='op'>=</span> <span class='va'>vecPointShapes</span>,</span>
<span>                           labels <span class='op'>=</span> <span class='va'>vecShapeLabels</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span><span class='va'>legendNamePoints</span>,</span>
<span>                    values <span class='op'>=</span> <span class='va'>vecPointColours</span>,</span>
<span>                    labels <span class='op'>=</span> <span class='va'>vecPointLabels</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span><span class='va'>legendNamePoints</span>,</span>
<span>                            values <span class='op'>=</span> <span class='va'>vecPointColours</span>,</span>
<span>                            labels <span class='op'>=</span> <span class='va'>vecPointLabels</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"none"</span>,</span>
<span>               fill <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot</span>  </span>
<span>    <span class='op'>}</span></span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>nPointColours</span> <span class='op'>&gt;</span> <span class='fl'>1</span> <span class='op'>&amp;</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>nAreaColours</span>, <span class='va'>nPointShapes</span><span class='op'>)</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>{</span></span>
<span>      <span class='co'># only got point colours</span></span>
<span>      <span class='va'>tmpPlot</span> <span class='op'>+</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span><span class='va'>legendNamePoints</span>,</span>
<span>                      values <span class='op'>=</span> <span class='va'>vecPointColours</span>,</span>
<span>                      labels <span class='op'>=</span> <span class='va'>vecPointLabels</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"none"</span>,</span>
<span>               shape <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot</span></span>
<span>    <span class='op'>}</span></span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>nPointShapes</span> <span class='op'>&gt;</span> <span class='fl'>1</span> <span class='op'>&amp;</span> <span class='va'>nPointColours</span> <span class='op'>&gt;</span> <span class='fl'>1</span> <span class='op'>&amp;</span> <span class='va'>nAreaColours</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>{</span></span>
<span>      <span class='co'># keep legend for colour and shape</span></span>
<span>      <span class='va'>tmpPlot</span> <span class='op'>+</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_shape_manual</a></span><span class='op'>(</span><span class='va'>legendNamePoints</span>,</span>
<span>                           values <span class='op'>=</span> <span class='va'>vecPointShapes</span>,</span>
<span>                           labels <span class='op'>=</span> <span class='va'>vecPointLabels</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span><span class='va'>legendNamePoints</span>,</span>
<span>                      values <span class='op'>=</span> <span class='va'>vecPointColours</span>,</span>
<span>                      labels <span class='op'>=</span> <span class='va'>vecPointLabels</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>        <span class='co'>### have to add fill as using filled points</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span><span class='va'>legendNamePoints</span>,</span>
<span>                      values <span class='op'>=</span> <span class='va'>vecPointColours</span>,</span>
<span>                      labels <span class='op'>=</span> <span class='va'>vecPointLabels</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot</span></span>
<span>    <span class='op'>}</span></span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>nPointShapes</span> <span class='op'>==</span> <span class='fl'>1</span> <span class='op'>&amp;</span> <span class='va'>nPointColours</span> <span class='op'>&gt;</span> <span class='fl'>1</span> <span class='op'>&amp;</span> <span class='va'>nAreaColours</span> <span class='op'>&gt;</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>{</span></span>
<span>      <span class='co'># keep legend for fill and colour</span></span>
<span>      <span class='va'>tmpPlot</span> <span class='op'>+</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span><span class='va'>legendNamePoints</span>,</span>
<span>                      values <span class='op'>=</span> <span class='va'>vecPointColours</span>,</span>
<span>                      labels <span class='op'>=</span> <span class='va'>vecPointLabels</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"none"</span>,</span>
<span>               shape <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot</span></span>
<span>    <span class='op'>}</span></span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>nPointShapes</span> <span class='op'>&gt;</span> <span class='fl'>1</span> <span class='op'>&amp;</span> <span class='va'>nPointColours</span> <span class='op'>==</span> <span class='fl'>1</span> <span class='op'>&amp;</span> <span class='va'>nAreaColours</span> <span class='op'>&gt;</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>{</span></span>
<span>      <span class='co'># using area colours and point shapes</span></span>
<span>      <span class='va'>tmpPlot</span> <span class='op'>+</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_shape_manual</a></span><span class='op'>(</span><span class='va'>legendNamePoints</span>,</span>
<span>                           values <span class='op'>=</span> <span class='va'>vecPointShapes</span>,</span>
<span>                           labels <span class='op'>=</span> <span class='va'>vecPointLabels</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span><span class='va'>legendNamePoints</span>,</span>
<span>                      values <span class='op'>=</span> <span class='va'>vecPointColours</span>,</span>
<span>                      labels <span class='op'>=</span> <span class='va'>vecPointLabels</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>        <span class='co'>### have to add fill as using filled points</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span><span class='va'>legendNamePoints</span>,</span>
<span>                          values <span class='op'>=</span> <span class='va'>vecPointColours</span>,</span>
<span>                          labels <span class='op'>=</span> <span class='va'>vecPointLabels</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"none"</span>,</span>
<span>               colour <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot</span></span>
<span>    <span class='op'>}</span></span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='va'>nPointShapes</span> <span class='op'>&gt;</span> <span class='fl'>1</span> <span class='op'>&amp;</span> <span class='va'>nPointColours</span> <span class='op'>&gt;</span> <span class='fl'>1</span> <span class='op'>&amp;</span> <span class='va'>nAreaColours</span> <span class='op'>&gt;</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>{</span></span>
<span>      <span class='co'># keep legends for all three, fill colour and shape</span></span>
<span>      <span class='va'>tmpPlot</span> <span class='op'>+</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_shape_manual</a></span><span class='op'>(</span><span class='va'>legendNamePoints</span>,</span>
<span>                           values <span class='op'>=</span> <span class='va'>vecPointShapes</span>,</span>
<span>                           labels <span class='op'>=</span> <span class='va'>vecPointLabels</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span><span class='va'>legendNamePoints</span>,</span>
<span>                      values <span class='op'>=</span> <span class='va'>vecPointColours</span>,</span>
<span>                      labels <span class='op'>=</span> <span class='va'>vecPointLabels</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>        <span class='co'>### have to add fill as using filled points</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span><span class='va'>legendNamePoints</span>,</span>
<span>                      values <span class='op'>=</span> <span class='va'>vecPointColours</span>,</span>
<span>                      labels <span class='op'>=</span> <span class='va'>vecPointLabels</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot</span></span>
<span>        </span>
<span>    <span class='op'>}</span></span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  <span class='kw'>if</span><span class='op'>(</span><span class='va'>labelAllPolygons</span><span class='op'>)</span><span class='op'>{</span></span>
<span>    <span class='va'>tmpPlot</span> <span class='op'>+</span></span>
<span>      <span class='co'>### if labelling centroids of each polygon ...</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>tibAreas</span>,</span>
<span>                <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>xCentre</span>, y <span class='op'>=</span> <span class='va'>yCentre</span>, label <span class='op'>=</span> <span class='va'>iPolygon</span><span class='op'>)</span>,</span>
<span>                size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot</span></span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>printVariables</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='st'>"Here are all the arguments from the call:"</span><span class='op'>)</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='st'>" "</span><span class='op'>)</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>listArgs</span><span class='op'>)</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='st'>" "</span><span class='op'>)</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='st'>"And here are all the internal variables at the end of the function:"</span><span class='op'>)</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='st'>" "</span><span class='op'>)</span></span>
<span>    <span class='va'>vecLs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ls.html'>ls</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>vecLs</span><span class='op'>)</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='st'>" "</span><span class='op'>)</span></span>
<span>    <span class='co'># vecLs &lt;- setdiff(vecLs, c("getJacobsonPlot", "tmpPlot"))</span></span>
<span>    <span class='co'># lapply(vecLs, function(x){print(get(x))})</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='st'>"tmpTib"</span><span class='op'>)</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>tmpTib</span><span class='op'>)</span><span class='op'>)</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='va'>tmpTib</span><span class='op'>)</span><span class='op'>)</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>tmpTib</span><span class='op'>)</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='st'>" "</span><span class='op'>)</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='st'>"tibAreas"</span><span class='op'>)</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>tibAreas</span><span class='op'>)</span><span class='op'>)</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='va'>tibAreas</span><span class='op'>)</span><span class='op'>)</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>tibAreas</span><span class='op'>)</span>    </span>
<span>  <span class='op'>}</span></span>
<span>  </span>
<span>  <span class='co'>### reset option to original if reset</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span><span class='st'>"warn"</span> <span class='op'>=</span> <span class='va'>oldWarn</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme_get.html'>theme_set</a></span><span class='op'>(</span><span class='va'>oldTheme</span><span class='op'>)</span></span>
<span>  <span class='co'>### finally, return the completed plot</span></span>
<span>  <span class='va'>tmpPlot</span></span>
<span><span class='op'>}</span></span></code></pre>
</div>
</details>
</div>
<h1 id="introduction">Introduction</h1>
<p><code>getJacobsonPlot()</code> is the basic function to create a Jacobson plot (a.k.a. RCSC plot) from, at minimum, starting scores and final scores as two vectors and the minimum and maximum possible scores on the measure.</p>
<p>Here is an example plot using only the necessary arguments and leaving all the others at their default settings. The data are real CORE-OM data scored on the 0 to 4 scoring. I have added three points falling into categories of the RCSC5 system that didnt occur in the real data (one reliable deterioration, stayed low, one reliable deterioration, low to high and one reliable improvement, stayed low.)</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>                finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>                CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>                RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>                minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                maxPossScore <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="plotjacobson_files/figure-html5/defaultPlot-1.png" width="624" /></p>
</div>
<p>So far so underwhelming: not a terribly good plot. However, what I hope makes the function really useful for a wide variety of possible users is that it can label points by their shape (for direction of change and reliable change (RCI3) and can label the points, and the areas of the plot, by a set of categorisations:</p>
<ul>
<li><p>direction of change (hardly Jacobson or RCSC but if you dont have values for the RCI or CSC you can use thats all youve got and the scatter of the plots is still informative)</p></li>
<li><p>reliable change, what I call the RCI3 categorisation, i.e.reliably deteriorated, no reliable change, reliable improvement</p></li>
<li><p>RCSC5: a commonly used RCSC categorisation: reliable deterioration, no reliable change, reliable improvement but stayed in a more trouble score range (above the CSC if the measure is has higher scores representing worse states that lower scores), reliably improved and moved from more toubled to less troubled score (often called recovered but please lets stop that!, and reliably improved but less troubled than the CSC score before and remained so</p></li>
<li><p>RCS7 which separates reliable deterioration into three areas: stayed less severe than CSC, from less severe to more severe and stayed severe</p></li>
<li><p>RCSC10 (which I cant see being useful) but which splits the no reliable change into four areas.</p></li>
</ul>
<p>Probably as important as that plethora of mappings the function handles the cueing of the measure, i.e.whether high scores indicate worse or better state. Finally, the function has a large huge number of arguments to the function that enable the user to change many aspects of the plot such as colour mappings, types and thickness of lines and, though I think its unlikely this is ever going to be necessary, point shapes. More importantly, all the text values: title, subtitle, mapping legend names, category labels and the two axis labels have sensible defaults but all can be changed to whatever you want, in whatever language and character set, depending on your local R, you would need.</p>
<h2 id="category-systems">Category systems</h2>
<p>As noted above the category systems I have implemented are:<br />
1. Direction (i.e.just a scattergram of first and last scores labelling direction of change)</p>
<ol start="2" type="1">
<li><p>RCI3: the classic threesome of reliable improvement, no reliable change and reliable deterioration</p></li>
<li><p>CSC4: the simple CSC foursome of HighToHigh, LowToHigh, HighToLow, LowToLow</p></li>
<li><p>The RCSC categories that use both RCI and CSC:</p>
<ul>
<li><p>RCSC5: NoRelChange, RelDet, RelImpHighToLow (Recovered), RelImpHighToHigh, RelImpLowToLow (using the obvious abbreviations and assuming negatively cued measure)</p></li>
<li><p>RCSC7: RelDetHighToHigh, RelDetLowToHigh, RelDetLowToLow, NoRelChange, RelImpHighToHigh, RelImpHighToLow (Recovered), RelImpLowToLow</p></li>
<li><p>RCSC10: RelDetHighToHigh, RelDetLowToHigh, RelDetLowToLow, NoRelChangeHighToHigh, NoRelChangeLowToHigh, NoRelChangeHighToLow, NoRelChangeLowToLow, RelImpHighToHigh, RelImpHighToLow (recovered), RelImpLowToLow.</p></li>
</ul></li>
</ol>
<p>The categories can be marked on the plot by:</p>
<ol type="1">
<li><p>Colouring the areas of the plot</p></li>
<li><p>Colouring the points</p></li>
<li><p>Changing the shapes of the points (but only for direction or for RCI3)</p></li>
</ol>
<h2 id="cueing-of-the-score-goodscorepos">Cueing of the score: <code>goodScorePos</code></h2>
<p>This shows the impact of that goodScorePos argument using the same data which are actually cued negatively</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>             finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>             subtitle <span class='op'>=</span> <span class='st'>"Positively cued scoring: 4 = best, 0 = worst; original data"</span>,</span>
<span>             CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>             RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>             minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>             maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>             goodScorePos <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>             areaColourScheme <span class='op'>=</span> <span class='st'>"DIRECTION"</span>,</span>
<span>             pointColourScheme <span class='op'>=</span> <span class='st'>"DIRECTION"</span>,</span>
<span>             pointSize <span class='op'>=</span> <span class='fl'>1.8</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="plotjacobson_files/figure-html5/goodScorePos-1.png" width="624" /></p>
</div>
<p>That also introduces another argument: areaAlpha: on some screens than others the red points are visible on top of the red area but the green points are not very visible. There are two arguments that control the alpha (transparency) of the points and areas: pointAlpha and areaAlpha. The default value of pointAlpha is 1, i.e.no transparency, the default value of areaAlpha is .3, i.e.30% transparency which for my vision system and screen at least is working for the red deterioration but not the green improvement. Lets trying pushing the area transparency down to .1.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>             finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>             subtitle <span class='op'>=</span> <span class='st'>"Positively cued scoring: 4 = best, 0 = worst; original data"</span>,</span>
<span>             CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>             RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>             minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>             maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>             goodScorePos <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>             areaColourScheme <span class='op'>=</span> <span class='st'>"DIRECTION"</span>,</span>
<span>             pointColourScheme <span class='op'>=</span> <span class='st'>"DIRECTION"</span>,</span>
<span>             pointSize <span class='op'>=</span> <span class='fl'>1.8</span>,</span>
<span>             areaAlpha <span class='op'>=</span> <span class='fl'>.1</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="plotjacobson_files/figure-html5/goodScorePosAlpha.1-1.png" width="624" /></p>
</div>
<p>OK (at least to my visual system and monitors!) I hope that illustrates that many things can be tweaked to get better images.</p>
<h2 id="categories-direction-rci-csc-and-rcsc">Categories: direction, RCI, CSC and RCSC</h2>
<h3 id="direction">Direction</h3>
<p>Direction is the simplest. I think people are only going to use this when they have neither a usable RCI nor a usable CSC.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#1</span></span>
<span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>             finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>             title <span class='op'>=</span> <span class='st'>"Direction categories, by point colour"</span>,</span>
<span>             subtitle <span class='op'>=</span> <span class='st'>""</span>,</span>
<span>             CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>             RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>             minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>             maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>             goodScorePos <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>             pointColourScheme <span class='op'>=</span> <span class='st'>"DIRECTION"</span>,</span>
<span>             areaColourScheme <span class='op'>=</span> <span class='st'>"NONE"</span>,</span>
<span>             pointSize <span class='op'>=</span> <span class='fl'>1.7</span>,</span>
<span>             lineTypeCSC <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>             lineTypeRCI <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot1</span></span>
<span><span class='va'>tmpPlot1</span></span></code></pre>
</div>
</details>
<img src="plotjacobson_files/figure-html5/direction-1.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#2</span></span>
<span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>             finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>             title <span class='op'>=</span> <span class='st'>"Direction categories, by area colour"</span>,</span>
<span>             subtitle <span class='op'>=</span> <span class='st'>""</span>,</span>
<span>             CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>             RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>             minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>             maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>             goodScorePos <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>             pointColourScheme <span class='op'>=</span> <span class='st'>"NONE"</span>,</span>
<span>             areaColourScheme <span class='op'>=</span> <span class='st'>"DIRECTION"</span>,</span>
<span>             pointSize <span class='op'>=</span> <span class='fl'>1.7</span>,</span>
<span>             lineTypeCSC <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>             lineTypeRCI <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot2</span></span>
<span><span class='va'>tmpPlot2</span></span></code></pre>
</div>
</details>
<p><img src="plotjacobson_files/figure-html5/direction-2.png" width="624" /></p>
</div>
<p>That shows one slightly counterintuitive issue: when mapping direction of change by point there are three categories: deteriorated, unchanged and improved but if mapping by the area of the plot there are only two categories as the unchanged points dont lie in either area but on the boundary between the areas.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#3</span></span>
<span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>             finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>             title <span class='op'>=</span> <span class='st'>"Direction categories, by point shapes"</span>,</span>
<span>             subtitle <span class='op'>=</span> <span class='st'>""</span>,</span>
<span>             CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>             RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>             minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>             maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>             goodScorePos <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>             pointColourScheme <span class='op'>=</span> <span class='st'>"NONE"</span>,</span>
<span>             areaColourScheme <span class='op'>=</span> <span class='st'>"NONE"</span>,</span>
<span>             pointShapeScheme <span class='op'>=</span> <span class='st'>"DIRECTION"</span>,</span>
<span>             pointSize <span class='op'>=</span> <span class='fl'>1.7</span>,</span>
<span>             lineTypeCSC <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>             lineTypeRCI <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot3</span></span>
<span><span class='va'>tmpPlot3</span></span></code></pre>
</div>
</details>
<img src="plotjacobson_files/figure-html5/direction2-1.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#4</span></span>
<span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>             finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>             title <span class='op'>=</span> <span class='st'>"Direction categories, by point and area colours"</span>,</span>
<span>             subtitle <span class='op'>=</span> <span class='st'>"Default alpha (transparency) for area and point\nallows points to be seen on same colour areas"</span>,</span>
<span>             CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>             RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>             minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>             maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>             goodScorePos <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>             pointColourScheme <span class='op'>=</span> <span class='st'>"DIRECTION"</span>,</span>
<span>             areaColourScheme <span class='op'>=</span> <span class='st'>"DIRECTION"</span>,</span>
<span>             pointShapeScheme <span class='op'>=</span> <span class='st'>"NONE"</span>,</span>
<span>             pointSize <span class='op'>=</span> <span class='fl'>1.7</span>,</span>
<span>             lineTypeCSC <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>             lineTypeRCI <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot4</span></span>
<span><span class='va'>tmpPlot4</span></span></code></pre>
</div>
</details>
<img src="plotjacobson_files/figure-html5/direction2-2.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#5</span></span>
<span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>             finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>             title <span class='op'>=</span> <span class='st'>"Direction categories, by area colours and point shapes"</span>,</span>
<span>             subtitle <span class='op'>=</span> <span class='st'>""</span>,</span>
<span>             CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>             RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>             minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>             maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>             goodScorePos <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>             pointColourScheme <span class='op'>=</span> <span class='st'>"NONE"</span>,</span>
<span>             areaColourScheme <span class='op'>=</span> <span class='st'>"DIRECTION"</span>,</span>
<span>             pointShapeScheme <span class='op'>=</span> <span class='st'>"DIRECTION"</span>,</span>
<span>             pointSize <span class='op'>=</span> <span class='fl'>1.7</span>,</span>
<span>             lineTypeCSC <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>             lineTypeRCI <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot5</span></span>
<span><span class='va'>tmpPlot5</span></span></code></pre>
</div>
</details>
<img src="plotjacobson_files/figure-html5/direction2-3.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#6</span></span>
<span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>             finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>             title <span class='op'>=</span> <span class='st'>"Direction categories, by point colours and shapes"</span>,</span>
<span>             subtitle <span class='op'>=</span> <span class='st'>""</span>,</span>
<span>             CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>             RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>             minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>             maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>             goodScorePos <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>             pointColourScheme <span class='op'>=</span> <span class='st'>"DIRECTION"</span>,</span>
<span>             areaColourScheme <span class='op'>=</span> <span class='st'>"NONE"</span>,</span>
<span>             pointShapeScheme <span class='op'>=</span> <span class='st'>"DIRECTION"</span>,</span>
<span>             pointSize <span class='op'>=</span> <span class='fl'>1.7</span>,</span>
<span>             lineTypeCSC <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>             lineTypeRCI <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot6</span></span>
<span><span class='va'>tmpPlot6</span></span></code></pre>
</div>
</details>
<img src="plotjacobson_files/figure-html5/direction2-4.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#7</span></span>
<span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>             finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>             title <span class='op'>=</span> <span class='st'>"Direction categories, by area and point colours and point shapes"</span>,</span>
<span>             subtitle <span class='op'>=</span> <span class='st'>""</span>,</span>
<span>             CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>             RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>             minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>             maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>             goodScorePos <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>             pointColourScheme <span class='op'>=</span> <span class='st'>"DIRECTION"</span>,</span>
<span>             areaColourScheme <span class='op'>=</span> <span class='st'>"DIRECTION"</span>,</span>
<span>             pointShapeScheme <span class='op'>=</span> <span class='st'>"DIRECTION"</span>,</span>
<span>             pointSize <span class='op'>=</span> <span class='fl'>1.5</span>,</span>
<span>             lineTypeCSC <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>             lineTypeRCI <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot7</span></span>
<span><span class='va'>tmpPlot7</span></span></code></pre>
</div>
</details>
<img src="plotjacobson_files/figure-html5/direction2-5.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># figure &lt;- ggpubr::ggarrange(tmpPlot1, tmpPlot2, tmpPlot3,</span></span>
<span><span class='co'>#                             tmpPlot4, tmpPlot5, tmpPlot6, tmpPlot7,</span></span>
<span><span class='co'>#                     # labels = c("A", "B", "C"),</span></span>
<span><span class='co'>#                     ncol = 2, nrow = 4)</span></span>
<span><span class='co'># figure</span></span></code></pre>
</div>
</details>
</div>
<h3 id="rci-categories-rci3">RCI categories RCI3</h3>
<p>This is just the conventional three level RCI categorisation.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>                finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>                title <span class='op'>=</span> <span class='st'>"RCI categories, by point colour"</span>,</span>
<span>                subtitle <span class='op'>=</span> <span class='st'>""</span>,</span>
<span>                CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>                RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>                minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>                goodScorePos <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>                pointColourScheme <span class='op'>=</span> <span class='st'>"RCI3"</span>,</span>
<span>                areaColourScheme <span class='op'>=</span> <span class='st'>"NONE"</span>,</span>
<span>                pointSize <span class='op'>=</span> <span class='fl'>1.7</span>,</span>
<span>                noLegend <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot1</span></span>
<span><span class='va'>tmpPlot1</span></span></code></pre>
</div>
</details>
<img src="plotjacobson_files/figure-html5/RCI3-1.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>                finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>                title <span class='op'>=</span> <span class='st'>"RCI categories, by area colour"</span>,</span>
<span>                subtitle <span class='op'>=</span> <span class='st'>""</span>,</span>
<span>                CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>                RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>                minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>                goodScorePos <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>                pointColourScheme <span class='op'>=</span> <span class='st'>"NONE"</span>,</span>
<span>                areaColourScheme <span class='op'>=</span> <span class='st'>"RCI3"</span>,</span>
<span>                pointSize <span class='op'>=</span> <span class='fl'>1.7</span>,</span>
<span>                noLegend <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot2</span></span>
<span><span class='va'>tmpPlot2</span></span></code></pre>
</div>
</details>
<img src="plotjacobson_files/figure-html5/RCI3-2.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>                finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>                title <span class='op'>=</span> <span class='st'>"RCI categories, by point shapes"</span>,</span>
<span>                subtitle <span class='op'>=</span> <span class='st'>""</span>,</span>
<span>                CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>                RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>                minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>                goodScorePos <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>                pointColourScheme <span class='op'>=</span> <span class='st'>"NONE"</span>,</span>
<span>                areaColourScheme <span class='op'>=</span> <span class='st'>"NONE"</span>,</span>
<span>                pointShapeScheme <span class='op'>=</span> <span class='st'>"RCI3"</span>,</span>
<span>                pointSize <span class='op'>=</span> <span class='fl'>1.7</span>,</span>
<span>                noLegend <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot3</span></span>
<span><span class='va'>tmpPlot3</span></span></code></pre>
</div>
</details>
<img src="plotjacobson_files/figure-html5/RCI3-3.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>                finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>                title <span class='op'>=</span> <span class='st'>"RCI categories, by point and area colours"</span>,</span>
<span>                subtitle <span class='op'>=</span> <span class='st'>"Default alpha (transparency) for area and point\nallows points to be seen on same colour areas"</span>,</span>
<span>                CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>                RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>                minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>                goodScorePos <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>                pointColourScheme <span class='op'>=</span> <span class='st'>"RCI3"</span>,</span>
<span>                areaColourScheme <span class='op'>=</span> <span class='st'>"RCI3"</span>,</span>
<span>                pointShapeScheme <span class='op'>=</span> <span class='st'>"NONE"</span>,</span>
<span>                pointSize <span class='op'>=</span> <span class='fl'>1.7</span>,</span>
<span>                noLegend <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot4</span></span>
<span><span class='va'>tmpPlot4</span></span></code></pre>
</div>
</details>
<img src="plotjacobson_files/figure-html5/RCI3-4.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>                finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>                title <span class='op'>=</span> <span class='st'>"RCI categories, by area colours and point shapes"</span>,</span>
<span>                subtitle <span class='op'>=</span> <span class='st'>""</span>,</span>
<span>                CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>                RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>                minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>                goodScorePos <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>                pointColourScheme <span class='op'>=</span> <span class='st'>"NONE"</span>,</span>
<span>                areaColourScheme <span class='op'>=</span> <span class='st'>"RCI3"</span>,</span>
<span>                pointShapeScheme <span class='op'>=</span> <span class='st'>"RCI3"</span>,</span>
<span>                pointSize <span class='op'>=</span> <span class='fl'>1.7</span>,</span>
<span>                noLegend <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot5</span></span>
<span><span class='va'>tmpPlot5</span></span></code></pre>
</div>
</details>
<img src="plotjacobson_files/figure-html5/RCI3-5.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>                finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>                title <span class='op'>=</span> <span class='st'>"RCI categories, by point colours and shapes"</span>,</span>
<span>                subtitle <span class='op'>=</span> <span class='st'>""</span>,</span>
<span>                CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>                RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>                minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>                goodScorePos <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>                pointColourScheme <span class='op'>=</span> <span class='st'>"RCI3"</span>,</span>
<span>                areaColourScheme <span class='op'>=</span> <span class='st'>"NONE"</span>,</span>
<span>                pointShapeScheme <span class='op'>=</span> <span class='st'>"RCI3"</span>,</span>
<span>                pointSize <span class='op'>=</span> <span class='fl'>1.7</span>,</span>
<span>                noLegend <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot6</span></span>
<span><span class='va'>tmpPlot6</span></span></code></pre>
</div>
</details>
<img src="plotjacobson_files/figure-html5/RCI3-6.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>                finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>                title <span class='op'>=</span> <span class='st'>"RCI categories, by area and point colours and point shapes"</span>,</span>
<span>                subtitle <span class='op'>=</span> <span class='st'>""</span>,</span>
<span>                CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>                RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>                minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>                goodScorePos <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>                pointColourScheme <span class='op'>=</span> <span class='st'>"RCI3"</span>,</span>
<span>                areaColourScheme <span class='op'>=</span> <span class='st'>"RCI3"</span>,</span>
<span>                pointShapeScheme <span class='op'>=</span> <span class='st'>"RCI3"</span>,</span>
<span>                pointSize <span class='op'>=</span> <span class='fl'>1.5</span>,</span>
<span>                noLegend <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot7</span></span>
<span><span class='va'>tmpPlot7</span></span></code></pre>
</div>
</details>
<img src="plotjacobson_files/figure-html5/RCI3-7.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># figure &lt;- ggpubr::ggarrange(tmpPlot1, tmpPlot2, tmpPlot3,</span></span>
<span><span class='co'>#                             tmpPlot4, tmpPlot5, tmpPlot6, tmpPlot7,</span></span>
<span><span class='co'>#                             # labels = c("A", "B", "C"),</span></span>
<span><span class='co'>#                             ncol = 2, nrow = 4)</span></span>
<span><span class='co'># figure</span></span></code></pre>
</div>
</details>
</div>
<h3 id="rcsc-categories-rcsc5">RCSC categories RCSC5</h3>
<p>RCSC categorisations combine the RCI categories with the CSC categories giving a maximum of 10 categories (as its not possible to have clinically significant deterioration with reliable deterioration nor <em>vice versa</em>.)</p>
<p>I think what I am calling RCSC5 is the most commonly used RCSC categorisation which
lumps all the no reliable deterioration and reliable deterioration categories, i.e.letting those RCI categories trump the CSC categories but distinguishing the three CSC categories within those showing reliable improvement and terming those who were in the reliable and clinically improved polygon as recovered (a term I dislike as it seems to me both to ignore the recovery movement and hugely overstate what we can derive from the measures we are using).</p>
<p>You could set pointShapeScheme to DIRECTION here but I think the only shape mapping to use logically is RCI3 as thats crucial to all the RCSC categorisations. Ive used RCI3 here when the title says mapping to point shape as well as area or point colour.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#1</span></span>
<span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>                finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>                title <span class='op'>=</span> <span class='st'>"RCSC5 categories, by point colour"</span>,</span>
<span>                subtitle <span class='op'>=</span> <span class='st'>""</span>,</span>
<span>                CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>                RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>                minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>                goodScorePos <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>                pointColourScheme <span class='op'>=</span> <span class='st'>"RCSC5"</span>,  <span class='co'># @@@@@@@</span></span>
<span>                areaColourScheme <span class='op'>=</span> <span class='st'>"NONE"</span>,</span>
<span>                pointSize <span class='op'>=</span> <span class='fl'>1.7</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot1</span></span>
<span><span class='va'>tmpPlot1</span></span></code></pre>
</div>
</details>
<img src="plotjacobson_files/figure-html5/RCSC5-1.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#2</span></span>
<span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>                finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>                title <span class='op'>=</span> <span class='st'>"RCSC5 categories, by area colour"</span>,</span>
<span>                subtitle <span class='op'>=</span> <span class='st'>""</span>,</span>
<span>                CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>                RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>                minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>                goodScorePos <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>                pointColourScheme <span class='op'>=</span> <span class='st'>"NONE"</span>,</span>
<span>                areaColourScheme <span class='op'>=</span> <span class='st'>"RCSC5"</span>,</span>
<span>                pointSize <span class='op'>=</span> <span class='fl'>1.7</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot2</span></span>
<span><span class='va'>tmpPlot2</span></span></code></pre>
</div>
</details>
<img src="plotjacobson_files/figure-html5/RCSC5-2.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#3</span></span>
<span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>                finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>                title <span class='op'>=</span> <span class='st'>"RCSC5 categories, by point and area colours"</span>,</span>
<span>                subtitle <span class='op'>=</span> <span class='st'>""</span>,</span>
<span>                CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>                RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>                minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>                goodScorePos <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>                pointColourScheme <span class='op'>=</span> <span class='st'>"RCSC5"</span>,</span>
<span>                areaColourScheme <span class='op'>=</span> <span class='st'>"RCSC5"</span>,</span>
<span>                pointShapeScheme <span class='op'>=</span> <span class='st'>"NONE"</span>,</span>
<span>                pointSize <span class='op'>=</span> <span class='fl'>1.7</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot3</span></span>
<span><span class='va'>tmpPlot3</span></span></code></pre>
</div>
</details>
<img src="plotjacobson_files/figure-html5/RCSC5-3.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#4</span></span>
<span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>                finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>                title <span class='op'>=</span> <span class='st'>"RCSC5 categories, by area colours and point shapes"</span>,</span>
<span>                subtitle <span class='op'>=</span> <span class='st'>""</span>,</span>
<span>                CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>                RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>                minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>                goodScorePos <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>                pointColourScheme <span class='op'>=</span> <span class='st'>"NONE"</span>,</span>
<span>                areaColourScheme <span class='op'>=</span> <span class='st'>"RCSC5"</span>,</span>
<span>                pointShapeScheme <span class='op'>=</span> <span class='st'>"RCI3"</span>,</span>
<span>                pointSize <span class='op'>=</span> <span class='fl'>1.7</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot4</span></span>
<span><span class='va'>tmpPlot4</span></span></code></pre>
</div>
</details>
<img src="plotjacobson_files/figure-html5/RCSC5-4.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># figure &lt;- ggpubr::ggarrange(tmpPlot1, tmpPlot2, tmpPlot3, </span></span>
<span><span class='co'>#                             tmpPlot4,  </span></span>
<span><span class='co'>#                             ncol = 1, nrow = 4)</span></span>
<span><span class='co'># figure</span></span></code></pre>
</div>
</details>
</div>
<h3 id="rcsc-categories-rcsc7">RCSC categories RCSC7</h3>
<p>Like what I call RCSC5 this allows the no reliable change to trump the CSC categories. However, unlike RCSC5 it splits the reliably deteriorated into three categories. Again, mapping to shape here only uses the reliable change categories.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#1</span></span>
<span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>                finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>                title <span class='op'>=</span> <span class='st'>"RCSC7 categories, by point colour"</span>,</span>
<span>                subtitle <span class='op'>=</span> <span class='st'>""</span>,</span>
<span>                CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>                RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>                minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>                goodScorePos <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>                pointColourScheme <span class='op'>=</span> <span class='st'>"RCSC7"</span>,</span>
<span>                areaColourScheme <span class='op'>=</span> <span class='st'>"NONE"</span>,</span>
<span>                pointSize <span class='op'>=</span> <span class='fl'>1.7</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot1</span></span>
<span><span class='va'>tmpPlot1</span></span></code></pre>
</div>
</details>
<img src="plotjacobson_files/figure-html5/RCSC7-1.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#2</span></span>
<span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>                finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>                title <span class='op'>=</span> <span class='st'>"RCSC7 categories, by area colour"</span>,</span>
<span>                subtitle <span class='op'>=</span> <span class='st'>""</span>,</span>
<span>                CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>                RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>                minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>                goodScorePos <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>                pointColourScheme <span class='op'>=</span> <span class='st'>"NONE"</span>,</span>
<span>                areaColourScheme <span class='op'>=</span> <span class='st'>"RCSC7"</span>,</span>
<span>                pointSize <span class='op'>=</span> <span class='fl'>1.7</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot2</span></span>
<span><span class='va'>tmpPlot2</span></span></code></pre>
</div>
</details>
<img src="plotjacobson_files/figure-html5/RCSC7-2.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#3</span></span>
<span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>                finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>                title <span class='op'>=</span> <span class='st'>"RCSC7 categories, by point and area colours"</span>,</span>
<span>                subtitle <span class='op'>=</span> <span class='st'>""</span>,</span>
<span>                CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>                RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>                minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>                goodScorePos <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>                pointColourScheme <span class='op'>=</span> <span class='st'>"RCSC7"</span>,</span>
<span>                areaColourScheme <span class='op'>=</span> <span class='st'>"RCSC7"</span>,</span>
<span>                pointShapeScheme <span class='op'>=</span> <span class='st'>"NONE"</span>,</span>
<span>                pointSize <span class='op'>=</span> <span class='fl'>1.7</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot3</span></span>
<span><span class='va'>tmpPlot3</span></span></code></pre>
</div>
</details>
<img src="plotjacobson_files/figure-html5/RCSC7-3.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># figure &lt;- ggpubr::ggarrange(tmpPlot1, tmpPlot2, tmpPlot3, </span></span>
<span><span class='co'>#                             # labels = c("A", "B", "C"),</span></span>
<span><span class='co'>#                             ncol = 1, nrow = 3)</span></span>
<span><span class='co'># figure</span></span></code></pre>
</div>
</details>
</div>
<h3 id="rcsc-categories-rcsc10">RCSC categories RCSC10</h3>
<p>I think this is a bit mad but I have created it! I havent bothered showing it coupled with direction or RCI3 by point shape as I think that really would be getting mad!</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#1</span></span>
<span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>                finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>                title <span class='op'>=</span> <span class='st'>"RCSC10 categories, by point colour"</span>,</span>
<span>                subtitle <span class='op'>=</span> <span class='st'>""</span>,</span>
<span>                CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>                RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>                minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>                goodScorePos <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>                pointColourScheme <span class='op'>=</span> <span class='st'>"RCSC10"</span>,</span>
<span>                areaColourScheme <span class='op'>=</span> <span class='st'>"NONE"</span>,</span>
<span>                pointSize <span class='op'>=</span> <span class='fl'>1.7</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot1</span></span>
<span><span class='va'>tmpPlot1</span></span></code></pre>
</div>
</details>
<img src="plotjacobson_files/figure-html5/RCSC10-1.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#2</span></span>
<span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>                finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>                title <span class='op'>=</span> <span class='st'>"RCSC10 categories, by area colour"</span>,</span>
<span>                subtitle <span class='op'>=</span> <span class='st'>""</span>,</span>
<span>                CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>                RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>                minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>                goodScorePos <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>                pointColourScheme <span class='op'>=</span> <span class='st'>"NONE"</span>,</span>
<span>                areaColourScheme <span class='op'>=</span> <span class='st'>"RCSC10"</span>,</span>
<span>                pointSize <span class='op'>=</span> <span class='fl'>1.7</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot2</span></span>
<span><span class='va'>tmpPlot2</span></span></code></pre>
</div>
</details>
<img src="plotjacobson_files/figure-html5/RCSC10-2.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>#4</span></span>
<span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>                finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>                title <span class='op'>=</span> <span class='st'>"RCSC10 categories, by point and area colours"</span>,</span>
<span>                subtitle <span class='op'>=</span> <span class='st'>""</span>,</span>
<span>                CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>                RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>                minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>                goodScorePos <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>                pointColourScheme <span class='op'>=</span> <span class='st'>"RCSC10"</span>,</span>
<span>                areaColourScheme <span class='op'>=</span> <span class='st'>"RCSC10"</span>,</span>
<span>                pointShapeScheme <span class='op'>=</span> <span class='st'>"NONE"</span>,</span>
<span>                pointSize <span class='op'>=</span> <span class='fl'>1.7</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpPlot3</span></span>
<span><span class='va'>tmpPlot3</span></span></code></pre>
</div>
</details>
<img src="plotjacobson_files/figure-html5/RCSC10-3.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># figure &lt;- ggpubr::ggarrange(tmpPlot1, tmpPlot2, tmpPlot3, </span></span>
<span><span class='co'>#                             # labels = c("A", "B", "C"),</span></span>
<span><span class='co'>#                             ncol = 1, nrow = 3)</span></span>
<span><span class='co'># figure</span></span></code></pre>
</div>
</details>
</div>
<h2 id="all-the-arguments-for-getjacobsonplot">All the arguments for <code>getJacobsonPlot()</code></h2>
<p>Here is the function definition showing the full set of arguments. Youll see that most have default values. Ill go through all the arguments below, by their groups, after demonstrating some of the category mappings.</p>
<pre><code>getJacobsonPlot &lt;- function(baselineScores, 
                          finalScores, 
                          pointNames = NA, # can be used to label points
                          namesNotPoints = FALSE, # only use labels, no points
                          nameRCIDetOnly = FALSE, # only label deteriorators
                          namesSize = 2, # sets the font size for labels
                          CSC = NA, # the CSC value to use
                          RCI = NA, # the RCI value to use
                          minPossScore = 0, 
                          maxPossScore = 4, 
                          goodScorePos = FALSE, # set to TRUE/T if a better score is positive
                          omitNHS = FALSE, # use to omit scores starting in non-help-seeking range
                          title = NULL, # to override the default title
                          subtitle = NULL, # ditto for subtitle
                          titleJustificn = .5, # centre justifies titles, 0 for L, 1 for R
                          xLab = NULL, # overrides the default x axis label 
                          yLab = NULL, # overrides the default y axis label
                          noLegend = FALSE, # removes legends for colours
                          labelCSClines = FALSE, # set to TRUE/T to label CSC lines with CSC value
                          areaColourScheme = c(&quot;NONE&quot;, # mapping to use, see notes, schemes are:
                                               &quot;RCSC5&quot;,
                                               &quot;DIRECTION&quot;,
                                               &quot;RCI3&quot;,
                                               &quot;CSC4&quot;,
                                               &quot;RCSC7&quot;,
                                               &quot;RCSC10&quot;,
                                               &quot;POLYGONS&quot;), 
                          legendNameAreas = &quot;Area mapping&quot;, # set title for area legend
                          pointColourScheme = c(&quot;RCSC5&quot;,
                                                &quot;RCI3&quot;,
                                                &quot;DIRECTION&quot;,
                                                &quot;CSC4&quot;,
                                                &quot;RCSC7&quot;,
                                                &quot;RCSC10&quot;,
                                                &quot;NONE&quot;), # chose point colour mapping, as above
                          legendNamePoints = &quot;Point mapping&quot;, # title for point colours
                          ### now lots of mappings used by the above colour mappings
                          coloursDirection = c(&quot;red&quot;, 
                                               &quot;green&quot;, 
                                               &quot;black&quot;),
                          ### you can override the labels to local choice and language
                          labelsDirection = c(&quot;Deterioration&quot;, 
                                              &quot;Improvement&quot;, 
                                              &quot;No change&quot;),
                          coloursRCI3 = c(&quot;grey&quot;, 
                                          &quot;red&quot;, 
                                          &quot;green&quot;),
                          labelsRCI3 = c(&quot;No reliable change&quot;, 
                                         &quot;Reliable deterioration&quot;, 
                                         &quot;Reliable improvement&quot;),
                          coloursCSC4 = c(&quot;green&quot;, 
                                          &quot;red&quot;, 
                                          &quot;orange&quot;, 
                                          &quot;skyblue1&quot;),
                          labelsCSC4 = c(&quot;High to low&quot;, 
                                         &quot;Low to high&quot;, 
                                         &quot;Stayed high&quot;, 
                                         &quot;Stayed low&quot;),
                          coloursRCSC5 = c(&quot;grey&quot;, 
                                           &quot;red&quot;, 
                                           &quot;skyblue1&quot;, 
                                           &quot;green&quot;, 
                                           &quot;chartreuse4&quot;),
                          labelsRCSC5 = c(&quot;No reliable change&quot;, 
                                          &quot;Reliable deterioration&quot;, 
                                          &quot;Reliable improvement, stayed high&quot;, 
                                          &quot;Reliable improvement, high to low (&#39;Recovered&#39;)&quot;, 
                                          &quot;Reliable improvement, stayed low&quot;),
                          ### it&#39;s essentially impossible to code labels for the RCSC
                          ### that would be independent of the cueing of the scores
                          ### hence different labels (but same colours and order)
                          ### for positively cued measures
                          labelsRCSC5pos = c(&quot;No reliable change&quot;, 
                                             &quot;Reliable deterioration&quot;, 
                                             &quot;Reliable improvement, stayed high&quot;, 
                                             &quot;Reliable improvement, low to high (&#39;Recovered&#39;)&quot;, 
                                             &quot;Reliable improvement, stayed low&quot;),
                          coloursRCSC7 = c(&quot;grey&quot;, 
                                           &quot;orange&quot;, 
                                           &quot;red&quot;, 
                                           &quot;sienna2&quot;, 
                                           &quot;palegreen&quot;, 
                                           &quot;green&quot;, 
                                           &quot;skyblue1&quot;),
                          labelsRCSC7 = c(&quot;No reliable change&quot;, 
                                          &quot;Reliable deterioration, stayed high&quot;, 
                                          &quot;Reliable deterioration, low to high&quot;, 
                                          &quot;Reliable deterioration, stayed low&quot;, 
                                          &quot;Reliable improvement, stayed high&quot;, 
                                          &quot;Reliable improvement, high to low (&#39;Recovered&#39;)&quot;, 
                                          &quot;Reliable improvement, stayed low&quot;),
                          labelsRCSC7pos = c(&quot;No reliable change&quot;, 
                                             &quot;Reliable deterioration, stayed low&quot;, 
                                             &quot;Reliable deterioration, high to low&quot;, 
                                             &quot;Reliable deterioration, stayed high&quot;, 
                                             &quot;Reliable improvement, stayed low&quot;, 
                                             &quot;Reliable improvement, low to high (&#39;Recovered&#39;)&quot;, 
                                             &quot;Reliable improvement, stayed high&quot;),
                          coloursRCSC10 = c(&quot;yellow&quot;, #1
                                            &quot;blue&quot;, #2
                                            &quot;purple&quot;, #3
                                            &quot;grey&quot;, #4
                                            &quot;orange&quot;, #5
                                            &quot;red&quot;, #6
                                            &quot;violetred4&quot;, #7
                                            &quot;palegreen&quot;, #8
                                            &quot;green&quot;, #9
                                            &quot;chartreuse4&quot;), #10
                          labelsRCSC10 = c(&quot;No reliable change, stayed high&quot;, #1
                                           &quot;No reliable change, high to low&quot;, #2
                                           &quot;No reliable change, low to high&quot;, #3
                                           &quot;No reliable change, stayed low&quot;, #4
                                           &quot;Reliable deterioration, stayed high&quot;, #5 
                                           &quot;Reliable deterioration, low to high&quot;, #6
                                           &quot;Reliable deterioration, stayed low&quot;, #7
                                           &quot;Reliable improvement, stayed high&quot;, #8
                                           &quot;Reliable improvement, high to low (&#39;Recovered&#39;)&quot;, #9
                                           &quot;Reliable improvement, stayed low&quot;), #10
                          labelsRCSC10pos = c(&quot;No reliable change, stayed low&quot;, #1p
                                              &quot;No reliable change, low to high&quot;, #2p
                                              &quot;No reliable change, high to low&quot;, #3p
                                              &quot;No reliable change, stayed high&quot;, #4p
                                              &quot;Reliable deterioration, stayed low&quot;, #5p
                                              &quot;Reliable deterioration, low to high&quot;, #6p
                                              &quot;Reliable deterioration, stayed high&quot;, #7p
                                              &quot;Reliable improvement, stayed low&quot;, #8p
                                              &quot;Reliable improvement, low to high (&#39;Recovered&#39;)&quot;, #9p
                                              &quot;Reliable improvement, stayed high&quot;), #10p
                          ### you can also add mapping to point shapes
                          pointShapeScheme = c(&quot;NONE&quot;,
                                               &quot;DIRECTION&quot;,
                                               &quot;RCI3&quot;),
                          ### these allow you to override the default mapping to 
                          ### a square and arrows pointing the appropriate ways
                          ### NULL leaves the default mapping in place
                          ### I really don&#39;t advise overriding these but you can!
                          pointShapeNoRelChange = NULL,
                          pointShapeRelDet = NULL,
                          pointShapeRelImp = NULL,
                          ### the following arguments control the aesthetics
                          pointSize = 1,
                          ### the default alpha settings allow both points and areas to be coloured
                          pointAlpha = 1, # 1 is no transparency, 0 is no colour
                          areaAlpha = .3, # ditto, .3 is probably OK for a pale coloured ground
                          ### aesthetics for the no-change diagonal line
                          lineTypeNoChange = 1, # default is solid line
                          lineWidthNoChange = .5, # default is ggplot default line thickness
                          lineColourNoChange = 1, # default is black
                          ### same for the CSC lines
                          lineTypeCSC = 1, 
                          lineWidthCSC = .5, 
                          lineColourCSC = 1, 
                          ### same for the RCI lines
                          lineTypeRCI = 1,
                          lineWidthRCI = .5,
                          lineColourRCI = 1,
                          themeToUse = theme_bw(), # set ggplot theme to use, unquoted
                          ### I can&#39;t imagine changing these myself but ...
                          ### these allow you to override the theme&#39;s colours
                          plotColour = NULL, # background colour of the plot area itself, e.g. &quot;white&quot;
                          borderColour = NULL, # and same for the border around it
                          ### you might want to use these to suppress messages and warnings
                          noMessages = FALSE, # suppress messages
                          noWarnings = FALSE, # suppress my warnings (not other R ones)
                          ### these are probably only useful to help me debug things
                          printVariables = FALSE, # will give a print out of all internal variables
                          warningsToErrors = FALSE, # makes warnings into errors, i.e. 
                          ### this is really only for someone drilling into the code
                          ### it labels all twelve area polygons with their numbers
                          labelAllPolygons = FALSE,
                          ### arguments not implemented yet
                          greyScale = FALSE # may be implemented to force B&amp;W/greyscale</code></pre>
<p>Most of those can be ignored most of the time. The required arguments are: @@@</p>
<ul>
<li>baselineScores: a vector</li>
<li>finalScores: a vector, same length as baselineScores</li>
</ul>
<p>Arguments that have defaults, hence are optional, but which you will almost certainly wish to add, changing the defaults are as follows:</p>
<ul>
<li><p>minPossScore: defaults to 0 as the data used are CORE-OM data scored on the mean item score, not the clinical score method. Must be a single number appropriate for your scale.</p></li>
<li><p>maxPossScore: defaults to 4, ditto.</p></li>
<li><p>CSC: defaults to NA, but put in whatever you need for your measure, I have used 1.26 as that was correct for the demo data. Using the default NA will drop CSC aspects of plot entirely, probably not what you want.</p></li>
<li><p>RCI: defaults to NA, but put in whatever you need for your measure, I have used 0.3123851, again because that was correct for the demo data. Using the default NA will drop the RCI aspects of plot entirely, again probably not what you want.</p></li>
<li><p>goodScorePos: defaults to FALSE as I think most therapy change measures are cued so higher scores indicate more distress/dysfunction and the aim of therapy is to reduce scores, change it to TRUE for measures where more positive scores indicate better states or better functioning. That change doesnt change the numbering on the axes running from lower to higher but it remaps the labelling of points (when used, see below) and of the areas (when used, see below!).</p></li>
</ul>
<h1 id="optional-arguments-not-for-categories">Optional arguments, not for categories</h1>
<p>Other optional arguments fall into the following categories:</p>
<ul>
<li>Text options
<ul>
<li>title</li>
<li>subtitle (to add one)</li>
<li>x axis label</li>
<li>y axis label</li>
</ul></li>
<li>Line type options</li>
<li>Point labelling options (generally by ID but could be by categories, e.g gender, therapist ID etc.)</li>
<li>Point marker options</li>
<li>Change categories/area options
<ul>
<li>what areas?</li>
<li>area colours</li>
<li>area labels</li>
</ul></li>
<li>Legend options</li>
</ul>
<p>The next sections run through these groups of arguments and show their impacts on the plot.</p>
<h2 id="text-options">Text options</h2>
<p>As we saw, the subtitle argument allows you to add a subtitle using the default formatting of subtitles for the theme.</p>
<p>Other text control arguments are the title, titleJustificn, xLab and yLab arguments.</p>
<p>The title argument just allows you to replace the default title with anything of your own.</p>
<p>The titleJustificn argument does what it says: controls the justification of the title (and subtitle actually). Why anyone might want to use right justified title beats me but I think some journals do require left justifcation so titleJustificn = 0 would get that.</p>
<p>The xLab and yLab allow you to override the axis labels.</p>
<p>In principle these text components can be in any language your local implementation of R (and perhaps your operating system) can handle.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>             finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>             CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>             RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>             minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>             maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>             title <span class='op'>=</span> <span class='st'>"Jacobson (RCSC) plot of data from Quito clinic"</span>,</span>
<span>             subtitle <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"n = "</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>tibDat</span><span class='op'>)</span>, <span class='st'>" clients"</span><span class='op'>)</span>,</span>
<span>             titleJustificn <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>             xLab <span class='op'>=</span> <span class='st'>"CORE-OM score at first session (= assessment)"</span>,</span>
<span>             yLab <span class='op'>=</span> <span class='st'>"Last completed CORE-OM score"</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="plotjacobson_files/figure-html5/textArguments-1.png" width="624" /></p>
</div>
<h2 id="line-type-options">Line type options</h2>
<p>These can be used to change the line types used for the three categories of lines on the usual Jacobson plot:</p>
<ul>
<li><p>the CSC lines for the horizontal and vertical CSC references lines</p></li>
<li><p>the diagonal no-change line and</p></li>
<li><p>the RCI tramlines either side of that no change line.</p></li>
</ul>
<p>For each of these the arguments are:</p>
<ul>
<li><p>lineType for the line types that R/ggplot offers</p></li>
<li><p>lineColour for the line colour (doh!) and</p></li>
<li><p>lineWidth for  guess!</p></li>
</ul>
<p>So the full list of these options is: lineTypeCSC, lineColourCSC, lineWidthCSC; lineTypeNoChange, lineColourNoChange, lineWidthNoChange; and lineTypeRCI, lineColourRCI, lineWidthRCI.</p>
<p>Here is a truly aesthetically horrible plot has removed the RCI tramlines by using lineTypeRCI = 0, turned the CSC lines red with lineColourCSC = red and dotted with lineTypeCSC = 3. I suspect that these options are only really useful when making plots to use for teaching.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>             finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>             CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>             RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>             minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>             maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>             lineTypeCSC <span class='op'>=</span> <span class='fl'>3</span>,</span>
<span>             lineWidthCSC <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>             lineColourCSC <span class='op'>=</span> <span class='st'>"red"</span>,</span>
<span>             lineTypeNoChange <span class='op'>=</span> <span class='fl'>2</span>,</span>
<span>             lineWidthNoChange <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>             lineColourNoChange <span class='op'>=</span> <span class='st'>"blue"</span>,</span>
<span>             lineTypeRCI <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>             lineWidthRCI <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="plotjacobson_files/figure-html5/lineTypes-1.png" width="624" /></p>
</div>
<h2 id="point-labelling">Point labelling</h2>
<p>These options are best introduced with ID labelling but the argument could be used to label points by categories, e.g gender, therapist ID etc. though the realities of the plotting area are such that any variable used here should probably be of a maximum of three characters in width. I hope to write another function to handle categories rather differently using a legend or facetting. For the moment, using the one argument, ID and category labelling are mutually exclusively options unless you create a system like M01, M02 etc. for male client IDs and F01, F02 for female client IDs.</p>
<p>The pertinent arguments are:</p>
<ul>
<li><p><strong>pointNames</strong>: defaults to NA, replace with a variable name, in this next example <code>as.character(tibDat$id)</code>. That illustrates that it is best to use a character variable. More on this below.</p></li>
<li><p><strong>namesNotPoints</strong>: this defaults to FALSE, set to TRUE to get ID labels instead of points. <em>At the moment (13.xi.23) you have to set this to TRUE to get labels and you can only get labels instead of points. I may fix this so that just giving a variable for pointNames will give you the points AND will label them but that will only work with really very small numbers of points/participants so I havent implemented it yet.</em></p></li>
<li><p><strong>nameRCIDetOnly</strong>: defaults to FALSE. If set to TRUE the only points designated reliable deterioration are labelled.</p></li>
<li><p><strong>namesSize</strong>: defaults to 2, change it to another value to make the labels larger (&gt; 2) or smaller (&lt; 2).</p></li>
</ul>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>             finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>             pointNames <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>tibDat</span><span class='op'>$</span><span class='va'>id</span><span class='op'>)</span>, </span>
<span>             pointColourScheme <span class='op'>=</span> <span class='st'>"RCI3"</span>,</span>
<span>             namesNotPoints <span class='op'>=</span> <span class='cn'>TRUE</span>, </span>
<span>             nameRCIDetOnly <span class='op'>=</span> <span class='cn'>FALSE</span>, </span>
<span>             <span class='co'># namesSize = 2, </span></span>
<span>             CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>             RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>             minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>             maxPossScore <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="plotjacobson_files/figure-html5/pointIDs1-1.png" width="624" /></p>
</div>
<p>That illustrates a lot of problems with labels.</p>
<ul>
<li><p>Labels dont really combine well with using point colours to map points to categories.</p></li>
<li><p>With many (here 185) points you have to make the text small so the labels are hardly readable or frankly unreadable.</p></li>
<li><p>Unless you really have quite few points, if you make the text big enough to read, the points will probably overlap and still be unreadable.</p></li>
<li><p>Its harder to tell the precise location of the points from text labels than point shapes.</p></li>
</ul>
<p>This next plot maps the RCI categories to plot areas rather than to point colours to at least have all the labels in black and it uses namesSize = 5 to make isolated labels much more readable than with the default namesSize of 2. However, it illustrates the overprinting issue!</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>             finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>             pointNames <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>tibDat</span><span class='op'>$</span><span class='va'>id</span><span class='op'>)</span>, </span>
<span>             areaColourScheme <span class='op'>=</span> <span class='st'>"RCI3"</span>,</span>
<span>             namesNotPoints <span class='op'>=</span> <span class='cn'>TRUE</span>, </span>
<span>             nameRCIDetOnly <span class='op'>=</span> <span class='cn'>FALSE</span>, </span>
<span>             namesSize <span class='op'>=</span> <span class='fl'>5</span>, </span>
<span>             CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>             RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>             minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>             maxPossScore <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="plotjacobson_files/figure-html5/pointIDs2-1.png" width="624" /></p>
</div>
<p>This, with an artificially reduced dataset illustrates that ID labelling <em>could</em> work with small datasets.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>goodScorePos</span> <span class='op'>&lt;-</span> <span class='cn'>FALSE</span></span>
<span><span class='va'>tibDat</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='co'>### get only real data</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>id</span> <span class='op'>&lt;</span> <span class='fl'>400</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>firstLastChange <span class='op'>=</span> <span class='va'>lastScore</span> <span class='op'>-</span> <span class='va'>firstScore</span>,</span>
<span>         direction3 <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span><span class='va'>firstLastChange</span> <span class='op'>==</span> <span class='fl'>0</span> <span class='op'>~</span> <span class='st'>"NoChange"</span>,</span>
<span>                                  <span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>firstLastChange</span> <span class='op'>&lt;</span> <span class='fl'>0</span> <span class='op'>~</span> <span class='st'>"Det"</span>,</span>
<span>                                  <span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>firstLastChange</span> <span class='op'>&gt;</span> <span class='fl'>0</span> <span class='op'>~</span> <span class='st'>"Imp"</span>,</span>
<span>                                  <span class='op'>!</span><span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>firstLastChange</span> <span class='op'>&lt;</span> <span class='fl'>0</span> <span class='op'>~</span> <span class='st'>"Imp"</span>,</span>
<span>                                  <span class='op'>!</span><span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>firstLastChange</span> <span class='op'>&gt;</span> <span class='fl'>0</span> <span class='op'>~</span> <span class='st'>"Det"</span><span class='op'>)</span>,</span>
<span>         RCIchange <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>firstLastChange</span><span class='op'>)</span> <span class='op'>&lt;</span> <span class='va'>RCI</span>, <span class='st'>"NoRelChange"</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Rel"</span>, <span class='va'>direction3</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>         firstCSCstatus <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span><span class='op'>!</span><span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>firstScore</span> <span class='op'>&gt;=</span> <span class='va'>CSC</span> <span class='op'>~</span> <span class='st'>"HS"</span>, </span>
<span>                                    <span class='op'>!</span><span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>firstScore</span> <span class='op'>&lt;</span> <span class='va'>CSC</span> <span class='op'>~</span> <span class='st'>"NHS"</span>,</span>
<span>                                    <span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>firstScore</span> <span class='op'>&lt;</span> <span class='va'>CSC</span> <span class='op'>~</span> <span class='st'>"HS"</span>, </span>
<span>                                    <span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>firstScore</span> <span class='op'>&gt;=</span> <span class='va'>CSC</span> <span class='op'>~</span> <span class='st'>"NHS"</span><span class='op'>)</span>,</span>
<span>         lastCSCstatus <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span><span class='op'>!</span><span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>lastScore</span> <span class='op'>&gt;=</span> <span class='va'>CSC</span> <span class='op'>~</span> <span class='st'>"HS"</span>, </span>
<span>                                   <span class='op'>!</span><span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>lastScore</span> <span class='op'>&lt;</span> <span class='va'>CSC</span> <span class='op'>~</span> <span class='st'>"NHS"</span>,</span>
<span>                                   <span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>lastScore</span> <span class='op'>&lt;</span> <span class='va'>CSC</span> <span class='op'>~</span> <span class='st'>"HS"</span>, </span>
<span>                                   <span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>lastScore</span> <span class='op'>&gt;=</span> <span class='va'>CSC</span> <span class='op'>~</span> <span class='st'>"NHS"</span><span class='op'>)</span>,</span>
<span>         CSC4 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>firstCSCstatus</span>, <span class='st'>"To"</span>, <span class='va'>lastCSCstatus</span><span class='op'>)</span>,</span>
<span>         RCSC5 <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>           <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"NoRelChange"</span> <span class='op'>~</span> <span class='st'>"NoRelChange"</span>,</span>
<span>           <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"RelDet"</span>  <span class='op'>~</span> <span class='st'>"RelDet"</span>,</span>
<span>           <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"RelImp"</span> <span class='op'>&amp;</span> <span class='va'>CSC4</span> <span class='op'>==</span> <span class='st'>"HSToHS"</span> <span class='op'>~</span> <span class='st'>"RelImpHSToHS"</span>,</span>
<span>           <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"RelImp"</span> <span class='op'>&amp;</span> <span class='va'>CSC4</span> <span class='op'>==</span> <span class='st'>"HSToNHS"</span> <span class='op'>~</span> <span class='st'>"RelImpHSToNHS"</span>,</span>
<span>           <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"RelImp"</span> <span class='op'>&amp;</span> <span class='va'>CSC4</span> <span class='op'>==</span> <span class='st'>"NHSToNHS"</span> <span class='op'>~</span> <span class='st'>"RelImpNHSToNHS"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='co'>### now reduce numbers</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>RCSC5</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/row_number.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>&lt;</span> <span class='fl'>6</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpDat</span></span>
<span></span>
<span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tmpDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>             finalScores <span class='op'>=</span> <span class='va'>tmpDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>             pointNames <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>tmpDat</span><span class='op'>$</span><span class='va'>id</span><span class='op'>)</span>, </span>
<span>             namesNotPoints <span class='op'>=</span> <span class='cn'>TRUE</span>, </span>
<span>             nameRCIDetOnly <span class='op'>=</span> <span class='cn'>FALSE</span>, </span>
<span>             areaColourScheme <span class='op'>=</span> <span class='st'>"RCI3"</span>,</span>
<span>             pointColourScheme <span class='op'>=</span> <span class='st'>"NONE"</span>,</span>
<span>             namesSize <span class='op'>=</span> <span class='fl'>5</span>, </span>
<span>             CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>             RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>             minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>             maxPossScore <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="plotjacobson_files/figure-html5/pointIDs3-1.png" width="624" /></p>
</div>
<p>Here, with totally artificial age labels, is an example labelling with age. These are totally artificial ages (though the data are real but demographics removed to protect confidentiality). I set them as:</p>
<ul>
<li><p>E for Emerging adult, &gt;= 18 and &lt;= 25</p></li>
<li><p>A for adult: &gt; 25 and &lt; 60</p></li>
<li><p>O for older: &gt; 60</p></li>
</ul>
<p>And I allocated in a ratio 3:5:2.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>tibDat</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='co'>### get only real data</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>id</span> <span class='op'>&lt;</span> <span class='fl'>400</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>firstLastChange <span class='op'>=</span> <span class='va'>lastScore</span> <span class='op'>-</span> <span class='va'>firstScore</span>,</span>
<span>         direction3 <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span><span class='va'>firstLastChange</span> <span class='op'>==</span> <span class='fl'>0</span> <span class='op'>~</span> <span class='st'>"NoChange"</span>,</span>
<span>                                  <span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>firstLastChange</span> <span class='op'>&lt;</span> <span class='fl'>0</span> <span class='op'>~</span> <span class='st'>"Det"</span>,</span>
<span>                                  <span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>firstLastChange</span> <span class='op'>&gt;</span> <span class='fl'>0</span> <span class='op'>~</span> <span class='st'>"Imp"</span>,</span>
<span>                                  <span class='op'>!</span><span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>firstLastChange</span> <span class='op'>&lt;</span> <span class='fl'>0</span> <span class='op'>~</span> <span class='st'>"Imp"</span>,</span>
<span>                                  <span class='op'>!</span><span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>firstLastChange</span> <span class='op'>&gt;</span> <span class='fl'>0</span> <span class='op'>~</span> <span class='st'>"Det"</span><span class='op'>)</span>,</span>
<span>         RCIchange <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>firstLastChange</span><span class='op'>)</span> <span class='op'>&lt;</span> <span class='va'>RCI</span>, <span class='st'>"NoRelChange"</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Rel"</span>, <span class='va'>direction3</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>         firstCSCstatus <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span><span class='op'>!</span><span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>firstScore</span> <span class='op'>&gt;=</span> <span class='va'>CSC</span> <span class='op'>~</span> <span class='st'>"HS"</span>, </span>
<span>                                    <span class='op'>!</span><span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>firstScore</span> <span class='op'>&lt;</span> <span class='va'>CSC</span> <span class='op'>~</span> <span class='st'>"NHS"</span>,</span>
<span>                                    <span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>firstScore</span> <span class='op'>&lt;</span> <span class='va'>CSC</span> <span class='op'>~</span> <span class='st'>"HS"</span>, </span>
<span>                                    <span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>firstScore</span> <span class='op'>&gt;=</span> <span class='va'>CSC</span> <span class='op'>~</span> <span class='st'>"NHS"</span><span class='op'>)</span>,</span>
<span>         lastCSCstatus <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span><span class='op'>!</span><span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>lastScore</span> <span class='op'>&gt;=</span> <span class='va'>CSC</span> <span class='op'>~</span> <span class='st'>"HS"</span>, </span>
<span>                                   <span class='op'>!</span><span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>lastScore</span> <span class='op'>&lt;</span> <span class='va'>CSC</span> <span class='op'>~</span> <span class='st'>"NHS"</span>,</span>
<span>                                   <span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>lastScore</span> <span class='op'>&lt;</span> <span class='va'>CSC</span> <span class='op'>~</span> <span class='st'>"HS"</span>, </span>
<span>                                   <span class='va'>goodScorePos</span> <span class='op'>&amp;</span> <span class='va'>lastScore</span> <span class='op'>&gt;=</span> <span class='va'>CSC</span> <span class='op'>~</span> <span class='st'>"NHS"</span><span class='op'>)</span>,</span>
<span>         CSC4 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>firstCSCstatus</span>, <span class='st'>"To"</span>, <span class='va'>lastCSCstatus</span><span class='op'>)</span>,</span>
<span>         RCSC5 <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span></span>
<span>           <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"NoRelChange"</span> <span class='op'>~</span> <span class='st'>"NoRelChange"</span>,</span>
<span>           <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"RelDet"</span>  <span class='op'>~</span> <span class='st'>"RelDet"</span>,</span>
<span>           <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"RelImp"</span> <span class='op'>&amp;</span> <span class='va'>CSC4</span> <span class='op'>==</span> <span class='st'>"HSToHS"</span> <span class='op'>~</span> <span class='st'>"RelImpHSToHS"</span>,</span>
<span>           <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"RelImp"</span> <span class='op'>&amp;</span> <span class='va'>CSC4</span> <span class='op'>==</span> <span class='st'>"HSToNHS"</span> <span class='op'>~</span> <span class='st'>"RelImpHSToNHS"</span>,</span>
<span>           <span class='va'>RCIchange</span> <span class='op'>==</span> <span class='st'>"RelImp"</span> <span class='op'>&amp;</span> <span class='va'>CSC4</span> <span class='op'>==</span> <span class='st'>"NHSToNHS"</span> <span class='op'>~</span> <span class='st'>"RelImpNHSToNHS"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='co'>### now reduce numbers</span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>RCSC5</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/row_number.html'>row_number</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>&lt;</span> <span class='fl'>21</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpDat</span></span>
<span></span>
<span><span class='va'>tmpDat</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpN</span></span>
<span></span>
<span><span class='va'>tmpDat</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span></span>
<span>  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>age <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"E"</span>, <span class='fl'>3</span><span class='op'>)</span>,</span>
<span>                        <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"A"</span>, <span class='fl'>5</span><span class='op'>)</span>,</span>
<span>                        <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"O"</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>, </span>
<span>                      <span class='va'>tmpN</span>,</span>
<span>                      replace <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>tmpDat</span></span>
<span></span>
<span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tmpDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>             finalScores <span class='op'>=</span> <span class='va'>tmpDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>             pointNames <span class='op'>=</span> <span class='va'>tmpDat</span><span class='op'>$</span><span class='va'>age</span>, </span>
<span>             namesNotPoints <span class='op'>=</span> <span class='cn'>TRUE</span>, </span>
<span>             nameRCIDetOnly <span class='op'>=</span> <span class='cn'>FALSE</span>, </span>
<span>             namesSize <span class='op'>=</span> <span class='fl'>3.5</span>, </span>
<span>             areaColourScheme <span class='op'>=</span> <span class='st'>"RCI3"</span>,</span>
<span>             pointColourScheme <span class='op'>=</span> <span class='st'>"NONE"</span>,</span>
<span>             CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>             RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>             minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>             maxPossScore <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="plotjacobson_files/figure-html5/pointIDs4-1.png" width="624" /></p>
</div>
<p>Even here with <em>n</em> =
65 and more pruning out of points from the usually more occupied areas of the plot, overprinting is becoming a issue.</p>
<p>A service may be particularly interested in the IDs of reliable deteriorators. (Though I recommend if doing clinical audit, it is best to balance looking at deteriorators by looking at a similar number of clients who showed the best improvements.) This shows the IDs of the reliable deteriorators. (The IDs above 900 are artificial ones I added to the real data to ensure that all areas of the plot had at least one point.)</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>,</span>
<span>             finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>,</span>
<span>             pointNames <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>tibDat</span><span class='op'>$</span><span class='va'>id</span><span class='op'>)</span>,</span>
<span>             namesNotPoints <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>             nameRCIDetOnly <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>             namesSize <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>             areaColourScheme <span class='op'>=</span> <span class='st'>"RCI3"</span>,</span>
<span>             pointColourScheme <span class='op'>=</span> <span class='st'>"NONE"</span>,</span>
<span>             CSC <span class='op'>=</span> <span class='fl'>1.26</span>,</span>
<span>             RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>             minPossScore <span class='op'>=</span> <span class='fl'>0</span>,</span>
<span>             maxPossScore <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="plotjacobson_files/figure-html5/pointIDs2detOnly-1.png" width="624" /></p>
</div>
<h2 id="point-labelling-options">Point labelling options</h2>
<p>We have already seen that the label size can be varied with namesSize. <em>(13.xi.23: I think I should add a choice of label colour and alpha/transparency and perhaps font and font characteristics.)</em></p>
<h2 id="point-marker-options">Point marker options</h2>
<p>These are pretty esoteric but these three arguments control the mapping of direction of change to point shapes</p>
<ul>
<li><p><strong>pointShapeNoRelChange</strong>: defaults to NULL,</p></li>
<li><p><strong>pointShapeRelDet</strong>: again defaults to NULL,</p></li>
<li><p><strong>pointShapeRelImp</strong>: defaults to NULL</p></li>
</ul>
<p>In addition there are:</p>
<ul>
<li><p><strong>pointSize</strong>: what it says, defaults to 1, you may want to adjust this depending on your output format</p></li>
<li><p><strong>pointAlpha</strong>: defaults to 1, i.e.no transparency. I cant think why you might want to increase transparency, particularly if you are using mapping of characters to areas as the more you reduce this, the less visible the points will become.</p></li>
</ul>
<p><strong>13.xi.23: ouch, something is overriding the remapping of the point shapes for no change but improvement and deterioration are working. Damn!</strong></p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>                finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>                CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>                RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>                minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>                areaColourScheme <span class='op'>=</span> <span class='st'>"RCI3"</span>,</span>
<span>                pointColourScheme <span class='op'>=</span> <span class='st'>"RCI3"</span>,</span>
<span>                pointShapeScheme <span class='op'>=</span> <span class='st'>"RCI3"</span>,</span>
<span>                pointShapeNoRelChange <span class='op'>=</span> <span class='st'>"*"</span>,</span>
<span>                pointShapeRelDet <span class='op'>=</span> <span class='st'>"D"</span>,</span>
<span>                pointShapeRelImp <span class='op'>=</span> <span class='st'>"B"</span>, </span>
<span>                pointSize <span class='op'>=</span> <span class='fl'>2.5</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="plotjacobson_files/figure-html5/pointMarkers1-1.png" width="624" /></p>
</div>
<h2 id="legend-options">Legend options</h2>
<p><strong>13.xi.23 Ouch, more to do. Need to make it possible to override the default legend labels.</strong></p>
<p>So for now the only option is noLegend which defaults to FALSE, which, as this shows, simply removes any legends.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>                finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>                CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>                RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>                minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>                pointSize <span class='op'>=</span> <span class='fl'>2</span>,</span>
<span>                noLegend <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="plotjacobson_files/figure-html5/noLegend-1.png" width="624" /></p>
</div>
<h1 id="saving-the-plot">Saving the plot</h1>
<p>By default the function returns the plot as a ggplot object. That means that if you dont capture the returned plot, R will usually print it to whatever default printing is current for your R session, usually to the console. However, you can capture the ggplot object and do some post-processing of it, though this is probably for R afficionados. This next example illustrates using this to change some aspects of the plot by altering theme settings. Here I have changed some text colours (why you would want to do that is of course, unclear!). Some theme changes wont impact on the plot, at least some arguments have been used to set things like area colours.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>              finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>              CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>              RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>              minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>              maxPossScore <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>savedPlot</span></span>
<span></span>
<span><span class='va'>savedPlot</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"blue"</span><span class='op'>)</span>,</span>
<span>        axis.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span>,</span>
<span>        plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>, </span>
<span>        plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> </span></code></pre>
</div>
</details>
<p><img src="plotjacobson_files/figure-html5/greyscale-1.png" width="624" /></p>
</div>
<p>Probably more importantly this can be used to capture the plot and send it to another print option, e.g.to print it to a PDF, jpeg, png or tiff file. (Use R help for those formats if you arent familiar with doing that.)</p>
<h1 id="technicalities-geek-stuff">Technicalities (geek stuff)</h1>
<h2 id="printvariables">printVariables</h2>
<p><em>[This needs a lot of work.]</em></p>
<p>I have written in an argument, printVariables, a logical value which defaults to FALSE. If TRUE it will print a lot (a <em>lot</em>) of information about the internal state of the function which might help me debug unexpected problems. Heres what it tells me for the default run.</p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, </span>
<span>                finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>                CSC <span class='op'>=</span> <span class='fl'>1.26</span>, </span>
<span>                RCI <span class='op'>=</span> <span class='fl'>0.3983001</span>,</span>
<span>                minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>                maxPossScore <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span>                printVariables <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>-&gt;</span> <span class='va'>savedPlot</span></span></code></pre>
</div>
</details>
<pre><code>[1] &quot;Here are all the arguments from the call:&quot;
[1] &quot; &quot;
$baselineScores
tibDat$firstScore

$finalScores
tibDat$lastScore

$CSC
[1] 1.26

$RCI
[1] 0.3983001

$minPossScore
[1] 0

$maxPossScore
[1] 4

$printVariables
[1] TRUE

[1] &quot; &quot;
[1] &quot;And here are all the internal variables at the end of the function:&quot;
[1] &quot; &quot;
  [1] &quot;areaAlpha&quot;                        
  [2] &quot;areaColourScheme&quot;                 
  [3] &quot;baselineScores&quot;                   
  [4] &quot;borderColour&quot;                     
  [5] &quot;coloursCSC4&quot;                      
  [6] &quot;coloursDirection&quot;                 
  [7] &quot;coloursRCI3&quot;                      
  [8] &quot;coloursRCSC10&quot;                    
  [9] &quot;coloursRCSC5&quot;                     
 [10] &quot;coloursRCSC7&quot;                     
 [11] &quot;Complete&quot;                         
 [12] &quot;CSC&quot;                              
 [13] &quot;dfPolygonNoRelChangeDetHighToHigh&quot;
 [14] &quot;dfPolygonNoRelChangeDetLowToHigh&quot; 
 [15] &quot;dfPolygonNoRelChangeDetLowToLow&quot;  
 [16] &quot;dfPolygonNoRelChangeImpHighToHigh&quot;
 [17] &quot;dfPolygonNoRelChangeImpHighToLow&quot; 
 [18] &quot;dfPolygonNoRelChangeImpLowToLow&quot;  
 [19] &quot;dfPolygonRelDetHighToHigh&quot;        
 [20] &quot;dfPolygonRelDetLowToHigh&quot;         
 [21] &quot;dfPolygonRelDetLowToLow&quot;          
 [22] &quot;dfPolygonRelImpHighToHigh&quot;        
 [23] &quot;dfPolygonRelImpHighToLow&quot;         
 [24] &quot;dfPolygonRelImpLowToLow&quot;          
 [25] &quot;finalScores&quot;                      
 [26] &quot;goodScorePos&quot;                     
 [27] &quot;greyScale&quot;                        
 [28] &quot;Incomplete&quot;                       
 [29] &quot;labelAllPolygons&quot;                 
 [30] &quot;labelCSClines&quot;                    
 [31] &quot;labelsCSC4&quot;                       
 [32] &quot;labelsDirection&quot;                  
 [33] &quot;labelsRCI3&quot;                       
 [34] &quot;labelsRCSC10&quot;                     
 [35] &quot;labelsRCSC10pos&quot;                  
 [36] &quot;labelsRCSC5&quot;                      
 [37] &quot;labelsRCSC5pos&quot;                   
 [38] &quot;labelsRCSC7&quot;                      
 [39] &quot;labelsRCSC7pos&quot;                   
 [40] &quot;legendNameAreas&quot;                  
 [41] &quot;legendNamePoints&quot;                 
 [42] &quot;lineColourCSC&quot;                    
 [43] &quot;lineColourNoChange&quot;               
 [44] &quot;lineColourRCI&quot;                    
 [45] &quot;lineTypeCSC&quot;                      
 [46] &quot;lineTypeNoChange&quot;                 
 [47] &quot;lineTypeRCI&quot;                      
 [48] &quot;lineWidthCSC&quot;                     
 [49] &quot;lineWidthNoChange&quot;                
 [50] &quot;lineWidthRCI&quot;                     
 [51] &quot;listArgs&quot;                         
 [52] &quot;maxPossScore&quot;                     
 [53] &quot;minPossScore&quot;                     
 [54] &quot;nameRCIDetOnly&quot;                   
 [55] &quot;namesNotPoints&quot;                   
 [56] &quot;namesSize&quot;                        
 [57] &quot;nAreaColours&quot;                     
 [58] &quot;nHelpSeeking&quot;                     
 [59] &quot;noLegend&quot;                         
 [60] &quot;noMessages&quot;                       
 [61] &quot;noWarnings&quot;                       
 [62] &quot;nPointColours&quot;                    
 [63] &quot;nPointShapes&quot;                     
 [64] &quot;oldTheme&quot;                         
 [65] &quot;oldWarn&quot;                          
 [66] &quot;omitNHS&quot;                          
 [67] &quot;Original_n&quot;                       
 [68] &quot;plotColour&quot;                       
 [69] &quot;pointAlpha&quot;                       
 [70] &quot;pointColourScheme&quot;                
 [71] &quot;pointNames&quot;                       
 [72] &quot;pointShape&quot;                       
 [73] &quot;pointShapeNoRelChange&quot;            
 [74] &quot;pointShapeRelDet&quot;                 
 [75] &quot;pointShapeRelImp&quot;                 
 [76] &quot;pointShapeScheme&quot;                 
 [77] &quot;pointSize&quot;                        
 [78] &quot;printVariables&quot;                   
 [79] &quot;RCI&quot;                              
 [80] &quot;scoreRange&quot;                       
 [81] &quot;subtitle&quot;                         
 [82] &quot;themeToUse&quot;                       
 [83] &quot;tibAreas&quot;                         
 [84] &quot;tibAreas1&quot;                        
 [85] &quot;title&quot;                            
 [86] &quot;titleJustificn&quot;                   
 [87] &quot;tmpPlot&quot;                          
 [88] &quot;tmpTib&quot;                           
 [89] &quot;tmpTibMissing&quot;                    
 [90] &quot;tmpVecRCSC10&quot;                     
 [91] &quot;tmpVecRCSC5&quot;                      
 [92] &quot;tmpVecRCSC7&quot;                      
 [93] &quot;vec12alphas&quot;                      
 [94] &quot;vec12colours&quot;                     
 [95] &quot;vecAreaColours&quot;                   
 [96] &quot;vecAreaLabels&quot;                    
 [97] &quot;vecAreas&quot;                         
 [98] &quot;vecPointColours&quot;                  
 [99] &quot;vecPointLabels&quot;                   
[100] &quot;vecPointShapes&quot;                   
[101] &quot;vecPointsRCSC5&quot;                   
[102] &quot;warningsToErrors&quot;                 
[103] &quot;xLab&quot;                             
[104] &quot;yLab&quot;                             
[1] &quot; &quot;
[1] &quot;tmpTib&quot;
 [1] &quot;pointNames&quot;      &quot;firstScore&quot;      &quot;lastScore&quot;      
 [4] &quot;goodScorePos&quot;    &quot;RCIcrit&quot;         &quot;CSCcrit&quot;        
 [7] &quot;firstLastChange&quot; &quot;direction3&quot;      &quot;RCIchange&quot;      
[10] &quot;firstCSCstatus&quot;  &quot;lastCSCstatus&quot;   &quot;CSC4&quot;           
[13] &quot;RCSC5&quot;           &quot;RCSC7&quot;           &quot;RCSC10&quot;         
[16] &quot;Shapes&quot;          &quot;Points&quot;         
tibble [185  17] (S3: tbl_df/tbl/data.frame)
 $ pointNames     : chr [1:185] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
 $ firstScore     : num [1:185] 0.5 0.1 1.1 1.44 2.18 ...
 $ lastScore      : num [1:185] 2 0.7 0.1 1.38 1.53 ...
 $ goodScorePos   : logi [1:185] FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ RCIcrit        : num [1:185] 0.398 0.398 0.398 0.398 0.398 ...
 $ CSCcrit        : num [1:185] 1.26 1.26 1.26 1.26 1.26 1.26 1.26 1.26 1.26 1.26 ...
 $ firstLastChange: num [1:185] 1.5 0.6 -1 -0.0588 -0.6471 ...
 $ direction3     : chr [1:185] &quot;Det&quot; &quot;Det&quot; &quot;Imp&quot; &quot;Imp&quot; ...
 $ RCIchange      : chr [1:185] &quot;RelDet&quot; &quot;RelDet&quot; &quot;RelImp&quot; &quot;NoRelChange&quot; ...
 $ firstCSCstatus : chr [1:185] &quot;NHS&quot; &quot;NHS&quot; &quot;NHS&quot; &quot;HS&quot; ...
 $ lastCSCstatus  : chr [1:185] &quot;HS&quot; &quot;NHS&quot; &quot;NHS&quot; &quot;HS&quot; ...
 $ CSC4           : chr [1:185] &quot;NHSToHS&quot; &quot;NHSToNHS&quot; &quot;NHSToNHS&quot; &quot;HSToHS&quot; ...
 $ RCSC5          : chr [1:185] &quot;RelDet&quot; &quot;RelDet&quot; &quot;RelImpNHSToNHS&quot; &quot;NoRelChange&quot; ...
 $ RCSC7          : chr [1:185] &quot;RelDetNHSToHS&quot; &quot;RelDetNHSToNHS&quot; &quot;RelImpNHSToNHS&quot; &quot;NoRelChange&quot; ...
 $ RCSC10         : chr [1:185] &quot;RelDetNHSToHS&quot; &quot;RelDetNHSToNHS&quot; &quot;RelImpNHSToNHS&quot; &quot;NoRelChangeHSToHS&quot; ...
 $ Shapes         : chr [1:185] &quot;default&quot; &quot;default&quot; &quot;default&quot; &quot;default&quot; ...
 $ Points         : chr [1:185] &quot;RelDet&quot; &quot;RelDet&quot; &quot;RelImpNHSToNHS&quot; &quot;NoRelChange&quot; ...
NULL
# A tibble: 185  17
   pointNames firstScore lastScore goodScorePos RCIcrit CSCcrit
   &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt; &lt;lgl&gt;          &lt;dbl&gt;   &lt;dbl&gt;
 1 1                0.5      2     FALSE          0.398    1.26
 2 2                0.1      0.7   FALSE          0.398    1.26
 3 3                1.1      0.1   FALSE          0.398    1.26
 4 4                1.44     1.38  FALSE          0.398    1.26
 5 5                2.18     1.53  FALSE          0.398    1.26
 6 6                1.79     1.03  FALSE          0.398    1.26
 7 7                1.71     1.03  FALSE          0.398    1.26
 8 8                1        0.882 FALSE          0.398    1.26
 9 9                1.91     0.879 FALSE          0.398    1.26
10 10               1.38     0.853 FALSE          0.398    1.26
#  175 more rows
#  11 more variables: firstLastChange &lt;dbl&gt;, direction3 &lt;chr&gt;,
#   RCIchange &lt;chr&gt;, firstCSCstatus &lt;chr&gt;, lastCSCstatus &lt;chr&gt;,
#   CSC4 &lt;chr&gt;, RCSC5 &lt;chr&gt;, RCSC7 &lt;chr&gt;, RCSC10 &lt;chr&gt;, Shapes &lt;chr&gt;,
#   Points &lt;chr&gt;
[1] &quot; &quot;
[1] &quot;tibAreas&quot;
 [1] &quot;iPolygon&quot;    &quot;namePolygon&quot; &quot;RCI&quot;         &quot;direction&quot;  
 [5] &quot;start&quot;       &quot;end&quot;         &quot;CSC4&quot;        &quot;areaAlpha&quot;  
 [9] &quot;RCSC5&quot;       &quot;RCSC7&quot;       &quot;RCSC10&quot;      &quot;x&quot;          
[13] &quot;y&quot;           &quot;xCentre&quot;     &quot;yCentre&quot;     &quot;Areas&quot;      
tibble [44  16] (S3: tbl_df/tbl/data.frame)
 $ iPolygon   : num [1:44] 1 1 1 2 2 2 2 3 3 3 ...
 $ namePolygon: Ord.factor w/ 12 levels &quot;RelDetHighToHigh&quot;&lt;..: 1 1 1 2 2 2 2 3 3 3 ...
 $ RCI        : chr [1:44] &quot;RelDet&quot; &quot;RelDet&quot; &quot;RelDet&quot; &quot;NoRelChange&quot; ...
 $ direction  : chr [1:44] &quot;Det&quot; &quot;Det&quot; &quot;Det&quot; &quot;Det&quot; ...
 $ start      : chr [1:44] &quot;High&quot; &quot;High&quot; &quot;High&quot; &quot;High&quot; ...
 $ end        : chr [1:44] &quot;High&quot; &quot;High&quot; &quot;High&quot; &quot;High&quot; ...
 $ CSC4       : chr [1:44] &quot;StayedHigh&quot; &quot;StayedHigh&quot; &quot;StayedHigh&quot; &quot;StayedHigh&quot; ...
 $ areaAlpha  : num [1:44] 0.3 0.3 0.3 0.3 0.3 0.3 0.3 0.3 0.3 0.3 ...
 $ RCSC5      : chr [1:44] &quot;RelDet&quot; &quot;RelDet&quot; &quot;RelDet&quot; &quot;NoRelChange&quot; ...
 $ RCSC7      : chr [1:44] &quot;RelDetHSToHS&quot; &quot;RelDetHSToHS&quot; &quot;RelDetHSToHS&quot; &quot;NoRelChange&quot; ...
 $ RCSC10     : chr [1:44] &quot;RelDetHSToHS&quot; &quot;RelDetHSToHS&quot; &quot;RelDetHSToHS&quot; &quot;NoRelChangeHSToHS&quot; ...
 $ x          : num [1:44] 1.26 3.6 1.26 1.26 4 ...
 $ y          : num [1:44] 1.66 4 4 1.26 4 ...
 $ xCentre    : num [1:44] 2.04 2.04 2.04 2.53 2.53 ...
 $ yCentre    : num [1:44] 3.22 3.22 3.22 2.73 2.73 ...
 $ Areas      : chr [1:44] &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; ...
NULL
# A tibble: 44  16
   iPolygon namePolygon    RCI   direction start end   CSC4  areaAlpha
      &lt;dbl&gt; &lt;ord&gt;          &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;     &lt;dbl&gt;
 1        1 RelDetHighToH RelD Det       High  High  Stay       0.3
 2        1 RelDetHighToH RelD Det       High  High  Stay       0.3
 3        1 RelDetHighToH RelD Det       High  High  Stay       0.3
 4        2 NoRelChangeDe NoRe Det       High  High  Stay       0.3
 5        2 NoRelChangeDe NoRe Det       High  High  Stay       0.3
 6        2 NoRelChangeDe NoRe Det       High  High  Stay       0.3
 7        2 NoRelChangeDe NoRe Det       High  High  Stay       0.3
 8        3 NoRelChangeIm NoRe Imp       High  High  Stay       0.3
 9        3 NoRelChangeIm NoRe Imp       High  High  Stay       0.3
10        3 NoRelChangeIm NoRe Imp       High  High  Stay       0.3
#  34 more rows
#  8 more variables: RCSC5 &lt;chr&gt;, RCSC7 &lt;chr&gt;, RCSC10 &lt;chr&gt;,
#   x &lt;dbl&gt;, y &lt;dbl&gt;, xCentre &lt;dbl&gt;, yCentre &lt;dbl&gt;, Areas &lt;chr&gt;</code></pre>
</div>
<h2 id="the-plot-areas">The plot areas</h2>
<p>The plotting by area works by breaking up the plot area into the 12 areas/polygons that cover the entire RCSC plot. These are as follows, spiralling in clockwise from top to the right of the CSC (tdc: to dead centre?!)</p>
<ol type="1">
<li>relDetHighToHigh,</li>
<li>noRelChangeDetHighToHigh</li>
<li>noRelChangeImpHighToHigh</li>
<li>relImpHighToHigh</li>
<li>relImpHighToLow (recovered)</li>
<li>relImpLowToLow</li>
<li>noRelChangeImpLowToLow</li>
<li>noRelChangeDetLowToLow</li>
<li>relDetLowToLow</li>
<li>relDetLowToHigh  and now back into the two litle triangles in the middle</li>
<li>noRelChangeDetLowToLow</li>
<li>noRelChangeImpHighToLow</li>
</ol>
<p>You can see these using the <code>labelAllPolygons = TRUE</code> argument to <code>getJacobsonPlot()</code></p>
<div class="layout-chunk" data-layout="l-body-outset">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'>### just to restart the plot area</span></span>
<span><span class='co'># ggplot(data = tibble(x = 1:10, y = 1:10), aes(x = x, y = y)) + geom_point() + geom_line()</span></span>
<span><span class='fu'>getJacobsonPlot</span><span class='op'>(</span>baselineScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>firstScore</span>, finalScores <span class='op'>=</span> <span class='va'>tibDat</span><span class='op'>$</span><span class='va'>lastScore</span>, </span>
<span>             pointNames <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>tibDat</span><span class='op'>$</span><span class='va'>id</span><span class='op'>)</span>,</span>
<span>             namesNotPoints <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>             namesSize <span class='op'>=</span> <span class='fl'>2</span>,</span>
<span>             nameRCIDetOnly <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>             CSC <span class='op'>=</span> <span class='fl'>1.26</span>,</span>
<span>             RCI <span class='op'>=</span> <span class='fl'>0.3123851</span>,</span>
<span>             minPossScore <span class='op'>=</span> <span class='fl'>0</span>, </span>
<span>             maxPossScore <span class='op'>=</span> <span class='fl'>4</span>, </span>
<span>             goodScorePos <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>             omitNHS <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='co'># use to omit scores starting in non-help-seeking range</span></span>
<span>             title <span class='op'>=</span> <span class='st'>"Jacobson plot, Quito clinic data"</span>,</span>
<span>             subtitle <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='co'>#"All completions were of full CORE-OM",</span></span>
<span>             xLab <span class='op'>=</span> <span class='st'>"Initial score"</span>,</span>
<span>             yLab <span class='op'>=</span> <span class='st'>"Final score"</span>,</span>
<span>             noLegend <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>             labelCSClines <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>             areaColourScheme <span class='op'>=</span> <span class='st'>"RCSC5"</span>,</span>
<span>             legendNameArea <span class='op'>=</span> <span class='st'>"Area mapping: RCSC5"</span>,</span>
<span>             pointColourScheme <span class='op'>=</span> <span class='st'>"RCI3"</span>,</span>
<span>             legendNamePoints <span class='op'>=</span> <span class='st'>"Point mapping: RCI3"</span>,</span>
<span>             pointSize <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>             pointAlpha <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>             areaAlpha <span class='op'>=</span> <span class='fl'>.1</span>,</span>
<span>             pointShapeScheme <span class='op'>=</span> <span class='st'>"NONE"</span>,</span>
<span>             lineTypeCSC <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>             lineWidthCSC <span class='op'>=</span> <span class='fl'>.5</span>,</span>
<span>             lineColourCSC <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>             lineTypeNoChange <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>             lineWidthNoChange <span class='op'>=</span> <span class='fl'>.5</span>,</span>
<span>             lineColourNoChange <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>             lineTypeRCI <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>             lineWidthRCI <span class='op'>=</span> <span class='fl'>.5</span>,</span>
<span>             lineColourRCI <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>             labelAllPolygons <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>             noMessages <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='co'># suppress messages</span></span>
<span>             noWarnings <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='co'># suppress my warnings (not other R ones)</span></span>
<span>             warningsToErrors <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>             greyScale <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<p><img src="plotjacobson_files/figure-html5/testFunction-1.png" width="624" /></p>
</div>
<h1 id="improvementstodo-list">Improvements/todo list</h1>
<h2 id="rejected-options">Rejected options</h2>
<ul>
<li>default to return the plot, hence to print it, add option to print and return nothing ?? Cant think why so not!</li>
<li>add option for greyscale rather than coloured plot but only for simple area/point categories or just one greyscale or best to leave greyscales for post-processing of the plot? Yes, I think that is best but put something about that in the vignette and/or Rblog post.</li>
</ul>
<h2 id="things-still-to-do-for-getjacobsonplot">Things still to do for getJacobsonPlot()</h2>
<ul>
<li><p>check that all those mappings are correct, then recheck with goodScorePos <strong>DONE</strong></p></li>
<li><p>then go back to the nightmare of labelling and selective labelling</p></li>
<li><p>if all OK, copy the function three times:</p>
<ul>
<li><p>no CSC</p></li>
<li><p>no RCI</p></li>
<li><p>neither</p></li>
</ul></li>
<li><p>For each of them, strip out the unnecessary bits, out pass all the arguments from plotJacobson() to each, inside each, ensure you ignore the args that become meaningless e.g.the CSC or RCI lines, cant do the default subtitle if no CSC</p></li>
<li><p>then check they work</p></li>
<li><p>if so, think what messages make sense to add</p>
<ul>
<li>add messages in light of Complete about using different alpha or going to geom_count() and about labels not really working above some n<br />
</li>
</ul></li>
<li><p>handle missing CSC and RCI: need to do this by skipping out to an utterly minimal plotting function</p></li>
<li><p>handle missing CSC or to omit the CSC analysis: need to do this by skipping out to a minimal RCI only plotting function</p></li>
<li><p>handle missing RCI or to omit the RCI analysis: do this by skipping out to a minimal CSC only plotting function</p></li>
<li><p>add to CECPfuns hence create all the tests</p></li>
<li><p>Finish this and </p>
<ul>
<li>finalise the Rblog page to reflect changes<br />
</li>
<li>turn it into a CECPfuns vignette</li>
</ul></li>
<li><p>additional functions building on this one:</p>
<ul>
<li>perhaps add functions to add tables to the plot: RCI and/or RCSC table (into top left for goodScorePos == FALSE, bottom right if TRUE)</li>
<li>function using geom_count()</li>
<li>function using categories but single CSC &amp; RCI, map by shape or override colour</li>
<li>ditto using facets (how to map the facets?)</li>
<li>gendered function changing CSC (but not RCI?)</li>
<li>function using named items as variables of dataframe or tibble, allow computation of RCI or fixed RCI</li>
</ul></li>
<li><p>complementary functions</p>
<ul>
<li>function to give missing table</li>
<li>function to give RCI table</li>
<li>function to give CSC table</li>
<li>function to give RCSC5 or RCSC7 table</li>
<li>add options to those functions to crosstabulate by another variable (gender )</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div></li>
</ul>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="reuse">Reuse</h3>
  <p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Evans (2023, Nov. 1). Chris (Evans) R SAFAQ: Background on plotJacobson() function. Retrieved from https://www.psyctc.org/R_blog/posts/2023-11-01-plotjacobson/</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@misc{evans2023background,
  author = {Evans, Chris},
  title = {Chris (Evans) R SAFAQ: Background on plotJacobson() function},
  url = {https://www.psyctc.org/R_blog/posts/2023-11-01-plotjacobson/},
  year = {2023}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
